{"sampler_perf": {"mean_inference_ms": 7.63714777010576, "mean_processing_ms": 9.306971115691367, "mean_env_wait_ms": 128.15737070319813}, "policy_reward_mean": {}, "time_since_restore": 144.73092675209045, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 20, "time_total_s": 144.73092675209045, "episode_reward_max": 750.9013779759407, "off_policy_estimator": {}, "episode_reward_min": 429.88378834724426, "episode_reward_mean": 618.9396103441716, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 144.73092675209045, "timestamp": 1559264429, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 1, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303759d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303758c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-00-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 843.490553359165, "cost1_mean": 124.2068339490985, "system_level_velocity_max": 12.544124798965953, "cost2_min": -67.94649071359422, "outflow_rate_min": 668.9362251429446, "system_level_velocity_min": 8.35913380575033, "cost2_max": -28.617645690209024, "cost1_max": 154.28112411332577, "cost2_mean": -46.29275043126128, "cost1_min": 102.6825320405399, "discrim_loss": 1.3853199481964111, "outflow_rate_mean": 736.4984695239594, "system_level_velocity_mean": 10.34930595258555}}
{"sampler_perf": {"mean_inference_ms": 7.592754583212631, "mean_processing_ms": 9.815213920115472, "mean_env_wait_ms": 126.37958169221722}, "policy_reward_mean": {}, "time_since_restore": 258.9928216934204, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 40, "time_total_s": 258.9928216934204, "episode_reward_max": 865.8986707925797, "off_policy_estimator": {}, "episode_reward_min": 394.33380448818207, "episode_reward_mean": 612.3047507584095, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.26189494132996, "timestamp": 1559264551, "episode_len_mean": 325.0, "iterations_since_restore": 2, "training_iteration": 2, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039b400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-02-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 765.3548395051786, "cost1_mean": 116.87197710538271, "system_level_velocity_max": 10.735402201173438, "cost2_min": -59.75584266954842, "outflow_rate_min": 549.0174983521172, "system_level_velocity_min": 7.812546980761624, "cost2_max": -24.21801971406789, "cost1_max": 130.4816865104033, "cost2_mean": -42.94284672748407, "cost1_min": 94.83586550029472, "discrim_loss": 1.325714111328125, "outflow_rate_mean": 702.4408460899124, "system_level_velocity_mean": 9.818278840363387}}
{"sampler_perf": {"mean_inference_ms": 7.619287542955763, "mean_processing_ms": 9.92441329888268, "mean_env_wait_ms": 124.27361868371543}, "policy_reward_mean": {}, "time_since_restore": 366.2521262168884, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 60, "time_total_s": 366.2521262168884, "episode_reward_max": 657.4021891355515, "off_policy_estimator": {}, "episode_reward_min": 331.6158522069454, "episode_reward_mean": 494.7188606202602, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.25930452346802, "timestamp": 1559264661, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 3, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033a0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033a048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039bf28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039bea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-04-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 755.1266049534084, "cost1_mean": 113.47499134663542, "system_level_velocity_max": 11.375997010595288, "cost2_min": -71.56322372142174, "outflow_rate_min": 569.0407612132294, "system_level_velocity_min": 8.469489145976345, "cost2_max": -22.73413967959663, "cost1_max": 129.06587900049496, "cost2_mean": -34.195761337172094, "cost1_min": 100.03177631975574, "discrim_loss": 1.1864452362060547, "outflow_rate_mean": 684.4593881749599, "system_level_velocity_mean": 9.544734031695283}}
{"sampler_perf": {"mean_inference_ms": 7.630873290509709, "mean_processing_ms": 10.602150349488303, "mean_env_wait_ms": 124.46801250912831}, "policy_reward_mean": {}, "time_since_restore": 484.26075983047485, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 30, "episodes_total": 90, "time_total_s": 484.26075983047485, "episode_reward_max": 717.1574300676584, "off_policy_estimator": {}, "episode_reward_min": 331.9292213022709, "episode_reward_mean": 502.8557354648908, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.00863361358643, "timestamp": 1559264779, "episode_len_mean": 325.0, "iterations_since_restore": 4, "training_iteration": 4, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375e18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-06-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 785.3212640648236, "cost1_mean": 113.60270000631431, "system_level_velocity_max": 11.390960998251437, "cost2_min": -56.143957250657195, "outflow_rate_min": 551.0464432681752, "system_level_velocity_min": 7.7891014006869, "cost2_max": -28.39657207552804, "cost1_max": 138.25043262068226, "cost2_mean": -40.29382387768502, "cost1_min": 92.96100274713011, "discrim_loss": 1.092968225479126, "outflow_rate_mean": 689.1420904470073, "system_level_velocity_mean": 9.504704879473953}}
{"sampler_perf": {"mean_inference_ms": 7.681176288068786, "mean_processing_ms": 10.407576914375161, "mean_env_wait_ms": 125.51085163325952}, "policy_reward_mean": {}, "time_since_restore": 604.918208360672, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 110, "time_total_s": 604.918208360672, "episode_reward_max": 805.3711915910244, "off_policy_estimator": {}, "episode_reward_min": 254.61512292176485, "episode_reward_mean": 504.3271283645183, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.65744853019714, "timestamp": 1559264900, "episode_len_mean": 325.0, "iterations_since_restore": 5, "training_iteration": 5, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033a0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033a048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-08-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 793.2308700539387, "cost1_mean": 122.027069182334, "system_level_velocity_max": 11.881927705098125, "cost2_min": -66.8318918006443, "outflow_rate_min": 542.4919441943952, "system_level_velocity_min": 8.762044370767429, "cost2_max": -29.032866538277663, "cost1_max": 146.17241895055355, "cost2_mean": -46.00265614145491, "cost1_min": 103.27956685309915, "discrim_loss": 1.0033543109893799, "outflow_rate_mean": 715.3157009997733, "system_level_velocity_mean": 10.153538860467297}}
{"sampler_perf": {"mean_inference_ms": 7.723675465959888, "mean_processing_ms": 10.28088423125719, "mean_env_wait_ms": 128.91890446468614}, "policy_reward_mean": {}, "time_since_restore": 735.3631429672241, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 130, "time_total_s": 735.3631429672241, "episode_reward_max": 922.252952972427, "off_policy_estimator": {}, "episode_reward_min": 283.93754586577415, "episode_reward_mean": 576.8316197175533, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.44493460655212, "timestamp": 1559265035, "episode_len_mean": 325.0, "iterations_since_restore": 6, "training_iteration": 6, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039b950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-10-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 873.661429050422, "cost1_mean": 131.61119887959754, "system_level_velocity_max": 13.204139313189234, "cost2_min": -88.6910798577753, "outflow_rate_min": 586.8933843363852, "system_level_velocity_min": 8.302858312142085, "cost2_max": -32.655521744645895, "cost1_max": 164.32854490553967, "cost2_mean": -60.22314866031972, "cost1_min": 99.82400568959882, "discrim_loss": 1.0546544790267944, "outflow_rate_mean": 751.2598284824514, "system_level_velocity_mean": 10.874667393094715}}
{"sampler_perf": {"mean_inference_ms": 7.761901106946223, "mean_processing_ms": 10.744018809420915, "mean_env_wait_ms": 130.35560500662}, "policy_reward_mean": {}, "time_since_restore": 865.1277163028717, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 31, "episodes_total": 161, "time_total_s": 865.1277163028717, "episode_reward_max": 1201.540415264666, "off_policy_estimator": {}, "episode_reward_min": 103.05717182904482, "episode_reward_mean": 819.4565614104991, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.76457333564758, "timestamp": 1559265165, "episode_len_mean": 315.38709677419354, "iterations_since_restore": 7, "training_iteration": 7, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c39d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c37b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-12-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.5997350343109, "cost1_mean": 151.6280355125255, "system_level_velocity_max": 16.89309091251078, "cost2_min": -107.79357429999929, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 9.959260825155123, "cost2_max": -19.68166479341319, "cost1_max": 194.653792735391, "cost2_mean": -80.35365332082534, "cost1_min": 17.665276788879922, "discrim_loss": 1.4236552715301514, "outflow_rate_mean": 828.0294594916438, "system_level_velocity_mean": 12.94572006708386}}
{"sampler_perf": {"mean_inference_ms": 7.732230789401972, "mean_processing_ms": 10.530068945475488, "mean_env_wait_ms": 131.69658401770863}, "policy_reward_mean": {}, "time_since_restore": 992.8199784755707, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 181, "time_total_s": 992.8199784755707, "episode_reward_max": 1143.0666941963136, "off_policy_estimator": {}, "episode_reward_min": 886.8701297128573, "episode_reward_mean": 1024.6697025797796, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.69226217269897, "timestamp": 1559265293, "episode_len_mean": 325.0, "iterations_since_restore": 8, "training_iteration": 8, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303a4950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303a48c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303a4840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303a47b8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-14-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1048.1803522725531, "cost1_mean": 178.09830030616126, "system_level_velocity_max": 17.349274442068715, "cost2_min": -126.71637196931891, "outflow_rate_min": 714.7134039615986, "system_level_velocity_min": 10.627355416637846, "cost2_max": -100.73576839982233, "cost1_max": 210.81132922737612, "cost2_mean": -113.10530980856679, "cost1_min": 127.55359437647512, "discrim_loss": 1.7998487949371338, "outflow_rate_mean": 919.6528599470869, "system_level_velocity_mean": 14.699904985108194}}
{"sampler_perf": {"mean_inference_ms": 7.726768926297366, "mean_processing_ms": 10.588156054509996, "mean_env_wait_ms": 132.62354924414754}, "policy_reward_mean": {}, "time_since_restore": 1128.1957216262817, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 202, "time_total_s": 1128.1957216262817, "episode_reward_max": 1004.1792014241219, "off_policy_estimator": {}, "episode_reward_min": 310.5147449746728, "episode_reward_mean": 780.4647697652912, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.37574315071106, "timestamp": 1559265428, "episode_len_mean": 315.4761904761905, "iterations_since_restore": 9, "training_iteration": 9, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-17-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.7365432504719, "cost1_mean": 172.3951536619497, "system_level_velocity_max": 18.77996757605929, "cost2_min": -139.53351555062258, "outflow_rate_min": 746.748172162775, "system_level_velocity_min": 12.475673158294452, "cost2_max": -58.76265218566351, "cost1_max": 211.82365147185652, "cost2_mean": -120.32087364651467, "cost1_min": 84.74178314181005, "discrim_loss": 1.7922345399856567, "outflow_rate_mean": 918.3733128285633, "system_level_velocity_mean": 14.95481789317823}}
{"sampler_perf": {"mean_inference_ms": 7.691160487191461, "mean_processing_ms": 10.732430380731628, "mean_env_wait_ms": 133.76157044987502}, "policy_reward_mean": {}, "time_since_restore": 1261.9255974292755, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 28, "episodes_total": 230, "time_total_s": 1261.9255974292755, "episode_reward_max": 911.8601620644331, "off_policy_estimator": {}, "episode_reward_min": 581.7435287963599, "episode_reward_mean": 756.306095369892, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.72987580299377, "timestamp": 1559265562, "episode_len_mean": 325.0, "iterations_since_restore": 10, "training_iteration": 10, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-19-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.2916784048116, "cost1_mean": 188.91540342734902, "system_level_velocity_max": 18.791875145205932, "cost2_min": -159.7786520269006, "outflow_rate_min": 832.4577688695981, "system_level_velocity_min": 12.349966754524543, "cost2_max": -109.55354603810673, "cost1_max": 223.68580355956058, "cost2_mean": -127.22320748442192, "cost1_min": 148.97480540663014, "discrim_loss": 1.5239393711090088, "outflow_rate_mean": 972.5354185967243, "system_level_velocity_mean": 15.842527616424203}}
{"sampler_perf": {"mean_inference_ms": 7.693860065133084, "mean_processing_ms": 10.75770236949324, "mean_env_wait_ms": 133.3287874538856}, "policy_reward_mean": {}, "time_since_restore": 1386.8597462177277, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 252, "time_total_s": 1386.8597462177277, "episode_reward_max": 914.0375417172909, "off_policy_estimator": {}, "episode_reward_min": 594.6963618211448, "episode_reward_mean": 758.4368220747194, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.93414878845215, "timestamp": 1559265687, "episode_len_mean": 325.0, "iterations_since_restore": 11, "training_iteration": 11, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930344598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930344510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930344488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-21-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1096.7995297312266, "cost1_mean": 191.8534063200517, "system_level_velocity_max": 18.945227755711755, "cost2_min": -151.96058102462132, "outflow_rate_min": 866.6017821995896, "system_level_velocity_min": 13.226695568360787, "cost2_max": -114.36526101287052, "cost1_max": 224.7352267952727, "cost2_mean": -132.08336535547699, "cost1_min": 156.77960844970218, "discrim_loss": 1.4483989477157593, "outflow_rate_mean": 982.5970331467485, "system_level_velocity_mean": 16.118070768510133}}
{"sampler_perf": {"mean_inference_ms": 7.6681566450559675, "mean_processing_ms": 10.737766934910871, "mean_env_wait_ms": 133.66624248599754}, "policy_reward_mean": {}, "time_since_restore": 1518.4054741859436, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 273, "time_total_s": 1518.4054741859436, "episode_reward_max": 856.3247372731566, "off_policy_estimator": {}, "episode_reward_min": 317.67566978931427, "episode_reward_mean": 679.030507880396, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.54572796821594, "timestamp": 1559265818, "episode_len_mean": 315.4761904761905, "iterations_since_restore": 12, "training_iteration": 12, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303447b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930344730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303446a8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-23-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1085.1726769091815, "cost1_mean": 182.5471381649032, "system_level_velocity_max": 18.82901966775349, "cost2_min": -163.29538477285556, "outflow_rate_min": 713.2653515471405, "system_level_velocity_min": 12.334746195478052, "cost2_max": -66.56395519616339, "cost1_max": 224.51792413334545, "cost2_mean": -128.76782147991233, "cost1_min": 84.44015505779494, "discrim_loss": 1.3664770126342773, "outflow_rate_mean": 958.078817083423, "system_level_velocity_mean": 15.907301653923613}}
{"sampler_perf": {"mean_inference_ms": 7.6542826643137785, "mean_processing_ms": 10.863600206226323, "mean_env_wait_ms": 134.9681745915817}, "policy_reward_mean": {}, "time_since_restore": 1661.201809167862, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 28, "episodes_total": 301, "time_total_s": 1661.201809167862, "episode_reward_max": 773.3228654637933, "off_policy_estimator": {}, "episode_reward_min": 596.5070331580937, "episode_reward_mean": 655.1343044021299, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.79633498191833, "timestamp": 1559265962, "episode_len_mean": 324.0, "iterations_since_restore": 13, "training_iteration": 13, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-26-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1094.637683897278, "cost1_mean": 179.12237613214626, "system_level_velocity_max": 18.883414251253544, "cost2_min": -162.10558392199857, "outflow_rate_min": 783.8313949953965, "system_level_velocity_min": 11.951647443781294, "cost2_max": -113.15043472739656, "cost1_max": 224.07075600687088, "cost2_mean": -129.83052007286142, "cost1_min": 140.94693630938923, "discrim_loss": 1.3010280132293701, "outflow_rate_mean": 944.9588479967928, "system_level_velocity_mean": 15.1684727851322}}
{"sampler_perf": {"mean_inference_ms": 7.65720651826567, "mean_processing_ms": 10.801752225953777, "mean_env_wait_ms": 134.91698855979593}, "policy_reward_mean": {}, "time_since_restore": 1788.1045398712158, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 321, "time_total_s": 1788.1045398712158, "episode_reward_max": 719.8916423395276, "off_policy_estimator": {}, "episode_reward_min": 267.83889758586884, "episode_reward_mean": 677.3682431098074, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.90273070335388, "timestamp": 1559266089, "episode_len_mean": 315.0, "iterations_since_restore": 14, "training_iteration": 14, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f400>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-28-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1089.5928753732262, "cost1_mean": 185.03200173273413, "system_level_velocity_max": 18.865633937901432, "cost2_min": -145.8134103275616, "outflow_rate_min": 747.6721958343614, "system_level_velocity_min": 12.902673356426487, "cost2_max": -64.70642196622626, "cost1_max": 223.3904012860409, "cost2_mean": -123.30635904875115, "cost1_min": 85.40906195405401, "discrim_loss": 1.3895847797393799, "outflow_rate_mean": 968.4326419925858, "system_level_velocity_mean": 16.136428080888614}}
{"sampler_perf": {"mean_inference_ms": 7.667243140937301, "mean_processing_ms": 10.82952705552946, "mean_env_wait_ms": 135.82862085799533}, "policy_reward_mean": {}, "time_since_restore": 1923.3984606266022, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 344, "time_total_s": 1923.3984606266022, "episode_reward_max": 798.3786579146981, "off_policy_estimator": {}, "episode_reward_min": 688.724337913096, "episode_reward_mean": 735.8886370898589, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.29392075538635, "timestamp": 1559266225, "episode_len_mean": 325.0, "iterations_since_restore": 15, "training_iteration": 15, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035fc80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035fbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035fae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035fb70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-30-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1085.5237799489503, "cost1_mean": 175.2849612487659, "system_level_velocity_max": 18.746721530520244, "cost2_min": -133.8274380407051, "outflow_rate_min": 772.9881884328739, "system_level_velocity_min": 11.477782618099058, "cost2_max": -112.44461917087644, "cost1_max": 222.6968500012531, "cost2_mean": -124.50544780273985, "cost1_min": 134.51382044412918, "discrim_loss": 1.3353219032287598, "outflow_rate_mean": 928.6024598583701, "system_level_velocity_mean": 14.77708459080061}}
{"sampler_perf": {"mean_inference_ms": 7.6589775296602385, "mean_processing_ms": 10.797127905183382, "mean_env_wait_ms": 136.66713062416412}, "policy_reward_mean": {}, "time_since_restore": 2055.4865131378174, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 365, "time_total_s": 2055.4865131378174, "episode_reward_max": 868.7875989824533, "off_policy_estimator": {}, "episode_reward_min": 251.53935335576534, "episode_reward_mean": 764.9670936702972, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.0880525112152, "timestamp": 1559266362, "episode_len_mean": 315.4761904761905, "iterations_since_restore": 16, "training_iteration": 16, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-32-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.6688232237639, "cost1_mean": 173.66907766779917, "system_level_velocity_max": 18.440042711258474, "cost2_min": -142.38053558995978, "outflow_rate_min": 744.949948303961, "system_level_velocity_min": 11.532177977866215, "cost2_max": -57.66780977788462, "cost1_max": 221.152215818888, "cost2_mean": -119.08114758946394, "cost1_min": 83.5523438334132, "discrim_loss": 1.359555721282959, "outflow_rate_mean": 926.8780306269376, "system_level_velocity_mean": 15.088832810794502}}
{"sampler_perf": {"mean_inference_ms": 7.640480501837895, "mean_processing_ms": 10.81600124226139, "mean_env_wait_ms": 137.31761399562615}, "policy_reward_mean": {}, "time_since_restore": 2184.5098843574524, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 391, "time_total_s": 2184.5098843574524, "episode_reward_max": 887.2596444785595, "off_policy_estimator": {}, "episode_reward_min": 661.2045555710793, "episode_reward_mean": 791.7844877707271, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.023371219635, "timestamp": 1559266494, "episode_len_mean": 325.0, "iterations_since_restore": 17, "training_iteration": 17, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303402f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-34-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.4896812426912, "cost1_mean": 175.9655579333343, "system_level_velocity_max": 18.16257360329344, "cost2_min": -137.76852360124764, "outflow_rate_min": 809.8937632264419, "system_level_velocity_min": 12.259231127247288, "cost2_max": -105.28146871157712, "cost1_max": 217.8157837437716, "cost2_mean": -119.48987202323983, "cost1_min": 146.7340366538531, "discrim_loss": 1.3766374588012695, "outflow_rate_mean": 924.4707129101176, "system_level_velocity_mean": 14.696906962842407}}
{"sampler_perf": {"mean_inference_ms": 7.645139568420592, "mean_processing_ms": 10.907125895963352, "mean_env_wait_ms": 137.2131490760081}, "policy_reward_mean": {}, "time_since_restore": 2313.311554670334, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 415, "time_total_s": 2313.311554670334, "episode_reward_max": 943.0926596522331, "off_policy_estimator": {}, "episode_reward_min": 596.3632277548313, "episode_reward_mean": 722.3170371614397, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.80167031288147, "timestamp": 1559266622, "episode_len_mean": 325.0, "iterations_since_restore": 18, "training_iteration": 18, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-37-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.2764365549544, "cost1_mean": 181.17060836266066, "system_level_velocity_max": 17.713731903741873, "cost2_min": -131.28977922198206, "outflow_rate_min": 750.0123036195779, "system_level_velocity_min": 11.384040556990822, "cost2_max": -98.85319517120445, "cost1_max": 212.18813047099005, "cost2_mean": -114.6541212715296, "cost1_min": 134.84375774838202, "discrim_loss": 1.348939299583435, "outflow_rate_mean": 934.5814942891162, "system_level_velocity_mean": 15.012485784804277}}
{"sampler_perf": {"mean_inference_ms": 7.660601237942633, "mean_processing_ms": 10.858864113704152, "mean_env_wait_ms": 137.60111861275453}, "policy_reward_mean": {}, "time_since_restore": 2441.637773513794, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 435, "time_total_s": 2441.637773513794, "episode_reward_max": 853.3904481828213, "off_policy_estimator": {}, "episode_reward_min": 539.2675212323666, "episode_reward_mean": 622.519382405281, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.32621884346008, "timestamp": 1559266755, "episode_len_mean": 325.0, "iterations_since_restore": 19, "training_iteration": 19, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303590d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ef28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-39-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.8571376460056, "cost1_mean": 188.3451534846156, "system_level_velocity_max": 17.11087280911905, "cost2_min": -130.13746595575913, "outflow_rate_min": 761.1644102533834, "system_level_velocity_min": 11.702291006251134, "cost2_max": -92.98399817214687, "cost1_max": 207.55501473313777, "cost2_mean": -107.71952090154636, "cost1_min": 138.8651755000643, "discrim_loss": 1.3125805854797363, "outflow_rate_mean": 959.9135647180553, "system_level_velocity_mean": 15.530851574503169}}
{"sampler_perf": {"mean_inference_ms": 7.664004949831324, "mean_processing_ms": 10.922378569273345, "mean_env_wait_ms": 137.83330698895958}, "policy_reward_mean": {}, "time_since_restore": 2567.1727170944214, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 461, "time_total_s": 2567.1727170944214, "episode_reward_max": 732.8187057673931, "off_policy_estimator": {}, "episode_reward_min": 504.17261108756065, "episode_reward_mean": 587.0984360976861, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.53494358062744, "timestamp": 1559266881, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 20, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-41-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1025.6432236289436, "cost1_mean": 187.3697615038711, "system_level_velocity_max": 16.868942689853377, "cost2_min": -128.94090898925344, "outflow_rate_min": 824.6282391993449, "system_level_velocity_min": 12.851638043878754, "cost2_max": -97.92661023587486, "cost1_max": 207.02351283577406, "cost2_mean": -110.99654466072579, "cost1_min": 156.48894765519847, "discrim_loss": 1.3070526123046875, "outflow_rate_mean": 955.0609985944187, "system_level_velocity_mean": 15.374273531463366}}
{"sampler_perf": {"mean_inference_ms": 7.6734828910628226, "mean_processing_ms": 10.997211235206754, "mean_env_wait_ms": 137.63427900563644}, "policy_reward_mean": {}, "time_since_restore": 2695.9519069194794, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 485, "time_total_s": 2695.9519069194794, "episode_reward_max": 823.7092905640602, "off_policy_estimator": {}, "episode_reward_min": 517.1107315272093, "episode_reward_mean": 636.9777323516706, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.77918982505798, "timestamp": 1559267010, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 21, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303591e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303592f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-43-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.722643915921, "cost1_mean": 184.13372098101152, "system_level_velocity_max": 17.559229073307762, "cost2_min": -141.43180170423085, "outflow_rate_min": 811.4228636563263, "system_level_velocity_min": 12.390479813247495, "cost2_max": -96.67480296701018, "cost1_max": 210.7316469769355, "cost2_mean": -115.00252553235616, "cost1_min": 148.8206751964902, "discrim_loss": 1.3435852527618408, "outflow_rate_mean": 947.6410055747364, "system_level_velocity_mean": 15.205731953343703}}
{"sampler_perf": {"mean_inference_ms": 7.667304542585295, "mean_processing_ms": 10.945449965040769, "mean_env_wait_ms": 137.90209459849308}, "policy_reward_mean": {}, "time_since_restore": 2828.3023734092712, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 506, "time_total_s": 2828.3023734092712, "episode_reward_max": 907.8369110673666, "off_policy_estimator": {}, "episode_reward_min": 46.48582863807678, "episode_reward_mean": 687.765648330961, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.35046648979187, "timestamp": 1559267142, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 22, "training_iteration": 22, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c32f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c37b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c39d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-45-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1059.044102495663, "cost1_mean": 181.63890647400981, "system_level_velocity_max": 17.80764558433427, "cost2_min": -130.49164257277187, "outflow_rate_min": 474.3699846082663, "system_level_velocity_min": 13.133590688963542, "cost2_max": -16.94603381314942, "cost1_max": 214.39063556600655, "cost2_mean": -110.7149895849118, "cost1_min": 17.596658357949337, "discrim_loss": 1.4088754653930664, "outflow_rate_mean": 947.6744809241211, "system_level_velocity_mean": 15.875544282510877}}
{"sampler_perf": {"mean_inference_ms": 7.669522815231351, "mean_processing_ms": 10.998147900128986, "mean_env_wait_ms": 138.34916554853942}, "policy_reward_mean": {}, "time_since_restore": 2964.2249155044556, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 531, "time_total_s": 2964.2249155044556, "episode_reward_max": 938.8287898153067, "off_policy_estimator": {}, "episode_reward_min": 648.4491256326437, "episode_reward_mean": 821.500211610198, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.92254209518433, "timestamp": 1559267278, "episode_len_mean": 325.0, "iterations_since_restore": 23, "training_iteration": 23, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361400>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-47-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.3565134210437, "cost1_mean": 169.38919689252006, "system_level_velocity_max": 18.101126469778997, "cost2_min": -138.57068081935248, "outflow_rate_min": 797.1898188723934, "system_level_velocity_min": 11.855835013570792, "cost2_max": -108.75687008282718, "cost1_max": 217.66321083586317, "cost2_mean": -122.91850943156226, "cost1_min": 142.34849311714902, "discrim_loss": 1.433135986328125, "outflow_rate_mean": 904.5267829686778, "system_level_velocity_mean": 14.18752736178566}}
{"sampler_perf": {"mean_inference_ms": 7.680596340021142, "mean_processing_ms": 11.051038162793448, "mean_env_wait_ms": 138.7281742443489}, "policy_reward_mean": {}, "time_since_restore": 3099.1823580265045, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 556, "time_total_s": 3099.1823580265045, "episode_reward_max": 895.4045141786337, "off_policy_estimator": {}, "episode_reward_min": 616.4174180328846, "episode_reward_mean": 771.8664857316018, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.95744252204895, "timestamp": 1559267413, "episode_len_mean": 325.0, "iterations_since_restore": 24, "training_iteration": 24, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303591e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-50-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1080.3051183744824, "cost1_mean": 174.44853628293674, "system_level_velocity_max": 18.41199123743782, "cost2_min": -147.61830775582047, "outflow_rate_min": 821.9217873249274, "system_level_velocity_min": 12.221608053453377, "cost2_max": -110.95328023409813, "cost1_max": 219.66021148191237, "cost2_mean": -125.07215159530064, "cost1_min": 144.97565588724396, "discrim_loss": 1.406184196472168, "outflow_rate_mean": 929.379444227321, "system_level_velocity_mean": 14.685173723788926}}
{"sampler_perf": {"mean_inference_ms": 7.674464465684963, "mean_processing_ms": 11.010875275552873, "mean_env_wait_ms": 138.3468500926418}, "policy_reward_mean": {}, "time_since_restore": 3224.1296112537384, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 577, "time_total_s": 3224.1296112537384, "episode_reward_max": 749.1461386084557, "off_policy_estimator": {}, "episode_reward_min": 44.0341956615448, "episode_reward_mean": 617.9622372268211, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.94725322723389, "timestamp": 1559267540, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 25, "training_iteration": 25, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303339d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303338c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-52-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.284999157978, "cost1_mean": 184.41159659557528, "system_level_velocity_max": 18.81991789295741, "cost2_min": -150.0020952621165, "outflow_rate_min": 494.27405165189856, "system_level_velocity_min": 12.286904142107, "cost2_max": -18.865563775106107, "cost1_max": 224.7490669302482, "cost2_mean": -120.37362603388803, "cost1_min": 18.039750175711994, "discrim_loss": 1.3474003076553345, "outflow_rate_mean": 966.3922333715576, "system_level_velocity_mean": 16.290222284791508}}
{"sampler_perf": {"mean_inference_ms": 7.678261780321925, "mean_processing_ms": 11.042552751111078, "mean_env_wait_ms": 138.51638956990803}, "policy_reward_mean": {}, "time_since_restore": 3357.0426416397095, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 602, "time_total_s": 3357.0426416397095, "episode_reward_max": 669.19886302948, "off_policy_estimator": {}, "episode_reward_min": 533.4689711481333, "episode_reward_mean": 575.2101232987642, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.91303038597107, "timestamp": 1559267673, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 26, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ef28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eb70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-54-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.5034372404778, "cost1_mean": 191.45737075223397, "system_level_velocity_max": 18.504231223876587, "cost2_min": -150.52559593351214, "outflow_rate_min": 850.845678829706, "system_level_velocity_min": 12.785520346425944, "cost2_max": -116.98018769988045, "cost1_max": 221.73962252494877, "cost2_mean": -127.03880601800626, "cost1_min": 152.57880016271997, "discrim_loss": 1.22333562374115, "outflow_rate_mean": 986.0903214832606, "system_level_velocity_mean": 16.111444426742086}}
{"sampler_perf": {"mean_inference_ms": 7.687242210649553, "mean_processing_ms": 11.021470736854713, "mean_env_wait_ms": 138.87875480133118}, "policy_reward_mean": {}, "time_since_restore": 3500.084906578064, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 623, "time_total_s": 3500.084906578064, "episode_reward_max": 590.7817197293043, "off_policy_estimator": {}, "episode_reward_min": 534.5475213080645, "episode_reward_mean": 559.6800378951289, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 143.0422649383545, "timestamp": 1559267818, "episode_len_mean": 325.0, "iterations_since_restore": 27, "training_iteration": 27, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c32f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c38c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-56-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.491104081854, "cost1_mean": 175.04568639831945, "system_level_velocity_max": 18.1523967174196, "cost2_min": -150.69948612649867, "outflow_rate_min": 839.2296367541586, "system_level_velocity_min": 12.594009070710422, "cost2_max": -124.07874118015621, "cost1_max": 216.53231196313322, "cost2_mean": -136.3494644665786, "cost1_min": 150.13709348763348, "discrim_loss": 1.148843765258789, "outflow_rate_mean": 929.9022531525436, "system_level_velocity_mean": 14.728148318934846}}
{"sampler_perf": {"mean_inference_ms": 7.683417515086933, "mean_processing_ms": 11.054223415130808, "mean_env_wait_ms": 138.86312018388296}, "policy_reward_mean": {}, "time_since_restore": 3630.8458511829376, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 647, "time_total_s": 3630.8458511829376, "episode_reward_max": 623.4376216903329, "off_policy_estimator": {}, "episode_reward_min": 542.5539315417409, "episode_reward_mean": 594.6182322688401, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.76094460487366, "timestamp": 1559267948, "episode_len_mean": 325.0, "iterations_since_restore": 28, "training_iteration": 28, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930360598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930360400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-59-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.0502336401491, "cost1_mean": 173.001856094422, "system_level_velocity_max": 17.942803297001486, "cost2_min": -156.4029887705222, "outflow_rate_min": 838.7585188918921, "system_level_velocity_min": 12.810721405797468, "cost2_max": -125.2152527870779, "cost1_max": 215.79671877790133, "cost2_mean": -135.61917692830244, "cost1_min": 152.7994129859763, "discrim_loss": 1.0716793537139893, "outflow_rate_mean": 926.7514425738382, "system_level_velocity_mean": 14.619146981646887}}
{"sampler_perf": {"mean_inference_ms": 7.65575091869857, "mean_processing_ms": 10.97143453475519, "mean_env_wait_ms": 138.7467304343032}, "policy_reward_mean": {}, "time_since_restore": 3757.601403951645, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 667, "time_total_s": 3757.601403951645, "episode_reward_max": 741.0482388883829, "off_policy_estimator": {}, "episode_reward_min": 631.086883187294, "episode_reward_mean": 675.6333413301036, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.75555276870728, "timestamp": 1559268075, "episode_len_mean": 325.0, "iterations_since_restore": 29, "training_iteration": 29, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3bf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-01-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1092.5708913385654, "cost1_mean": 179.66054126529377, "system_level_velocity_max": 18.836722359367535, "cost2_min": -152.21857540192497, "outflow_rate_min": 850.503807453231, "system_level_velocity_min": 12.713470529179114, "cost2_max": -116.49607970904701, "cost1_max": 223.81911184440753, "cost2_mean": -132.46558960269397, "cost1_min": 148.83399772696325, "discrim_loss": 1.1054774522781372, "outflow_rate_mean": 946.1484917580896, "system_level_velocity_mean": 15.165566713917709}}
{"sampler_perf": {"mean_inference_ms": 7.646193448834473, "mean_processing_ms": 11.02124770540855, "mean_env_wait_ms": 138.52624576237326}, "policy_reward_mean": {}, "time_since_restore": 3885.3142368793488, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 27, "episodes_total": 694, "time_total_s": 3885.3142368793488, "episode_reward_max": 812.0670183897018, "off_policy_estimator": {}, "episode_reward_min": 69.34550023078918, "episode_reward_mean": 701.6709087089532, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.71283292770386, "timestamp": 1559268203, "episode_len_mean": 314.0, "iterations_since_restore": 30, "training_iteration": 30, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303332f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303331e0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-03-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1084.453807420517, "cost1_mean": 180.98372101077751, "system_level_velocity_max": 18.689784688235463, "cost2_min": -151.7376734062346, "outflow_rate_min": 497.50056700217027, "system_level_velocity_min": 12.567226715802821, "cost2_max": -19.407267614014426, "cost1_max": 223.18660942300963, "cost2_mean": -124.860581016956, "cost1_min": 18.789340035669973, "discrim_loss": 1.155425786972046, "outflow_rate_mean": 955.0071265259554, "system_level_velocity_mean": 15.866679974658432}}
{"sampler_perf": {"mean_inference_ms": 7.646754714522623, "mean_processing_ms": 11.03489531200286, "mean_env_wait_ms": 138.4838344998584}, "policy_reward_mean": {}, "time_since_restore": 4013.372862100601, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 718, "time_total_s": 4013.372862100601, "episode_reward_max": 778.3548888489604, "off_policy_estimator": {}, "episode_reward_min": 620.0795346889645, "episode_reward_mean": 678.3659837578889, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.05862522125244, "timestamp": 1559268331, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 31, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ed08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-05-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.3229690964295, "cost1_mean": 185.8262186089252, "system_level_velocity_max": 18.669311002115098, "cost2_min": -146.5004724051388, "outflow_rate_min": 838.5270451662383, "system_level_velocity_min": 12.78561759012318, "cost2_max": -113.6663093177073, "cost1_max": 223.19652687728757, "cost2_mean": -126.99789423342861, "cost1_min": 151.77041923599785, "discrim_loss": 1.0735315084457397, "outflow_rate_mean": 966.4772237210351, "system_level_velocity_mean": 15.633795047258848}}
{"sampler_perf": {"mean_inference_ms": 7.640353136621689, "mean_processing_ms": 10.991443214275046, "mean_env_wait_ms": 138.80030438431226}, "policy_reward_mean": {}, "time_since_restore": 4151.665757656097, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 738, "time_total_s": 4151.665757656097, "episode_reward_max": 620.1383397094905, "off_policy_estimator": {}, "episode_reward_min": 504.58547956496477, "episode_reward_mean": 567.4305489105172, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.29289555549622, "timestamp": 1559268470, "episode_len_mean": 325.0, "iterations_since_restore": 32, "training_iteration": 32, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303610d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-07-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.2195559966876, "cost1_mean": 174.14395432750806, "system_level_velocity_max": 18.430853401457902, "cost2_min": -161.63807920089988, "outflow_rate_min": 786.9441058850446, "system_level_velocity_min": 11.791514220102687, "cost2_max": -107.78377699498581, "cost1_max": 220.31339884128147, "cost2_mean": -127.10188109987439, "cost1_min": 140.87868340633466, "discrim_loss": 1.1588599681854248, "outflow_rate_mean": 922.1570983760681, "system_level_velocity_mean": 14.647732701675437}}
{"sampler_perf": {"mean_inference_ms": 7.634824240357683, "mean_processing_ms": 11.024838430297175, "mean_env_wait_ms": 138.87522763398536}, "policy_reward_mean": {}, "time_since_restore": 4281.197199583054, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 764, "time_total_s": 4281.197199583054, "episode_reward_max": 593.2211182583123, "off_policy_estimator": {}, "episode_reward_min": 435.72021249774843, "episode_reward_mean": 493.0466048720364, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.53144192695618, "timestamp": 1559268599, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 33, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ec80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-09-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.6412206747154, "cost1_mean": 183.64393565489797, "system_level_velocity_max": 18.423996569612115, "cost2_min": -142.9441807832133, "outflow_rate_min": 771.2849787735998, "system_level_velocity_min": 11.767044311994347, "cost2_max": -108.54991297018606, "cost1_max": 220.18248369713928, "cost2_mean": -121.43258473840885, "cost1_min": 139.4760398033052, "discrim_loss": 1.1869953870773315, "outflow_rate_mean": 956.9190328116761, "system_level_velocity_mean": 15.396772873002202}}
{"sampler_perf": {"mean_inference_ms": 7.635274510153668, "mean_processing_ms": 11.024629657160716, "mean_env_wait_ms": 138.79415036801427}, "policy_reward_mean": {}, "time_since_restore": 4407.397436380386, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 787, "time_total_s": 4407.397436380386, "episode_reward_max": 529.1240042699501, "off_policy_estimator": {}, "episode_reward_min": 454.8040300095454, "episode_reward_mean": 490.2630356248549, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.20023679733276, "timestamp": 1559268729, "episode_len_mean": 325.0, "iterations_since_restore": 34, "training_iteration": 34, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303619d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303618c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-12-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.4241097163115, "cost1_mean": 176.95171000892265, "system_level_velocity_max": 17.877225460196282, "cost2_min": -151.73717215501352, "outflow_rate_min": 783.7919388108604, "system_level_velocity_min": 12.115336304199602, "cost2_max": -110.47807544902675, "cost1_max": 215.10901823680484, "cost2_mean": -124.34220811366298, "cost1_min": 145.22442149967145, "discrim_loss": 1.1935136318206787, "outflow_rate_mean": 929.1313007805278, "system_level_velocity_mean": 14.767470259983337}}
{"sampler_perf": {"mean_inference_ms": 7.634210986946057, "mean_processing_ms": 10.97823865052481, "mean_env_wait_ms": 138.729451057399}, "policy_reward_mean": {}, "time_since_restore": 4540.854208946228, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 808, "time_total_s": 4540.854208946228, "episode_reward_max": 613.1011083256453, "off_policy_estimator": {}, "episode_reward_min": 528.7460007555783, "episode_reward_mean": 571.3611245855157, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.45677256584167, "timestamp": 1559268866, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 35, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-14-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1069.5518672347066, "cost1_mean": 177.9996729540956, "system_level_velocity_max": 18.098677868683613, "cost2_min": -133.43135746339456, "outflow_rate_min": 763.9077664603769, "system_level_velocity_min": 11.605773636821088, "cost2_max": -106.06313600785813, "cost1_max": 216.64397387799454, "cost2_mean": -116.24370317037483, "cost1_min": 137.3397653710854, "discrim_loss": 1.1962697505950928, "outflow_rate_mean": 929.9885581273044, "system_level_velocity_mean": 14.865210747080457}}
{"sampler_perf": {"mean_inference_ms": 7.617696415705029, "mean_processing_ms": 10.976994804586448, "mean_env_wait_ms": 138.73297411518394}, "policy_reward_mean": {}, "time_since_restore": 4663.574551582336, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 832, "time_total_s": 4663.574551582336, "episode_reward_max": 678.7708916217089, "off_policy_estimator": {}, "episode_reward_min": 569.8365900563076, "episode_reward_mean": 622.0640596687639, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.7203426361084, "timestamp": 1559268988, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 36, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303619d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303618c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-16-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.2455777715086, "cost1_mean": 187.27772014031316, "system_level_velocity_max": 17.441908945315284, "cost2_min": -131.78140954304234, "outflow_rate_min": 822.257641716905, "system_level_velocity_min": 12.621781740132736, "cost2_max": -101.70205060394673, "cost1_max": 210.25176099413696, "cost2_mean": -115.101177728873, "cost1_min": 151.1037045848194, "discrim_loss": 1.1615086793899536, "outflow_rate_mean": 959.8174005008523, "system_level_velocity_mean": 15.485763005049515}}
{"sampler_perf": {"mean_inference_ms": 7.6287717943960285, "mean_processing_ms": 11.008684397783329, "mean_env_wait_ms": 138.77896543442807}, "policy_reward_mean": {}, "time_since_restore": 4788.318737030029, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 857, "time_total_s": 4788.318737030029, "episode_reward_max": 658.9671509582549, "off_policy_estimator": {}, "episode_reward_min": 524.5894630504772, "episode_reward_mean": 572.5044824627042, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.74418544769287, "timestamp": 1559269113, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 37, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ef28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-18-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.9397636713782, "cost1_mean": 186.47342004516034, "system_level_velocity_max": 17.024174636074118, "cost2_min": -131.44015492639744, "outflow_rate_min": 793.8021335271994, "system_level_velocity_min": 11.925221569811661, "cost2_max": -103.88835562650198, "cost1_max": 206.2040473601486, "cost2_mean": -116.07602428633409, "cost1_min": 143.47971280463202, "discrim_loss": 1.212784767150879, "outflow_rate_mean": 952.7221792067427, "system_level_velocity_mean": 15.310387259077611}}
{"sampler_perf": {"mean_inference_ms": 7.632094204062022, "mean_processing_ms": 10.984487844327191, "mean_env_wait_ms": 138.7304782374279}, "policy_reward_mean": {}, "time_since_restore": 4917.940671682358, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 878, "time_total_s": 4917.940671682358, "episode_reward_max": 594.7002784833312, "off_policy_estimator": {}, "episode_reward_min": 430.07929440774024, "episode_reward_mean": 481.7409708656459, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.6219346523285, "timestamp": 1559269244, "episode_len_mean": 325.0, "iterations_since_restore": 38, "training_iteration": 38, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303649d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303648c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-20-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.5635236537393, "cost1_mean": 182.8096752115633, "system_level_velocity_max": 16.63264196911136, "cost2_min": -125.58476987958112, "outflow_rate_min": 743.2718963925763, "system_level_velocity_min": 11.418774113770503, "cost2_max": -100.22401485680045, "cost1_max": 202.39123852981461, "cost2_mean": -112.83143638094981, "cost1_min": 136.87223032229042, "discrim_loss": 1.148716926574707, "outflow_rate_mean": 935.7173200245734, "system_level_velocity_mean": 14.974174503622985}}
{"sampler_perf": {"mean_inference_ms": 7.629395969184121, "mean_processing_ms": 10.983429433542724, "mean_env_wait_ms": 139.01633558601466}, "policy_reward_mean": {}, "time_since_restore": 5047.567937850952, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 902, "time_total_s": 5047.567937850952, "episode_reward_max": 478.9994436278939, "off_policy_estimator": {}, "episode_reward_min": 417.24715313408524, "episode_reward_mean": 444.93134502659086, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.62726616859436, "timestamp": 1559269374, "episode_len_mean": 325.0, "iterations_since_restore": 39, "training_iteration": 39, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-22-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.4770377865024, "cost1_mean": 182.18325958014495, "system_level_velocity_max": 15.943652013992516, "cost2_min": -123.64298101678354, "outflow_rate_min": 901.0971677126578, "system_level_velocity_min": 14.178557797041734, "cost2_max": -101.82483765191671, "cost1_max": 194.107852087794, "cost2_mean": -113.44351745948889, "cost1_min": 172.676356676641, "discrim_loss": 1.1015323400497437, "outflow_rate_mean": 934.5978254152924, "system_level_velocity_mean": 14.890819880957764}}
{"sampler_perf": {"mean_inference_ms": 7.637567857651587, "mean_processing_ms": 11.018734314668885, "mean_env_wait_ms": 139.10610920606507}, "policy_reward_mean": {}, "time_since_restore": 5174.629401922226, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 926, "time_total_s": 5174.629401922226, "episode_reward_max": 547.1517667705193, "off_policy_estimator": {}, "episode_reward_min": 66.89435076713562, "episode_reward_mean": 466.5284965304115, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.0614640712738, "timestamp": 1559269502, "episode_len_mean": 300.875, "iterations_since_restore": 40, "training_iteration": 40, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303649d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303648c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-25-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 946.0620597063506, "cost1_mean": 164.81608697684106, "system_level_velocity_max": 18.365136340967016, "cost2_min": -120.19109126455166, "outflow_rate_min": 484.88522595723686, "system_level_velocity_min": 13.81786335860445, "cost2_max": -21.136862717314653, "cost1_max": 184.61475592582912, "cost2_mean": -105.147868975645, "cost1_min": 22.788175975517795, "discrim_loss": 1.0636515617370605, "outflow_rate_mean": 882.3607812399856, "system_level_velocity_mean": 14.804555451290788}}
{"sampler_perf": {"mean_inference_ms": 7.6452283039068005, "mean_processing_ms": 11.033996415833705, "mean_env_wait_ms": 139.15300072767496}, "policy_reward_mean": {}, "time_since_restore": 5305.869733095169, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 950, "time_total_s": 5305.869733095169, "episode_reward_max": 678.527359393891, "off_policy_estimator": {}, "episode_reward_min": 500.31468066573143, "episode_reward_mean": 600.2832710424167, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.24033117294312, "timestamp": 1559269633, "episode_len_mean": 325.0, "iterations_since_restore": 41, "training_iteration": 41, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303647b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303646a8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-27-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 954.7169131486091, "cost1_mean": 171.5526121260243, "system_level_velocity_max": 15.13239773336381, "cost2_min": -128.20120983885238, "outflow_rate_min": 764.0498309259577, "system_level_velocity_min": 11.657720410507444, "cost2_max": -94.83922663872053, "cost1_max": 185.02878120493924, "cost2_mean": -110.46950493990342, "cost1_min": 140.81425664708823, "discrim_loss": 0.9756022691726685, "outflow_rate_mean": 896.6129576302325, "system_level_velocity_mean": 13.990163327367597}}
{"sampler_perf": {"mean_inference_ms": 7.645525336208797, "mean_processing_ms": 11.003520872391524, "mean_env_wait_ms": 139.4832918195209}, "policy_reward_mean": {}, "time_since_restore": 5445.830643892288, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 970, "time_total_s": 5445.830643892288, "episode_reward_max": 653.8722060685977, "off_policy_estimator": {}, "episode_reward_min": 550.9852790059522, "episode_reward_mean": 617.6685161906062, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 139.96091079711914, "timestamp": 1559269773, "episode_len_mean": 325.0, "iterations_since_restore": 42, "training_iteration": 42, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e2f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-29-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 943.2933470742704, "cost1_mean": 169.18575590569947, "system_level_velocity_max": 14.85260663333002, "cost2_min": -124.49356486496846, "outflow_rate_min": 739.2456909396847, "system_level_velocity_min": 11.29973870404698, "cost2_max": -102.24246693546341, "cost1_max": 182.50237690586488, "cost2_mean": -109.88653675295151, "cost1_min": 135.47044012723825, "discrim_loss": 0.9887941479682922, "outflow_rate_mean": 886.8344019999571, "system_level_velocity_mean": 13.79919485347762}}
{"sampler_perf": {"mean_inference_ms": 7.640352267394657, "mean_processing_ms": 11.045580998162032, "mean_env_wait_ms": 139.71874801811498}, "policy_reward_mean": {}, "time_since_restore": 5575.952877521515, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 28, "episodes_total": 998, "time_total_s": 5575.952877521515, "episode_reward_max": 630.2399486377835, "off_policy_estimator": {}, "episode_reward_min": 58.17405468225479, "episode_reward_mean": 506.0096205585869, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.12223362922668, "timestamp": 1559269903, "episode_len_mean": 304.07142857142856, "iterations_since_restore": 43, "training_iteration": 43, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303590d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c32f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-31-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 942.3012121788641, "cost1_mean": 159.91326971456058, "system_level_velocity_max": 18.275287978703947, "cost2_min": -123.68633810080237, "outflow_rate_min": 460.62677674270975, "system_level_velocity_min": 12.64105391143003, "cost2_max": -19.25316801623017, "cost1_max": 182.36165155549094, "cost2_mean": -103.87087839504817, "cost1_min": 17.86319216816724, "discrim_loss": 0.9111045002937317, "outflow_rate_mean": 862.0313384642425, "system_level_velocity_mean": 14.143330979963352}}
{"sampler_perf": {"mean_inference_ms": 7.650061722527973, "mean_processing_ms": 11.081231005493814, "mean_env_wait_ms": 139.56706329499704}, "policy_reward_mean": {}, "time_since_restore": 5707.503283262253, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1022, "time_total_s": 5707.503283262253, "episode_reward_max": 485.1210404317826, "off_policy_estimator": {}, "episode_reward_min": 382.94665917009115, "episode_reward_mean": 419.80539090919774, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.55040574073792, "timestamp": 1559270035, "episode_len_mean": 325.0, "iterations_since_restore": 44, "training_iteration": 44, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e950>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-33-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 944.3303632847155, "cost1_mean": 171.47997039924257, "system_level_velocity_max": 14.882042919124387, "cost2_min": -121.98882380732327, "outflow_rate_min": 844.3121088530066, "system_level_velocity_min": 13.069206195261913, "cost2_max": -99.32831558254918, "cost1_max": 183.34741473429207, "cost2_mean": -111.24050132831091, "cost1_min": 159.30544449237493, "discrim_loss": 0.8929721117019653, "outflow_rate_mean": 895.8494356165228, "system_level_velocity_mean": 13.953743128349382}}
{"sampler_perf": {"mean_inference_ms": 7.641868079024059, "mean_processing_ms": 11.047979505435578, "mean_env_wait_ms": 139.64778730552896}, "policy_reward_mean": {}, "time_since_restore": 5835.887712478638, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 1042, "time_total_s": 5835.887712478638, "episode_reward_max": 397.59399177879095, "off_policy_estimator": {}, "episode_reward_min": 350.83377980068326, "episode_reward_mean": 376.768145251344, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.3844292163849, "timestamp": 1559270164, "episode_len_mean": 325.0, "iterations_since_restore": 45, "training_iteration": 45, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365400>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-36-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 947.0980782750412, "cost1_mean": 173.82466581587198, "system_level_velocity_max": 14.990552964873709, "cost2_min": -129.1532449932855, "outflow_rate_min": 813.9245759697842, "system_level_velocity_min": 12.231517656317646, "cost2_max": -95.9674640089184, "cost1_max": 184.2644457324892, "cost2_mean": -110.6648222315273, "cost1_min": 152.40018174700472, "discrim_loss": 0.8595225214958191, "outflow_rate_mean": 904.8121459002004, "system_level_velocity_mean": 14.140344127560486}}
{"sampler_perf": {"mean_inference_ms": 7.635075272038912, "mean_processing_ms": 11.045029796522096, "mean_env_wait_ms": 139.92450834293842}, "policy_reward_mean": {}, "time_since_restore": 5974.188845157623, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1066, "time_total_s": 5974.188845157623, "episode_reward_max": 418.28587599121965, "off_policy_estimator": {}, "episode_reward_min": 352.68545085471123, "episode_reward_mean": 390.7991611301356, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.3011326789856, "timestamp": 1559270302, "episode_len_mean": 325.0, "iterations_since_restore": 46, "training_iteration": 46, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ed08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ed90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-38-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 958.6809674129329, "cost1_mean": 169.00809609002386, "system_level_velocity_max": 15.217484444266772, "cost2_min": -120.80201069485659, "outflow_rate_min": 700.1615308395566, "system_level_velocity_min": 10.6699883861909, "cost2_max": -94.72169306183986, "cost1_max": 186.06352457031255, "cost2_mean": -107.25040740428845, "cost1_min": 129.49525422330825, "discrim_loss": 0.7615728378295898, "outflow_rate_mean": 888.122317673238, "system_level_velocity_mean": 13.81634309990964}}
{"sampler_perf": {"mean_inference_ms": 7.6522989767277005, "mean_processing_ms": 11.072328451374092, "mean_env_wait_ms": 140.0938425112175}, "policy_reward_mean": {}, "time_since_restore": 6106.580923318863, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1090, "time_total_s": 6106.580923318863, "episode_reward_max": 474.13887874409556, "off_policy_estimator": {}, "episode_reward_min": 400.5265574110672, "episode_reward_mean": 443.75898254006944, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.39207816123962, "timestamp": 1559270437, "episode_len_mean": 325.0, "iterations_since_restore": 47, "training_iteration": 47, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-40-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 936.0682286277417, "cost1_mean": 171.5128447010222, "system_level_velocity_max": 14.661150469933727, "cost2_min": -126.7944571404328, "outflow_rate_min": 839.1175677153119, "system_level_velocity_min": 12.963089554607306, "cost2_max": -96.41000648689479, "cost1_max": 180.84021981177847, "cost2_mean": -111.30192562524574, "cost1_min": 160.31710804961446, "discrim_loss": 0.8337844014167786, "outflow_rate_mean": 895.5963472711472, "system_level_velocity_mean": 13.947986398803911}}
{"sampler_perf": {"mean_inference_ms": 7.647658709227039, "mean_processing_ms": 11.058506464948016, "mean_env_wait_ms": 139.77699157195656}, "policy_reward_mean": {}, "time_since_restore": 6229.949391126633, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1112, "time_total_s": 6229.949391126633, "episode_reward_max": 482.52464838605374, "off_policy_estimator": {}, "episode_reward_min": 348.4412768979091, "episode_reward_mean": 395.3683451564866, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.36846780776978, "timestamp": 1559270560, "episode_len_mean": 325.0, "iterations_since_restore": 48, "training_iteration": 48, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303642f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e950>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-42-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 935.2751563257748, "cost1_mean": 171.9305428045259, "system_level_velocity_max": 14.72316052911469, "cost2_min": -134.94438854853144, "outflow_rate_min": 792.8768659688027, "system_level_velocity_min": 12.206673910482811, "cost2_max": -96.7821996993504, "cost1_max": 180.95204884138755, "cost2_mean": -110.27829989923288, "cost1_min": 151.32204683603734, "discrim_loss": 0.766930878162384, "outflow_rate_mean": 897.2024185144189, "system_level_velocity_mean": 13.984022499649898}}
{"sampler_perf": {"mean_inference_ms": 7.6461689888348525, "mean_processing_ms": 11.056920149469068, "mean_env_wait_ms": 140.00432314983317}, "policy_reward_mean": {}, "time_since_restore": 6369.28861451149, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1135, "time_total_s": 6369.28861451149, "episode_reward_max": 399.66808803752065, "off_policy_estimator": {}, "episode_reward_min": 262.9900420398917, "episode_reward_mean": 328.8859764366694, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 139.33922338485718, "timestamp": 1559270700, "episode_len_mean": 325.0, "iterations_since_restore": 49, "training_iteration": 49, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ed08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ec80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-45-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 945.3810929867525, "cost1_mean": 173.05525891349689, "system_level_velocity_max": 14.93042775409322, "cost2_min": -127.67479798567761, "outflow_rate_min": 768.2048906658143, "system_level_velocity_min": 11.800119633121703, "cost2_max": -97.02106699771538, "cost1_max": 183.44951076601296, "cost2_mean": -111.25274639213976, "cost1_min": 143.43313200278163, "discrim_loss": 0.7461773157119751, "outflow_rate_mean": 901.2287059525248, "system_level_velocity_mean": 14.053659419671211}}
{"sampler_perf": {"mean_inference_ms": 7.645659800612965, "mean_processing_ms": 11.089207480946651, "mean_env_wait_ms": 140.23810860468626}, "policy_reward_mean": {}, "time_since_restore": 6505.471130609512, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 1161, "time_total_s": 6505.471130609512, "episode_reward_max": 321.4616096317768, "off_policy_estimator": {}, "episode_reward_min": 40.020182237029076, "episode_reward_mean": 270.96106752888033, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.18251609802246, "timestamp": 1559270836, "episode_len_mean": 313.53846153846155, "iterations_since_restore": 50, "training_iteration": 50, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-47-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 951.6510411467457, "cost1_mean": 168.30723602303806, "system_level_velocity_max": 17.821023054572336, "cost2_min": -121.54185991257611, "outflow_rate_min": 489.92492200470633, "system_level_velocity_min": 13.008512609355178, "cost2_max": -18.24428388649423, "cost1_max": 185.0524734274445, "cost2_mean": -106.69422309211086, "cost1_min": 17.886667670095754, "discrim_loss": 0.7018952965736389, "outflow_rate_mean": 891.2631423900392, "system_level_velocity_mean": 14.328938970553242}}
{"sampler_perf": {"mean_inference_ms": 7.647049312826867, "mean_processing_ms": 11.08446818513144, "mean_env_wait_ms": 140.09308970685845}, "policy_reward_mean": {}, "time_since_restore": 6642.868718624115, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1183, "time_total_s": 6642.868718624115, "episode_reward_max": 324.16267682472244, "off_policy_estimator": {}, "episode_reward_min": 252.8022414034931, "episode_reward_mean": 289.5651770721253, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.39758801460266, "timestamp": 1559270973, "episode_len_mean": 325.0, "iterations_since_restore": 51, "training_iteration": 51, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-49-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 945.5969827196328, "cost1_mean": 171.3064983998326, "system_level_velocity_max": 14.790422071201203, "cost2_min": -124.6208571871185, "outflow_rate_min": 816.4160202431973, "system_level_velocity_min": 12.12677514066288, "cost2_max": -97.10354145450003, "cost1_max": 181.6819830624131, "cost2_mean": -109.69306274778461, "cost1_min": 150.4649268602082, "discrim_loss": 0.6122173070907593, "outflow_rate_mean": 897.9146847669382, "system_level_velocity_mean": 13.938756724195235}}
{"sampler_perf": {"mean_inference_ms": 7.636473112185116, "mean_processing_ms": 11.066649209032619, "mean_env_wait_ms": 140.16486179577967}, "policy_reward_mean": {}, "time_since_restore": 6784.00212097168, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1206, "time_total_s": 6784.00212097168, "episode_reward_max": 371.94123883731663, "off_policy_estimator": {}, "episode_reward_min": 254.64367285673507, "episode_reward_mean": 320.9564895469407, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 141.1334023475647, "timestamp": 1559271114, "episode_len_mean": 325.0, "iterations_since_restore": 52, "training_iteration": 52, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364bf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-51-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 954.600231997168, "cost1_mean": 173.97139956699158, "system_level_velocity_max": 15.077952354055691, "cost2_min": -123.976256533134, "outflow_rate_min": 741.0308727860981, "system_level_velocity_min": 11.311605156083692, "cost2_max": -99.63011969922098, "cost1_max": 186.43806594990497, "cost2_mean": -109.90651636958445, "cost1_min": 137.10492142699087, "discrim_loss": 0.6416922211647034, "outflow_rate_mean": 905.5003887441137, "system_level_velocity_mean": 14.177632106453057}}
{"sampler_perf": {"mean_inference_ms": 7.632253864123266, "mean_processing_ms": 11.065400310050606, "mean_env_wait_ms": 140.2252397853988}, "policy_reward_mean": {}, "time_since_restore": 6916.5139355659485, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1229, "time_total_s": 6916.5139355659485, "episode_reward_max": 356.32400073856115, "off_policy_estimator": {}, "episode_reward_min": 286.2745018975111, "episode_reward_mean": 319.45441601773643, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.5118145942688, "timestamp": 1559271247, "episode_len_mean": 325.0, "iterations_since_restore": 53, "training_iteration": 53, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ed08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-54-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 935.0549942112019, "cost1_mean": 173.81052468354952, "system_level_velocity_max": 14.810327705256569, "cost2_min": -122.94249508474748, "outflow_rate_min": 826.4707128133136, "system_level_velocity_min": 12.515448079954744, "cost2_max": -104.09118772435139, "cost1_max": 181.0643045684036, "cost2_mean": -111.87723227272895, "cost1_min": 154.89830191559224, "discrim_loss": 0.6459353566169739, "outflow_rate_mean": 904.2590484481345, "system_level_velocity_mean": 14.142758767622277}}
{"sampler_perf": {"mean_inference_ms": 7.639216327202578, "mean_processing_ms": 11.0757645663001, "mean_env_wait_ms": 139.92015079079454}, "policy_reward_mean": {}, "time_since_restore": 7042.84662771225, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1253, "time_total_s": 7042.84662771225, "episode_reward_max": 327.63584084279137, "off_policy_estimator": {}, "episode_reward_min": 232.6730463631684, "episode_reward_mean": 265.465419210479, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.33269214630127, "timestamp": 1559271373, "episode_len_mean": 325.0, "iterations_since_restore": 54, "training_iteration": 54, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79304250d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-56-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 961.019822816007, "cost1_mean": 174.3211726773475, "system_level_velocity_max": 15.355454944908594, "cost2_min": -124.87500078749495, "outflow_rate_min": 740.6570069948712, "system_level_velocity_min": 11.318459059948328, "cost2_max": -102.17110595125138, "cost1_max": 186.95119310753842, "cost2_mean": -111.91009748056467, "cost1_min": 136.40465564621306, "discrim_loss": 0.6181890964508057, "outflow_rate_mean": 906.5783043437109, "system_level_velocity_mean": 14.247929963563687}}
{"sampler_perf": {"mean_inference_ms": 7.633706053817615, "mean_processing_ms": 11.052884603525085, "mean_env_wait_ms": 140.01247411937487}, "policy_reward_mean": {}, "time_since_restore": 7177.6336171627045, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 1274, "time_total_s": 7177.6336171627045, "episode_reward_max": 268.41438005678356, "off_policy_estimator": {}, "episode_reward_min": 36.71158114820719, "episode_reward_mean": 213.55298851139239, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.7869894504547, "timestamp": 1559271508, "episode_len_mean": 311.1904761904762, "iterations_since_restore": 55, "training_iteration": 55, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-58-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 973.0396603962457, "cost1_mean": 166.5070596827622, "system_level_velocity_max": 18.319285062641985, "cost2_min": -125.11150033816614, "outflow_rate_min": 466.74083028559994, "system_level_velocity_min": 12.375898271690707, "cost2_max": -24.01799258200108, "cost1_max": 190.52007296952496, "cost2_mean": -109.1262292800108, "cost1_min": 22.862962306584564, "discrim_loss": 0.563149094581604, "outflow_rate_mean": 884.5634271174802, "system_level_velocity_mean": 14.361284465643353}}
{"sampler_perf": {"mean_inference_ms": 7.622257375088468, "mean_processing_ms": 11.067614768349813, "mean_env_wait_ms": 140.15772401311372}, "policy_reward_mean": {}, "time_since_restore": 7314.3943910598755, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 1300, "time_total_s": 7314.3943910598755, "episode_reward_max": 273.93139691618853, "off_policy_estimator": {}, "episode_reward_min": 196.25265667081112, "episode_reward_mean": 233.03555033470127, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.76077389717102, "timestamp": 1559271645, "episode_len_mean": 325.0, "iterations_since_restore": 56, "training_iteration": 56, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bba60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-00-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 963.4670676188952, "cost1_mean": 172.7563558390634, "system_level_velocity_max": 15.312273319400003, "cost2_min": -121.75022279903928, "outflow_rate_min": 717.0388123184475, "system_level_velocity_min": 10.887729618186864, "cost2_max": -100.42463765226194, "cost1_max": 186.92265709794168, "cost2_mean": -111.30013409328828, "cost1_min": 129.43446178328475, "discrim_loss": 0.5062687397003174, "outflow_rate_mean": 900.6304342965548, "system_level_velocity_mean": 14.113538782767469}}
{"sampler_perf": {"mean_inference_ms": 7.628450696304267, "mean_processing_ms": 11.081814986945636, "mean_env_wait_ms": 139.8821117876571}, "policy_reward_mean": {}, "time_since_restore": 7442.727674484253, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1323, "time_total_s": 7442.727674484253, "episode_reward_max": 329.9906904665113, "off_policy_estimator": {}, "episode_reward_min": 238.31097836827394, "episode_reward_mean": 279.8300864487044, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.33328342437744, "timestamp": 1559271774, "episode_len_mean": 325.0, "iterations_since_restore": 57, "training_iteration": 57, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-02-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 952.1384555752264, "cost1_mean": 174.66144425133052, "system_level_velocity_max": 15.032574221512942, "cost2_min": -130.34292654975837, "outflow_rate_min": 815.415780075084, "system_level_velocity_min": 12.711062635951754, "cost2_max": -98.42180811779487, "cost1_max": 183.70627864358528, "cost2_mean": -108.24611841899161, "cost1_min": 156.5216353440496, "discrim_loss": 0.5885450839996338, "outflow_rate_mean": 910.6832580440209, "system_level_velocity_mean": 14.242147911582531}}
{"sampler_perf": {"mean_inference_ms": 7.62280003930427, "mean_processing_ms": 11.062341512250889, "mean_env_wait_ms": 139.93541882571193}, "policy_reward_mean": {}, "time_since_restore": 7571.115250825882, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 1344, "time_total_s": 7571.115250825882, "episode_reward_max": 322.67718180452357, "off_policy_estimator": {}, "episode_reward_min": 256.31355152477045, "episode_reward_mean": 277.0456857303867, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.38757634162903, "timestamp": 1559271902, "episode_len_mean": 325.0, "iterations_since_restore": 58, "training_iteration": 58, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-05-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 950.1743155943491, "cost1_mean": 175.83434153545008, "system_level_velocity_max": 14.99916904972755, "cost2_min": -118.20222090573583, "outflow_rate_min": 851.8982758007185, "system_level_velocity_min": 13.238493504963598, "cost2_max": -98.41580051810095, "cost1_max": 182.43405752831154, "cost2_mean": -105.80147508141366, "cost1_min": 160.80935184723353, "discrim_loss": 0.5797947645187378, "outflow_rate_mean": 916.8481016251492, "system_level_velocity_mean": 14.354638048639298}}
{"sampler_perf": {"mean_inference_ms": 7.616581769711286, "mean_processing_ms": 11.060461429664466, "mean_env_wait_ms": 139.93831058150636}, "policy_reward_mean": {}, "time_since_restore": 7701.1558537483215, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1368, "time_total_s": 7701.1558537483215, "episode_reward_max": 293.8373314909404, "off_policy_estimator": {}, "episode_reward_min": 215.2401342780504, "episode_reward_mean": 255.92867925484097, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.04060292243958, "timestamp": 1559272032, "episode_len_mean": 325.0, "iterations_since_restore": 59, "training_iteration": 59, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bba60>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-07-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 949.6002344146056, "cost1_mean": 173.10044495633943, "system_level_velocity_max": 14.857167683269688, "cost2_min": -125.54877829585877, "outflow_rate_min": 766.6428529869745, "system_level_velocity_min": 11.919841782253698, "cost2_max": -95.79005452806877, "cost1_max": 181.1107803463722, "cost2_mean": -108.28485206645182, "cost1_min": 145.85631051841693, "discrim_loss": 0.5395780801773071, "outflow_rate_mean": 907.035611559763, "system_level_velocity_mean": 14.109660935613855}}
{"sampler_perf": {"mean_inference_ms": 7.621380438116204, "mean_processing_ms": 11.073942410874055, "mean_env_wait_ms": 140.01093993642027}, "policy_reward_mean": {}, "time_since_restore": 7833.2788553237915, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1391, "time_total_s": 7833.2788553237915, "episode_reward_max": 278.4925321646733, "off_policy_estimator": {}, "episode_reward_min": 232.46085391100496, "episode_reward_mean": 251.50943446434266, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.12300157546997, "timestamp": 1559272166, "episode_len_mean": 325.0, "iterations_since_restore": 60, "training_iteration": 60, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb730>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-09-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 946.8741278189867, "cost1_mean": 174.24098557045147, "system_level_velocity_max": 14.8485763525865, "cost2_min": -120.16828035167356, "outflow_rate_min": 855.3953035841045, "system_level_velocity_min": 13.176202886805255, "cost2_max": -96.27092175755931, "cost1_max": 181.14339068283664, "cost2_mean": -105.04686688810114, "cost1_min": 161.55026215191472, "discrim_loss": 0.5650396347045898, "outflow_rate_mean": 914.0912166520735, "system_level_velocity_mean": 14.233986274559769}}
{"sampler_perf": {"mean_inference_ms": 7.6207994378493895, "mean_processing_ms": 11.074097392278038, "mean_env_wait_ms": 139.64109228627314}, "policy_reward_mean": {}, "time_since_restore": 7959.068156003952, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1414, "time_total_s": 7959.068156003952, "episode_reward_max": 303.50514944363385, "off_policy_estimator": {}, "episode_reward_min": 228.2162264250219, "episode_reward_mean": 259.610565146511, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.78930068016052, "timestamp": 1559272292, "episode_len_mean": 325.0, "iterations_since_restore": 61, "training_iteration": 61, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-11-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 950.3149199484714, "cost1_mean": 171.58346164742147, "system_level_velocity_max": 14.904890581814, "cost2_min": -115.20758131473244, "outflow_rate_min": 838.0327052784536, "system_level_velocity_min": 12.78355138893723, "cost2_max": -87.64757018852592, "cost1_max": 181.56867753972207, "cost2_mean": -103.60084169855227, "cost1_min": 156.1514569355832, "discrim_loss": 0.5298590660095215, "outflow_rate_mean": 905.3087249696106, "system_level_velocity_mean": 14.043511979932521}}
{"sampler_perf": {"mean_inference_ms": 7.616423043617601, "mean_processing_ms": 11.068031751788174, "mean_env_wait_ms": 139.72707571875225}, "policy_reward_mean": {}, "time_since_restore": 8088.172130346298, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1437, "time_total_s": 8088.172130346298, "episode_reward_max": 291.4456525016576, "off_policy_estimator": {}, "episode_reward_min": 219.108786361292, "episode_reward_mean": 251.21179446169054, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.1039743423462, "timestamp": 1559272422, "episode_len_mean": 325.0, "iterations_since_restore": 62, "training_iteration": 62, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-13-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 952.293572330603, "cost1_mean": 171.3873549122032, "system_level_velocity_max": 14.954930632586247, "cost2_min": -113.81345181501027, "outflow_rate_min": 852.5911662015789, "system_level_velocity_min": 13.039070889593061, "cost2_max": -90.84985576234318, "cost1_max": 180.35509079498593, "cost2_mean": -101.07344647641193, "cost1_min": 159.66246631546915, "discrim_loss": 0.6142076253890991, "outflow_rate_mean": 910.0820914008715, "system_level_velocity_mean": 14.071452769934762}}
{"sampler_perf": {"mean_inference_ms": 7.6179280182791755, "mean_processing_ms": 11.072110576363826, "mean_env_wait_ms": 139.9106939434799}, "policy_reward_mean": {}, "time_since_restore": 8221.162618160248, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1461, "time_total_s": 8221.162618160248, "episode_reward_max": 320.71182521246374, "off_policy_estimator": {}, "episode_reward_min": 235.96573080215603, "episode_reward_mean": 275.4737084735728, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.99048781394958, "timestamp": 1559272555, "episode_len_mean": 325.0, "iterations_since_restore": 63, "training_iteration": 63, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-15-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 939.0962321245914, "cost1_mean": 169.49069103169197, "system_level_velocity_max": 14.599276818601007, "cost2_min": -100.71229044091797, "outflow_rate_min": 845.7204180607117, "system_level_velocity_min": 12.353133992063842, "cost2_max": -83.01917664541469, "cost1_max": 175.92109075997644, "cost2_mean": -92.70508584692128, "cost1_min": 152.23301072802371, "discrim_loss": 0.6406760215759277, "outflow_rate_mean": 911.4209687507629, "system_level_velocity_mean": 13.99459960919905}}
{"sampler_perf": {"mean_inference_ms": 7.622965115187671, "mean_processing_ms": 11.075077473564383, "mean_env_wait_ms": 139.5519650750397}, "policy_reward_mean": {}, "time_since_restore": 8353.621485233307, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1484, "time_total_s": 8353.621485233307, "episode_reward_max": 389.2359005478211, "off_policy_estimator": {}, "episode_reward_min": 245.35199341457337, "episode_reward_mean": 302.8860459633415, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.45886707305908, "timestamp": 1559272687, "episode_len_mean": 325.0, "iterations_since_restore": 64, "training_iteration": 64, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ed08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ee18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-18-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 947.2512534395686, "cost1_mean": 166.80888705354798, "system_level_velocity_max": 14.85591780001734, "cost2_min": -101.0406519379328, "outflow_rate_min": 853.6321322701885, "system_level_velocity_min": 12.50164995055037, "cost2_max": -83.45637386664495, "cost1_max": 177.92810175158263, "cost2_mean": -92.19775135635908, "cost1_min": 153.59302635862014, "discrim_loss": 0.666366457939148, "outflow_rate_mean": 902.4359700811639, "system_level_velocity_mean": 13.796410565896949}}
{"sampler_perf": {"mean_inference_ms": 7.615230401122979, "mean_processing_ms": 11.05895619103075, "mean_env_wait_ms": 139.58306426310676}, "policy_reward_mean": {}, "time_since_restore": 8479.890646219254, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1507, "time_total_s": 8479.890646219254, "episode_reward_max": 416.9897014722228, "off_policy_estimator": {}, "episode_reward_min": 190.80360298181768, "episode_reward_mean": 301.3931908969876, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.26916098594666, "timestamp": 1559272813, "episode_len_mean": 325.0, "iterations_since_restore": 65, "training_iteration": 65, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-20-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 947.5242228865924, "cost1_mean": 164.2130896459451, "system_level_velocity_max": 14.827869795264856, "cost2_min": -119.46085351638285, "outflow_rate_min": 723.0727721502024, "system_level_velocity_min": 9.831540172242674, "cost2_max": -79.17372500121724, "cost1_max": 175.58555827718095, "cost2_mean": -89.57708715222314, "cost1_min": 123.32919673500905, "discrim_loss": 0.6644426584243774, "outflow_rate_mean": 896.4369504409121, "system_level_velocity_mean": 13.669626502061206}}
{"sampler_perf": {"mean_inference_ms": 7.612379381398932, "mean_processing_ms": 11.058093390524922, "mean_env_wait_ms": 139.6658458775957}, "policy_reward_mean": {}, "time_since_restore": 8603.416992664337, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1530, "time_total_s": 8603.416992664337, "episode_reward_max": 455.1040663723834, "off_policy_estimator": {}, "episode_reward_min": 236.2805576887913, "episode_reward_mean": 317.9257733002811, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.52634644508362, "timestamp": 1559272937, "episode_len_mean": 325.0, "iterations_since_restore": 66, "training_iteration": 66, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-22-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 940.4320215628719, "cost1_mean": 161.4684933597411, "system_level_velocity_max": 14.604096385134484, "cost2_min": -102.80752517479269, "outflow_rate_min": 780.0630780387577, "system_level_velocity_min": 11.36387291293803, "cost2_max": -75.10442726005292, "cost1_max": 173.19364210015993, "cost2_mean": -86.34048008136651, "cost1_min": 137.34620650614562, "discrim_loss": 0.7216074466705322, "outflow_rate_mean": 891.5939039161099, "system_level_velocity_mean": 13.493464425428257}}
{"sampler_perf": {"mean_inference_ms": 7.617359345924285, "mean_processing_ms": 11.075587617588928, "mean_env_wait_ms": 139.30659939213785}, "policy_reward_mean": {}, "time_since_restore": 8727.516652107239, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1554, "time_total_s": 8727.516652107239, "episode_reward_max": 487.0754892685218, "off_policy_estimator": {}, "episode_reward_min": 220.18419025163166, "episode_reward_mean": 382.83439952551754, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.09965944290161, "timestamp": 1559273061, "episode_len_mean": 325.0, "iterations_since_restore": 67, "training_iteration": 67, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbd08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-24-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 937.2914260214644, "cost1_mean": 156.80133812409838, "system_level_velocity_max": 14.627976870556768, "cost2_min": -83.8827566410082, "outflow_rate_min": 839.8655521293174, "system_level_velocity_min": 11.999662527368034, "cost2_max": -69.58797883544275, "cost1_max": 171.17048344366998, "cost2_mean": -78.58827630183431, "cost1_min": 144.40304190273974, "discrim_loss": 0.8771726489067078, "outflow_rate_mean": 882.0699264671799, "system_level_velocity_mean": 13.196834389366481}}
{"sampler_perf": {"mean_inference_ms": 7.610654420954196, "mean_processing_ms": 11.043940615446896, "mean_env_wait_ms": 139.235711018246}, "policy_reward_mean": {}, "time_since_restore": 8851.447155714035, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 20, "episodes_total": 1574, "time_total_s": 8851.447155714035, "episode_reward_max": 448.8733783336356, "off_policy_estimator": {}, "episode_reward_min": 288.0079766046256, "episode_reward_mean": 370.90225125786384, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.93050360679626, "timestamp": 1559273185, "episode_len_mean": 325.0, "iterations_since_restore": 68, "training_iteration": 68, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365950>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-26-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 950.2032583944093, "cost1_mean": 155.93590953255645, "system_level_velocity_max": 14.777787843066736, "cost2_min": -89.26719958544527, "outflow_rate_min": 799.9088644666239, "system_level_velocity_min": 11.401367678958858, "cost2_max": -67.32120399437358, "cost1_max": 172.2709959641858, "cost2_mean": -76.75493586518078, "cost1_min": 138.2616811194059, "discrim_loss": 0.8824460506439209, "outflow_rate_mean": 879.4251429168764, "system_level_velocity_mean": 13.164600183190846}}
{"sampler_perf": {"mean_inference_ms": 7.600390402361786, "mean_processing_ms": 11.062733956545461, "mean_env_wait_ms": 139.0797358400888}, "policy_reward_mean": {}, "time_since_restore": 8969.657173871994, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 1600, "time_total_s": 8969.657173871994, "episode_reward_max": 479.06292959395796, "off_policy_estimator": {}, "episode_reward_min": 275.0065413310658, "episode_reward_mean": 371.7221943919923, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.21001815795898, "timestamp": 1559273304, "episode_len_mean": 325.0, "iterations_since_restore": 69, "training_iteration": 69, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303629d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-28-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 954.5994145281319, "cost1_mean": 160.37689036974012, "system_level_velocity_max": 14.85138388410584, "cost2_min": -82.94776481988157, "outflow_rate_min": 852.5156623052665, "system_level_velocity_min": 12.52892499837558, "cost2_max": -64.13156845325179, "cost1_max": 172.21127840439806, "cost2_mean": -73.07385897821165, "cost1_min": 151.02851552034787, "discrim_loss": 0.9198238849639893, "outflow_rate_mean": 899.6255235842782, "system_level_velocity_mean": 13.62837049633866}}
{"sampler_perf": {"mean_inference_ms": 7.608683095464317, "mean_processing_ms": 11.065353877789297, "mean_env_wait_ms": 138.7494213957574}, "policy_reward_mean": {}, "time_since_restore": 9083.777386426926, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1623, "time_total_s": 9083.777386426926, "episode_reward_max": 411.7521088827634, "off_policy_estimator": {}, "episode_reward_min": 284.5365948409308, "episode_reward_mean": 358.9196629170025, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.12021255493164, "timestamp": 1559273418, "episode_len_mean": 325.0, "iterations_since_restore": 70, "training_iteration": 70, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-30-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 957.2490769016931, "cost1_mean": 162.07316028609452, "system_level_velocity_max": 14.996221732313458, "cost2_min": -80.3825116635838, "outflow_rate_min": 803.0632811098305, "system_level_velocity_min": 11.119494687706192, "cost2_max": -68.67246220773603, "cost1_max": 174.4887734542866, "cost2_mean": -74.34111058442527, "cost1_min": 133.9722405015945, "discrim_loss": 0.9223307371139526, "outflow_rate_mean": 906.6901360936047, "system_level_velocity_mean": 13.790885327556554}}
{"sampler_perf": {"mean_inference_ms": 7.600400379347448, "mean_processing_ms": 11.056701202927048, "mean_env_wait_ms": 138.5223733000449}, "policy_reward_mean": {}, "time_since_restore": 9197.63333272934, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1645, "time_total_s": 9197.63333272934, "episode_reward_max": 399.33787769800983, "off_policy_estimator": {}, "episode_reward_min": 244.40480804629624, "episode_reward_mean": 330.63985915054485, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.85594630241394, "timestamp": 1559273532, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 71, "training_iteration": 71, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb6a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-32-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 976.2096126448201, "cost1_mean": 162.77557499527478, "system_level_velocity_max": 16.084215096387933, "cost2_min": -81.25629308503358, "outflow_rate_min": 823.8734662191896, "system_level_velocity_min": 11.752027562156732, "cost2_max": -59.20037203215521, "cost1_max": 178.3257236869777, "cost2_mean": -73.05372352138028, "cost1_min": 119.96831259886602, "discrim_loss": 0.9477559328079224, "outflow_rate_mean": 910.8033538763761, "system_level_velocity_mean": 14.140086161629675}}
{"sampler_perf": {"mean_inference_ms": 7.594250298991613, "mean_processing_ms": 11.041854832367141, "mean_env_wait_ms": 138.27152973747562}, "policy_reward_mean": {}, "time_since_restore": 9305.190244913101, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1668, "time_total_s": 9305.190244913101, "episode_reward_max": 435.783795714844, "off_policy_estimator": {}, "episode_reward_min": 289.5779563225806, "episode_reward_mean": 364.73025237857973, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.5569121837616, "timestamp": 1559273639, "episode_len_mean": 325.0, "iterations_since_restore": 72, "training_iteration": 72, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324268>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-33-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 977.3127792623833, "cost1_mean": 166.62928158684284, "system_level_velocity_max": 15.513698445445346, "cost2_min": -80.95677152866187, "outflow_rate_min": 822.2483794315978, "system_level_velocity_min": 12.141702912695877, "cost2_max": -68.78045712312235, "cost1_max": 179.18274583750517, "cost2_mean": -75.51040634726215, "cost1_min": 145.29163765156426, "discrim_loss": 0.9862861633300781, "outflow_rate_mean": 918.9064366100574, "system_level_velocity_mean": 14.148593562311794}}
{"sampler_perf": {"mean_inference_ms": 7.588135436666236, "mean_processing_ms": 11.03723813859575, "mean_env_wait_ms": 137.99387717853185}, "policy_reward_mean": {}, "time_since_restore": 9417.204379081726, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1691, "time_total_s": 9417.204379081726, "episode_reward_max": 478.20582439238206, "off_policy_estimator": {}, "episode_reward_min": 321.11465925350785, "episode_reward_mean": 409.40535832113466, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.01413416862488, "timestamp": 1559273751, "episode_len_mean": 325.0, "iterations_since_restore": 73, "training_iteration": 73, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b41e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b40d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-35-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.6775150139931, "cost1_mean": 167.87557622085188, "system_level_velocity_max": 15.54158392427221, "cost2_min": -91.03298543646054, "outflow_rate_min": 785.5531837056147, "system_level_velocity_min": 11.4693250456231, "cost2_max": -66.3854828412374, "cost1_max": 179.5425764611358, "cost2_mean": -75.28242868724811, "cost1_min": 136.8727466971565, "discrim_loss": 1.0469709634780884, "outflow_rate_mean": 921.821642704905, "system_level_velocity_mean": 14.29489344975789}}
{"sampler_perf": {"mean_inference_ms": 7.591825831901043, "mean_processing_ms": 11.044290714130518, "mean_env_wait_ms": 137.46480457501502}, "policy_reward_mean": {}, "time_since_restore": 9530.694228887558, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1715, "time_total_s": 9530.694228887558, "episode_reward_max": 467.78309419890866, "off_policy_estimator": {}, "episode_reward_min": 357.48119150754064, "episode_reward_mean": 423.90952256865177, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.48984980583191, "timestamp": 1559273865, "episode_len_mean": 325.0, "iterations_since_restore": 74, "training_iteration": 74, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-37-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.9372129944284, "cost1_mean": 168.82721405887784, "system_level_velocity_max": 15.667004914994264, "cost2_min": -78.95340343788253, "outflow_rate_min": 853.5089569803969, "system_level_velocity_min": 12.643046344314117, "cost2_max": -65.35463904097841, "cost1_max": 180.74208768631186, "cost2_mean": -72.31349786508054, "cost1_min": 151.1865938208169, "discrim_loss": 1.034742832183838, "outflow_rate_mean": 926.7810592942475, "system_level_velocity_mean": 14.406034346251895}}
{"sampler_perf": {"mean_inference_ms": 7.590231950359013, "mean_processing_ms": 11.050947168371602, "mean_env_wait_ms": 137.44940679030043}, "policy_reward_mean": {}, "time_since_restore": 9645.103668928146, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1738, "time_total_s": 9645.103668928146, "episode_reward_max": 454.735225411132, "off_policy_estimator": {}, "episode_reward_min": 48.504125982522964, "episode_reward_mean": 388.8871208637062, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.40944004058838, "timestamp": 1559273979, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 75, "training_iteration": 75, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b2048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbe18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb9d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-39-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.5103495727368, "cost1_mean": 162.5307477940918, "system_level_velocity_max": 17.080952588169055, "cost2_min": -78.86817838931238, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 12.79829737291868, "cost2_max": -20.59388437519287, "cost1_max": 181.98878401448331, "cost2_mean": -70.3297954912106, "cost1_min": 17.745819052425347, "discrim_loss": 1.0068857669830322, "outflow_rate_mean": 905.2475938516245, "system_level_velocity_mean": 14.540275576223786}}
{"sampler_perf": {"mean_inference_ms": 7.586542078765436, "mean_processing_ms": 11.04408419856578, "mean_env_wait_ms": 137.22857263503306}, "policy_reward_mean": {}, "time_since_restore": 9757.067133426666, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1761, "time_total_s": 9757.067133426666, "episode_reward_max": 436.86851752363145, "off_policy_estimator": {}, "episode_reward_min": 348.70223991572857, "episode_reward_mean": 400.57589968267587, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.9634644985199, "timestamp": 1559274091, "episode_len_mean": 325.0, "iterations_since_restore": 76, "training_iteration": 76, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-41-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.5375461110068, "cost1_mean": 171.3522491216673, "system_level_velocity_max": 15.791096762240397, "cost2_min": -75.2322773415826, "outflow_rate_min": 781.0814653296353, "system_level_velocity_min": 11.456055960678565, "cost2_max": -65.40399689139682, "cost1_max": 181.3359026788579, "cost2_mean": -70.41139026945866, "cost1_min": 135.85164543894763, "discrim_loss": 1.0468932390213013, "outflow_rate_mean": 937.847788877064, "system_level_velocity_mean": 14.718712478532773}}
{"sampler_perf": {"mean_inference_ms": 7.588326248288106, "mean_processing_ms": 11.068191737877326, "mean_env_wait_ms": 136.78499675858467}, "policy_reward_mean": {}, "time_since_restore": 9867.14578294754, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 1786, "time_total_s": 9867.14578294754, "episode_reward_max": 468.70371393300593, "off_policy_estimator": {}, "episode_reward_min": 365.29159955400974, "episode_reward_mean": 414.0406099864282, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.07864952087402, "timestamp": 1559274205, "episode_len_mean": 325.0, "iterations_since_restore": 77, "training_iteration": 77, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303628c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362730>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-43-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.6887390872367, "cost1_mean": 169.91725862853443, "system_level_velocity_max": 15.84448556418538, "cost2_min": -72.63993986139263, "outflow_rate_min": 839.6765385385617, "system_level_velocity_min": 12.544626930762341, "cost2_max": -61.68579406542979, "cost1_max": 182.30515824856894, "cost2_mean": -66.57882959925634, "cost1_min": 147.3586960120461, "discrim_loss": 1.0579829216003418, "outflow_rate_mean": 932.6995043354615, "system_level_velocity_mean": 14.720027320427231}}
{"sampler_perf": {"mean_inference_ms": 7.587623037001024, "mean_processing_ms": 11.055395205233337, "mean_env_wait_ms": 136.54217487141338}, "policy_reward_mean": {}, "time_since_restore": 9972.428049087524, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1808, "time_total_s": 9972.428049087524, "episode_reward_max": 483.4097205507569, "off_policy_estimator": {}, "episode_reward_min": 381.32318137865514, "episode_reward_mean": 433.84996136855756, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 105.28226613998413, "timestamp": 1559274310, "episode_len_mean": 325.0, "iterations_since_restore": 78, "training_iteration": 78, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-45-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.0992189107047, "cost1_mean": 167.65287216207645, "system_level_velocity_max": 15.734553334310515, "cost2_min": -70.42442959896215, "outflow_rate_min": 765.353373669791, "system_level_velocity_min": 10.935492766020582, "cost2_max": -62.87873597916494, "cost1_max": 179.81901942466797, "cost2_mean": -66.69210154001767, "cost1_min": 130.0467446565927, "discrim_loss": 1.0743619203567505, "outflow_rate_mean": 920.0135604386505, "system_level_velocity_mean": 14.45801125143336}}
{"sampler_perf": {"mean_inference_ms": 7.5830092162863005, "mean_processing_ms": 11.05201504392754, "mean_env_wait_ms": 136.32617439282848}, "policy_reward_mean": {}, "time_since_restore": 10078.111105918884, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1831, "time_total_s": 10078.111105918884, "episode_reward_max": 452.7572236843407, "off_policy_estimator": {}, "episode_reward_min": 256.8079462945461, "episode_reward_mean": 390.1546694368286, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 105.68305683135986, "timestamp": 1559274416, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 79, "training_iteration": 79, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbe18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbbf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-46-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.7518302769984, "cost1_mean": 163.5323525206101, "system_level_velocity_max": 16.357743188616226, "cost2_min": -73.14355301834121, "outflow_rate_min": 840.8257272895903, "system_level_velocity_min": 12.516612831964672, "cost2_max": -59.998565441936854, "cost1_max": 181.58336532951057, "cost2_mean": -67.42346920833998, "cost1_min": 121.85832574670351, "discrim_loss": 1.0416741371154785, "outflow_rate_mean": 905.5836487400996, "system_level_velocity_mean": 14.291793457357036}}
{"sampler_perf": {"mean_inference_ms": 7.588967865122931, "mean_processing_ms": 11.069892958814634, "mean_env_wait_ms": 135.9814968270286}, "policy_reward_mean": {}, "time_since_restore": 10190.090366363525, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1855, "time_total_s": 10190.090366363525, "episode_reward_max": 447.90079901739955, "off_policy_estimator": {}, "episode_reward_min": 265.93799137324095, "episode_reward_mean": 387.63716609715874, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.97926044464111, "timestamp": 1559274528, "episode_len_mean": 320.4583333333333, "iterations_since_restore": 80, "training_iteration": 80, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-48-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.9045027709124, "cost1_mean": 169.81209116117464, "system_level_velocity_max": 16.710158324062917, "cost2_min": -80.46751103981408, "outflow_rate_min": 786.3210795673648, "system_level_velocity_min": 11.5272881489497, "cost2_max": -61.01213483784507, "cost1_max": 183.75101875143878, "cost2_mean": -71.50476794740997, "cost1_min": 129.37043911337219, "discrim_loss": 1.0656481981277466, "outflow_rate_mean": 933.0790901597937, "system_level_velocity_mean": 14.827305890245476}}
{"sampler_perf": {"mean_inference_ms": 7.5812010650972015, "mean_processing_ms": 11.059836017845925, "mean_env_wait_ms": 135.8771871501748}, "policy_reward_mean": {}, "time_since_restore": 10306.860061645508, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1877, "time_total_s": 10306.860061645508, "episode_reward_max": 443.23163206502795, "off_policy_estimator": {}, "episode_reward_min": 279.1978202499449, "episode_reward_mean": 401.6892870936797, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.76969528198242, "timestamp": 1559274645, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 81, "training_iteration": 81, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303642f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303641e0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-50-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.2450283190458, "cost1_mean": 170.17844374230737, "system_level_velocity_max": 16.121487501250705, "cost2_min": -85.68287562977132, "outflow_rate_min": 759.8708432509512, "system_level_velocity_min": 13.318775555897913, "cost2_max": -68.02218656885302, "cost1_max": 187.03103413709056, "cost2_mean": -78.96558059055964, "cost1_min": 112.47560906351077, "discrim_loss": 1.088169813156128, "outflow_rate_mean": 930.7653334675535, "system_level_velocity_mean": 14.673083050923259}}
{"sampler_perf": {"mean_inference_ms": 7.5873902882931255, "mean_processing_ms": 11.073235545289652, "mean_env_wait_ms": 135.7553882708664}, "policy_reward_mean": {}, "time_since_restore": 10422.36401438713, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 1902, "time_total_s": 10422.36401438713, "episode_reward_max": 462.65470626950264, "off_policy_estimator": {}, "episode_reward_min": 372.36317643523216, "episode_reward_mean": 427.47239185623823, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.50395274162292, "timestamp": 1559274761, "episode_len_mean": 325.0, "iterations_since_restore": 82, "training_iteration": 82, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-52-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.4951845872488, "cost1_mean": 170.6659911088905, "system_level_velocity_max": 16.14348760296623, "cost2_min": -85.66350884838646, "outflow_rate_min": 821.0791047394791, "system_level_velocity_min": 12.041645121909658, "cost2_max": -73.62570642969389, "cost1_max": 186.68376806592022, "cost2_mean": -78.83248657046279, "cost1_min": 145.2310162328621, "discrim_loss": 1.0553739070892334, "outflow_rate_mean": 929.5320929858436, "system_level_velocity_mean": 14.470371602802954}}
{"sampler_perf": {"mean_inference_ms": 7.5882213451544285, "mean_processing_ms": 11.087317449028122, "mean_env_wait_ms": 135.5955985905525}, "policy_reward_mean": {}, "time_since_restore": 10539.258011817932, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 1925, "time_total_s": 10539.258011817932, "episode_reward_max": 483.93956139683723, "off_policy_estimator": {}, "episode_reward_min": 419.887317369692, "episode_reward_mean": 456.2022030613912, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.89399743080139, "timestamp": 1559274878, "episode_len_mean": 325.0, "iterations_since_restore": 83, "training_iteration": 83, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bba60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbbf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-54-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.2954732407536, "cost1_mean": 175.53630729974893, "system_level_velocity_max": 16.439154899658927, "cost2_min": -87.47599663152032, "outflow_rate_min": 872.6624669499389, "system_level_velocity_min": 13.076651523167317, "cost2_max": -77.43618766075708, "cost1_max": 190.05831684547883, "cost2_mean": -81.19673198690225, "cost1_min": 156.7092812266908, "discrim_loss": 1.0763537883758545, "outflow_rate_mean": 945.6752931197237, "system_level_velocity_mean": 14.895689585518696}}
{"sampler_perf": {"mean_inference_ms": 7.585012894396088, "mean_processing_ms": 11.073650740499088, "mean_env_wait_ms": 135.47773510351192}, "policy_reward_mean": {}, "time_since_restore": 10655.44472026825, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1947, "time_total_s": 10655.44472026825, "episode_reward_max": 467.9239665484056, "off_policy_estimator": {}, "episode_reward_min": 364.1790093295276, "episode_reward_mean": 419.4840030810288, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.18670845031738, "timestamp": 1559274995, "episode_len_mean": 325.0, "iterations_since_restore": 84, "training_iteration": 84, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-56-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.4279807718947, "cost1_mean": 167.71728145823764, "system_level_velocity_max": 16.143601759496836, "cost2_min": -83.12918034866, "outflow_rate_min": 786.3867941052796, "system_level_velocity_min": 11.548923442074491, "cost2_max": -73.65257515467793, "cost1_max": 185.87058224897828, "cost2_mean": -78.13915824949278, "cost1_min": 139.72814188598124, "discrim_loss": 1.0159322023391724, "outflow_rate_mean": 916.8958191059043, "system_level_velocity_mean": 14.199782387548163}}
{"sampler_perf": {"mean_inference_ms": 7.5903639219866506, "mean_processing_ms": 11.0758540058494, "mean_env_wait_ms": 135.29590063542426}, "policy_reward_mean": {}, "time_since_restore": 10771.60100865364, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 1971, "time_total_s": 10771.60100865364, "episode_reward_max": 414.50924678053707, "off_policy_estimator": {}, "episode_reward_min": 358.9416033606976, "episode_reward_mean": 387.99507884162205, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.15628838539124, "timestamp": 1559275111, "episode_len_mean": 325.0, "iterations_since_restore": 85, "training_iteration": 85, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362c80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-58-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.3648312172799, "cost1_mean": 174.7202889528534, "system_level_velocity_max": 16.213129219485783, "cost2_min": -86.37335671283248, "outflow_rate_min": 773.695259328187, "system_level_velocity_min": 10.879135252117365, "cost2_max": -70.92516450307251, "cost1_max": 187.8132300785757, "cost2_mean": -79.4671411253412, "cost1_min": 132.9892323521937, "discrim_loss": 1.0089738368988037, "outflow_rate_mean": 945.2468827524182, "system_level_velocity_mean": 14.881382282098755}}
{"sampler_perf": {"mean_inference_ms": 7.58389097016607, "mean_processing_ms": 11.086425638187626, "mean_env_wait_ms": 135.07326018836469}, "policy_reward_mean": {}, "time_since_restore": 10883.131655454636, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 1993, "time_total_s": 10883.131655454636, "episode_reward_max": 430.2482368797064, "off_policy_estimator": {}, "episode_reward_min": 268.13403901830316, "episode_reward_mean": 392.10063550259326, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.53064680099487, "timestamp": 1559275222, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 86, "training_iteration": 86, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-00-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.6339094334654, "cost1_mean": 169.36585407433157, "system_level_velocity_max": 16.131517681756502, "cost2_min": -83.42480244564598, "outflow_rate_min": 759.7891167399816, "system_level_velocity_min": 11.969548603977573, "cost2_max": -68.52863065233164, "cost1_max": 187.19065027295522, "cost2_mean": -77.22893222298339, "cost1_min": 113.12701148329501, "discrim_loss": 1.0012359619140625, "outflow_rate_mean": 927.4986121484496, "system_level_velocity_mean": 14.660835402067073}}
{"sampler_perf": {"mean_inference_ms": 7.579919157867711, "mean_processing_ms": 11.07683614679135, "mean_env_wait_ms": 134.91208349318728}, "policy_reward_mean": {}, "time_since_restore": 10995.634333372116, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2017, "time_total_s": 10995.634333372116, "episode_reward_max": 470.81708538136445, "off_policy_estimator": {}, "episode_reward_min": 391.5702186129056, "episode_reward_mean": 428.1523859418958, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.50267791748047, "timestamp": 1559275335, "episode_len_mean": 325.0, "iterations_since_restore": 87, "training_iteration": 87, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303658c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-02-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.0113940619663, "cost1_mean": 167.66502951903718, "system_level_velocity_max": 16.093353863569217, "cost2_min": -83.89286144808736, "outflow_rate_min": 831.3573289190211, "system_level_velocity_min": 12.283045903980582, "cost2_max": -74.12402663801363, "cost1_max": 187.7934436062348, "cost2_mean": -80.37720999584967, "cost1_min": 146.5676575284752, "discrim_loss": 0.9826480150222778, "outflow_rate_mean": 913.2636709099087, "system_level_velocity_mean": 14.113642907044522}}
{"sampler_perf": {"mean_inference_ms": 7.579702272365236, "mean_processing_ms": 11.07512001767234, "mean_env_wait_ms": 134.70353762285302}, "policy_reward_mean": {}, "time_since_restore": 11110.184247732162, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2040, "time_total_s": 11110.184247732162, "episode_reward_max": 463.8011904711602, "off_policy_estimator": {}, "episode_reward_min": 303.4090155204758, "episode_reward_mean": 419.3418889048702, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.54991436004639, "timestamp": 1559275450, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 88, "training_iteration": 88, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303248c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-04-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1004.1818819188898, "cost1_mean": 167.52118913749595, "system_level_velocity_max": 16.227412739556417, "cost2_min": -90.22298591061875, "outflow_rate_min": 766.8089226421139, "system_level_velocity_min": 11.325683531891993, "cost2_max": -68.84774015363435, "cost1_max": 187.92339980642535, "cost2_mean": -79.63482862273237, "cost1_min": 113.03370533736208, "discrim_loss": 0.9709978103637695, "outflow_rate_mean": 915.3885783707296, "system_level_velocity_mean": 14.383515871655664}}
{"sampler_perf": {"mean_inference_ms": 7.5784269755584655, "mean_processing_ms": 11.084031674301226, "mean_env_wait_ms": 134.63103114246505}, "policy_reward_mean": {}, "time_since_restore": 11228.539321660995, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2063, "time_total_s": 11228.539321660995, "episode_reward_max": 450.3119465163909, "off_policy_estimator": {}, "episode_reward_min": 347.31692338269204, "episode_reward_mean": 394.4180996796957, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.35507392883301, "timestamp": 1559275568, "episode_len_mean": 325.0, "iterations_since_restore": 89, "training_iteration": 89, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd158>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-06-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.8680810040189, "cost1_mean": 164.43568558761362, "system_level_velocity_max": 16.11951034892879, "cost2_min": -84.92628258473124, "outflow_rate_min": 838.9240024174597, "system_level_velocity_min": 12.487481732441484, "cost2_max": -75.12133603004035, "cost1_max": 186.75147318006117, "cost2_mean": -77.72326032593487, "cost1_min": 148.37631746580573, "discrim_loss": 0.9403682947158813, "outflow_rate_mean": 903.2153698211434, "system_level_velocity_mean": 13.859155879735711}}
{"sampler_perf": {"mean_inference_ms": 7.577722808379588, "mean_processing_ms": 11.085187130876035, "mean_env_wait_ms": 134.47203836623507}, "policy_reward_mean": {}, "time_since_restore": 11345.843173742294, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2087, "time_total_s": 11345.843173742294, "episode_reward_max": 407.2568611591123, "off_policy_estimator": {}, "episode_reward_min": 313.2810893729329, "episode_reward_mean": 365.0909113207114, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.30385208129883, "timestamp": 1559275685, "episode_len_mean": 325.0, "iterations_since_restore": 90, "training_iteration": 90, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324a60>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-08-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.9832382688976, "cost1_mean": 169.3101037015113, "system_level_velocity_max": 16.094141758833384, "cost2_min": -83.08778066787782, "outflow_rate_min": 784.5445648974727, "system_level_velocity_min": 11.6813202224083, "cost2_max": -73.47739011315585, "cost1_max": 185.21710727560773, "cost2_mean": -77.58292334318286, "cost1_min": 141.3448635685208, "discrim_loss": 0.9355512857437134, "outflow_rate_mean": 924.0843813335574, "system_level_velocity_mean": 14.37603476916781}}
{"sampler_perf": {"mean_inference_ms": 7.579171415076763, "mean_processing_ms": 11.08729522235545, "mean_env_wait_ms": 134.25727027387418}, "policy_reward_mean": {}, "time_since_restore": 11456.862767457962, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2110, "time_total_s": 11456.862767457962, "episode_reward_max": 393.7182740592398, "off_policy_estimator": {}, "episode_reward_min": 317.34921973757446, "episode_reward_mean": 364.65009150096296, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.01959371566772, "timestamp": 1559275797, "episode_len_mean": 325.0, "iterations_since_restore": 91, "training_iteration": 91, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-09-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.3354633536574, "cost1_mean": 171.35541059641253, "system_level_velocity_max": 16.05479045612258, "cost2_min": -81.20786957565625, "outflow_rate_min": 830.5177315726218, "system_level_velocity_min": 12.284095188559375, "cost2_max": -69.7315227952119, "cost1_max": 184.28695683382324, "cost2_mean": -74.95059552432103, "cost1_min": 146.59508614760574, "discrim_loss": 0.9243626594543457, "outflow_rate_mean": 934.4529699319021, "system_level_velocity_mean": 14.596803351300705}}
{"sampler_perf": {"mean_inference_ms": 7.579477272091935, "mean_processing_ms": 11.097168246734524, "mean_env_wait_ms": 134.22990502382214}, "policy_reward_mean": {}, "time_since_restore": 11571.538597106934, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2133, "time_total_s": 11571.538597106934, "episode_reward_max": 427.4696454210207, "off_policy_estimator": {}, "episode_reward_min": 239.67984668165445, "episode_reward_mean": 378.5297487018144, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.67582964897156, "timestamp": 1559275912, "episode_len_mean": 314.7391304347826, "iterations_since_restore": 92, "training_iteration": 92, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-11-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.4212520829848, "cost1_mean": 163.39640645827475, "system_level_velocity_max": 16.757503478282953, "cost2_min": -82.53992292655246, "outflow_rate_min": 780.5207248437736, "system_level_velocity_min": 11.548379815271417, "cost2_max": -60.112734531479745, "cost1_max": 183.34806773961873, "cost2_mean": -74.1058421574013, "cost1_min": 123.8070843582063, "discrim_loss": 0.9301729202270508, "outflow_rate_mean": 911.5076044302638, "system_level_velocity_mean": 14.424012490650956}}
{"sampler_perf": {"mean_inference_ms": 7.581878679320148, "mean_processing_ms": 11.091873979218912, "mean_env_wait_ms": 134.08298645796086}, "policy_reward_mean": {}, "time_since_restore": 11686.280311584473, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2156, "time_total_s": 11686.280311584473, "episode_reward_max": 414.55288320593536, "off_policy_estimator": {}, "episode_reward_min": 319.0874952878803, "episode_reward_mean": 357.2177486632667, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.74171447753906, "timestamp": 1559276030, "episode_len_mean": 323.7826086956522, "iterations_since_restore": 93, "training_iteration": 93, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303482f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-13-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.8849745398402, "cost1_mean": 173.67358159477405, "system_level_velocity_max": 16.150324045477902, "cost2_min": -79.23520457503909, "outflow_rate_min": 863.3076565578954, "system_level_velocity_min": 12.769515137318784, "cost2_max": -72.08837514511333, "cost1_max": 184.88699457957054, "cost2_mean": -74.76444247635521, "cost1_min": 152.00754775735538, "discrim_loss": 0.9024755954742432, "outflow_rate_mean": 946.9523735246484, "system_level_velocity_mean": 14.91774799946802}}
{"sampler_perf": {"mean_inference_ms": 7.583205220876497, "mean_processing_ms": 11.102079610397974, "mean_env_wait_ms": 133.91270626682717}, "policy_reward_mean": {}, "time_since_restore": 11802.402082204819, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 2182, "time_total_s": 11802.402082204819, "episode_reward_max": 350.7271882109344, "off_policy_estimator": {}, "episode_reward_min": 35.655433267354965, "episode_reward_mean": 303.52050671106775, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.12177062034607, "timestamp": 1559276146, "episode_len_mean": 313.53846153846155, "iterations_since_restore": 94, "training_iteration": 94, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303659d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-15-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.2218178495638, "cost1_mean": 167.06235017297507, "system_level_velocity_max": 17.053690194841582, "cost2_min": -78.94879049102559, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 12.657557409752744, "cost2_max": -20.97079906928769, "cost1_max": 185.29059420941633, "cost2_mean": -72.95724907004329, "cost1_min": 17.764369970066994, "discrim_loss": 0.9033534526824951, "outflow_rate_mean": 923.4120946751129, "system_level_velocity_mean": 14.873754247568549}}
{"sampler_perf": {"mean_inference_ms": 7.584300480335291, "mean_processing_ms": 11.104971904772217, "mean_env_wait_ms": 133.7608175357107}, "policy_reward_mean": {}, "time_since_restore": 11914.219844579697, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 2203, "time_total_s": 11914.219844579697, "episode_reward_max": 317.82307266723365, "off_policy_estimator": {}, "episode_reward_min": 181.57413746230304, "episode_reward_mean": 288.0497546812874, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.81776237487793, "timestamp": 1559276258, "episode_len_mean": 319.3809523809524, "iterations_since_restore": 95, "training_iteration": 95, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b16a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b1620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b1598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b1510>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-17-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.9822679196318, "cost1_mean": 168.6954438533298, "system_level_velocity_max": 16.745603862200266, "cost2_min": -78.5056634928354, "outflow_rate_min": 855.9768108306745, "system_level_velocity_min": 13.256609935149049, "cost2_max": -59.773223142375045, "cost1_max": 183.4909642438443, "cost2_mean": -73.21836478323364, "cost1_min": 123.43986810445779, "discrim_loss": 0.8837323188781738, "outflow_rate_mean": 931.1551274908833, "system_level_velocity_mean": 14.730347753797814}}
{"sampler_perf": {"mean_inference_ms": 7.582210119783102, "mean_processing_ms": 11.118244466459625, "mean_env_wait_ms": 133.59429583612612}, "policy_reward_mean": {}, "time_since_restore": 12028.096638679504, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2228, "time_total_s": 12028.096638679504, "episode_reward_max": 373.5120324390009, "off_policy_estimator": {}, "episode_reward_min": 296.4606406968087, "episode_reward_mean": 336.6280914051272, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.87679409980774, "timestamp": 1559276372, "episode_len_mean": 325.0, "iterations_since_restore": 96, "training_iteration": 96, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-19-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.8836491401394, "cost1_mean": 171.03033969552078, "system_level_velocity_max": 15.891816756409309, "cost2_min": -78.15534595004755, "outflow_rate_min": 840.3221079956221, "system_level_velocity_min": 12.59059484691779, "cost2_max": -70.33338511194307, "cost1_max": 182.57525012436207, "cost2_mean": -73.79715624236098, "cost1_min": 149.63313916205635, "discrim_loss": 0.8791064620018005, "outflow_rate_mean": 935.2806102601141, "system_level_velocity_mean": 14.637093313283835}}
{"sampler_perf": {"mean_inference_ms": 7.5876236051110535, "mean_processing_ms": 11.105702817277065, "mean_env_wait_ms": 133.4916658564716}, "policy_reward_mean": {}, "time_since_restore": 12139.477640390396, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2251, "time_total_s": 12139.477640390396, "episode_reward_max": 433.61144591029733, "off_policy_estimator": {}, "episode_reward_min": 346.1059648040682, "episode_reward_mean": 395.61513544289073, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.38100171089172, "timestamp": 1559276483, "episode_len_mean": 324.1304347826087, "iterations_since_restore": 97, "training_iteration": 97, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b40d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b41e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4b70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-21-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.4845124824199, "cost1_mean": 173.33879405364422, "system_level_velocity_max": 15.90448615607864, "cost2_min": -78.43059566272589, "outflow_rate_min": 833.725388457448, "system_level_velocity_min": 12.637547237211486, "cost2_max": -69.8402186927811, "cost1_max": 183.176089177773, "cost2_mean": -74.1401585149682, "cost1_min": 150.70488759164476, "discrim_loss": 0.8893082141876221, "outflow_rate_mean": 944.6860132558359, "system_level_velocity_mean": 14.884098742207495}}
{"sampler_perf": {"mean_inference_ms": 7.58435067313063, "mean_processing_ms": 11.107837845273904, "mean_env_wait_ms": 133.28426730390342}, "policy_reward_mean": {}, "time_since_restore": 12250.90621471405, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 2272, "time_total_s": 12250.90621471405, "episode_reward_max": 410.1315707946196, "off_policy_estimator": {}, "episode_reward_min": 329.7715600808151, "episode_reward_mean": 376.10327288173585, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.42857432365417, "timestamp": 1559276594, "episode_len_mean": 323.6666666666667, "iterations_since_restore": 98, "training_iteration": 98, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348bf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-23-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.6817364683179, "cost1_mean": 169.5607650100966, "system_level_velocity_max": 15.870979139750368, "cost2_min": -77.12100151871115, "outflow_rate_min": 820.5991374505716, "system_level_velocity_min": 12.377026575020547, "cost2_max": -69.549060095078, "cost1_max": 183.0324842299727, "cost2_mean": -73.68065284749234, "cost1_min": 147.84662842802106, "discrim_loss": 0.8598966002464294, "outflow_rate_mean": 928.3477078932724, "system_level_velocity_mean": 14.521561627680905}}
{"sampler_perf": {"mean_inference_ms": 7.584390320445043, "mean_processing_ms": 11.128689458742008, "mean_env_wait_ms": 133.11431496095594}, "policy_reward_mean": {}, "time_since_restore": 12361.822941541672, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2297, "time_total_s": 12361.822941541672, "episode_reward_max": 374.1660552462563, "off_policy_estimator": {}, "episode_reward_min": 41.603821739554405, "episode_reward_mean": 296.7867301692348, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.91672682762146, "timestamp": 1559276705, "episode_len_mean": 312.92, "iterations_since_restore": 99, "training_iteration": 99, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303489d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303488c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-25-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.4943607265391, "cost1_mean": 163.56641023193566, "system_level_velocity_max": 18.691001619063783, "cost2_min": -77.56897590068328, "outflow_rate_min": 518.6392970701784, "system_level_velocity_min": 12.709915514083953, "cost2_max": -22.995107008812287, "cost1_max": 184.37906557065907, "cost2_mean": -70.75495493516337, "cost1_min": 24.185692304480632, "discrim_loss": 0.8419070839881897, "outflow_rate_mean": 909.5336330872389, "system_level_velocity_mean": 14.669182091788008}}
{"sampler_perf": {"mean_inference_ms": 7.588096044344613, "mean_processing_ms": 11.122635173946378, "mean_env_wait_ms": 133.09995318112044}, "policy_reward_mean": {}, "time_since_restore": 12474.648652076721, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2322, "time_total_s": 12474.648652076721, "episode_reward_max": 305.5469431565143, "off_policy_estimator": {}, "episode_reward_min": 268.073179631494, "episode_reward_mean": 283.5898189753201, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.82571053504944, "timestamp": 1559276818, "episode_len_mean": 325.0, "iterations_since_restore": 100, "training_iteration": 100, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd7b8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-26-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.1835771635608, "cost1_mean": 170.36247814922092, "system_level_velocity_max": 15.821406741866433, "cost2_min": -77.80136150509708, "outflow_rate_min": 849.3847334536551, "system_level_velocity_min": 12.712709346358116, "cost2_max": -71.06377380566505, "cost1_max": 182.54994495801353, "cost2_mean": -73.24386160822219, "cost1_min": 151.5907761314565, "discrim_loss": 0.8575881719589233, "outflow_rate_mean": 932.0957155319464, "system_level_velocity_mean": 14.566724189703452}}
{"sampler_perf": {"mean_inference_ms": 7.586165424060412, "mean_processing_ms": 11.121210666378612, "mean_env_wait_ms": 132.84530696817185}, "policy_reward_mean": {}, "time_since_restore": 12588.200891017914, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 2343, "time_total_s": 12588.200891017914, "episode_reward_max": 357.9446308258921, "off_policy_estimator": {}, "episode_reward_min": 254.95128394383937, "episode_reward_mean": 332.348327297806, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.55223894119263, "timestamp": 1559276935, "episode_len_mean": 325.0, "iterations_since_restore": 101, "training_iteration": 101, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdd90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bdd08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-28-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.6011307433452, "cost1_mean": 169.40178329335646, "system_level_velocity_max": 15.768273106385728, "cost2_min": -78.59629882355466, "outflow_rate_min": 853.2251514655113, "system_level_velocity_min": 12.774954351480353, "cost2_max": -70.1734620689592, "cost1_max": 182.40664388394478, "cost2_mean": -73.90474354185925, "cost1_min": 152.08911806083336, "discrim_loss": 0.861768901348114, "outflow_rate_mean": 925.7928635731339, "system_level_velocity_mean": 14.423584636031652}}
{"sampler_perf": {"mean_inference_ms": 7.585580098538775, "mean_processing_ms": 11.134218462265551, "mean_env_wait_ms": 132.65686630781966}, "policy_reward_mean": {}, "time_since_restore": 12700.436686515808, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2367, "time_total_s": 12700.436686515808, "episode_reward_max": 452.7876487504691, "off_policy_estimator": {}, "episode_reward_min": 331.0991693586111, "episode_reward_mean": 382.6221608808264, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.23579549789429, "timestamp": 1559277047, "episode_len_mean": 325.0, "iterations_since_restore": 102, "training_iteration": 102, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303482f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-30-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 998.2574022937819, "cost1_mean": 168.24197447408793, "system_level_velocity_max": 16.082020105263094, "cost2_min": -77.7430861191494, "outflow_rate_min": 809.4683296717508, "system_level_velocity_min": 12.072243814431847, "cost2_max": -71.60514150229254, "cost1_max": 184.29217805404926, "cost2_mean": -74.31303108163986, "cost1_min": 143.63586693928588, "discrim_loss": 0.8565579652786255, "outflow_rate_mean": 922.852384910585, "system_level_velocity_mean": 14.34143164096438}}
{"sampler_perf": {"mean_inference_ms": 7.5872996332612725, "mean_processing_ms": 11.129236687986563, "mean_env_wait_ms": 132.7198755529957}, "policy_reward_mean": {}, "time_since_restore": 12813.551042795181, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2390, "time_total_s": 12813.551042795181, "episode_reward_max": 424.59156572585925, "off_policy_estimator": {}, "episode_reward_min": 333.4079449195415, "episode_reward_mean": 361.90365842776373, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.11435627937317, "timestamp": 1559277160, "episode_len_mean": 325.0, "iterations_since_restore": 103, "training_iteration": 103, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-32-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.3325227368813, "cost1_mean": 170.58613080440188, "system_level_velocity_max": 15.940881900489641, "cost2_min": -78.36678603472757, "outflow_rate_min": 816.1791908884849, "system_level_velocity_min": 12.21790965634596, "cost2_max": -69.37533946533149, "cost1_max": 182.93311591180236, "cost2_mean": -73.5172276208736, "cost1_min": 145.43863875226742, "discrim_loss": 0.8225299119949341, "outflow_rate_mean": 930.7952501162788, "system_level_velocity_mean": 14.558170397367887}}
{"sampler_perf": {"mean_inference_ms": 7.590899885846748, "mean_processing_ms": 11.1312704983714, "mean_env_wait_ms": 132.4209440083479}, "policy_reward_mean": {}, "time_since_restore": 12923.27714395523, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2414, "time_total_s": 12923.27714395523, "episode_reward_max": 360.48638875968754, "off_policy_estimator": {}, "episode_reward_min": 231.4726878479123, "episode_reward_mean": 316.98267953012447, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.72610116004944, "timestamp": 1559277270, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 104, "training_iteration": 104, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdc80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bde18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-34-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.5223089506568, "cost1_mean": 171.23335785882637, "system_level_velocity_max": 16.59082231006012, "cost2_min": -78.9137630633838, "outflow_rate_min": 826.1901962039484, "system_level_velocity_min": 12.488428843884028, "cost2_max": -58.800142274878965, "cost1_max": 186.02835803036567, "cost2_mean": -73.76668405626388, "cost1_min": 123.6261316096447, "discrim_loss": 0.8467968702316284, "outflow_rate_mean": 939.0488067277989, "system_level_velocity_mean": 14.909691750959363}}
{"sampler_perf": {"mean_inference_ms": 7.585774142596269, "mean_processing_ms": 11.122880270538356, "mean_env_wait_ms": 132.28556142043675}, "policy_reward_mean": {}, "time_since_restore": 13032.266374349594, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 2435, "time_total_s": 13032.266374349594, "episode_reward_max": 344.2647173758596, "off_policy_estimator": {}, "episode_reward_min": 283.709680845961, "episode_reward_mean": 311.2433100115685, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.9892303943634, "timestamp": 1559277379, "episode_len_mean": 325.0, "iterations_since_restore": 105, "training_iteration": 105, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-36-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.3299282838684, "cost1_mean": 170.09197654087725, "system_level_velocity_max": 15.884860445289174, "cost2_min": -79.21083594066477, "outflow_rate_min": 861.2754226153987, "system_level_velocity_min": 12.845755013884807, "cost2_max": -70.69912581261568, "cost1_max": 183.42760417885873, "cost2_mean": -75.30018448248568, "cost1_min": 152.38375745439296, "discrim_loss": 0.8594746589660645, "outflow_rate_mean": 927.5595805455711, "system_level_velocity_mean": 14.438192608894068}}
{"sampler_perf": {"mean_inference_ms": 7.585298034742279, "mean_processing_ms": 11.122237520386875, "mean_env_wait_ms": 132.17541638496994}, "policy_reward_mean": {}, "time_since_restore": 13146.090940952301, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2459, "time_total_s": 13146.090940952301, "episode_reward_max": 376.87139044702053, "off_policy_estimator": {}, "episode_reward_min": 295.0912887910381, "episode_reward_mean": 346.53578487824416, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.82456660270691, "timestamp": 1559277493, "episode_len_mean": 325.0, "iterations_since_restore": 106, "training_iteration": 106, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8e18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-38-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 998.7016626691204, "cost1_mean": 169.40773209810254, "system_level_velocity_max": 16.062829562729938, "cost2_min": -78.61114192640785, "outflow_rate_min": 855.664088801776, "system_level_velocity_min": 12.632084357570251, "cost2_max": -71.99834495410892, "cost1_max": 184.92543218865208, "cost2_mean": -75.17290939288071, "cost1_min": 150.77461602719137, "discrim_loss": 0.850806474685669, "outflow_rate_mean": 927.2953338417143, "system_level_velocity_mean": 14.408286586459242}}
{"sampler_perf": {"mean_inference_ms": 7.5929812284822, "mean_processing_ms": 11.130004480242176, "mean_env_wait_ms": 132.06042161164743}, "policy_reward_mean": {}, "time_since_restore": 13263.763326883316, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2484, "time_total_s": 13263.763326883316, "episode_reward_max": 508.4886749368161, "off_policy_estimator": {}, "episode_reward_min": 77.89017879962921, "episode_reward_mean": 409.91547974389044, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.67238593101501, "timestamp": 1559277611, "episode_len_mean": 313.4, "iterations_since_restore": 107, "training_iteration": 107, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-40-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.4840484734831, "cost1_mean": 163.26646282443983, "system_level_velocity_max": 18.50961121293398, "cost2_min": -80.05887925493244, "outflow_rate_min": 506.5568824271422, "system_level_velocity_min": 12.757241628613286, "cost2_max": -22.273266786223317, "cost1_max": 184.03087701325126, "cost2_mean": -73.2872061620898, "cost1_min": 22.857343577659346, "discrim_loss": 0.8688795566558838, "outflow_rate_mean": 905.7397284036409, "system_level_velocity_mean": 14.475257025872104}}
{"sampler_perf": {"mean_inference_ms": 7.592257281188364, "mean_processing_ms": 11.149813498305408, "mean_env_wait_ms": 131.93045179616118}, "policy_reward_mean": {}, "time_since_restore": 13378.317656993866, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2507, "time_total_s": 13378.317656993866, "episode_reward_max": 449.9145644083619, "off_policy_estimator": {}, "episode_reward_min": 50.28851467370987, "episode_reward_mean": 393.0015948054016, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.55433011054993, "timestamp": 1559277726, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 108, "training_iteration": 108, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-42-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.1369871305446, "cost1_mean": 165.03449671030086, "system_level_velocity_max": 17.877344224211384, "cost2_min": -80.88257811238091, "outflow_rate_min": 493.8123238995481, "system_level_velocity_min": 12.3044886296039, "cost2_max": -18.354301059357493, "cost1_max": 185.86931746176245, "cost2_mean": -73.67576441529346, "cost1_min": 17.917854687631788, "discrim_loss": 0.8487475514411926, "outflow_rate_mean": 916.3070120649422, "system_level_velocity_mean": 14.748630378992132}}
{"sampler_perf": {"mean_inference_ms": 7.5885434338823865, "mean_processing_ms": 11.126710047542115, "mean_env_wait_ms": 131.84696681587454}, "policy_reward_mean": {}, "time_since_restore": 13497.090773820877, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2530, "time_total_s": 13497.090773820877, "episode_reward_max": 400.8437106516212, "off_policy_estimator": {}, "episode_reward_min": 320.7406696435064, "episode_reward_mean": 355.063858343511, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.77311682701111, "timestamp": 1559277844, "episode_len_mean": 325.0, "iterations_since_restore": 109, "training_iteration": 109, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-44-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.0627215066986, "cost1_mean": 170.75902399237995, "system_level_velocity_max": 16.255840927384163, "cost2_min": -84.93408149051263, "outflow_rate_min": 778.2496353476382, "system_level_velocity_min": 11.60104595065493, "cost2_max": -73.43973371447422, "cost1_max": 186.89174750384353, "cost2_mean": -76.72923422570189, "cost1_min": 140.77720969475155, "discrim_loss": 0.858654260635376, "outflow_rate_mean": 928.7029973758177, "system_level_velocity_mean": 14.503384419329722}}
{"sampler_perf": {"mean_inference_ms": 7.59514574614385, "mean_processing_ms": 11.137731517954961, "mean_env_wait_ms": 131.9349200198257}, "policy_reward_mean": {}, "time_since_restore": 13617.40812921524, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2554, "time_total_s": 13617.40812921524, "episode_reward_max": 397.17693209741265, "off_policy_estimator": {}, "episode_reward_min": 287.8698349785991, "episode_reward_mean": 324.82516341882484, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.3173553943634, "timestamp": 1559277965, "episode_len_mean": 323.0, "iterations_since_restore": 110, "training_iteration": 110, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-46-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1004.5100929438358, "cost1_mean": 164.28402296581444, "system_level_velocity_max": 16.208330161927236, "cost2_min": -89.78542008362076, "outflow_rate_min": 794.6788506641655, "system_level_velocity_min": 11.709539781079801, "cost2_max": -74.04733255217158, "cost1_max": 186.7087235384539, "cost2_mean": -78.00010062335234, "cost1_min": 140.4674125463032, "discrim_loss": 0.8597767353057861, "outflow_rate_mean": 903.5062456825088, "system_level_velocity_mean": 13.934137572329314}}
{"sampler_perf": {"mean_inference_ms": 7.594098113511442, "mean_processing_ms": 11.143549952115833, "mean_env_wait_ms": 131.71580855075908}, "policy_reward_mean": {}, "time_since_restore": 13731.275687217712, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 2576, "time_total_s": 13731.275687217712, "episode_reward_max": 417.76340670511127, "off_policy_estimator": {}, "episode_reward_min": 306.91069026850164, "episode_reward_mean": 356.2460946289568, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.86755800247192, "timestamp": 1559278079, "episode_len_mean": 325.0, "iterations_since_restore": 111, "training_iteration": 111, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-47-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.780497843648, "cost1_mean": 173.82247523508758, "system_level_velocity_max": 16.210503764706452, "cost2_min": -81.75542025933805, "outflow_rate_min": 861.4481526309647, "system_level_velocity_min": 12.86917974778736, "cost2_max": -74.62944482450871, "cost1_max": 186.35917302957847, "cost2_mean": -77.22672905013371, "cost1_min": 155.1299436831814, "discrim_loss": 0.8643029928207397, "outflow_rate_mean": 941.8680863545699, "system_level_velocity_mean": 14.753782377730777}}
{"sampler_perf": {"mean_inference_ms": 7.591913786453944, "mean_processing_ms": 11.137697346531798, "mean_env_wait_ms": 131.58780462341142}, "policy_reward_mean": {}, "time_since_restore": 13845.08985710144, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2599, "time_total_s": 13845.08985710144, "episode_reward_max": 477.8698646109551, "off_policy_estimator": {}, "episode_reward_min": 362.3892008960247, "episode_reward_mean": 423.71513923221147, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.81416988372803, "timestamp": 1559278193, "episode_len_mean": 325.0, "iterations_since_restore": 112, "training_iteration": 112, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd950>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-49-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.560779343154, "cost1_mean": 169.14057331079422, "system_level_velocity_max": 16.10567118200801, "cost2_min": -81.35768117085527, "outflow_rate_min": 808.2419592221265, "system_level_velocity_min": 12.093721743207425, "cost2_max": -72.1947700741736, "cost1_max": 185.62505257031256, "cost2_mean": -76.15472209419241, "cost1_min": 145.724776844248, "discrim_loss": 0.8777792453765869, "outflow_rate_mean": 923.4358538793474, "system_level_velocity_mean": 14.322567479577414}}
{"sampler_perf": {"mean_inference_ms": 7.594543444360754, "mean_processing_ms": 11.139869506410498, "mean_env_wait_ms": 131.63342754428243}, "policy_reward_mean": {}, "time_since_restore": 13955.482046365738, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2624, "time_total_s": 13955.482046365738, "episode_reward_max": 458.5466480925679, "off_policy_estimator": {}, "episode_reward_min": 302.977008420974, "episode_reward_mean": 407.37097458586095, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.39218926429749, "timestamp": 1559278303, "episode_len_mean": 320.28, "iterations_since_restore": 113, "training_iteration": 113, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a598>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-51-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.3415560821024, "cost1_mean": 163.8598288574923, "system_level_velocity_max": 16.122433365527097, "cost2_min": -80.68453715034252, "outflow_rate_min": 807.1381525590903, "system_level_velocity_min": 11.93057522157158, "cost2_max": -61.11462838629099, "cost1_max": 184.9872658013822, "cost2_mean": -71.29194389564347, "cost1_min": 121.81868584880593, "discrim_loss": 0.8513458967208862, "outflow_rate_mean": 906.998537594058, "system_level_velocity_mean": 14.185973815897537}}
{"sampler_perf": {"mean_inference_ms": 7.588674605933597, "mean_processing_ms": 11.151892177112682, "mean_env_wait_ms": 131.32079818270822}, "policy_reward_mean": {}, "time_since_restore": 14065.096922636032, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2647, "time_total_s": 14065.096922636032, "episode_reward_max": 394.5098006129265, "off_policy_estimator": {}, "episode_reward_min": 308.1100979205221, "episode_reward_mean": 348.0623925118505, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.61487627029419, "timestamp": 1559278414, "episode_len_mean": 325.0, "iterations_since_restore": 114, "training_iteration": 114, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a400>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-53-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.0263570857703, "cost1_mean": 164.77235771248087, "system_level_velocity_max": 15.848616150811912, "cost2_min": -79.93218713405722, "outflow_rate_min": 783.9420168749814, "system_level_velocity_min": 11.499312135465368, "cost2_max": -63.95794259516618, "cost1_max": 181.70765216181098, "cost2_mean": -69.9927867758655, "cost1_min": 137.22816196937072, "discrim_loss": 0.8856184482574463, "outflow_rate_mean": 904.1512785454671, "system_level_velocity_mean": 14.063301015369378}}
{"sampler_perf": {"mean_inference_ms": 7.591859411350382, "mean_processing_ms": 11.136682660787896, "mean_env_wait_ms": 131.24813086439013}, "policy_reward_mean": {}, "time_since_restore": 14176.375619411469, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 2669, "time_total_s": 14176.375619411469, "episode_reward_max": 354.5891908593476, "off_policy_estimator": {}, "episode_reward_min": 285.861235961318, "episode_reward_mean": 311.8718382117804, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.2786967754364, "timestamp": 1559278527, "episode_len_mean": 325.0, "iterations_since_restore": 115, "training_iteration": 115, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-55-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 978.2778708834896, "cost1_mean": 166.38337787317704, "system_level_velocity_max": 15.760514477615708, "cost2_min": -72.71846208398209, "outflow_rate_min": 835.2456710585287, "system_level_velocity_min": 12.384244236598052, "cost2_max": -65.42478297398893, "cost1_max": 181.449557407501, "cost2_mean": -69.48761001569262, "cost1_min": 147.10859373709928, "discrim_loss": 0.8618229627609253, "outflow_rate_mean": 911.8213636624012, "system_level_velocity_mean": 14.19087179665744}}
{"sampler_perf": {"mean_inference_ms": 7.593285985696956, "mean_processing_ms": 11.147538124495322, "mean_env_wait_ms": 131.34889377892543}, "policy_reward_mean": {}, "time_since_restore": 14291.035534143448, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2693, "time_total_s": 14291.035534143448, "episode_reward_max": 366.1949666561559, "off_policy_estimator": {}, "episode_reward_min": 47.49541328847408, "episode_reward_mean": 325.5278139062381, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.65991473197937, "timestamp": 1559278642, "episode_len_mean": 312.625, "iterations_since_restore": 116, "training_iteration": 116, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdd90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd9d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-57-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.5094478599955, "cost1_mean": 159.5473621186554, "system_level_velocity_max": 18.24991840313791, "cost2_min": -76.47346028207674, "outflow_rate_min": 499.684746459077, "system_level_velocity_min": 11.6974933423747, "cost2_max": -18.937699343731847, "cost1_max": 182.41798262932235, "cost2_mean": -67.61789852588926, "cost1_min": 18.60695114562007, "discrim_loss": 0.8553302884101868, "outflow_rate_mean": 891.3689097812791, "system_level_velocity_mean": 14.320084370683764}}
{"sampler_perf": {"mean_inference_ms": 7.591850010684773, "mean_processing_ms": 11.146417402913839, "mean_env_wait_ms": 131.02006949997605}, "policy_reward_mean": {}, "time_since_restore": 14403.366379261017, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2717, "time_total_s": 14403.366379261017, "episode_reward_max": 443.1005631480366, "off_policy_estimator": {}, "episode_reward_min": 340.91803976893425, "episode_reward_mean": 396.1303915790825, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.33084511756897, "timestamp": 1559278754, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 117, "training_iteration": 117, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ad08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034abf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-59-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.8034136605255, "cost1_mean": 168.56827618281713, "system_level_velocity_max": 15.791360150901667, "cost2_min": -72.35043433730996, "outflow_rate_min": 841.4921936671894, "system_level_velocity_min": 12.69043914325561, "cost2_max": -64.97235406245753, "cost1_max": 182.17758170768354, "cost2_mean": -69.27306322099876, "cost1_min": 149.23548322644803, "discrim_loss": 0.8856143951416016, "outflow_rate_mean": 923.6969504572235, "system_level_velocity_mean": 14.488993561592489}}
{"sampler_perf": {"mean_inference_ms": 7.590310702465358, "mean_processing_ms": 11.15686007641827, "mean_env_wait_ms": 130.86513054921605}, "policy_reward_mean": {}, "time_since_restore": 14510.596592664719, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2740, "time_total_s": 14510.596592664719, "episode_reward_max": 427.9110650680959, "off_policy_estimator": {}, "episode_reward_min": 351.68094231933355, "episode_reward_mean": 380.0898478149801, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.23021340370178, "timestamp": 1559278861, "episode_len_mean": 325.0, "iterations_since_restore": 118, "training_iteration": 118, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-01-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.1674885740507, "cost1_mean": 165.97243867526586, "system_level_velocity_max": 15.729041325856743, "cost2_min": -74.78816103411936, "outflow_rate_min": 814.0426208213333, "system_level_velocity_min": 12.028933509658268, "cost2_max": -64.81530986580347, "cost1_max": 181.59485087770875, "cost2_mean": -69.66659766145493, "cost1_min": 142.25887646260242, "discrim_loss": 0.8528506755828857, "outflow_rate_mean": 910.5490089280361, "system_level_velocity_mean": 14.17904287368905}}
{"sampler_perf": {"mean_inference_ms": 7.588092917931991, "mean_processing_ms": 11.159680435376412, "mean_env_wait_ms": 130.8523961403029}, "policy_reward_mean": {}, "time_since_restore": 14619.103198051453, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2763, "time_total_s": 14619.103198051453, "episode_reward_max": 356.6841712780297, "off_policy_estimator": {}, "episode_reward_min": 52.88512419164181, "episode_reward_mean": 304.0774916068894, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.50660538673401, "timestamp": 1559278970, "episode_len_mean": 312.39130434782606, "iterations_since_restore": 119, "training_iteration": 119, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfb70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf9d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-02-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.1028912904126, "cost1_mean": 162.7016490353108, "system_level_velocity_max": 18.470712027091324, "cost2_min": -72.14698925980235, "outflow_rate_min": 500.0282905092703, "system_level_velocity_min": 12.782984505664057, "cost2_max": -22.325339409249995, "cost1_max": 181.4612553470533, "cost2_mean": -66.69943014316976, "cost1_min": 22.908564279366267, "discrim_loss": 0.8644723296165466, "outflow_rate_mean": 904.7443255859148, "system_level_velocity_mean": 14.619167096109607}}
{"sampler_perf": {"mean_inference_ms": 7.587097013602382, "mean_processing_ms": 11.148537673748443, "mean_env_wait_ms": 130.65610417424213}, "policy_reward_mean": {}, "time_since_restore": 14725.265141010284, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2788, "time_total_s": 14725.265141010284, "episode_reward_max": 317.16093579586595, "off_policy_estimator": {}, "episode_reward_min": 47.12596459686756, "episode_reward_mean": 278.7063421632722, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 106.16194295883179, "timestamp": 1559279076, "episode_len_mean": 312.28, "iterations_since_restore": 120, "training_iteration": 120, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-04-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.3291907114749, "cost1_mean": 161.0514036502061, "system_level_velocity_max": 18.41259208193596, "cost2_min": -71.97031879003548, "outflow_rate_min": 516.5375004973323, "system_level_velocity_min": 11.573287716421698, "cost2_max": -22.393332988589027, "cost1_max": 182.80271327122074, "cost2_mean": -67.57307470044226, "cost1_min": 22.62775242706536, "discrim_loss": 0.850601315498352, "outflow_rate_mean": 899.4213563011082, "system_level_velocity_mean": 14.452528930474166}}
{"sampler_perf": {"mean_inference_ms": 7.581461974969426, "mean_processing_ms": 11.158588195734604, "mean_env_wait_ms": 130.40039798916706}, "policy_reward_mean": {}, "time_since_restore": 14827.010999679565, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2811, "time_total_s": 14827.010999679565, "episode_reward_max": 363.6018949057907, "off_policy_estimator": {}, "episode_reward_min": 285.08743598591536, "episode_reward_mean": 333.55917820899305, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 101.745858669281, "timestamp": 1559279178, "episode_len_mean": 325.0, "iterations_since_restore": 121, "training_iteration": 121, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ac80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ad90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-06-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.9168128841628, "cost1_mean": 169.57314748334346, "system_level_velocity_max": 15.766105945863584, "cost2_min": -72.86107483934904, "outflow_rate_min": 841.6229886222113, "system_level_velocity_min": 12.361152100792578, "cost2_max": -66.04960613792477, "cost1_max": 182.2619220738446, "cost2_mean": -69.3337748619201, "cost1_min": 147.3784969240809, "discrim_loss": 0.8315039873123169, "outflow_rate_mean": 926.5865096288555, "system_level_velocity_mean": 14.516303988068186}}
{"sampler_perf": {"mean_inference_ms": 7.580487679542679, "mean_processing_ms": 11.142373438204503, "mean_env_wait_ms": 130.34471812094296}, "policy_reward_mean": {}, "time_since_restore": 14940.221655607224, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 2833, "time_total_s": 14940.221655607224, "episode_reward_max": 427.5954859899357, "off_policy_estimator": {}, "episode_reward_min": 347.0259022768587, "episode_reward_mean": 385.8204299622766, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.21065592765808, "timestamp": 1559279291, "episode_len_mean": 325.0, "iterations_since_restore": 122, "training_iteration": 122, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303750d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-08-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.7610417972512, "cost1_mean": 164.2357126885661, "system_level_velocity_max": 15.778467428923468, "cost2_min": -77.15789790985458, "outflow_rate_min": 793.7501383827605, "system_level_velocity_min": 11.606002329622342, "cost2_max": -65.04451174920604, "cost1_max": 182.25054807366058, "cost2_mean": -69.94060360042198, "cost1_min": 138.05986989426378, "discrim_loss": 0.822969913482666, "outflow_rate_mean": 903.8748381284848, "system_level_velocity_mean": 13.980334311279874}}
{"sampler_perf": {"mean_inference_ms": 7.584470318931582, "mean_processing_ms": 11.147265583034995, "mean_env_wait_ms": 130.3412463613897}, "policy_reward_mean": {}, "time_since_restore": 15053.00443816185, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 2857, "time_total_s": 15053.00443816185, "episode_reward_max": 401.42670544516295, "off_policy_estimator": {}, "episode_reward_min": 356.009415442124, "episode_reward_mean": 380.5115608999428, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.78278255462646, "timestamp": 1559279404, "episode_len_mean": 325.0, "iterations_since_restore": 123, "training_iteration": 123, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb2f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-10-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.0679035557624, "cost1_mean": 168.70366310249182, "system_level_velocity_max": 15.696826142155103, "cost2_min": -73.25425626347415, "outflow_rate_min": 839.6239930105181, "system_level_velocity_min": 12.691618059660266, "cost2_max": -67.98742672157954, "cost1_max": 181.51379038336603, "cost2_mean": -70.62025308067246, "cost1_min": 150.26912308956224, "discrim_loss": 0.8119046688079834, "outflow_rate_mean": 921.5220696683718, "system_level_velocity_mean": 14.377995414559445}}
{"sampler_perf": {"mean_inference_ms": 7.58029761079545, "mean_processing_ms": 11.156757984032447, "mean_env_wait_ms": 130.10873992691745}, "policy_reward_mean": {}, "time_since_restore": 15167.094818353653, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2880, "time_total_s": 15167.094818353653, "episode_reward_max": 375.82712309109047, "off_policy_estimator": {}, "episode_reward_min": 286.7553918166086, "episode_reward_mean": 315.9998575908274, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.09038019180298, "timestamp": 1559279518, "episode_len_mean": 325.0, "iterations_since_restore": 124, "training_iteration": 124, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ac80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a048>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-11-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.156136428299, "cost1_mean": 172.3265804283779, "system_level_velocity_max": 15.748191683038035, "cost2_min": -72.92407012568424, "outflow_rate_min": 840.3495874304758, "system_level_velocity_min": 12.697204903173153, "cost2_max": -66.06473907013282, "cost1_max": 182.7506480132579, "cost2_mean": -69.95699078498689, "cost1_min": 151.5637437002647, "discrim_loss": 0.8148382902145386, "outflow_rate_mean": 936.0269751366661, "system_level_velocity_mean": 14.690254660625707}}
{"sampler_perf": {"mean_inference_ms": 7.581785242847355, "mean_processing_ms": 11.141617418778031, "mean_env_wait_ms": 130.04906985735508}, "policy_reward_mean": {}, "time_since_restore": 15277.659273147583, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 2902, "time_total_s": 15277.659273147583, "episode_reward_max": 299.4267949676141, "off_policy_estimator": {}, "episode_reward_min": 257.3035521591082, "episode_reward_mean": 274.73480563407594, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.56445479393005, "timestamp": 1559279631, "episode_len_mean": 325.0, "iterations_since_restore": 125, "training_iteration": 125, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-13-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.3034524027197, "cost1_mean": 169.09107372001557, "system_level_velocity_max": 15.706721127153136, "cost2_min": -80.13082069411436, "outflow_rate_min": 783.6251830859919, "system_level_velocity_min": 11.463854797909187, "cost2_max": -66.63805721440383, "cost1_max": 181.59143089947685, "cost2_mean": -70.8709413624139, "cost1_min": 139.66334264733237, "discrim_loss": 0.8002988696098328, "outflow_rate_mean": 923.745715584886, "system_level_velocity_mean": 14.36254683978043}}
{"sampler_perf": {"mean_inference_ms": 7.582541422657691, "mean_processing_ms": 11.145726771767475, "mean_env_wait_ms": 130.0956416459307}, "policy_reward_mean": {}, "time_since_restore": 15389.21401643753, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 2927, "time_total_s": 15389.21401643753, "episode_reward_max": 353.4423276986927, "off_policy_estimator": {}, "episode_reward_min": 260.24256980326027, "episode_reward_mean": 308.03816908441485, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.55474328994751, "timestamp": 1559279743, "episode_len_mean": 325.0, "iterations_since_restore": 126, "training_iteration": 126, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bff28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfe18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-15-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.7084591377625, "cost1_mean": 167.50097591871148, "system_level_velocity_max": 15.716285703529284, "cost2_min": -77.68929527518291, "outflow_rate_min": 801.9681827386087, "system_level_velocity_min": 11.801029431524523, "cost2_max": -67.82177587634617, "cost1_max": 181.91633435674535, "cost2_mean": -71.88941040277673, "cost1_min": 140.57814059850526, "discrim_loss": 0.788017749786377, "outflow_rate_mean": 916.6611825646177, "system_level_velocity_mean": 14.228566653743464}}
{"sampler_perf": {"mean_inference_ms": 7.579366768752178, "mean_processing_ms": 11.161109422070183, "mean_env_wait_ms": 129.84660054290657}, "policy_reward_mean": {}, "time_since_restore": 15501.091620206833, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2950, "time_total_s": 15501.091620206833, "episode_reward_max": 423.89549831999466, "off_policy_estimator": {}, "episode_reward_min": 328.4495387482457, "episode_reward_mean": 387.5105712590739, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.87760376930237, "timestamp": 1559279855, "episode_len_mean": 325.0, "iterations_since_restore": 127, "training_iteration": 127, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-17-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.5182911129708, "cost1_mean": 166.87813747959274, "system_level_velocity_max": 15.75411627395597, "cost2_min": -75.162560773367, "outflow_rate_min": 803.5284297855242, "system_level_velocity_min": 11.85074966328396, "cost2_max": -67.35412840066012, "cost1_max": 182.39438194774095, "cost2_mean": -71.9064939974729, "cost1_min": 142.4953892861867, "discrim_loss": 0.8104454278945923, "outflow_rate_mean": 913.4898043361824, "system_level_velocity_mean": 14.158528054110946}}
{"sampler_perf": {"mean_inference_ms": 7.581411769732253, "mean_processing_ms": 11.16280571893769, "mean_env_wait_ms": 129.8225534866174}, "policy_reward_mean": {}, "time_since_restore": 15617.646674871445, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2973, "time_total_s": 15617.646674871445, "episode_reward_max": 404.4911359800026, "off_policy_estimator": {}, "episode_reward_min": 63.425537034869194, "episode_reward_mean": 367.48450972500217, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.55505466461182, "timestamp": 1559279972, "episode_len_mean": 312.39130434782606, "iterations_since_restore": 128, "training_iteration": 128, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a7b8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-19-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.0424377178599, "cost1_mean": 162.39142510413126, "system_level_velocity_max": 18.49895631160903, "cost2_min": -76.88418098728597, "outflow_rate_min": 507.9240826301831, "system_level_velocity_min": 12.6474510130291, "cost2_max": -21.798968709855302, "cost1_max": 183.52227346817574, "cost2_mean": -71.3167971885897, "cost1_min": 22.865249419012557, "discrim_loss": 0.7995802760124207, "outflow_rate_mean": 902.7588831757406, "system_level_velocity_mean": 14.43947751878004}}
{"sampler_perf": {"mean_inference_ms": 7.581038166990466, "mean_processing_ms": 11.15336112951372, "mean_env_wait_ms": 129.92413816904752}, "policy_reward_mean": {}, "time_since_restore": 15733.428018569946, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 2996, "time_total_s": 15733.428018569946, "episode_reward_max": 361.0565411821008, "off_policy_estimator": {}, "episode_reward_min": 271.9589880006388, "episode_reward_mean": 302.7396831388342, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.78134369850159, "timestamp": 1559280087, "episode_len_mean": 325.0, "iterations_since_restore": 129, "training_iteration": 129, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-21-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.032568194594, "cost1_mean": 166.22962066158522, "system_level_velocity_max": 15.677781508537905, "cost2_min": -81.21780682309931, "outflow_rate_min": 789.6371786034904, "system_level_velocity_min": 11.788109574715453, "cost2_max": -69.45328619404643, "cost1_max": 183.80707628929, "cost2_mean": -75.39021568346992, "cost1_min": 140.85529063776568, "discrim_loss": 0.7655038833618164, "outflow_rate_mean": 906.6829817115233, "system_level_velocity_mean": 13.985790578547995}}
{"sampler_perf": {"mean_inference_ms": 7.57950272980645, "mean_processing_ms": 11.15454119913777, "mean_env_wait_ms": 129.68797863595697}, "policy_reward_mean": {}, "time_since_restore": 15849.107234716415, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3020, "time_total_s": 15849.107234716415, "episode_reward_max": 297.27372214756906, "off_policy_estimator": {}, "episode_reward_min": 262.1125706844032, "episode_reward_mean": 278.17093111097347, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.67921614646912, "timestamp": 1559280203, "episode_len_mean": 325.0, "iterations_since_restore": 130, "training_iteration": 130, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfa60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfd90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-23-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.4506402491327, "cost1_mean": 170.48032843251804, "system_level_velocity_max": 15.82123030663083, "cost2_min": -81.3983912314219, "outflow_rate_min": 819.2470389510412, "system_level_velocity_min": 11.976931708867493, "cost2_max": -70.01448078002741, "cost1_max": 184.74720083535215, "cost2_mean": -75.0730735630932, "cost1_min": 144.52484475163908, "discrim_loss": 0.7734265923500061, "outflow_rate_mean": 925.6444585370518, "system_level_velocity_mean": 14.39053298253603}}
{"sampler_perf": {"mean_inference_ms": 7.5803300068781985, "mean_processing_ms": 11.170505955894807, "mean_env_wait_ms": 129.63607212344715}, "policy_reward_mean": {}, "time_since_restore": 15963.665168046951, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3043, "time_total_s": 15963.665168046951, "episode_reward_max": 352.170429575257, "off_policy_estimator": {}, "episode_reward_min": 287.0965452333912, "episode_reward_mean": 321.0889248003495, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.55793333053589, "timestamp": 1559280318, "episode_len_mean": 325.0, "iterations_since_restore": 131, "training_iteration": 131, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf7b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-25-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.6083790676023, "cost1_mean": 172.88004165153276, "system_level_velocity_max": 15.847353540428795, "cost2_min": -78.09560488351124, "outflow_rate_min": 855.521596291926, "system_level_velocity_min": 12.400069573133651, "cost2_max": -68.54678957116337, "cost1_max": 184.7081062362008, "cost2_mean": -74.58531656789937, "cost1_min": 149.33521242271357, "discrim_loss": 0.7625361680984497, "outflow_rate_mean": 935.8178633539137, "system_level_velocity_mean": 14.59431713688517}}
{"sampler_perf": {"mean_inference_ms": 7.577124590408755, "mean_processing_ms": 11.158334415168389, "mean_env_wait_ms": 129.68532353822766}, "policy_reward_mean": {}, "time_since_restore": 16075.867487192154, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3065, "time_total_s": 16075.867487192154, "episode_reward_max": 411.5133370589465, "off_policy_estimator": {}, "episode_reward_min": 335.6532267834991, "episode_reward_mean": 375.6001143234528, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.20231914520264, "timestamp": 1559280430, "episode_len_mean": 325.0, "iterations_since_restore": 132, "training_iteration": 132, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-27-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.119484383969, "cost1_mean": 172.41668737003317, "system_level_velocity_max": 16.02162074609094, "cost2_min": -81.71059659159914, "outflow_rate_min": 779.602955953209, "system_level_velocity_min": 11.636874187182634, "cost2_max": -70.1659308214264, "cost1_max": 185.24621583735345, "cost2_mean": -74.25690007140497, "cost1_min": 140.97413062342744, "discrim_loss": 0.7631258368492126, "outflow_rate_mean": 934.4317920436301, "system_level_velocity_mean": 14.582797100921645}}
{"sampler_perf": {"mean_inference_ms": 7.578341030856783, "mean_processing_ms": 11.151323507704626, "mean_env_wait_ms": 129.58333597459034}, "policy_reward_mean": {}, "time_since_restore": 16195.105609178543, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3089, "time_total_s": 16195.105609178543, "episode_reward_max": 446.55781212449074, "off_policy_estimator": {}, "episode_reward_min": 340.44368705153465, "episode_reward_mean": 365.1936284795714, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.23812198638916, "timestamp": 1559280549, "episode_len_mean": 325.0, "iterations_since_restore": 133, "training_iteration": 133, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-29-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.5274963412319, "cost1_mean": 172.67424780640786, "system_level_velocity_max": 15.916260576429089, "cost2_min": -77.33244878036925, "outflow_rate_min": 849.011441319412, "system_level_velocity_min": 12.665096414858848, "cost2_max": -68.43414674035978, "cost1_max": 185.309582432683, "cost2_mean": -74.48876687921035, "cost1_min": 152.4201254257745, "discrim_loss": 0.763637363910675, "outflow_rate_mean": 935.96270943517, "system_level_velocity_mean": 14.591349543303897}}
{"sampler_perf": {"mean_inference_ms": 7.573080580502194, "mean_processing_ms": 11.16972657173522, "mean_env_wait_ms": 129.4185308279409}, "policy_reward_mean": {}, "time_since_restore": 16305.22343492508, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3112, "time_total_s": 16305.22343492508, "episode_reward_max": 362.0392323252745, "off_policy_estimator": {}, "episode_reward_min": 274.6980626909062, "episode_reward_mean": 307.9446162859018, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.11782574653625, "timestamp": 1559280660, "episode_len_mean": 325.0, "iterations_since_restore": 134, "training_iteration": 134, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfbf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfd08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-31-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.4436331006505, "cost1_mean": 169.83498409069153, "system_level_velocity_max": 15.676616007304622, "cost2_min": -77.89589454828787, "outflow_rate_min": 866.096377339822, "system_level_velocity_min": 12.79495594715568, "cost2_max": -71.25312423403918, "cost1_max": 183.1654762487205, "cost2_mean": -74.55927447266795, "cost1_min": 153.57888196627772, "discrim_loss": 0.7685805559158325, "outflow_rate_mean": 924.6398362488997, "system_level_velocity_mean": 14.323981940797102}}
{"sampler_perf": {"mean_inference_ms": 7.574844371039982, "mean_processing_ms": 11.15972306816816, "mean_env_wait_ms": 129.40274292447043}, "policy_reward_mean": {}, "time_since_restore": 16425.066799879074, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3135, "time_total_s": 16425.066799879074, "episode_reward_max": 300.2013113256544, "off_policy_estimator": {}, "episode_reward_min": 42.894150987267494, "episode_reward_mean": 274.0251163223596, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.84336495399475, "timestamp": 1559280780, "episode_len_mean": 312.4782608695652, "iterations_since_restore": 135, "training_iteration": 135, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-33-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 991.8660928746418, "cost1_mean": 165.868170649055, "system_level_velocity_max": 18.77320869482845, "cost2_min": -79.40276232816237, "outflow_rate_min": 518.6392970701784, "system_level_velocity_min": 12.34773430172456, "cost2_max": -23.057161488310093, "cost1_max": 184.75887807995315, "cost2_mean": -72.52534532457427, "cost1_min": 24.309606897745162, "discrim_loss": 0.7663410902023315, "outflow_rate_mean": 915.6235793014652, "system_level_velocity_mean": 14.752223393389492}}
{"sampler_perf": {"mean_inference_ms": 7.583759599336091, "mean_processing_ms": 11.161870046220146, "mean_env_wait_ms": 129.49676949870363}, "policy_reward_mean": {}, "time_since_restore": 16543.073256492615, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3159, "time_total_s": 16543.073256492615, "episode_reward_max": 343.7410923745483, "off_policy_estimator": {}, "episode_reward_min": 267.4930061586201, "episode_reward_mean": 311.03215340945945, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.00645661354065, "timestamp": 1559280898, "episode_len_mean": 325.0, "iterations_since_restore": 136, "training_iteration": 136, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bec80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bebf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bed90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bed08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-34-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.2748432159893, "cost1_mean": 172.38283869176996, "system_level_velocity_max": 15.70668082676666, "cost2_min": -78.63249329746994, "outflow_rate_min": 863.9862949765524, "system_level_velocity_min": 12.649393257044377, "cost2_max": -70.2321634219484, "cost1_max": 183.1602736869906, "cost2_mean": -74.79894171893373, "cost1_min": 152.91650336977804, "discrim_loss": 0.7444954514503479, "outflow_rate_mean": 935.1621852760882, "system_level_velocity_mean": 14.574797414189446}}
{"sampler_perf": {"mean_inference_ms": 7.579845052968326, "mean_processing_ms": 11.1773473868722, "mean_env_wait_ms": 129.32572759860324}, "policy_reward_mean": {}, "time_since_restore": 16660.940169095993, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3182, "time_total_s": 16660.940169095993, "episode_reward_max": 395.2266349233687, "off_policy_estimator": {}, "episode_reward_min": 328.2242976613343, "episode_reward_mean": 368.1815083290896, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.8669126033783, "timestamp": 1559281016, "episode_len_mean": 325.0, "iterations_since_restore": 137, "training_iteration": 137, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-36-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.3819809669023, "cost1_mean": 171.4891388535511, "system_level_velocity_max": 15.754010258925955, "cost2_min": -79.9200177335268, "outflow_rate_min": 844.3061874692243, "system_level_velocity_min": 12.651312430491293, "cost2_max": -73.32808468461538, "cost1_max": 184.16232905604585, "cost2_mean": -76.06202314723407, "cost1_min": 152.16655834888687, "discrim_loss": 0.7485510110855103, "outflow_rate_mean": 929.2394088410499, "system_level_velocity_mean": 14.44554428045448}}
{"sampler_perf": {"mean_inference_ms": 7.58238953578365, "mean_processing_ms": 11.166495963997194, "mean_env_wait_ms": 129.31318072677902}, "policy_reward_mean": {}, "time_since_restore": 16776.22527384758, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3204, "time_total_s": 16776.22527384758, "episode_reward_max": 393.4858154761605, "off_policy_estimator": {}, "episode_reward_min": 333.3993236999959, "episode_reward_mean": 358.35350500142454, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.28510475158691, "timestamp": 1559281131, "episode_len_mean": 325.0, "iterations_since_restore": 138, "training_iteration": 138, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-38-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.2746183455306, "cost1_mean": 168.42869660319613, "system_level_velocity_max": 15.940020857516076, "cost2_min": -81.9546997120699, "outflow_rate_min": 782.5445521029997, "system_level_velocity_min": 11.644401238897167, "cost2_max": -71.63672701686482, "cost1_max": 185.4629821931423, "cost2_mean": -76.19831858987213, "cost1_min": 139.42092014390863, "discrim_loss": 0.7299020290374756, "outflow_rate_mean": 916.7027428313557, "system_level_velocity_mean": 14.1915127627665}}
{"sampler_perf": {"mean_inference_ms": 7.584700830717948, "mean_processing_ms": 11.165428703906667, "mean_env_wait_ms": 129.42359917528688}, "policy_reward_mean": {}, "time_since_restore": 16905.304470300674, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 3229, "time_total_s": 16905.304470300674, "episode_reward_max": 351.77058128640056, "off_policy_estimator": {}, "episode_reward_min": 271.07333240285516, "episode_reward_mean": 307.5269325805688, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.07919645309448, "timestamp": 1559281265, "episode_len_mean": 325.0, "iterations_since_restore": 139, "training_iteration": 139, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bed08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bec80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bed90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bebf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-41-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.5082414266014, "cost1_mean": 166.47819971910823, "system_level_velocity_max": 15.986740941422104, "cost2_min": -85.39124389955482, "outflow_rate_min": 490.10564178336915, "system_level_velocity_min": 6.308253228727488, "cost2_max": -71.5757368596803, "cost1_max": 186.2369260767236, "cost2_mean": -76.29645285214629, "cost1_min": 76.01574937340088, "discrim_loss": 0.7312713861465454, "outflow_rate_mean": 907.4901609995956, "system_level_velocity_mean": 14.014982899082426}}
{"sampler_perf": {"mean_inference_ms": 7.580950366880953, "mean_processing_ms": 11.163885878180691, "mean_env_wait_ms": 129.25210076560583}, "policy_reward_mean": {}, "time_since_restore": 17018.885282993317, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 3250, "time_total_s": 17018.885282993317, "episode_reward_max": 302.31707936059684, "off_policy_estimator": {}, "episode_reward_min": 269.6226186528802, "episode_reward_mean": 286.28143339012087, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.58081269264221, "timestamp": 1559281379, "episode_len_mean": 325.0, "iterations_since_restore": 140, "training_iteration": 140, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beb70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-42-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.6979452877979, "cost1_mean": 172.02844729795066, "system_level_velocity_max": 15.66283310687315, "cost2_min": -81.85311076920686, "outflow_rate_min": 827.547434557657, "system_level_velocity_min": 11.847326392417814, "cost2_max": -71.14400699348602, "cost1_max": 183.49257071560385, "cost2_mean": -75.65096688330748, "cost1_min": 144.52515569881905, "discrim_loss": 0.734618067741394, "outflow_rate_mean": 931.5992685545498, "system_level_velocity_mean": 14.500115731051194}}
{"sampler_perf": {"mean_inference_ms": 7.581360707538818, "mean_processing_ms": 11.18076050636575, "mean_env_wait_ms": 129.1598306785082}, "policy_reward_mean": {}, "time_since_restore": 17134.29699063301, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3274, "time_total_s": 17134.29699063301, "episode_reward_max": 345.85310349054635, "off_policy_estimator": {}, "episode_reward_min": 255.480269420892, "episode_reward_mean": 305.73643866181374, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.41170763969421, "timestamp": 1559281494, "episode_len_mean": 325.0, "iterations_since_restore": 141, "training_iteration": 141, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-44-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.3142412714732, "cost1_mean": 171.33185618624483, "system_level_velocity_max": 15.988697479743134, "cost2_min": -78.0914023665678, "outflow_rate_min": 853.7625191466238, "system_level_velocity_min": 12.305762589092415, "cost2_max": -69.82855168564114, "cost1_max": 186.00036692538316, "cost2_mean": -74.70000873872134, "cost1_min": 149.59108454868874, "discrim_loss": 0.7084383964538574, "outflow_rate_mean": 930.0291171421947, "system_level_velocity_mean": 14.444109048589988}}
{"sampler_perf": {"mean_inference_ms": 7.584297344618915, "mean_processing_ms": 11.169201997703409, "mean_env_wait_ms": 129.29703878037517}, "policy_reward_mean": {}, "time_since_restore": 17252.707325935364, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3297, "time_total_s": 17252.707325935364, "episode_reward_max": 381.290889300406, "off_policy_estimator": {}, "episode_reward_min": 311.2037252634764, "episode_reward_mean": 346.1714623432363, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.4103353023529, "timestamp": 1559281613, "episode_len_mean": 325.0, "iterations_since_restore": 142, "training_iteration": 142, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-46-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.0832674447175, "cost1_mean": 168.42132529591586, "system_level_velocity_max": 15.645555045802624, "cost2_min": -84.28022646360034, "outflow_rate_min": 816.2318178129891, "system_level_velocity_min": 11.966799728614545, "cost2_max": -72.20155589009516, "cost1_max": 183.76470444799884, "cost2_mean": -75.64327831964172, "cost1_min": 142.3058373846801, "discrim_loss": 0.7134814262390137, "outflow_rate_mean": 918.6204778525889, "system_level_velocity_mean": 14.202747399218792}}
{"sampler_perf": {"mean_inference_ms": 7.584999733083451, "mean_processing_ms": 11.16413612768197, "mean_env_wait_ms": 129.1444979318517}, "policy_reward_mean": {}, "time_since_restore": 17369.244809389114, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3320, "time_total_s": 17369.244809389114, "episode_reward_max": 365.165631595999, "off_policy_estimator": {}, "episode_reward_min": 298.1863516699523, "episode_reward_mean": 328.5696260347841, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.53748345375061, "timestamp": 1559281729, "episode_len_mean": 325.0, "iterations_since_restore": 143, "training_iteration": 143, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-48-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.3725100480098, "cost1_mean": 168.04166093722404, "system_level_velocity_max": 15.723334438319956, "cost2_min": -80.62166153314985, "outflow_rate_min": 807.6344395969758, "system_level_velocity_min": 11.973931780360294, "cost2_max": -72.12532312905279, "cost1_max": 183.6166708255707, "cost2_mean": -75.26744250016276, "cost1_min": 145.49331565700874, "discrim_loss": 0.7125234603881836, "outflow_rate_mean": 914.951548549666, "system_level_velocity_mean": 14.127732297193164}}
{"sampler_perf": {"mean_inference_ms": 7.5830188715832065, "mean_processing_ms": 11.185280192949621, "mean_env_wait_ms": 129.0572583722295}, "policy_reward_mean": {}, "time_since_restore": 17487.55722141266, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3344, "time_total_s": 17487.55722141266, "episode_reward_max": 337.72766955010593, "off_policy_estimator": {}, "episode_reward_min": 240.39855642430484, "episode_reward_mean": 284.88974170795217, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.31241202354431, "timestamp": 1559281848, "episode_len_mean": 325.0, "iterations_since_restore": 144, "training_iteration": 144, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-50-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.4867658924331, "cost1_mean": 170.31019897139228, "system_level_velocity_max": 15.948954992705655, "cost2_min": -80.35958570065347, "outflow_rate_min": 784.3120325846307, "system_level_velocity_min": 11.673665970055701, "cost2_max": -70.21823734423131, "cost1_max": 185.71607261726348, "cost2_mean": -75.16429812946485, "cost1_min": 141.014096255406, "discrim_loss": 0.7167675495147705, "outflow_rate_mean": 924.8933765054971, "system_level_velocity_mean": 14.381716985353115}}
{"sampler_perf": {"mean_inference_ms": 7.5848060034302955, "mean_processing_ms": 11.17286751209369, "mean_env_wait_ms": 129.1615470874811}, "policy_reward_mean": {}, "time_since_restore": 17606.67739009857, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3366, "time_total_s": 17606.67739009857, "episode_reward_max": 284.73096759058535, "off_policy_estimator": {}, "episode_reward_min": 246.80424419790506, "episode_reward_mean": 269.2847257898909, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.12016868591309, "timestamp": 1559281967, "episode_len_mean": 325.0, "iterations_since_restore": 145, "training_iteration": 145, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c19d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-52-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.4743203705591, "cost1_mean": 169.50097766310424, "system_level_velocity_max": 15.742341730136317, "cost2_min": -80.26586651015648, "outflow_rate_min": 780.7966245674434, "system_level_velocity_min": 11.535110736165604, "cost2_max": -68.88793983859006, "cost1_max": 183.2619177048171, "cost2_mean": -75.07339712219742, "cost1_min": 138.0068006788652, "discrim_loss": 0.6895897388458252, "outflow_rate_mean": 922.7446959096491, "system_level_velocity_mean": 14.307936152767796}}
{"sampler_perf": {"mean_inference_ms": 7.588498489200833, "mean_processing_ms": 11.161189473372103, "mean_env_wait_ms": 129.0867244231873}, "policy_reward_mean": {}, "time_since_restore": 17723.24690055847, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3390, "time_total_s": 17723.24690055847, "episode_reward_max": 376.17213846743107, "off_policy_estimator": {}, "episode_reward_min": 252.6197579698637, "episode_reward_mean": 325.45771790400613, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.5695104598999, "timestamp": 1559282084, "episode_len_mean": 325.0, "iterations_since_restore": 146, "training_iteration": 146, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-54-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.1397060940868, "cost1_mean": 170.59081489132885, "system_level_velocity_max": 15.660702549075227, "cost2_min": -79.08436278678532, "outflow_rate_min": 853.2014759251313, "system_level_velocity_min": 12.646665537440937, "cost2_max": -70.36708027666158, "cost1_max": 182.90866235749348, "cost2_mean": -75.36247277009669, "cost1_min": 152.0617705311749, "discrim_loss": 0.6950365304946899, "outflow_rate_mean": 926.6266579418966, "system_level_velocity_mean": 14.393773411756067}}
{"sampler_perf": {"mean_inference_ms": 7.58609578530124, "mean_processing_ms": 11.186282031216022, "mean_env_wait_ms": 128.98324749793707}, "policy_reward_mean": {}, "time_since_restore": 17837.658794164658, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3413, "time_total_s": 17837.658794164658, "episode_reward_max": 372.1405106391758, "off_policy_estimator": {}, "episode_reward_min": 321.1043564733118, "episode_reward_mean": 351.50965673375225, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.41189360618591, "timestamp": 1559282198, "episode_len_mean": 325.0, "iterations_since_restore": 147, "training_iteration": 147, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034e268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034e158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034e0d0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-56-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 998.5886694685151, "cost1_mean": 170.98132761329163, "system_level_velocity_max": 16.034924939169542, "cost2_min": -77.82218246683453, "outflow_rate_min": 857.8815998707696, "system_level_velocity_min": 12.59666761944781, "cost2_max": -72.15237502417976, "cost1_max": 185.70770085181317, "cost2_mean": -74.62488229441826, "cost1_min": 150.80968500640034, "discrim_loss": 0.7033064365386963, "outflow_rate_mean": 929.7740401774082, "system_level_velocity_mean": 14.452141476342586}}
{"sampler_perf": {"mean_inference_ms": 7.586247061376718, "mean_processing_ms": 11.17400662700089, "mean_env_wait_ms": 128.96293765537519}, "policy_reward_mean": {}, "time_since_restore": 17953.409447669983, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3435, "time_total_s": 17953.409447669983, "episode_reward_max": 350.9977804366499, "off_policy_estimator": {}, "episode_reward_min": 270.26897665299475, "episode_reward_mean": 299.8886633176801, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.75065350532532, "timestamp": 1559282314, "episode_len_mean": 325.0, "iterations_since_restore": 148, "training_iteration": 148, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-58-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 977.3339937842198, "cost1_mean": 169.5033428584526, "system_level_velocity_max": 15.560801355718414, "cost2_min": -79.67474285790283, "outflow_rate_min": 844.8848785846774, "system_level_velocity_min": 12.581666668294066, "cost2_max": -72.88896107472792, "cost1_max": 182.77622540517174, "cost2_mean": -76.09818420091136, "cost1_min": 150.64412566997288, "discrim_loss": 0.6895331144332886, "outflow_rate_mean": 919.6976677842966, "system_level_velocity_mean": 14.26578871034294}}
{"sampler_perf": {"mean_inference_ms": 7.592361167675558, "mean_processing_ms": 11.170461567858164, "mean_env_wait_ms": 129.0001906970488}, "policy_reward_mean": {}, "time_since_restore": 18071.75498342514, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3459, "time_total_s": 18071.75498342514, "episode_reward_max": 292.8268399666995, "off_policy_estimator": {}, "episode_reward_min": 247.0332041438669, "episode_reward_mean": 270.4174112757125, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.34553575515747, "timestamp": 1559282432, "episode_len_mean": 325.0, "iterations_since_restore": 149, "training_iteration": 149, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ae400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ae2f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ae378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-00-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.1693745044918, "cost1_mean": 172.8835790264387, "system_level_velocity_max": 16.002899387140648, "cost2_min": -82.10955035333569, "outflow_rate_min": 875.7105948535811, "system_level_velocity_min": 13.303514763822061, "cost2_max": -73.70768715496045, "cost1_max": 186.11677863639682, "cost2_mean": -76.69770700605649, "cost1_min": 160.8963983205465, "discrim_loss": 0.7073984146118164, "outflow_rate_mean": 931.4546973488877, "system_level_velocity_mean": 14.546496984841136}}
{"sampler_perf": {"mean_inference_ms": 7.586235366445449, "mean_processing_ms": 11.185702157005652, "mean_env_wait_ms": 128.82894898826032}, "policy_reward_mean": {}, "time_since_restore": 18186.235284090042, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3482, "time_total_s": 18186.235284090042, "episode_reward_max": 322.4065914656967, "off_policy_estimator": {}, "episode_reward_min": 257.9319846890867, "episode_reward_mean": 288.39534483675885, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.48030066490173, "timestamp": 1559282547, "episode_len_mean": 325.0, "iterations_since_restore": 150, "training_iteration": 150, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303241e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-02-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.0188040747868, "cost1_mean": 175.5036352806474, "system_level_velocity_max": 16.2219357868856, "cost2_min": -81.90739952221503, "outflow_rate_min": 882.4697634698726, "system_level_velocity_min": 13.515782608633028, "cost2_max": -73.62418217245127, "cost1_max": 187.9440258707653, "cost2_mean": -76.7005759636579, "cost1_min": 164.20024952406203, "discrim_loss": 0.6919592618942261, "outflow_rate_mean": 943.823461567169, "system_level_velocity_mean": 14.822300705416193}}
{"sampler_perf": {"mean_inference_ms": 7.588721251800087, "mean_processing_ms": 11.176487504118029, "mean_env_wait_ms": 128.8033525794788}, "policy_reward_mean": {}, "time_since_restore": 18302.76089835167, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3504, "time_total_s": 18302.76089835167, "episode_reward_max": 381.63114234805107, "off_policy_estimator": {}, "episode_reward_min": 293.53829850256443, "episode_reward_mean": 341.5845958049494, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.5256142616272, "timestamp": 1559282664, "episode_len_mean": 325.0, "iterations_since_restore": 151, "training_iteration": 151, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ae840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ae7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ae730>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-04-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.2449741174675, "cost1_mean": 172.4149196436786, "system_level_velocity_max": 15.980015249629925, "cost2_min": -81.14016276998433, "outflow_rate_min": 864.7146655486795, "system_level_velocity_min": 12.931925599397342, "cost2_max": -71.09605133429608, "cost1_max": 186.559667582374, "cost2_mean": -76.55194612090469, "cost1_min": 156.99637165948462, "discrim_loss": 0.685799241065979, "outflow_rate_mean": 930.2637509471701, "system_level_velocity_mean": 14.489177583342451}}
{"sampler_perf": {"mean_inference_ms": 7.593493496534811, "mean_processing_ms": 11.172727574432196, "mean_env_wait_ms": 128.9004988243751}, "policy_reward_mean": {}, "time_since_restore": 18422.735144615173, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 3529, "time_total_s": 18422.735144615173, "episode_reward_max": 404.95346191478893, "off_policy_estimator": {}, "episode_reward_min": 335.6249685604125, "episode_reward_mean": 360.7548063471541, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.97424626350403, "timestamp": 1559282784, "episode_len_mean": 325.0, "iterations_since_restore": 152, "training_iteration": 152, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303659d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-06-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.6622734588077, "cost1_mean": 166.62729721008222, "system_level_velocity_max": 16.12012165482803, "cost2_min": -84.66940684315082, "outflow_rate_min": 763.4574389096407, "system_level_velocity_min": 11.370262627856976, "cost2_max": -75.05219838265641, "cost1_max": 188.2301181516191, "cost2_mean": -77.88432864715466, "cost1_min": 137.7534562361633, "discrim_loss": 0.6924622058868408, "outflow_rate_mean": 905.5701537543495, "system_level_velocity_mean": 13.947195261019479}}
{"sampler_perf": {"mean_inference_ms": 7.58848617054109, "mean_processing_ms": 11.175890072096351, "mean_env_wait_ms": 128.77198402111122}, "policy_reward_mean": {}, "time_since_restore": 18542.130405426025, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 3550, "time_total_s": 18542.130405426025, "episode_reward_max": 363.47281775344163, "off_policy_estimator": {}, "episode_reward_min": 299.8255813634023, "episode_reward_mean": 322.1814997593118, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.39526081085205, "timestamp": 1559282903, "episode_len_mean": 325.0, "iterations_since_restore": 153, "training_iteration": 153, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-08-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.171605819494, "cost1_mean": 174.6856100948276, "system_level_velocity_max": 16.054558403064924, "cost2_min": -83.88071883757377, "outflow_rate_min": 806.2897376193654, "system_level_velocity_min": 11.849835361967576, "cost2_max": -74.87901865962368, "cost1_max": 186.36424956075672, "cost2_mean": -77.97840085256996, "cost1_min": 144.22562805549558, "discrim_loss": 0.6990019083023071, "outflow_rate_mean": 939.3690593653848, "system_level_velocity_mean": 14.721981942134974}}
{"sampler_perf": {"mean_inference_ms": 7.588214552618585, "mean_processing_ms": 11.191293377167748, "mean_env_wait_ms": 128.70484156254543}, "policy_reward_mean": {}, "time_since_restore": 18659.130400896072, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3574, "time_total_s": 18659.130400896072, "episode_reward_max": 315.91564994398504, "off_policy_estimator": {}, "episode_reward_min": 245.06941653462127, "episode_reward_mean": 273.5476913873766, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.999995470047, "timestamp": 1559283020, "episode_len_mean": 325.0, "iterations_since_restore": 154, "training_iteration": 154, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-10-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.077878761636, "cost1_mean": 172.00369807931426, "system_level_velocity_max": 15.96568812094866, "cost2_min": -79.69725288322468, "outflow_rate_min": 857.4078994545563, "system_level_velocity_min": 12.6955688461092, "cost2_max": -73.12795783978358, "cost1_max": 185.6216807357385, "cost2_mean": -75.8443860629785, "cost1_min": 152.98179933890796, "discrim_loss": 0.7033087611198425, "outflow_rate_mean": 930.6521673909145, "system_level_velocity_mean": 14.488646140278902}}
{"sampler_perf": {"mean_inference_ms": 7.59027228945873, "mean_processing_ms": 11.197651043982091, "mean_env_wait_ms": 128.83050190911192}, "policy_reward_mean": {}, "time_since_restore": 18780.58232498169, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 26, "episodes_total": 3600, "time_total_s": 18780.58232498169, "episode_reward_max": 286.5572483111173, "off_policy_estimator": {}, "episode_reward_min": 44.44985556602478, "episode_reward_mean": 242.37257179170132, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.45192408561707, "timestamp": 1559283142, "episode_len_mean": 291.61538461538464, "iterations_since_restore": 155, "training_iteration": 155, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-12-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.989153436034, "cost1_mean": 152.65198757140698, "system_level_velocity_max": 18.791012803763685, "cost2_min": -79.489046144048, "outflow_rate_min": 504.5827016154056, "system_level_velocity_min": 12.210097477007077, "cost2_max": -21.924905543606272, "cost1_max": 187.26319529040862, "cost2_mean": -69.17233075933265, "cost1_min": 22.802344607598545, "discrim_loss": 0.6844359636306763, "outflow_rate_mean": 873.37312981435, "system_level_velocity_mean": 14.78098098809759}}
{"sampler_perf": {"mean_inference_ms": 7.592510089002897, "mean_processing_ms": 11.179917724245632, "mean_env_wait_ms": 128.7470896240541}, "policy_reward_mean": {}, "time_since_restore": 18896.441586494446, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3623, "time_total_s": 18896.441586494446, "episode_reward_max": 421.635445099324, "off_policy_estimator": {}, "episode_reward_min": 276.1719632446766, "episode_reward_mean": 337.4666830709447, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.85926151275635, "timestamp": 1559283259, "episode_len_mean": 325.0, "iterations_since_restore": 156, "training_iteration": 156, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c12f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1d90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-14-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.6022697226742, "cost1_mean": 164.99236296052973, "system_level_velocity_max": 15.661132206677083, "cost2_min": -83.86091754860472, "outflow_rate_min": 764.2518523725712, "system_level_velocity_min": 11.319205839443153, "cost2_max": -69.51407222728308, "cost1_max": 183.1289892546505, "cost2_mean": -76.49172072481468, "cost1_min": 137.87866948844749, "discrim_loss": 0.6818984746932983, "outflow_rate_mean": 898.8460264712986, "system_level_velocity_mean": 13.870014582451411}}
{"sampler_perf": {"mean_inference_ms": 7.5916307128100415, "mean_processing_ms": 11.205303067214471, "mean_env_wait_ms": 128.65636541570117}, "policy_reward_mean": {}, "time_since_restore": 19013.203493595123, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3647, "time_total_s": 19013.203493595123, "episode_reward_max": 396.1883933879435, "off_policy_estimator": {}, "episode_reward_min": 331.5087130526081, "episode_reward_mean": 359.47279890151304, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.76190710067749, "timestamp": 1559283378, "episode_len_mean": 325.0, "iterations_since_restore": 157, "training_iteration": 157, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-16-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.8987807755465, "cost1_mean": 172.09070162050105, "system_level_velocity_max": 15.988793168458203, "cost2_min": -81.45048650042543, "outflow_rate_min": 780.9136714352962, "system_level_velocity_min": 11.714178719984483, "cost2_max": -73.08256388530671, "cost1_max": 186.6716944456636, "cost2_mean": -76.08356844180423, "cost1_min": 141.51380773039529, "discrim_loss": 0.6846494674682617, "outflow_rate_mean": 930.5564475623438, "system_level_velocity_mean": 14.52683556238936}}
{"sampler_perf": {"mean_inference_ms": 7.592394622126263, "mean_processing_ms": 11.195937813158865, "mean_env_wait_ms": 128.7357512815104}, "policy_reward_mean": {}, "time_since_restore": 19126.90023612976, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3669, "time_total_s": 19126.90023612976, "episode_reward_max": 383.46969643514603, "off_policy_estimator": {}, "episode_reward_min": 260.055012492463, "episode_reward_mean": 294.9231652067339, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.69674253463745, "timestamp": 1559283491, "episode_len_mean": 325.0, "iterations_since_restore": 158, "training_iteration": 158, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bed90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be9d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-18-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.0167955360658, "cost1_mean": 175.0170522013217, "system_level_velocity_max": 16.04590186027145, "cost2_min": -79.48287396998356, "outflow_rate_min": 848.0864756151624, "system_level_velocity_min": 12.717126435660903, "cost2_max": -72.09196671519891, "cost1_max": 186.08186630279386, "cost2_mean": -75.46526107699239, "cost1_min": 153.72994588404705, "discrim_loss": 0.6790305376052856, "outflow_rate_mean": 942.8190049307065, "system_level_velocity_mean": 14.808298039461897}}
{"sampler_perf": {"mean_inference_ms": 7.595385272504905, "mean_processing_ms": 11.183747499670126, "mean_env_wait_ms": 128.66526156332262}, "policy_reward_mean": {}, "time_since_restore": 19240.163705587387, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3693, "time_total_s": 19240.163705587387, "episode_reward_max": 320.94884486682713, "off_policy_estimator": {}, "episode_reward_min": 243.49503412563354, "episode_reward_mean": 261.34922532781883, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.26346945762634, "timestamp": 1559283606, "episode_len_mean": 325.0, "iterations_since_restore": 159, "training_iteration": 159, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-20-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.2307638463342, "cost1_mean": 172.89220066200775, "system_level_velocity_max": 16.000778447195305, "cost2_min": -78.60582351269008, "outflow_rate_min": 808.1222974848977, "system_level_velocity_min": 12.199336648484932, "cost2_max": -72.68728408190054, "cost1_max": 186.00613800164336, "cost2_mean": -76.23136813413505, "cost1_min": 146.85769563919354, "discrim_loss": 0.6962159276008606, "outflow_rate_mean": 934.3383226664658, "system_level_velocity_mean": 14.588110476028106}}
{"sampler_perf": {"mean_inference_ms": 7.591446034807659, "mean_processing_ms": 11.196781917001447, "mean_env_wait_ms": 128.58011534954323}, "policy_reward_mean": {}, "time_since_restore": 19354.77719259262, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 3715, "time_total_s": 19354.77719259262, "episode_reward_max": 302.0416206466034, "off_policy_estimator": {}, "episode_reward_min": 43.089595310389996, "episode_reward_mean": 270.5276873752009, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.61348700523376, "timestamp": 1559283720, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 160, "training_iteration": 160, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034af28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ae18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-22-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 991.7900817507656, "cost1_mean": 165.10744362170334, "system_level_velocity_max": 17.759522971325268, "cost2_min": -79.29574910194376, "outflow_rate_min": 492.0625426222078, "system_level_velocity_min": 11.809603855400963, "cost2_max": -18.479189036182312, "cost1_max": 186.07084328266572, "cost2_mean": -73.32061263660056, "cost1_min": 17.82455516877674, "discrim_loss": 0.6862086653709412, "outflow_rate_mean": 909.5850372674718, "system_level_velocity_mean": 14.652906579234703}}
{"sampler_perf": {"mean_inference_ms": 7.592315138487238, "mean_processing_ms": 11.204757299684854, "mean_env_wait_ms": 128.5372990358596}, "policy_reward_mean": {}, "time_since_restore": 19475.04113459587, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3738, "time_total_s": 19475.04113459587, "episode_reward_max": 361.8254161849618, "off_policy_estimator": {}, "episode_reward_min": 290.1583667071536, "episode_reward_mean": 328.39705695709944, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.26394200325012, "timestamp": 1559283843, "episode_len_mean": 325.0, "iterations_since_restore": 161, "training_iteration": 161, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-24-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 998.8150552089794, "cost1_mean": 170.9093499376757, "system_level_velocity_max": 16.028238116966413, "cost2_min": -81.79253639441643, "outflow_rate_min": 862.9059902960774, "system_level_velocity_min": 12.75513401273715, "cost2_max": -72.79618127567655, "cost1_max": 186.8302933231958, "cost2_mean": -76.39131917621549, "cost1_min": 153.2201869437341, "discrim_loss": 0.6530423760414124, "outflow_rate_mean": 926.9579097490665, "system_level_velocity_mean": 14.413307836114194}}
{"sampler_perf": {"mean_inference_ms": 7.595965300768698, "mean_processing_ms": 11.191541883113677, "mean_env_wait_ms": 128.645238158385}, "policy_reward_mean": {}, "time_since_restore": 19592.86809539795, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 3763, "time_total_s": 19592.86809539795, "episode_reward_max": 378.61338985338807, "off_policy_estimator": {}, "episode_reward_min": 317.2990715019405, "episode_reward_mean": 346.81428012972697, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.82696080207825, "timestamp": 1559283961, "episode_len_mean": 325.0, "iterations_since_restore": 162, "training_iteration": 162, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4e18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-26-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.9961775689819, "cost1_mean": 171.8118138464273, "system_level_velocity_max": 16.013836607078353, "cost2_min": -82.8439440933106, "outflow_rate_min": 851.8586862397683, "system_level_velocity_min": 12.735780585088312, "cost2_max": -72.74707582784671, "cost1_max": 186.5458151878312, "cost2_mean": -76.84057745177844, "cost1_min": 152.01600619512703, "discrim_loss": 0.6833789348602295, "outflow_rate_mean": 931.0803438472886, "system_level_velocity_mean": 14.489963225463377}}
{"sampler_perf": {"mean_inference_ms": 7.593314826672071, "mean_processing_ms": 11.19040747583289, "mean_env_wait_ms": 128.50944127144632}, "policy_reward_mean": {}, "time_since_restore": 19710.266619205475, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 3784, "time_total_s": 19710.266619205475, "episode_reward_max": 359.1612744741142, "off_policy_estimator": {}, "episode_reward_min": 265.5464298725128, "episode_reward_mean": 296.9381298615065, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.39852380752563, "timestamp": 1559284078, "episode_len_mean": 325.0, "iterations_since_restore": 163, "training_iteration": 163, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-27-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.1470060009024, "cost1_mean": 171.2568718368821, "system_level_velocity_max": 16.05291754781794, "cost2_min": -81.82397250962637, "outflow_rate_min": 781.7383643055177, "system_level_velocity_min": 11.159134808949984, "cost2_max": -72.46652589089024, "cost1_max": 186.67271878334606, "cost2_mean": -76.71006848345722, "cost1_min": 136.3358918399042, "discrim_loss": 0.6761516332626343, "outflow_rate_mean": 929.5159670676718, "system_level_velocity_mean": 14.484929570936211}}
{"sampler_perf": {"mean_inference_ms": 7.591914834193569, "mean_processing_ms": 11.208231424371279, "mean_env_wait_ms": 128.41972761788557}, "policy_reward_mean": {}, "time_since_restore": 19825.263157844543, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3808, "time_total_s": 19825.263157844543, "episode_reward_max": 283.47837340366095, "off_policy_estimator": {}, "episode_reward_min": 233.30310879461467, "episode_reward_mean": 256.4832348546285, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.9965386390686, "timestamp": 1559284193, "episode_len_mean": 325.0, "iterations_since_restore": 164, "training_iteration": 164, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c26a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2598>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-29-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.5751741888911, "cost1_mean": 175.05562785499106, "system_level_velocity_max": 16.083077470658203, "cost2_min": -79.95142897520446, "outflow_rate_min": 868.2788019374211, "system_level_velocity_min": 12.95458381807379, "cost2_max": -72.8974751658289, "cost1_max": 186.24600418004454, "cost2_mean": -76.25817945875758, "cost1_min": 155.6680394043487, "discrim_loss": 0.6856880784034729, "outflow_rate_mean": 944.5686769352266, "system_level_velocity_mean": 14.845381932828209}}
{"sampler_perf": {"mean_inference_ms": 7.595501937781132, "mean_processing_ms": 11.194424778060482, "mean_env_wait_ms": 128.51848998457663}, "policy_reward_mean": {}, "time_since_restore": 19937.336037635803, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 25, "episodes_total": 3833, "time_total_s": 19937.336037635803, "episode_reward_max": 334.6321154483594, "off_policy_estimator": {}, "episode_reward_min": 241.57941078068689, "episode_reward_mean": 271.8721381388488, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.07287979125977, "timestamp": 1559284305, "episode_len_mean": 325.0, "iterations_since_restore": 165, "training_iteration": 165, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-31-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.0260820002488, "cost1_mean": 171.67416969801008, "system_level_velocity_max": 16.130346748887547, "cost2_min": -83.09017735407576, "outflow_rate_min": 781.3253174786375, "system_level_velocity_min": 11.729340353118863, "cost2_max": -72.44503452657733, "cost1_max": 186.6393952743486, "cost2_mean": -76.2997874185256, "cost1_min": 140.38761141974084, "discrim_loss": 0.6829821467399597, "outflow_rate_mean": 929.4212922058863, "system_level_velocity_mean": 14.532723138916504}}
{"sampler_perf": {"mean_inference_ms": 7.590746854874223, "mean_processing_ms": 11.196823235793724, "mean_env_wait_ms": 128.37976160533663}, "policy_reward_mean": {}, "time_since_restore": 20052.042363405228, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 21, "episodes_total": 3854, "time_total_s": 20052.042363405228, "episode_reward_max": 355.64443724323064, "off_policy_estimator": {}, "episode_reward_min": 275.94734458159655, "episode_reward_mean": 327.98115120566496, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.70632576942444, "timestamp": 1559284420, "episode_len_mean": 325.0, "iterations_since_restore": 166, "training_iteration": 166, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b46a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b49d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4a60>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-33-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.825494333792, "cost1_mean": 167.9420126959437, "system_level_velocity_max": 15.94619213073316, "cost2_min": -80.38808605771237, "outflow_rate_min": 843.2128510697397, "system_level_velocity_min": 12.64717816463505, "cost2_max": -73.87115220823898, "cost1_max": 185.24217118785077, "cost2_mean": -76.39916251068885, "cost1_min": 152.01265403314898, "discrim_loss": 0.6586856842041016, "outflow_rate_mean": 913.619461271511, "system_level_velocity_mean": 14.110801496291852}}
{"sampler_perf": {"mean_inference_ms": 7.589598243030764, "mean_processing_ms": 11.216151488455687, "mean_env_wait_ms": 128.2884000279482}, "policy_reward_mean": {}, "time_since_restore": 20166.107364177704, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3878, "time_total_s": 20166.107364177704, "episode_reward_max": 472.85933387465775, "off_policy_estimator": {}, "episode_reward_min": 326.17346242722124, "episode_reward_mean": 360.82711088975583, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.0650007724762, "timestamp": 1559284534, "episode_len_mean": 325.0, "iterations_since_restore": 167, "training_iteration": 167, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303658c8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-35-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.6818047055789, "cost1_mean": 170.90659548063783, "system_level_velocity_max": 16.002940629751695, "cost2_min": -82.61574228712608, "outflow_rate_min": 816.656418893867, "system_level_velocity_min": 11.945064679642373, "cost2_max": -74.85649209265932, "cost1_max": 186.0620001420211, "cost2_mean": -77.3345304181175, "cost1_min": 142.92287515081995, "discrim_loss": 0.6821514368057251, "outflow_rate_mean": 926.8714666273199, "system_level_velocity_mean": 14.436830193328248}}
{"sampler_perf": {"mean_inference_ms": 7.591742814880733, "mean_processing_ms": 11.197970539316595, "mean_env_wait_ms": 128.4068282267334}, "policy_reward_mean": {}, "time_since_restore": 20283.1046295166, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3901, "time_total_s": 20283.1046295166, "episode_reward_max": 346.8488877294585, "off_policy_estimator": {}, "episode_reward_min": 261.5305620562285, "episode_reward_mean": 302.00881289125863, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.9972653388977, "timestamp": 1559284651, "episode_len_mean": 325.0, "iterations_since_restore": 168, "training_iteration": 168, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-37-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.2007884040564, "cost1_mean": 173.27010705665109, "system_level_velocity_max": 16.165081378140226, "cost2_min": -81.52453000518645, "outflow_rate_min": 865.5545499623307, "system_level_velocity_min": 12.999205316491901, "cost2_max": -74.81073645138622, "cost1_max": 187.40783449316064, "cost2_mean": -77.79068551056537, "cost1_min": 156.8438267913798, "discrim_loss": 0.6723450422286987, "outflow_rate_mean": 933.3697005130028, "system_level_velocity_mean": 14.596879449394024}}
{"sampler_perf": {"mean_inference_ms": 7.589438463974546, "mean_processing_ms": 11.189485368091999, "mean_env_wait_ms": 128.26907868105823}, "policy_reward_mean": {}, "time_since_restore": 20399.59248995781, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3924, "time_total_s": 20399.59248995781, "episode_reward_max": 300.16405978333205, "off_policy_estimator": {}, "episode_reward_min": 238.61819441709667, "episode_reward_mean": 263.589706295757, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.48786044120789, "timestamp": 1559284768, "episode_len_mean": 325.0, "iterations_since_restore": 169, "training_iteration": 169, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b41e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4158>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-39-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.6951354023213, "cost1_mean": 172.76393435337314, "system_level_velocity_max": 16.10322895210463, "cost2_min": -84.76189495551316, "outflow_rate_min": 822.4917078264314, "system_level_velocity_min": 12.183543760098035, "cost2_max": -74.07692049818006, "cost1_max": 186.69499567888892, "cost2_mean": -78.0047555315384, "cost1_min": 147.1018696324014, "discrim_loss": 0.6844502687454224, "outflow_rate_mean": 932.0980241060008, "system_level_velocity_mean": 14.602155646442442}}
{"sampler_perf": {"mean_inference_ms": 7.585528443117159, "mean_processing_ms": 11.212605199954387, "mean_env_wait_ms": 128.17566029733828}, "policy_reward_mean": {}, "time_since_restore": 20514.02658700943, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3948, "time_total_s": 20514.02658700943, "episode_reward_max": 343.91091672331095, "off_policy_estimator": {}, "episode_reward_min": 233.72248273156583, "episode_reward_mean": 288.36940619703574, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.43409705162048, "timestamp": 1559284882, "episode_len_mean": 324.25, "iterations_since_restore": 170, "training_iteration": 170, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-41-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.018128753979, "cost1_mean": 173.7351641980599, "system_level_velocity_max": 16.210250557024303, "cost2_min": -81.877282490683, "outflow_rate_min": 861.2422969738839, "system_level_velocity_min": 12.833917931954533, "cost2_max": -74.71182048487321, "cost1_max": 187.1681364761673, "cost2_mean": -77.30563411916705, "cost1_min": 154.45033750022412, "discrim_loss": 0.6778751611709595, "outflow_rate_mean": 938.7393603903938, "system_level_velocity_mean": 14.741883569607571}}
{"sampler_perf": {"mean_inference_ms": 7.589691257495783, "mean_processing_ms": 11.196385580578136, "mean_env_wait_ms": 128.20398664144216}, "policy_reward_mean": {}, "time_since_restore": 20627.61370062828, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 3971, "time_total_s": 20627.61370062828, "episode_reward_max": 432.16507003828883, "off_policy_estimator": {}, "episode_reward_min": 55.178384743630886, "episode_reward_mean": 342.49617788750356, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.58711361885071, "timestamp": 1559284999, "episode_len_mean": 312.39130434782606, "iterations_since_restore": 171, "training_iteration": 171, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a840>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-43-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.7005667471474, "cost1_mean": 169.33045180735803, "system_level_velocity_max": 18.220298596859266, "cost2_min": -84.00114850468908, "outflow_rate_min": 460.7989278777953, "system_level_velocity_min": 11.578665233423036, "cost2_max": -24.771437768891087, "cost1_max": 187.54425644121207, "cost2_mean": -75.51632874406663, "cost1_min": 22.82140165563821, "discrim_loss": 0.6779370307922363, "outflow_rate_mean": 926.2878938951136, "system_level_velocity_mean": 15.09874327959442}}
{"sampler_perf": {"mean_inference_ms": 7.5907710581914785, "mean_processing_ms": 11.190758852327916, "mean_env_wait_ms": 128.16650482197355}, "policy_reward_mean": {}, "time_since_restore": 20740.526909828186, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 3995, "time_total_s": 20740.526909828186, "episode_reward_max": 390.3129102400271, "off_policy_estimator": {}, "episode_reward_min": 327.6024096105248, "episode_reward_mean": 349.8230821755521, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.9132091999054, "timestamp": 1559285112, "episode_len_mean": 325.0, "iterations_since_restore": 172, "training_iteration": 172, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303248c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303242f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ea0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-45-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.984172651675, "cost1_mean": 169.8111075801942, "system_level_velocity_max": 16.10440891688666, "cost2_min": -78.79331962613757, "outflow_rate_min": 866.9391339724606, "system_level_velocity_min": 12.868469922019324, "cost2_max": -72.7509371703355, "cost1_max": 186.37941457335612, "cost2_mean": -75.38617300372869, "cost1_min": 155.23339337731284, "discrim_loss": 0.6770802140235901, "outflow_rate_mean": 923.4590331325684, "system_level_velocity_mean": 14.34106723769491}}
{"sampler_perf": {"mean_inference_ms": 7.587370925093737, "mean_processing_ms": 11.20252974302412, "mean_env_wait_ms": 128.0933165372478}, "policy_reward_mean": {}, "time_since_restore": 20857.603760242462, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 4017, "time_total_s": 20857.603760242462, "episode_reward_max": 338.215967037715, "off_policy_estimator": {}, "episode_reward_min": 193.88451691903174, "episode_reward_mean": 286.41420997433704, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.07685041427612, "timestamp": 1559285229, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 173, "training_iteration": 173, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034aea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ae18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034af28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-47-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.5696306267876, "cost1_mean": 170.39518413995253, "system_level_velocity_max": 16.129270685643768, "cost2_min": -82.5388150684648, "outflow_rate_min": 759.7963221177489, "system_level_velocity_min": 13.26960614850123, "cost2_max": -67.96066136808581, "cost1_max": 186.90515605549058, "cost2_mean": -77.15040891651394, "cost1_min": 113.45303731384745, "discrim_loss": 0.6986975073814392, "outflow_rate_mean": 926.5361359262641, "system_level_velocity_mean": 14.630161250956167}}
{"sampler_perf": {"mean_inference_ms": 7.587372096446618, "mean_processing_ms": 11.201082790872038, "mean_env_wait_ms": 128.02024163963526}, "policy_reward_mean": {}, "time_since_restore": 20971.188912391663, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 4039, "time_total_s": 20971.188912391663, "episode_reward_max": 304.014322118368, "off_policy_estimator": {}, "episode_reward_min": 240.06767973909155, "episode_reward_mean": 262.87236326028045, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.58515214920044, "timestamp": 1559285342, "episode_len_mean": 325.0, "iterations_since_restore": 174, "training_iteration": 174, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-49-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.0576537257051, "cost1_mean": 171.0381271970996, "system_level_velocity_max": 16.16629890991811, "cost2_min": -82.60568470683273, "outflow_rate_min": 774.8921678475764, "system_level_velocity_min": 11.576618403033834, "cost2_max": -72.7777269279709, "cost1_max": 187.43826823320597, "cost2_mean": -77.99799340652677, "cost1_min": 140.6691540997161, "discrim_loss": 0.693575918674469, "outflow_rate_mean": 925.2150975832063, "system_level_velocity_mean": 14.431295471928097}}
{"sampler_perf": {"mean_inference_ms": 7.588851499345206, "mean_processing_ms": 11.19167085371503, "mean_env_wait_ms": 128.12454607501056}, "policy_reward_mean": {}, "time_since_restore": 21084.482029676437, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4063, "time_total_s": 21084.482029676437, "episode_reward_max": 329.0763308866881, "off_policy_estimator": {}, "episode_reward_min": 246.27326080715284, "episode_reward_mean": 293.6910070211549, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.29311728477478, "timestamp": 1559285456, "episode_len_mean": 325.0, "iterations_since_restore": 175, "training_iteration": 175, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-50-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.1806564322516, "cost1_mean": 175.60078898390793, "system_level_velocity_max": 16.12108782496394, "cost2_min": -82.19070791282944, "outflow_rate_min": 865.6539512978111, "system_level_velocity_min": 13.01457371004025, "cost2_max": -76.1883800097508, "cost1_max": 187.53790465381127, "cost2_mean": -78.84413497489781, "cost1_min": 157.81995884581892, "discrim_loss": 0.6905682682991028, "outflow_rate_mean": 945.035434043905, "system_level_velocity_mean": 14.86718022910147}}
{"sampler_perf": {"mean_inference_ms": 7.586257623249182, "mean_processing_ms": 11.194736171397834, "mean_env_wait_ms": 127.90611063857004}, "policy_reward_mean": {}, "time_since_restore": 21195.445209503174, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4087, "time_total_s": 21195.445209503174, "episode_reward_max": 386.4495720881969, "off_policy_estimator": {}, "episode_reward_min": 293.29671600461006, "episode_reward_mean": 354.6788142678852, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.96317982673645, "timestamp": 1559285567, "episode_len_mean": 325.0, "iterations_since_restore": 176, "training_iteration": 176, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b49d8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-52-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.678882563468, "cost1_mean": 176.64617456157285, "system_level_velocity_max": 16.27077531456536, "cost2_min": -82.4085303516883, "outflow_rate_min": 863.8335199904642, "system_level_velocity_min": 12.71499586739106, "cost2_max": -75.9471308702812, "cost1_max": 188.55676358042717, "cost2_mean": -78.22705451761048, "cost1_min": 153.21671621863914, "discrim_loss": 0.6919357180595398, "outflow_rate_mean": 952.0607607305511, "system_level_velocity_mean": 15.02774742553207}}
{"sampler_perf": {"mean_inference_ms": 7.586149578686714, "mean_processing_ms": 11.204210466031153, "mean_env_wait_ms": 127.86122741432537}, "policy_reward_mean": {}, "time_since_restore": 21304.402107477188, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 4109, "time_total_s": 21304.402107477188, "episode_reward_max": 359.05356045335066, "off_policy_estimator": {}, "episode_reward_min": 285.0832626260817, "episode_reward_mean": 321.40235535425285, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.95689797401428, "timestamp": 1559285676, "episode_len_mean": 325.0, "iterations_since_restore": 177, "training_iteration": 177, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b9048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2e18>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-54-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.8074535594469, "cost1_mean": 172.26513412906675, "system_level_velocity_max": 16.124847779086537, "cost2_min": -82.45492575890947, "outflow_rate_min": 861.6120618158751, "system_level_velocity_min": 12.695831306086674, "cost2_max": -73.16303662481398, "cost1_max": 186.94539089560368, "cost2_mean": -78.15420294220463, "cost1_min": 153.46816475683212, "discrim_loss": 0.6802862286567688, "outflow_rate_mean": 931.0918647387728, "system_level_velocity_mean": 14.535814902765685}}
{"sampler_perf": {"mean_inference_ms": 7.588372404761562, "mean_processing_ms": 11.192018290178458, "mean_env_wait_ms": 127.94895880566754}, "policy_reward_mean": {}, "time_since_restore": 21418.190564632416, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4133, "time_total_s": 21418.190564632416, "episode_reward_max": 306.45401157066226, "off_policy_estimator": {}, "episode_reward_min": 227.0273556066677, "episode_reward_mean": 263.046159089053, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.78845715522766, "timestamp": 1559285790, "episode_len_mean": 325.0, "iterations_since_restore": 178, "training_iteration": 178, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303242f0>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-56-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.7768733845887, "cost1_mean": 177.84767025489205, "system_level_velocity_max": 16.226197815057006, "cost2_min": -83.67784711960518, "outflow_rate_min": 869.6776142541074, "system_level_velocity_min": 13.207489343699157, "cost2_max": -73.41923751018297, "cost1_max": 188.00120837886124, "cost2_mean": -78.52209656115828, "cost1_min": 158.7169168160257, "discrim_loss": 0.6862697601318359, "outflow_rate_mean": 955.5604522379466, "system_level_velocity_mean": 15.119646173847407}}
{"sampler_perf": {"mean_inference_ms": 7.585526646425027, "mean_processing_ms": 11.191664726346357, "mean_env_wait_ms": 127.76171370954536}, "policy_reward_mean": {}, "time_since_restore": 21532.554538965225, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 4156, "time_total_s": 21532.554538965225, "episode_reward_max": 352.9653110917425, "off_policy_estimator": {}, "episode_reward_min": 234.2483224356547, "episode_reward_mean": 265.62627365368763, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.36397433280945, "timestamp": 1559285907, "episode_len_mean": 325.0, "iterations_since_restore": 179, "training_iteration": 179, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c16a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1510>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-58-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1004.4698860948375, "cost1_mean": 171.13060557026, "system_level_velocity_max": 16.27013537788119, "cost2_min": -87.84687254748866, "outflow_rate_min": 734.0555762637376, "system_level_velocity_min": 10.660511157056446, "cost2_max": -74.59455539690232, "cost1_max": 187.75362769693277, "cost2_mean": -79.06582591524023, "cost1_min": 128.73170957291654, "discrim_loss": 0.6874983906745911, "outflow_rate_mean": 926.075281456668, "system_level_velocity_mean": 14.475358314760134}}
{"sampler_perf": {"mean_inference_ms": 7.584948955804627, "mean_processing_ms": 11.20491457056008, "mean_env_wait_ms": 127.72251247722095}, "policy_reward_mean": {}, "time_since_restore": 21645.366745233536, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 4179, "time_total_s": 21645.366745233536, "episode_reward_max": 345.3670733147301, "off_policy_estimator": {}, "episode_reward_min": 249.60892934445292, "episode_reward_mean": 305.6367255643304, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.81220626831055, "timestamp": 1559286019, "episode_len_mean": 325.0, "iterations_since_restore": 180, "training_iteration": 180, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c11e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2bf8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-00-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.9368115755443, "cost1_mean": 174.2654070772806, "system_level_velocity_max": 16.145106333623417, "cost2_min": -84.84811152255952, "outflow_rate_min": 820.120664269926, "system_level_velocity_min": 12.032388417632895, "cost2_max": -75.35886722808833, "cost1_max": 187.36093858226295, "cost2_mean": -79.24509890565318, "cost1_min": 143.64934177436638, "discrim_loss": 0.6782612800598145, "outflow_rate_mean": 939.702402522814, "system_level_velocity_mean": 14.787503758870406}}
{"sampler_perf": {"mean_inference_ms": 7.588080402370198, "mean_processing_ms": 11.197689137238081, "mean_env_wait_ms": 127.79928894935375}, "policy_reward_mean": {}, "time_since_restore": 21762.720097780228, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4203, "time_total_s": 21762.720097780228, "episode_reward_max": 386.8978811921552, "off_policy_estimator": {}, "episode_reward_min": 38.015831626951694, "episode_reward_mean": 331.82654039513244, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.3533525466919, "timestamp": 1559286139, "episode_len_mean": 307.6666666666667, "iterations_since_restore": 181, "training_iteration": 181, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c12f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c19d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1ae8>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-02-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.8872880149032, "cost1_mean": 164.41285488931393, "system_level_velocity_max": 17.57299996812065, "cost2_min": -83.01831192493526, "outflow_rate_min": 447.40921683303424, "system_level_velocity_min": 13.189942173191305, "cost2_max": -20.38772186377305, "cost1_max": 187.2432605051451, "cost2_mean": -75.22051391793083, "cost1_min": 17.990675250461525, "discrim_loss": 0.6806913614273071, "outflow_rate_mean": 909.0443860826826, "system_level_velocity_mean": 14.781367809383697}}
{"sampler_perf": {"mean_inference_ms": 7.585235494483972, "mean_processing_ms": 11.194106854893802, "mean_env_wait_ms": 127.7007779808553}, "policy_reward_mean": {}, "time_since_restore": 21879.90083861351, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4227, "time_total_s": 21879.90083861351, "episode_reward_max": 353.3133917376399, "off_policy_estimator": {}, "episode_reward_min": 277.8948855837807, "episode_reward_mean": 315.2437250885608, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.18074083328247, "timestamp": 1559286256, "episode_len_mean": 325.0, "iterations_since_restore": 182, "training_iteration": 182, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-04-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1000.58797338641, "cost1_mean": 175.49480401333608, "system_level_velocity_max": 16.247708621125284, "cost2_min": -83.34335098908639, "outflow_rate_min": 875.4806395784382, "system_level_velocity_min": 13.05005275518077, "cost2_max": -73.07661841448567, "cost1_max": 187.80814587778474, "cost2_mean": -78.39695038549202, "cost1_min": 156.4872718973055, "discrim_loss": 0.6733880043029785, "outflow_rate_mean": 943.2144259112637, "system_level_velocity_mean": 14.857105922375732}}
{"sampler_perf": {"mean_inference_ms": 7.584885600531909, "mean_processing_ms": 11.210603606542886, "mean_env_wait_ms": 127.69110401015719}, "policy_reward_mean": {}, "time_since_restore": 21995.735850811005, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 23, "episodes_total": 4250, "time_total_s": 21995.735850811005, "episode_reward_max": 306.6225520061562, "off_policy_estimator": {}, "episode_reward_min": 224.45301741641015, "episode_reward_mean": 267.9599809310875, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.8350121974945, "timestamp": 1559286372, "episode_len_mean": 325.0, "iterations_since_restore": 183, "training_iteration": 183, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324950>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-06-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.253209032843, "cost1_mean": 168.45677843789326, "system_level_velocity_max": 16.179067216222254, "cost2_min": -86.16429995296485, "outflow_rate_min": 816.9900149209263, "system_level_velocity_min": 12.08741730685605, "cost2_max": -74.97279058589692, "cost1_max": 187.11012279129147, "cost2_mean": -78.84743387604969, "cost1_min": 146.28012224130006, "discrim_loss": 0.6942571401596069, "outflow_rate_mean": 912.7217527220022, "system_level_velocity_mean": 14.155211748103106}}
{"sampler_perf": {"mean_inference_ms": 7.581243569052659, "mean_processing_ms": 11.197485557384157, "mean_env_wait_ms": 127.61816752439181}, "policy_reward_mean": {}, "time_since_restore": 22111.393729686737, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 4272, "time_total_s": 22111.393729686737, "episode_reward_max": 297.4048506678082, "off_policy_estimator": {}, "episode_reward_min": 232.5568957142532, "episode_reward_mean": 252.0965521961731, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.65787887573242, "timestamp": 1559286488, "episode_len_mean": 325.0, "iterations_since_restore": 184, "training_iteration": 184, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c16a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1510>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-08-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.193456719843, "cost1_mean": 176.51374346220288, "system_level_velocity_max": 16.14296390305437, "cost2_min": -84.32243576255769, "outflow_rate_min": 879.3785911162321, "system_level_velocity_min": 13.256616329474852, "cost2_max": -75.19047311878664, "cost1_max": 187.20276506075822, "cost2_mean": -77.97932389994612, "cost1_min": 159.9380136158398, "discrim_loss": 0.6848607063293457, "outflow_rate_mean": 948.7924641985763, "system_level_velocity_mean": 14.97917590692914}}
{"sampler_perf": {"mean_inference_ms": 7.58434852468928, "mean_processing_ms": 11.186212636541406, "mean_env_wait_ms": 127.61161325166906}, "policy_reward_mean": {}, "time_since_restore": 22224.56709599495, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4296, "time_total_s": 22224.56709599495, "episode_reward_max": 358.6939970506355, "off_policy_estimator": {}, "episode_reward_min": 44.44712921231985, "episode_reward_mean": 292.5735160592594, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.17336630821228, "timestamp": 1559286601, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 185, "training_iteration": 185, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2f28>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-10-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.1867433598007, "cost1_mean": 167.82883817470653, "system_level_velocity_max": 18.469454605857955, "cost2_min": -83.3232021924924, "outflow_rate_min": 487.27071284982367, "system_level_velocity_min": 12.74076819337644, "cost2_max": -23.182618782414213, "cost1_max": 187.55719487152055, "cost2_mean": -76.34338502308667, "cost1_min": 22.973870948719494, "discrim_loss": 0.6863752603530884, "outflow_rate_mean": 920.4621421718266, "system_level_velocity_mean": 14.89647451745153}}
{"sampler_perf": {"mean_inference_ms": 7.584334442613874, "mean_processing_ms": 11.205750437636445, "mean_env_wait_ms": 127.57561858507495}, "policy_reward_mean": {}, "time_since_restore": 22345.250036239624, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 24, "episodes_total": 4320, "time_total_s": 22345.250036239624, "episode_reward_max": 464.74961547460407, "off_policy_estimator": {}, "episode_reward_min": 312.7454110244289, "episode_reward_mean": 352.5297848963916, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.68294024467468, "timestamp": 1559286722, "episode_len_mean": 325.0, "iterations_since_restore": 186, "training_iteration": 186, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-12-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.0679581507585, "cost1_mean": 176.54496171065236, "system_level_velocity_max": 16.175089203030325, "cost2_min": -84.38403310457525, "outflow_rate_min": 768.4225885031562, "system_level_velocity_min": 11.69539616602243, "cost2_max": -74.80934332843907, "cost1_max": 187.1433017674122, "cost2_mean": -78.66500286095852, "cost1_min": 141.6174870133072, "discrim_loss": 0.6878777742385864, "outflow_rate_mean": 948.5168852281076, "system_level_velocity_mean": 15.045759168557643}}
{"sampler_perf": {"mean_inference_ms": 7.582274239679513, "mean_processing_ms": 11.210529208698295, "mean_env_wait_ms": 127.48605642285652}, "policy_reward_mean": {}, "time_since_restore": 22456.21486544609, "experiment_id": "6c71b9f736214100bf373fa902070d48", "episodes_this_iter": 22, "episodes_total": 4342, "time_total_s": 22456.21486544609, "episode_reward_max": 344.52916512358934, "off_policy_estimator": {}, "episode_reward_min": 283.59263435937464, "episode_reward_mean": 311.79889758227563, "pid": 7145, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.96482920646667, "timestamp": 1559286833, "episode_len_mean": 325.0, "iterations_since_restore": 187, "training_iteration": 187, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "discrim_lr": 0.01, "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "custom_model": null, "free_log_std": false}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "straggler_mitigation": false, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)", "on_train_result": null}, "num_workers": 10, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-13-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1004.5935052213172, "cost1_mean": 177.0844044959874, "system_level_velocity_max": 16.304080237996107, "cost2_min": -82.58427931419017, "outflow_rate_min": 870.4427600912173, "system_level_velocity_min": 12.948819515573229, "cost2_max": -74.29535692317064, "cost1_max": 188.1878292573653, "cost2_mean": -77.96651798858755, "cost1_min": 156.5537343436716, "discrim_loss": 0.6769459247589111, "outflow_rate_mean": 953.0265917521057, "system_level_velocity_mean": 15.055001527273303}}

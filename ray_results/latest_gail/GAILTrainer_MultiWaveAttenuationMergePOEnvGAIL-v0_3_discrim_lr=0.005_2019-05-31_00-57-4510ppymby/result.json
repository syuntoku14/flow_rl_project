{"sampler_perf": {"mean_inference_ms": 8.072403363000536, "mean_processing_ms": 9.734007521729655, "mean_env_wait_ms": 131.8720026117825}, "policy_reward_mean": {}, "time_since_restore": 144.73164224624634, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 144.73164224624634, "episodes_total": 20, "episode_reward_max": 752.8200892210007, "episode_reward_mean": 618.2263988345861, "episode_reward_min": 364.35881346464157, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 144.73164224624634, "timestamp": 1559264427, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 1, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c31e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-00-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 793.1511006749296, "outflow_rate_min": 699.0712141021402, "system_level_velocity_max": 11.442683429792988, "cost2_min": -78.41252967408589, "system_level_velocity_min": 9.051239981705722, "cost1_min": 108.46141476645137, "cost1_max": 141.4989937571075, "cost2_mean": -50.42555416794822, "discrim_loss": 1.3857731819152832, "cost2_max": -34.40963021663152, "cost1_mean": 125.09074287614051, "outflow_rate_mean": 747.984389536792, "system_level_velocity_mean": 10.424723140448483}}
{"sampler_perf": {"mean_inference_ms": 7.889427064975687, "mean_processing_ms": 9.745397907666254, "mean_env_wait_ms": 132.12433615817298}, "policy_reward_mean": {}, "time_since_restore": 262.8010847568512, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 262.8010847568512, "episodes_total": 40, "episode_reward_max": 769.6866229772568, "episode_reward_mean": 638.5448635488749, "episode_reward_min": 447.46878772974014, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.06944251060486, "timestamp": 1559264548, "episode_len_mean": 325.0, "iterations_since_restore": 2, "training_iteration": 2, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039b7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-02-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 833.8216840191704, "outflow_rate_min": 676.3459241589018, "system_level_velocity_max": 12.547864871191276, "cost2_min": -86.94637548059686, "system_level_velocity_min": 9.304003648384004, "cost1_min": 111.78172702324905, "cost1_max": 153.8714706504191, "cost2_mean": -51.342176610990975, "discrim_loss": 1.3594794273376465, "cost2_max": -32.08570238270683, "cost1_mean": 128.14001724402448, "outflow_rate_mean": 743.966651276331, "system_level_velocity_mean": 10.61924837282327}}
{"sampler_perf": {"mean_inference_ms": 7.768097468240162, "mean_processing_ms": 9.894334840965183, "mean_env_wait_ms": 128.5246821627623}, "policy_reward_mean": {}, "time_since_restore": 376.57363533973694, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 376.57363533973694, "episodes_total": 60, "episode_reward_max": 703.0659998059273, "episode_reward_mean": 609.3857973784209, "episode_reward_min": 473.18306615948677, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.77255058288574, "timestamp": 1559264662, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 3, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033a510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033a488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033a400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033a378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-04-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 793.1103789824878, "outflow_rate_min": 685.1210697172927, "system_level_velocity_max": 11.977283931253995, "cost2_min": -80.70369610914764, "system_level_velocity_min": 9.7771996520696, "cost1_min": 114.75930349642438, "cost1_max": 146.85772282117756, "cost2_mean": -49.010711358229166, "discrim_loss": 1.325512409210205, "cost2_max": -34.45144335469622, "cost1_mean": 126.66862770895777, "outflow_rate_mean": 739.3125238633846, "system_level_velocity_mean": 10.523634631204297}}
{"sampler_perf": {"mean_inference_ms": 7.804324626128142, "mean_processing_ms": 10.828295051157772, "mean_env_wait_ms": 126.48338396046327}, "policy_reward_mean": {}, "time_since_restore": 488.7106087207794, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 30, "time_total_s": 488.7106087207794, "episodes_total": 90, "episode_reward_max": 685.0554676055908, "episode_reward_mean": 554.6982314278682, "episode_reward_min": 459.67712023854256, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.13697338104248, "timestamp": 1559264775, "episode_len_mean": 325.0, "iterations_since_restore": 4, "training_iteration": 4, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c37b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c36a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-06-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 854.8191738515039, "outflow_rate_min": 660.330805225126, "system_level_velocity_max": 12.893134733498743, "cost2_min": -75.15098205625293, "system_level_velocity_min": 8.836091601247677, "cost1_min": 104.06106229463356, "cost1_max": 152.94996490177272, "cost2_mean": -48.05089819388598, "discrim_loss": 1.2981007099151611, "cost2_max": -33.98304433749662, "cost1_mean": 136.61079112509563, "outflow_rate_mean": 773.8107285112418, "system_level_velocity_mean": 11.503761992326798}}
{"sampler_perf": {"mean_inference_ms": 7.730147006574614, "mean_processing_ms": 10.799620298346465, "mean_env_wait_ms": 122.1900475308025}, "policy_reward_mean": {}, "time_since_restore": 593.9033355712891, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 593.9033355712891, "episodes_total": 110, "episode_reward_max": 540.8510526716709, "episode_reward_mean": 485.07182825654746, "episode_reward_min": 405.08709509670734, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 105.19272685050964, "timestamp": 1559264880, "episode_len_mean": 325.0, "iterations_since_restore": 5, "training_iteration": 5, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033ad90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033ad08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033ac80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033abf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-08-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 891.2152821128035, "outflow_rate_min": 695.5826080330212, "system_level_velocity_max": 14.060352907711035, "cost2_min": -68.77144153554076, "system_level_velocity_min": 10.016098663611853, "cost1_min": 118.9347446238636, "cost1_max": 167.8197176182193, "cost2_mean": -47.93082197504533, "discrim_loss": 1.233057975769043, "cost2_max": -30.02690335939191, "cost1_mean": 141.22949643864982, "outflow_rate_mean": 782.0228779318559, "system_level_velocity_mean": 11.937355889274354}}
{"sampler_perf": {"mean_inference_ms": 7.674622959466648, "mean_processing_ms": 10.384221379954507, "mean_env_wait_ms": 120.78912333365786}, "policy_reward_mean": {}, "time_since_restore": 702.5438890457153, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 702.5438890457153, "episodes_total": 130, "episode_reward_max": 600.724237576127, "episode_reward_mean": 504.0505568780005, "episode_reward_min": 404.30411346256733, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.64055347442627, "timestamp": 1559264989, "episode_len_mean": 325.0, "iterations_since_restore": 6, "training_iteration": 6, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c37b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303756a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-09-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 918.0115085053012, "outflow_rate_min": 696.0910101009332, "system_level_velocity_max": 14.266817485784621, "cost2_min": -69.77018621315719, "system_level_velocity_min": 10.608924911265646, "cost1_min": 126.48065341413913, "cost1_max": 172.85180327093684, "cost2_mean": -55.64972631926673, "discrim_loss": 1.2215237617492676, "cost2_max": -42.01826629577489, "cost1_mean": 151.11295151332828, "outflow_rate_mean": 824.3907549488795, "system_level_velocity_mean": 12.666631433512269}}
{"sampler_perf": {"mean_inference_ms": 7.625786528499258, "mean_processing_ms": 10.721320107968006, "mean_env_wait_ms": 119.7191035581802}, "policy_reward_mean": {}, "time_since_restore": 813.8539338111877, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 30, "time_total_s": 813.8539338111877, "episodes_total": 160, "episode_reward_max": 817.6315010562539, "episode_reward_mean": 635.8247559177379, "episode_reward_min": 466.43158823251724, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.31004476547241, "timestamp": 1559265100, "episode_len_mean": 325.0, "iterations_since_restore": 7, "training_iteration": 7, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033b268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033b1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033b0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033b158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-11-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.7124662297158, "outflow_rate_min": 763.3360683683212, "system_level_velocity_max": 15.930808967694164, "cost2_min": -113.5946493339214, "system_level_velocity_min": 11.698880992795585, "cost1_min": 137.9260178800376, "cost1_max": 191.55486519043697, "cost2_mean": -81.08353273392781, "discrim_loss": 1.3816176652908325, "cost2_max": -52.37411783457288, "cost1_mean": 167.14535363175, "outflow_rate_mean": 886.8511788214554, "system_level_velocity_mean": 13.876572664275157}}
{"sampler_perf": {"mean_inference_ms": 7.571840345660407, "mean_processing_ms": 10.637815846517572, "mean_env_wait_ms": 120.0148979457659}, "policy_reward_mean": {}, "time_since_restore": 940.150337934494, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 940.150337934494, "episodes_total": 181, "episode_reward_max": 931.3775738626719, "episode_reward_mean": 782.648505152691, "episode_reward_min": 56.89812269806862, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.29640412330627, "timestamp": 1559265226, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 8, "training_iteration": 8, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-13-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.6820568229696, "outflow_rate_min": 476.10320957347216, "system_level_velocity_max": 17.850300097417787, "cost2_min": -127.16582701224577, "system_level_velocity_min": 11.76599227507757, "cost1_min": 18.045288002421945, "cost1_max": 214.78474630157052, "cost2_mean": -107.28739783621192, "discrim_loss": 1.5497610569000244, "cost2_max": -19.11476822324161, "cost1_mean": 175.21555026229555, "outflow_rate_mean": 914.9898406616315, "system_level_velocity_mean": 15.284502495469392}}
{"sampler_perf": {"mean_inference_ms": 7.536114306101808, "mean_processing_ms": 10.54766823725113, "mean_env_wait_ms": 121.09616383108315}, "policy_reward_mean": {}, "time_since_restore": 1068.215404033661, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 1068.215404033661, "episodes_total": 202, "episode_reward_max": 941.4660182073712, "episode_reward_mean": 838.3820136171721, "episode_reward_min": 86.2727743089199, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.06506609916687, "timestamp": 1559265355, "episode_len_mean": 311.3333333333333, "iterations_since_restore": 9, "training_iteration": 9, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303a4598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303a4730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303a4620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303a46a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-15-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.4640109260756, "outflow_rate_min": 490.50015477035146, "system_level_velocity_max": 18.633867610384883, "cost2_min": -135.4012049543897, "system_level_velocity_min": 12.212028088883061, "cost1_min": 25.056312692735492, "cost1_max": 221.24436922574927, "cost2_mean": -119.35641027687052, "discrim_loss": 1.617816686630249, "cost2_max": -24.816366307868982, "cost1_mean": 171.81615278002366, "outflow_rate_mean": 913.5905201283425, "system_level_velocity_mean": 15.184708719603572}}
{"sampler_perf": {"mean_inference_ms": 7.5382812061713365, "mean_processing_ms": 10.748821660315214, "mean_env_wait_ms": 123.01788265577468}, "policy_reward_mean": {}, "time_since_restore": 1207.1762642860413, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 28, "time_total_s": 1207.1762642860413, "episodes_total": 230, "episode_reward_max": 936.0413883924484, "episode_reward_mean": 862.3710213237043, "episode_reward_min": 762.3717598468065, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.96086025238037, "timestamp": 1559265494, "episode_len_mean": 325.0, "iterations_since_restore": 10, "training_iteration": 10, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-18-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1082.9776377202625, "outflow_rate_min": 853.5294423761928, "system_level_velocity_max": 18.797191937647273, "cost2_min": -149.13005472551123, "system_level_velocity_min": 12.81087482766682, "cost1_min": 152.8814718095892, "cost1_max": 224.04218283950428, "cost2_mean": -131.68135291743303, "discrim_loss": 1.5700041055679321, "cost2_max": -112.38638682545893, "cost1_mean": 181.85450306506166, "outflow_rate_mean": 951.9170665165457, "system_level_velocity_mean": 15.286293099019682}}
{"sampler_perf": {"mean_inference_ms": 7.5063117823617205, "mean_processing_ms": 10.745541151617964, "mean_env_wait_ms": 123.50151965349696}, "policy_reward_mean": {}, "time_since_restore": 1333.6701200008392, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 1333.6701200008392, "episodes_total": 252, "episode_reward_max": 899.9429069757462, "episode_reward_mean": 786.944223092361, "episode_reward_min": 478.1377224624157, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.49385571479797, "timestamp": 1559265620, "episode_len_mean": 320.0, "iterations_since_restore": 11, "training_iteration": 11, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303402f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303401e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-20-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1091.3914619821408, "outflow_rate_min": 861.137230152722, "system_level_velocity_max": 18.91233541651969, "cost2_min": -152.23032364587982, "system_level_velocity_min": 12.928559676087534, "cost1_min": 148.8161779605894, "cost1_max": 224.0904711949471, "cost2_mean": -132.82611018068334, "discrim_loss": 1.5456149578094482, "cost2_max": -93.21141274234573, "cost1_mean": 179.15992394159252, "outflow_rate_mean": 951.721539809199, "system_level_velocity_mean": 15.448526856753166}}
{"sampler_perf": {"mean_inference_ms": 7.510733373985462, "mean_processing_ms": 10.60983432741804, "mean_env_wait_ms": 124.54314813284381}, "policy_reward_mean": {}, "time_since_restore": 1465.1506090164185, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 1465.1506090164185, "episodes_total": 272, "episode_reward_max": 781.8641660958529, "episode_reward_mean": 722.3091268964112, "episode_reward_min": 656.4369544386864, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.48048901557922, "timestamp": 1559265752, "episode_len_mean": 325.0, "iterations_since_restore": 12, "training_iteration": 12, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-22-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.073754554508, "outflow_rate_min": 855.9927523785364, "system_level_velocity_max": 18.92777927804898, "cost2_min": -153.33643044995753, "system_level_velocity_min": 12.954479160518536, "cost1_min": 154.13248472604556, "cost1_max": 226.33183313832998, "cost2_mean": -135.25834128487625, "discrim_loss": 1.4416747093200684, "cost2_max": -118.98572439274699, "cost1_mean": 182.11169176120384, "outflow_rate_mean": 960.8515666562658, "system_level_velocity_mean": 15.399171770111915}}
{"sampler_perf": {"mean_inference_ms": 7.497194123350162, "mean_processing_ms": 10.8086991557746, "mean_env_wait_ms": 125.492387988715}, "policy_reward_mean": {}, "time_since_restore": 1605.5284686088562, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 29, "time_total_s": 1605.5284686088562, "episodes_total": 301, "episode_reward_max": 726.2090021669865, "episode_reward_mean": 652.3661933438532, "episode_reward_min": 589.1270427107811, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 140.37785959243774, "timestamp": 1559265892, "episode_len_mean": 325.0, "iterations_since_restore": 13, "training_iteration": 13, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930344620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930344510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930344598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-24-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1096.8418978666707, "outflow_rate_min": 826.8104626164289, "system_level_velocity_max": 18.998339974228358, "cost2_min": -160.8207222187745, "system_level_velocity_min": 12.285939952697502, "cost1_min": 144.38970656800032, "cost1_max": 226.43134393171704, "cost2_mean": -137.95999034233267, "discrim_loss": 1.3460379838943481, "cost2_max": -120.13469424302026, "cost1_mean": 180.84956625048565, "outflow_rate_mean": 956.7107239025229, "system_level_velocity_mean": 15.28571847210178}}
{"sampler_perf": {"mean_inference_ms": 7.445048337927204, "mean_processing_ms": 10.742776050221915, "mean_env_wait_ms": 125.4449015841167}, "policy_reward_mean": {}, "time_since_restore": 1729.0293922424316, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 1729.0293922424316, "episodes_total": 322, "episode_reward_max": 649.2078282237053, "episode_reward_mean": 607.1485896167301, "episode_reward_min": 560.5918931663036, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.50092363357544, "timestamp": 1559266016, "episode_len_mean": 325.0, "iterations_since_restore": 14, "training_iteration": 14, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303401e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-26-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1072.4314318337715, "outflow_rate_min": 802.1159346160748, "system_level_velocity_max": 18.201384422566004, "cost2_min": -156.81732532197924, "system_level_velocity_min": 11.950689667612503, "cost1_min": 138.85129966165505, "cost1_max": 218.42727762564604, "cost2_mean": -140.30475695841088, "discrim_loss": 1.31929612159729, "cost2_max": -122.78388017310242, "cost1_mean": 177.5242317862769, "outflow_rate_mean": 942.29243702605, "system_level_velocity_mean": 14.998064706913768}}
{"sampler_perf": {"mean_inference_ms": 7.436074615955226, "mean_processing_ms": 10.659523726929432, "mean_env_wait_ms": 125.37622365323439}, "policy_reward_mean": {}, "time_since_restore": 1854.1711242198944, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 1854.1711242198944, "episodes_total": 342, "episode_reward_max": 629.8287978321314, "episode_reward_mean": 582.0240356624126, "episode_reward_min": 542.2683637142181, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.14173197746277, "timestamp": 1559266141, "episode_len_mean": 325.0, "iterations_since_restore": 15, "training_iteration": 15, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-29-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1096.9362676123287, "outflow_rate_min": 841.5193519160592, "system_level_velocity_max": 19.02501624091544, "cost2_min": -153.83656872128304, "system_level_velocity_min": 12.689977914630733, "cost1_min": 150.15928291077128, "cost1_max": 227.32017408465117, "cost2_mean": -134.27084206613299, "discrim_loss": 1.265234112739563, "cost2_max": -118.28368126910924, "cost1_mean": 189.35376174433654, "outflow_rate_mean": 980.6495752663689, "system_level_velocity_mean": 15.94160264251054}}
{"sampler_perf": {"mean_inference_ms": 7.392721203847121, "mean_processing_ms": 10.578722043737681, "mean_env_wait_ms": 125.53656613169122}, "policy_reward_mean": {}, "time_since_restore": 1986.712072134018, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 1986.712072134018, "episodes_total": 363, "episode_reward_max": 659.9590391218662, "episode_reward_mean": 609.4421062107597, "episode_reward_min": 557.9086222350597, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.54094791412354, "timestamp": 1559266274, "episode_len_mean": 325.0, "iterations_since_restore": 16, "training_iteration": 16, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303620d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ff28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-31-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1090.3282374037562, "outflow_rate_min": 821.629554065198, "system_level_velocity_max": 18.936832042858246, "cost2_min": -155.53680517484037, "system_level_velocity_min": 12.442939867607667, "cost1_min": 146.35853115282518, "cost1_max": 225.32550465669317, "cost2_mean": -135.86492351309894, "discrim_loss": 1.2148911952972412, "cost2_max": -118.18825907097907, "cost1_mean": 178.97576132387886, "outflow_rate_mean": 946.7153187689355, "system_level_velocity_mean": 15.119580873298679}}
{"sampler_perf": {"mean_inference_ms": 7.353139145635768, "mean_processing_ms": 10.755858986225403, "mean_env_wait_ms": 125.47972979500756}, "policy_reward_mean": {}, "time_since_restore": 2112.468647003174, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 29, "time_total_s": 2112.468647003174, "episodes_total": 392, "episode_reward_max": 745.8958693444729, "episode_reward_mean": 658.8626953486738, "episode_reward_min": 564.0028091967106, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.75657486915588, "timestamp": 1559266399, "episode_len_mean": 325.0, "iterations_since_restore": 17, "training_iteration": 17, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303756a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-33-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1093.016215233389, "outflow_rate_min": 770.9891408335409, "system_level_velocity_max": 18.95647467681588, "cost2_min": -163.88168304086463, "system_level_velocity_min": 10.771412753224576, "cost1_min": 130.23436302268846, "cost1_max": 224.96785907402955, "cost2_mean": -135.26223169002128, "discrim_loss": 1.268592119216919, "cost2_max": -117.35262368923807, "cost1_mean": 176.4820515757189, "outflow_rate_mean": 939.9515199487571, "system_level_velocity_mean": 14.89676712358712}}
{"sampler_perf": {"mean_inference_ms": 7.32760359627981, "mean_processing_ms": 10.640863510125053, "mean_env_wait_ms": 125.33633216611811}, "policy_reward_mean": {}, "time_since_restore": 2233.7391505241394, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 2233.7391505241394, "episodes_total": 412, "episode_reward_max": 758.4626957625151, "episode_reward_mean": 705.1572853960097, "episode_reward_min": 651.9997210949659, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.27050352096558, "timestamp": 1559266521, "episode_len_mean": 325.0, "iterations_since_restore": 18, "training_iteration": 18, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-35-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1088.8920296240394, "outflow_rate_min": 820.588688244212, "system_level_velocity_max": 18.96071749785929, "cost2_min": -152.3076569826584, "system_level_velocity_min": 12.301389440977589, "cost1_min": 145.25170745407053, "cost1_max": 225.41890434586077, "cost2_mean": -134.53209091540023, "discrim_loss": 1.2720246315002441, "cost2_max": -118.71485527784579, "cost1_mean": 179.95168815214973, "outflow_rate_mean": 947.3636420673802, "system_level_velocity_mean": 15.15151428907414}}
{"sampler_perf": {"mean_inference_ms": 7.284102712706093, "mean_processing_ms": 10.618464604204993, "mean_env_wait_ms": 124.75209520219641}, "policy_reward_mean": {}, "time_since_restore": 2342.6266174316406, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 2342.6266174316406, "episodes_total": 433, "episode_reward_max": 795.3729897290468, "episode_reward_mean": 706.1604364532091, "episode_reward_min": 623.5612958967686, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.88746690750122, "timestamp": 1559266630, "episode_len_mean": 324.04761904761904, "iterations_since_restore": 19, "training_iteration": 19, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79306d3f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303757b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-37-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1091.311487961275, "outflow_rate_min": 832.9422417469133, "system_level_velocity_max": 18.89807945559904, "cost2_min": -149.34566900834233, "system_level_velocity_min": 12.526350868328288, "cost1_min": 148.8426947265905, "cost1_max": 224.6917993841937, "cost2_mean": -128.37457666453145, "discrim_loss": 1.3096699714660645, "cost2_max": -114.6654990330321, "cost1_mean": 191.40821288159125, "outflow_rate_mean": 984.7469434470916, "system_level_velocity_mean": 16.183431230214556}}
{"sampler_perf": {"mean_inference_ms": 7.306846800088298, "mean_processing_ms": 10.713729282636768, "mean_env_wait_ms": 125.94387485074243}, "policy_reward_mean": {}, "time_since_restore": 2479.15279173851, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 29, "time_total_s": 2479.15279173851, "episodes_total": 462, "episode_reward_max": 812.4034809842706, "episode_reward_mean": 744.3381690668135, "episode_reward_min": 678.3712200522423, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.5261743068695, "timestamp": 1559266767, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 20, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303599d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303598c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-39-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1087.648830384051, "outflow_rate_min": 823.5474270432655, "system_level_velocity_max": 18.63380746403961, "cost2_min": -148.3066958333158, "system_level_velocity_min": 12.346332434774627, "cost1_min": 146.78829522520465, "cost1_max": 222.44255089161584, "cost2_mean": -131.2238604134019, "discrim_loss": 1.3078118562698364, "cost2_max": -113.72282520763625, "cost1_mean": 176.9536475171051, "outflow_rate_mean": 935.7910938328922, "system_level_velocity_mean": 14.923178637834537}}
{"sampler_perf": {"mean_inference_ms": 7.3037667029562865, "mean_processing_ms": 10.63334267522848, "mean_env_wait_ms": 126.33483037820857}, "policy_reward_mean": {}, "time_since_restore": 2607.1001827716827, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 2607.1001827716827, "episodes_total": 482, "episode_reward_max": 799.421295851469, "episode_reward_mean": 728.7088577266783, "episode_reward_min": 648.35223723948, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.94739103317261, "timestamp": 1559266895, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 21, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c37b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c39d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c32f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-41-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1073.6134275035788, "outflow_rate_min": 851.4569723344997, "system_level_velocity_max": 18.423168086388518, "cost2_min": -148.49202852916738, "system_level_velocity_min": 12.743845916461192, "cost1_min": 152.7107399748838, "cost1_max": 222.16908698145517, "cost2_mean": -129.35575100212145, "discrim_loss": 1.3133283853530884, "cost2_max": -114.96043872069767, "cost1_mean": 180.74128684729837, "outflow_rate_mean": 949.3604028259575, "system_level_velocity_mean": 15.200509266012727}}
{"sampler_perf": {"mean_inference_ms": 7.30331854998989, "mean_processing_ms": 10.646266142382775, "mean_env_wait_ms": 126.58895862733058}, "policy_reward_mean": {}, "time_since_restore": 2724.9311039447784, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 2724.9311039447784, "episodes_total": 503, "episode_reward_max": 804.7045263126493, "episode_reward_mean": 689.7927829101682, "episode_reward_min": 231.8548135459423, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.8309211730957, "timestamp": 1559267013, "episode_len_mean": 315.0952380952381, "iterations_since_restore": 22, "training_iteration": 22, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-43-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1088.4271244010426, "outflow_rate_min": 718.5662547505541, "system_level_velocity_max": 18.686126752101956, "cost2_min": -138.83753812126628, "system_level_velocity_min": 12.135132732487818, "cost1_min": 79.78969427156244, "cost1_max": 223.98508199237102, "cost2_mean": -118.66606942766504, "discrim_loss": 1.3848536014556885, "cost2_max": -61.46694803739963, "cost1_mean": 184.5855440268555, "outflow_rate_mean": 965.9749276849761, "system_level_velocity_mean": 16.055222264776617}}
{"sampler_perf": {"mean_inference_ms": 7.317016930207655, "mean_processing_ms": 10.722826686578673, "mean_env_wait_ms": 127.20298403707686}, "policy_reward_mean": {}, "time_since_restore": 2860.210524082184, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 28, "time_total_s": 2860.210524082184, "episodes_total": 531, "episode_reward_max": 782.1824265047908, "episode_reward_mean": 689.7553860132715, "episode_reward_min": 241.84444379806519, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.2794201374054, "timestamp": 1559267149, "episode_len_mean": 317.85714285714283, "iterations_since_restore": 23, "training_iteration": 23, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ebf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ec80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-45-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.7361042240193, "outflow_rate_min": 733.633172537913, "system_level_velocity_max": 18.469221972743682, "cost2_min": -141.24826166943149, "system_level_velocity_min": 12.38710046022572, "cost1_min": 83.89067996587684, "cost1_max": 220.46471293174568, "cost2_mean": -119.63925420480656, "discrim_loss": 1.376962423324585, "cost2_max": -60.90171594511735, "cost1_mean": 181.36811807478767, "outflow_rate_mean": 951.2757367267806, "system_level_velocity_mean": 15.587427288453664}}
{"sampler_perf": {"mean_inference_ms": 7.3466555067586965, "mean_processing_ms": 10.758671185725817, "mean_env_wait_ms": 127.85352991678018}, "policy_reward_mean": {}, "time_since_restore": 2986.1067819595337, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 2986.1067819595337, "episodes_total": 554, "episode_reward_max": 789.4486791417003, "episode_reward_mean": 665.3858050921041, "episode_reward_min": 623.6640634983778, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.89625787734985, "timestamp": 1559267276, "episode_len_mean": 325.0, "iterations_since_restore": 24, "training_iteration": 24, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303619d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303618c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-47-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.6031779089635, "outflow_rate_min": 805.899470371192, "system_level_velocity_max": 18.014128169387263, "cost2_min": -139.57122695010688, "system_level_velocity_min": 12.250529718348409, "cost1_min": 145.94430805670314, "cost1_max": 215.08894588804964, "cost2_mean": -117.26433744345391, "discrim_loss": 1.419022798538208, "cost2_max": -106.83703438522832, "cost1_mean": 192.67836612916918, "outflow_rate_mean": 980.9850488807929, "system_level_velocity_mean": 15.999545691726377}}
{"sampler_perf": {"mean_inference_ms": 7.364474040439278, "mean_processing_ms": 10.696026146122628, "mean_env_wait_ms": 128.43809830818833}, "policy_reward_mean": {}, "time_since_restore": 3117.448392868042, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 3117.448392868042, "episodes_total": 574, "episode_reward_max": 752.8767255991697, "episode_reward_mean": 670.5952593512833, "episode_reward_min": 598.4023394286633, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.3416109085083, "timestamp": 1559267412, "episode_len_mean": 325.0, "iterations_since_restore": 25, "training_iteration": 25, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c36a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-50-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.8232378437444, "outflow_rate_min": 771.9298333405158, "system_level_velocity_max": 17.338390528599113, "cost2_min": -139.92958038974626, "system_level_velocity_min": 11.731772224320235, "cost1_min": 139.13300065511146, "cost1_max": 209.97125471939324, "cost2_mean": -117.88087331232573, "discrim_loss": 1.3789641857147217, "cost2_max": -100.4859238758802, "cost1_mean": 176.15969856742194, "outflow_rate_mean": 920.7857991614804, "system_level_velocity_mean": 14.61519434222904}}
{"sampler_perf": {"mean_inference_ms": 7.370545090079263, "mean_processing_ms": 10.747434262796462, "mean_env_wait_ms": 128.67173936787714}, "policy_reward_mean": {}, "time_since_restore": 3249.301107406616, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 27, "time_total_s": 3249.301107406616, "episodes_total": 601, "episode_reward_max": 719.329006806016, "episode_reward_mean": 632.9926739539261, "episode_reward_min": 579.5141316056252, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.85271453857422, "timestamp": 1559267544, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 26, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303597b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-52-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.7216548810152, "outflow_rate_min": 797.813919088194, "system_level_velocity_max": 17.088200831957103, "cost2_min": -134.52173977663824, "system_level_velocity_min": 12.02226265517684, "cost1_min": 144.79860660952698, "cost1_max": 206.5963811445946, "cost2_mean": -114.96482221101203, "discrim_loss": 1.3424302339553833, "cost2_max": -101.13120588922352, "cost1_mean": 181.06642305892805, "outflow_rate_mean": 933.5813093370314, "system_level_velocity_mean": 14.892330986292414}}
{"sampler_perf": {"mean_inference_ms": 7.390009988242138, "mean_processing_ms": 10.77257943533013, "mean_env_wait_ms": 129.320550214068}, "policy_reward_mean": {}, "time_since_restore": 3375.601992368698, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 3375.601992368698, "episodes_total": 623, "episode_reward_max": 744.4152145683765, "episode_reward_mean": 628.0502392758023, "episode_reward_min": 593.1959809362888, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.30088496208191, "timestamp": 1559267672, "episode_len_mean": 325.0, "iterations_since_restore": 27, "training_iteration": 27, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e8c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-54-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 997.7375714037621, "outflow_rate_min": 735.5658227657102, "system_level_velocity_max": 15.948576057248776, "cost2_min": -131.73562711760812, "system_level_velocity_min": 11.315407614753513, "cost1_min": 135.08407049667636, "cost1_max": 194.9708367565829, "cost2_mean": -110.8396939403576, "discrim_loss": 1.3509719371795654, "cost2_max": -100.3316372324583, "cost1_mean": 180.02833893710368, "outflow_rate_mean": 925.843816640984, "system_level_velocity_mean": 14.743548486594962}}
{"sampler_perf": {"mean_inference_ms": 7.3988659949756785, "mean_processing_ms": 10.743918451071956, "mean_env_wait_ms": 129.6850820172546}, "policy_reward_mean": {}, "time_since_restore": 3505.8388929367065, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 3505.8388929367065, "episodes_total": 644, "episode_reward_max": 692.220951795578, "episode_reward_mean": 633.0112534740141, "episode_reward_min": 610.9629867374897, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.23690056800842, "timestamp": 1559267802, "episode_len_mean": 325.0, "iterations_since_restore": 28, "training_iteration": 28, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ea60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-56-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.0446998426457, "outflow_rate_min": 813.0355585119336, "system_level_velocity_max": 15.77748591684776, "cost2_min": -128.59676106796996, "system_level_velocity_min": 12.529768062399695, "cost1_min": 153.74353165274238, "cost1_max": 192.23909292558824, "cost2_mean": -108.3438526917784, "discrim_loss": 1.3287122249603271, "cost2_max": -95.38434597499212, "cost1_mean": 179.3694699909908, "outflow_rate_mean": 925.7321651713976, "system_level_velocity_mean": 14.682369994325105}}
{"sampler_perf": {"mean_inference_ms": 7.395292925686479, "mean_processing_ms": 10.75040350232924, "mean_env_wait_ms": 129.77512667180414}, "policy_reward_mean": {}, "time_since_restore": 3633.721180677414, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 3633.721180677414, "episodes_total": 666, "episode_reward_max": 717.3681828081608, "episode_reward_mean": 610.6745604953983, "episode_reward_min": 46.85078352689743, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.8822877407074, "timestamp": 1559267930, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 29, "training_iteration": 29, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-58-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 974.2271447707647, "outflow_rate_min": 474.3699846082663, "system_level_velocity_max": 16.94288385488717, "cost2_min": -120.51594922055062, "system_level_velocity_min": 11.496800303533607, "cost1_min": 17.520475734089963, "cost1_max": 190.12561960615105, "cost2_mean": -102.64416912985025, "discrim_loss": 1.3019330501556396, "cost2_max": -16.556408955462, "cost1_mean": 169.2714125544979, "outflow_rate_mean": 897.3195813639035, "system_level_velocity_mean": 14.566717006300046}}
{"sampler_perf": {"mean_inference_ms": 7.411583022650341, "mean_processing_ms": 10.781220597259201, "mean_env_wait_ms": 130.29351033262867}, "policy_reward_mean": {}, "time_since_restore": 3764.539456129074, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 27, "time_total_s": 3764.539456129074, "episodes_total": 693, "episode_reward_max": 697.2164376378059, "episode_reward_mean": 642.7299967010816, "episode_reward_min": 626.921773225069, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.81827545166016, "timestamp": 1559268061, "episode_len_mean": 325.0, "iterations_since_restore": 30, "training_iteration": 30, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-01-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 953.4758280818254, "outflow_rate_min": 825.8611765245473, "system_level_velocity_max": 15.195020805138881, "cost2_min": -127.02391385136173, "system_level_velocity_min": 12.643551343632632, "cost1_min": 154.66582444801628, "cost1_max": 185.85947741599836, "cost2_mean": -106.03051793692167, "discrim_loss": 1.276193618774414, "cost2_max": -94.9310814480906, "cost1_mean": 175.10378917972352, "outflow_rate_mean": 911.843486406307, "system_level_velocity_mean": 14.293570063121441}}
{"sampler_perf": {"mean_inference_ms": 7.423718773452361, "mean_processing_ms": 10.808614319946718, "mean_env_wait_ms": 130.83818831075328}, "policy_reward_mean": {}, "time_since_restore": 3892.9634957313538, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 3892.9634957313538, "episodes_total": 715, "episode_reward_max": 708.5830247104168, "episode_reward_mean": 642.5019177279689, "episode_reward_min": 623.113371938467, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.42403960227966, "timestamp": 1559268190, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 31, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035eb70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ef28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e6a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-03-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 969.7977773578219, "outflow_rate_min": 772.9447646863699, "system_level_velocity_max": 15.453089636031478, "cost2_min": -125.23980168325915, "system_level_velocity_min": 11.877244750040179, "cost1_min": 143.8719572676979, "cost1_max": 188.96751683899748, "cost2_mean": -108.05038683509984, "discrim_loss": 1.2502145767211914, "cost2_max": -94.93833994329128, "cost1_mean": 173.98269464132088, "outflow_rate_mean": 905.3714041808706, "system_level_velocity_mean": 14.21938839947586}}
{"sampler_perf": {"mean_inference_ms": 7.436260436244243, "mean_processing_ms": 10.827140750291372, "mean_env_wait_ms": 131.11892795419698}, "policy_reward_mean": {}, "time_since_restore": 4024.98841714859, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 4024.98841714859, "episodes_total": 737, "episode_reward_max": 706.3766615390778, "episode_reward_mean": 620.2375382686204, "episode_reward_min": 58.881033301353455, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.02492141723633, "timestamp": 1559268322, "episode_len_mean": 311.8181818181818, "iterations_since_restore": 32, "training_iteration": 32, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333bf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-05-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.908205348408, "outflow_rate_min": 471.084583467557, "system_level_velocity_max": 18.185589609534805, "cost2_min": -123.34562820722314, "system_level_velocity_min": 11.079019946871709, "cost1_min": 22.68647776794228, "cost1_max": 193.80765547481343, "cost2_mean": -105.89264044911687, "discrim_loss": 1.2510344982147217, "cost2_max": -23.74874978626639, "cost1_mean": 167.1382814923493, "outflow_rate_mean": 884.2169710128591, "system_level_velocity_mean": 14.40896603087943}}
{"sampler_perf": {"mean_inference_ms": 7.458981078603413, "mean_processing_ms": 10.851444958812833, "mean_env_wait_ms": 131.69141937394306}, "policy_reward_mean": {}, "time_since_restore": 4159.285570144653, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 4159.285570144653, "episodes_total": 763, "episode_reward_max": 675.815061122179, "episode_reward_mean": 626.8623923796874, "episode_reward_min": 608.6181105971336, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.29715299606323, "timestamp": 1559268456, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 33, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375bf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-07-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 952.963811396478, "outflow_rate_min": 826.8358568559748, "system_level_velocity_max": 15.292013131734423, "cost2_min": -121.07787554558105, "system_level_velocity_min": 12.78005239192233, "cost1_min": 156.64918745147975, "cost1_max": 186.62545106768488, "cost2_mean": -110.74235967905028, "discrim_loss": 1.2285010814666748, "cost2_max": -95.13729193840709, "cost1_mean": 175.56481750134014, "outflow_rate_mean": 911.0774087864186, "system_level_velocity_mean": 14.336888516295897}}
{"sampler_perf": {"mean_inference_ms": 7.462098309003046, "mean_processing_ms": 10.894830491001963, "mean_env_wait_ms": 132.09532304323872}, "policy_reward_mean": {}, "time_since_restore": 4289.499675273895, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 4289.499675273895, "episodes_total": 786, "episode_reward_max": 644.4414584040642, "episode_reward_mean": 606.1861141427704, "episode_reward_min": 582.8590753376484, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.21410512924194, "timestamp": 1559268587, "episode_len_mean": 325.0, "iterations_since_restore": 34, "training_iteration": 34, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-09-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.5626145615295, "outflow_rate_min": 811.5984617137458, "system_level_velocity_max": 15.87005717178374, "cost2_min": -129.55852149305392, "system_level_velocity_min": 12.231782453402154, "cost1_min": 150.30446367195228, "cost1_max": 194.19485174007292, "cost2_mean": -111.77588144955801, "discrim_loss": 1.2219293117523193, "cost2_max": -99.86732841472161, "cost1_mean": 178.6633657330819, "outflow_rate_mean": 921.9815712566881, "system_level_velocity_mean": 14.603152454232614}}
{"sampler_perf": {"mean_inference_ms": 7.46921439074747, "mean_processing_ms": 10.867254553574671, "mean_env_wait_ms": 132.11977311004608}, "policy_reward_mean": {}, "time_since_restore": 4416.435932159424, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 4416.435932159424, "episodes_total": 806, "episode_reward_max": 647.6854173988104, "episode_reward_mean": 579.0325572006404, "episode_reward_min": 550.4497049748898, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.93625688552856, "timestamp": 1559268714, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 35, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303339d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-11-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.9710583226226, "outflow_rate_min": 721.7973224473582, "system_level_velocity_max": 16.325295122759155, "cost2_min": -130.87804074446052, "system_level_velocity_min": 11.069663438238448, "cost1_min": 132.7593769155626, "cost1_max": 198.7514982723191, "cost2_mean": -111.60364296171251, "discrim_loss": 1.2004029750823975, "cost2_max": -96.91900474665528, "cost1_mean": 178.43968187599106, "outflow_rate_mean": 918.7850898126675, "system_level_velocity_mean": 14.607073348336238}}
{"sampler_perf": {"mean_inference_ms": 7.463849120684234, "mean_processing_ms": 10.856598376642287, "mean_env_wait_ms": 131.8620302471803}, "policy_reward_mean": {}, "time_since_restore": 4535.697563409805, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 4535.697563409805, "episodes_total": 832, "episode_reward_max": 573.56534306705, "episode_reward_mean": 550.5466378990275, "episode_reward_min": 524.8259906768799, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.26163125038147, "timestamp": 1559268835, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 36, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303336a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-13-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1007.7888764466734, "outflow_rate_min": 875.8724954018932, "system_level_velocity_max": 16.474056571808323, "cost2_min": -124.36401341983495, "system_level_velocity_min": 13.579047310164388, "cost1_min": 165.41340057530817, "cost1_max": 200.78015348740217, "cost2_mean": -113.73622266922263, "discrim_loss": 1.1874117851257324, "cost2_max": -100.3343456664453, "cost1_mean": 184.58728009065345, "outflow_rate_mean": 943.9022755593669, "system_level_velocity_mean": 15.102012532601607}}
{"sampler_perf": {"mean_inference_ms": 7.4695428846811796, "mean_processing_ms": 10.924511216314627, "mean_env_wait_ms": 132.1180968137523}, "policy_reward_mean": {}, "time_since_restore": 4668.603411912918, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 4668.603411912918, "episodes_total": 856, "episode_reward_max": 582.5088970959187, "episode_reward_mean": 546.8812155021975, "episode_reward_min": 526.6453847587109, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.9058485031128, "timestamp": 1559268968, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 37, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c36a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-16-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.5701746757728, "outflow_rate_min": 792.6134152798219, "system_level_velocity_max": 16.58425796784064, "cost2_min": -142.68163016058588, "system_level_velocity_min": 11.909354236925154, "cost1_min": 146.6696121953243, "cost1_max": 202.59442880335627, "cost2_mean": -115.88838135326675, "discrim_loss": 1.1911133527755737, "cost2_max": -102.33205167236301, "cost1_mean": 184.65048153941044, "outflow_rate_mean": 944.8576661144263, "system_level_velocity_mean": 15.114501094901108}}
{"sampler_perf": {"mean_inference_ms": 7.462241191963727, "mean_processing_ms": 10.86267254268164, "mean_env_wait_ms": 131.90762009153383}, "policy_reward_mean": {}, "time_since_restore": 4793.927705526352, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 4793.927705526352, "episodes_total": 876, "episode_reward_max": 569.2848558276892, "episode_reward_mean": 546.1331323325634, "episode_reward_min": 525.3042023479939, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.32429361343384, "timestamp": 1559269093, "episode_len_mean": 325.0, "iterations_since_restore": 38, "training_iteration": 38, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303756a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-18-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1019.2371874222981, "outflow_rate_min": 822.7316582629396, "system_level_velocity_max": 16.79765579406626, "cost2_min": -130.1591106093573, "system_level_velocity_min": 12.528630508366156, "cost1_min": 151.58109052785585, "cost1_max": 204.4998146450942, "cost2_mean": -119.16197115234691, "discrim_loss": 1.1632606983184814, "cost2_max": -99.36349846715233, "cost1_mean": 180.399713389809, "outflow_rate_mean": 929.7901849617349, "system_level_velocity_mean": 14.819285189058002}}
{"sampler_perf": {"mean_inference_ms": 7.433617610306269, "mean_processing_ms": 10.85470834220041, "mean_env_wait_ms": 131.52674138285008}, "policy_reward_mean": {}, "time_since_restore": 4921.543414354324, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 4921.543414354324, "episodes_total": 902, "episode_reward_max": 562.1108897924423, "episode_reward_mean": 542.9152752914681, "episode_reward_min": 526.7728303819895, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.61570882797241, "timestamp": 1559269221, "episode_len_mean": 325.0, "iterations_since_restore": 39, "training_iteration": 39, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303640d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333d90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-20-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1030.5351450851338, "outflow_rate_min": 768.0647153797075, "system_level_velocity_max": 17.10736481747242, "cost2_min": -144.831726821016, "system_level_velocity_min": 11.68776030670183, "cost1_min": 138.11497132986656, "cost1_max": 206.38120426145304, "cost2_mean": -117.10093480797764, "discrim_loss": 1.1298637390136719, "cost2_max": -104.61260552155004, "cost1_mean": 181.044012268287, "outflow_rate_mean": 936.8946486534431, "system_level_velocity_mean": 14.995256254674294}}
{"sampler_perf": {"mean_inference_ms": 7.436329285929032, "mean_processing_ms": 10.892017174486606, "mean_env_wait_ms": 131.70426030461903}, "policy_reward_mean": {}, "time_since_restore": 5053.321011304855, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 5053.321011304855, "episodes_total": 925, "episode_reward_max": 539.9351549372077, "episode_reward_mean": 530.6249663130096, "episode_reward_min": 524.5782064944506, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.777596950531, "timestamp": 1559269353, "episode_len_mean": 325.0, "iterations_since_restore": 40, "training_iteration": 40, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e8c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-22-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.559319187635, "outflow_rate_min": 794.5929531236322, "system_level_velocity_max": 17.560095285385028, "cost2_min": -134.8557051032399, "system_level_velocity_min": 11.746234780820009, "cost1_min": 142.51967281091166, "cost1_max": 211.88421857102998, "cost2_mean": -118.65357008069356, "discrim_loss": 1.0980474948883057, "cost2_max": -105.70439192882066, "cost1_mean": 185.44795381401894, "outflow_rate_mean": 954.7435293090286, "system_level_velocity_mean": 15.349766066233263}}
{"sampler_perf": {"mean_inference_ms": 7.41317683098703, "mean_processing_ms": 10.848009892691259, "mean_env_wait_ms": 131.2227921249062}, "policy_reward_mean": {}, "time_since_restore": 5175.536385297775, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 5175.536385297775, "episodes_total": 947, "episode_reward_max": 535.107171818614, "episode_reward_mean": 490.06335085833615, "episode_reward_min": 38.7871136367321, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.21537399291992, "timestamp": 1559269475, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 41, "training_iteration": 41, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303642f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303641e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-24-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.6920715050735, "outflow_rate_min": 492.0625426222078, "system_level_velocity_max": 17.760754892879774, "cost2_min": -144.8882372524003, "system_level_velocity_min": 11.590677542656637, "cost1_min": 17.85718419696174, "cost1_max": 207.98022267603668, "cost2_mean": -112.65661888078711, "discrim_loss": 1.0404964685440063, "cost2_max": -18.373789683928933, "cost1_mean": 174.97368393328108, "outflow_rate_mean": 921.4569771451639, "system_level_velocity_mean": 15.222294146499491}}
{"sampler_perf": {"mean_inference_ms": 7.411578067606912, "mean_processing_ms": 10.833055329081787, "mean_env_wait_ms": 131.31654630858495}, "policy_reward_mean": {}, "time_since_restore": 5313.408378601074, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 5313.408378601074, "episodes_total": 969, "episode_reward_max": 524.4404805675149, "episode_reward_mean": 476.8439479160377, "episode_reward_min": 42.28112778067589, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.87199330329895, "timestamp": 1559269613, "episode_len_mean": 306.5, "iterations_since_restore": 42, "training_iteration": 42, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ebf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-26-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.789553815842, "outflow_rate_min": 497.50056700217027, "system_level_velocity_max": 18.360004904666084, "cost2_min": -142.20374321910285, "system_level_velocity_min": 12.25798756633101, "cost1_min": 18.743570242517468, "cost1_max": 208.79386854228366, "cost2_mean": -114.64272021438991, "discrim_loss": 1.005075454711914, "cost2_max": -19.122973715239066, "cost1_mean": 164.4013006162311, "outflow_rate_mean": 886.7281117767895, "system_level_velocity_mean": 14.663638366431808}}
{"sampler_perf": {"mean_inference_ms": 7.418227441173898, "mean_processing_ms": 10.86826447987872, "mean_env_wait_ms": 131.65688445298287}, "policy_reward_mean": {}, "time_since_restore": 5451.48671746254, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 28, "time_total_s": 5451.48671746254, "episodes_total": 997, "episode_reward_max": 551.4663206040859, "episode_reward_mean": 498.54041036218405, "episode_reward_min": 59.77401593327522, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.07833886146545, "timestamp": 1559269751, "episode_len_mean": 314.7142857142857, "iterations_since_restore": 43, "training_iteration": 43, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303599d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303598c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-29-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.119972761692, "outflow_rate_min": 472.1492185913593, "system_level_velocity_max": 18.459972135151922, "cost2_min": -135.8305238679771, "system_level_velocity_min": 11.599853426516948, "cost1_min": 24.297405787672076, "cost1_max": 210.1300047826062, "cost2_mean": -117.17183045402338, "discrim_loss": 0.9753963351249695, "cost2_max": -26.16366779829292, "cost1_mean": 174.2208601944701, "outflow_rate_mean": 917.6163497905809, "system_level_velocity_mean": 15.03256585794902}}
{"sampler_perf": {"mean_inference_ms": 7.398759409481688, "mean_processing_ms": 10.887599652564115, "mean_env_wait_ms": 131.1938175116267}, "policy_reward_mean": {}, "time_since_restore": 5578.865993738174, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 5578.865993738174, "episodes_total": 1021, "episode_reward_max": 558.0494284927845, "episode_reward_mean": 501.7711051620233, "episode_reward_min": 45.156505048274994, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.37927627563477, "timestamp": 1559269879, "episode_len_mean": 312.5833333333333, "iterations_since_restore": 44, "training_iteration": 44, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3bf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c37b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c39d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-31-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.1960361925749, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 17.477607470920198, "cost2_min": -133.52151092501578, "system_level_velocity_min": 11.040139432611232, "cost1_min": 17.915906610201166, "cost1_max": 210.45227152069447, "cost2_mean": -112.4617640712891, "discrim_loss": 0.9810740351676941, "cost2_max": -21.464866346140735, "cost1_mean": 178.16594169148638, "outflow_rate_mean": 931.9840565843657, "system_level_velocity_mean": 15.437247536946591}}
{"sampler_perf": {"mean_inference_ms": 7.407337476764198, "mean_processing_ms": 10.843176577681842, "mean_env_wait_ms": 131.4540306722382}, "policy_reward_mean": {}, "time_since_restore": 5712.45460319519, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 5712.45460319519, "episodes_total": 1041, "episode_reward_max": 527.9039772972465, "episode_reward_mean": 478.926998136472, "episode_reward_min": 438.8697170112282, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.588609457016, "timestamp": 1559270015, "episode_len_mean": 325.0, "iterations_since_restore": 45, "training_iteration": 45, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035eae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-33-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1052.981487130286, "outflow_rate_min": 778.4039519421744, "system_level_velocity_max": 17.5078600122979, "cost2_min": -143.4219036006371, "system_level_velocity_min": 11.796239575137072, "cost1_min": 139.48712663710458, "cost1_max": 210.65020949227122, "cost2_mean": -119.13166402675047, "discrim_loss": 0.909866213798523, "cost2_max": -107.20399089723446, "cost1_mean": 177.9613498183147, "outflow_rate_mean": 927.0660439877117, "system_level_velocity_mean": 14.748786624605748}}
{"sampler_perf": {"mean_inference_ms": 7.4121777592063, "mean_processing_ms": 10.85925512246673, "mean_env_wait_ms": 131.60544013684046}, "policy_reward_mean": {}, "time_since_restore": 5853.52429318428, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 5853.52429318428, "episodes_total": 1066, "episode_reward_max": 501.6920273527503, "episode_reward_mean": 446.9058657412231, "episode_reward_min": 397.9801041986793, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 141.06968998908997, "timestamp": 1559270156, "episode_len_mean": 325.0, "iterations_since_restore": 46, "training_iteration": 46, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303650d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-35-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.9600553035925, "outflow_rate_min": 816.1555443903295, "system_level_velocity_max": 17.552235117382203, "cost2_min": -136.39609349394527, "system_level_velocity_min": 12.25292831550534, "cost1_min": 147.8607540131341, "cost1_max": 211.70203026326215, "cost2_mean": -115.728000714028, "discrim_loss": 0.8696726560592651, "cost2_max": -106.8354712605331, "cost1_mean": 186.6275608798119, "outflow_rate_mean": 961.6752528097247, "system_level_velocity_mean": 15.493996324697042}}
{"sampler_perf": {"mean_inference_ms": 7.415306698004102, "mean_processing_ms": 10.894789925009624, "mean_env_wait_ms": 131.86709485792315}, "policy_reward_mean": {}, "time_since_restore": 5998.628034830093, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 5998.628034830093, "episodes_total": 1090, "episode_reward_max": 468.7103660404682, "episode_reward_mean": 403.64918066503014, "episode_reward_min": 352.57395744509995, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 145.103741645813, "timestamp": 1559270301, "episode_len_mean": 325.0, "iterations_since_restore": 47, "training_iteration": 47, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ec80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-38-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.1381258466934, "outflow_rate_min": 707.0843006332935, "system_level_velocity_max": 17.63935956732614, "cost2_min": -140.79986076628646, "system_level_velocity_min": 10.78459804411991, "cost1_min": 128.4511515842623, "cost1_max": 212.6479850538333, "cost2_mean": -118.13616132382758, "discrim_loss": 0.8845375776290894, "cost2_max": -106.81323233967727, "cost1_mean": 183.79786164423876, "outflow_rate_mean": 947.4420212388362, "system_level_velocity_mean": 15.226458036122393}}
{"sampler_perf": {"mean_inference_ms": 7.419303046943843, "mean_processing_ms": 10.876150337950197, "mean_env_wait_ms": 131.94666254151304}, "policy_reward_mean": {}, "time_since_restore": 6135.949959039688, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 6135.949959039688, "episodes_total": 1111, "episode_reward_max": 430.35093981027603, "episode_reward_mean": 373.4020489139394, "episode_reward_min": 336.51644219923764, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.32192420959473, "timestamp": 1559270438, "episode_len_mean": 325.0, "iterations_since_restore": 48, "training_iteration": 48, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b3378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b32f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b3268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b31e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-40-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.2595008264825, "outflow_rate_min": 752.3277353590536, "system_level_velocity_max": 17.59521699474534, "cost2_min": -142.6807683048162, "system_level_velocity_min": 11.414032771795055, "cost1_min": 135.9543815586572, "cost1_max": 212.2867091492651, "cost2_mean": -120.82773914978034, "discrim_loss": 0.8301305770874023, "cost2_max": -107.2140920210897, "cost1_mean": 177.6962681761486, "outflow_rate_mean": 925.6634921496654, "system_level_velocity_mean": 14.740881724728514}}
{"sampler_perf": {"mean_inference_ms": 7.415995311936648, "mean_processing_ms": 10.850579552741541, "mean_env_wait_ms": 132.20236936885888}, "policy_reward_mean": {}, "time_since_restore": 6269.040794372559, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 6269.040794372559, "episodes_total": 1134, "episode_reward_max": 416.09504099562764, "episode_reward_mean": 368.48811380964014, "episode_reward_min": 341.9533538138494, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.09083533287048, "timestamp": 1559270572, "episode_len_mean": 325.0, "iterations_since_restore": 49, "training_iteration": 49, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303640d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-42-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.409208334066, "outflow_rate_min": 735.9959823966377, "system_level_velocity_max": 17.429600591957335, "cost2_min": -133.73559273121646, "system_level_velocity_min": 11.179427757373102, "cost1_min": 132.94698479139987, "cost1_max": 209.70865000471167, "cost2_mean": -120.72567093794486, "discrim_loss": 0.7842400074005127, "cost2_max": -106.62041053119181, "cost1_mean": 168.08786901332428, "outflow_rate_mean": 890.9969111252638, "system_level_velocity_mean": 13.970326486152018}}
{"sampler_perf": {"mean_inference_ms": 7.428829099225323, "mean_processing_ms": 10.905460463492677, "mean_env_wait_ms": 132.4549631453966}, "policy_reward_mean": {}, "time_since_restore": 6420.597186326981, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 6420.597186326981, "episodes_total": 1160, "episode_reward_max": 454.487632855773, "episode_reward_mean": 404.72249725355334, "episode_reward_min": 346.9498895779252, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 151.556391954422, "timestamp": 1559270723, "episode_len_mean": 325.0, "iterations_since_restore": 50, "training_iteration": 50, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ed90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ea60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ef28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-45-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.2709748654229, "outflow_rate_min": 735.6668922572914, "system_level_velocity_max": 17.430253389123255, "cost2_min": -140.03262838007805, "system_level_velocity_min": 11.1858733023907, "cost1_min": 133.06659176692858, "cost1_max": 210.18926785147184, "cost2_mean": -116.20302017540001, "discrim_loss": 0.7823337912559509, "cost2_max": -103.24646882999745, "cost1_mean": 184.9791259222958, "outflow_rate_mean": 950.0688311832434, "system_level_velocity_mean": 15.281710734902466}}
{"sampler_perf": {"mean_inference_ms": 7.4268652986456365, "mean_processing_ms": 10.886126323481836, "mean_env_wait_ms": 132.7628830914408}, "policy_reward_mean": {}, "time_since_restore": 6566.211993932724, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 6566.211993932724, "episodes_total": 1181, "episode_reward_max": 408.40574133209884, "episode_reward_mean": 353.4380992609298, "episode_reward_min": 318.70593407563865, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 145.6148076057434, "timestamp": 1559270869, "episode_len_mean": 325.0, "iterations_since_restore": 51, "training_iteration": 51, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-47-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.3340640355407, "outflow_rate_min": 764.2634508014379, "system_level_velocity_max": 17.181487373775813, "cost2_min": -142.39188576700803, "system_level_velocity_min": 11.500531066872785, "cost1_min": 137.8561265180352, "cost1_max": 207.68208682879487, "cost2_mean": -122.42481114500598, "discrim_loss": 0.6718007326126099, "cost2_max": -105.31956146489642, "cost1_mean": 170.42005366657608, "outflow_rate_mean": 897.6510167570424, "system_level_velocity_mean": 14.096936895486815}}
{"sampler_perf": {"mean_inference_ms": 7.433198101643281, "mean_processing_ms": 10.880640543576849, "mean_env_wait_ms": 133.05882864490775}, "policy_reward_mean": {}, "time_since_restore": 6709.147857427597, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 6709.147857427597, "episodes_total": 1204, "episode_reward_max": 386.4730602558702, "episode_reward_mean": 332.45680926878856, "episode_reward_min": 297.0384145383723, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.93586349487305, "timestamp": 1559271012, "episode_len_mean": 325.0, "iterations_since_restore": 52, "training_iteration": 52, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-50-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.782639842388, "outflow_rate_min": 695.5691191078932, "system_level_velocity_max": 17.2655898690329, "cost2_min": -131.1141125512187, "system_level_velocity_min": 10.05836184130902, "cost1_min": 119.48092317805497, "cost1_max": 208.22590090631576, "cost2_mean": -117.09016371458411, "discrim_loss": 0.7223273515701294, "cost2_max": -102.01484194692077, "cost1_mean": 177.80197856939475, "outflow_rate_mean": 924.1968808818897, "system_level_velocity_mean": 14.71893741558779}}
{"sampler_perf": {"mean_inference_ms": 7.447018866982719, "mean_processing_ms": 10.921881410545447, "mean_env_wait_ms": 133.2017722562503}, "policy_reward_mean": {}, "time_since_restore": 6838.905384778976, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 6838.905384778976, "episodes_total": 1229, "episode_reward_max": 363.5856325291097, "episode_reward_mean": 301.95977637022736, "episode_reward_min": 271.6548792575486, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.7575273513794, "timestamp": 1559271142, "episode_len_mean": 325.0, "iterations_since_restore": 53, "training_iteration": 53, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303641e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-52-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.2858133490367, "outflow_rate_min": 827.7057856516257, "system_level_velocity_max": 17.301470476982388, "cost2_min": -131.85341035159212, "system_level_velocity_min": 12.743822795579044, "cost1_min": 152.6722262374362, "cost1_max": 208.70169094078238, "cost2_mean": -119.03727046976614, "discrim_loss": 0.7064757347106934, "cost2_max": -104.8064966419636, "cost1_mean": 180.08859603458626, "outflow_rate_mean": 933.4291091261009, "system_level_velocity_mean": 14.867112286258509}}
{"sampler_perf": {"mean_inference_ms": 7.430774464913529, "mean_processing_ms": 10.90093009053844, "mean_env_wait_ms": 133.02689520136667}, "policy_reward_mean": {}, "time_since_restore": 6962.0681393146515, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 6962.0681393146515, "episodes_total": 1251, "episode_reward_max": 346.0797577649355, "episode_reward_mean": 298.76970596259076, "episode_reward_min": 259.66094222967513, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.16275453567505, "timestamp": 1559271265, "episode_len_mean": 325.0, "iterations_since_restore": 54, "training_iteration": 54, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-54-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.5816193504716, "outflow_rate_min": 829.985901376311, "system_level_velocity_max": 17.32634515312413, "cost2_min": -131.91175144384675, "system_level_velocity_min": 12.548005825409664, "cost1_min": 152.43588127740412, "cost1_max": 208.6341440391563, "cost2_mean": -118.57986409058618, "discrim_loss": 0.6916931867599487, "cost2_max": -102.88978842035587, "cost1_mean": 184.1898010067388, "outflow_rate_mean": 948.2991841570831, "system_level_velocity_mean": 15.194042164590304}}
{"sampler_perf": {"mean_inference_ms": 7.435488752884036, "mean_processing_ms": 10.868531077856735, "mean_env_wait_ms": 133.01598088836263}, "policy_reward_mean": {}, "time_since_restore": 7103.064825534821, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 7103.064825534821, "episodes_total": 1271, "episode_reward_max": 331.8100602477789, "episode_reward_mean": 292.8591736366041, "episode_reward_min": 243.56443331832998, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 140.99668622016907, "timestamp": 1559271406, "episode_len_mean": 325.0, "iterations_since_restore": 55, "training_iteration": 55, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-56-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.1367522996636, "outflow_rate_min": 816.4197083909537, "system_level_velocity_max": 17.255863543707786, "cost2_min": -134.03738079234427, "system_level_velocity_min": 12.23231568471216, "cost1_min": 147.80022747989975, "cost1_max": 208.6163092814246, "cost2_mean": -114.2120176658353, "discrim_loss": 0.6463884711265564, "cost2_max": -101.53970845705722, "cost1_mean": 189.21512360976618, "outflow_rate_mean": 969.1579606968835, "system_level_velocity_mean": 15.645453689983423}}
{"sampler_perf": {"mean_inference_ms": 7.438648166753727, "mean_processing_ms": 10.908940200429114, "mean_env_wait_ms": 133.182469798632}, "policy_reward_mean": {}, "time_since_restore": 7238.062086343765, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 27, "time_total_s": 7238.062086343765, "episodes_total": 1298, "episode_reward_max": 315.59719420969486, "episode_reward_mean": 265.9830864847, "episode_reward_min": 225.8753590201959, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.9972608089447, "timestamp": 1559271541, "episode_len_mean": 325.0, "iterations_since_restore": 56, "training_iteration": 56, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303649d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303648c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-59-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.8163612604637, "outflow_rate_min": 763.4143362464301, "system_level_velocity_max": 17.21551516971945, "cost2_min": -132.00763846208355, "system_level_velocity_min": 11.487044944835484, "cost1_min": 137.41083444152514, "cost1_max": 207.60893230446473, "cost2_mean": -115.62775395087036, "discrim_loss": 0.5836787223815918, "cost2_max": -100.78942793928279, "cost1_mean": 185.35897039073947, "outflow_rate_mean": 951.2731253323175, "system_level_velocity_mean": 15.27756987785323}}
{"sampler_perf": {"mean_inference_ms": 7.439016238770044, "mean_processing_ms": 10.910638164385011, "mean_env_wait_ms": 133.11589340564564}, "policy_reward_mean": {}, "time_since_restore": 7369.427973508835, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 7369.427973508835, "episodes_total": 1321, "episode_reward_max": 276.68164834193885, "episode_reward_mean": 240.01711121249093, "episode_reward_min": 213.18610660464037, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.36588716506958, "timestamp": 1559271673, "episode_len_mean": 325.0, "iterations_since_restore": 57, "training_iteration": 57, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e2f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-01-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.4999145260792, "outflow_rate_min": 821.7908215309468, "system_level_velocity_max": 16.97737664744593, "cost2_min": -128.70276107000126, "system_level_velocity_min": 12.562531898447608, "cost1_min": 152.75989851199887, "cost1_max": 205.91261126095083, "cost2_mean": -116.46022934250405, "discrim_loss": 0.6420120000839233, "cost2_max": -103.55123600258887, "cost1_mean": 183.527793387853, "outflow_rate_mean": 945.6828336999703, "system_level_velocity_mean": 15.130717830025862}}
{"sampler_perf": {"mean_inference_ms": 7.438691471727994, "mean_processing_ms": 10.876673759941351, "mean_env_wait_ms": 133.1268932826985}, "policy_reward_mean": {}, "time_since_restore": 7499.105136156082, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 7499.105136156082, "episodes_total": 1341, "episode_reward_max": 293.65663862694055, "episode_reward_mean": 243.287355618499, "episode_reward_min": 202.51070395298302, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.67716264724731, "timestamp": 1559271803, "episode_len_mean": 325.0, "iterations_since_restore": 58, "training_iteration": 58, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303248c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-03-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.886000615225, "outflow_rate_min": 841.2227080346653, "system_level_velocity_max": 17.161750665717587, "cost2_min": -135.09849824345406, "system_level_velocity_min": 12.927110786661718, "cost1_min": 156.04223889763597, "cost1_max": 206.96899016921327, "cost2_mean": -116.76093206167589, "discrim_loss": 0.6355588436126709, "cost2_max": -101.7718873364728, "cost1_mean": 187.11642692703805, "outflow_rate_mean": 958.5307314667, "system_level_velocity_mean": 15.416968090403657}}
{"sampler_perf": {"mean_inference_ms": 7.440353221229094, "mean_processing_ms": 10.889246798092888, "mean_env_wait_ms": 133.09491147531853}, "policy_reward_mean": {}, "time_since_restore": 7631.642440319061, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 7631.642440319061, "episodes_total": 1366, "episode_reward_max": 289.30955293029547, "episode_reward_mean": 233.0118806909537, "episode_reward_min": 33.2585426941514, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.53730416297913, "timestamp": 1559271935, "episode_len_mean": 313.4, "iterations_since_restore": 59, "training_iteration": 59, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-05-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.128341344637, "outflow_rate_min": 480.4101308344419, "system_level_velocity_max": 18.503036781779457, "cost2_min": -140.382107384891, "system_level_velocity_min": 12.431832585863395, "cost1_min": 22.99940567582668, "cost1_max": 206.57289683021207, "cost2_mean": -113.87810156048747, "discrim_loss": 0.6138919591903687, "cost2_max": -22.644978734059066, "cost1_mean": 178.75412830035012, "outflow_rate_mean": 933.1809849000216, "system_level_velocity_mean": 15.405084956177816}}
{"sampler_perf": {"mean_inference_ms": 7.448645835637924, "mean_processing_ms": 10.910742682712995, "mean_env_wait_ms": 133.09110100143596}, "policy_reward_mean": {}, "time_since_restore": 7753.777756214142, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 7753.777756214142, "episodes_total": 1391, "episode_reward_max": 293.18996518850327, "episode_reward_mean": 252.7267987053655, "episode_reward_min": 211.44131728843786, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.13531589508057, "timestamp": 1559272058, "episode_len_mean": 324.2, "iterations_since_restore": 60, "training_iteration": 60, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbb70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb0d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-07-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.5516509307438, "outflow_rate_min": 731.1102109529713, "system_level_velocity_max": 17.15524014393881, "cost2_min": -128.45519218877877, "system_level_velocity_min": 10.90969919554188, "cost1_min": 131.24058257727563, "cost1_max": 205.35358271344757, "cost2_mean": -111.92522728723772, "discrim_loss": 0.6164296269416809, "cost2_max": -97.36268915288377, "cost1_mean": 189.87261616396142, "outflow_rate_mean": 969.9004973863028, "system_level_velocity_mean": 15.6890703183016}}
{"sampler_perf": {"mean_inference_ms": 7.444876373401745, "mean_processing_ms": 10.890717747718007, "mean_env_wait_ms": 133.07321824137497}, "policy_reward_mean": {}, "time_since_restore": 7892.477786779404, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 7892.477786779404, "episodes_total": 1412, "episode_reward_max": 280.736692301929, "episode_reward_mean": 232.23301548605863, "episode_reward_min": 193.1326769979205, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.70003056526184, "timestamp": 1559272196, "episode_len_mean": 325.0, "iterations_since_restore": 61, "training_iteration": 61, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ed08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-09-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.98400425398, "outflow_rate_min": 759.2201041752129, "system_level_velocity_max": 17.1772688887238, "cost2_min": -136.6753572830969, "system_level_velocity_min": 11.530040865634007, "cost1_min": 138.8243719890356, "cost1_max": 206.71317516216854, "cost2_mean": -116.64383171277771, "discrim_loss": 0.5486215353012085, "cost2_max": -99.42934474038053, "cost1_mean": 181.19798096540123, "outflow_rate_mean": 934.5719578684395, "system_level_velocity_mean": 14.918651336939236}}
{"sampler_perf": {"mean_inference_ms": 7.442448903480221, "mean_processing_ms": 10.876153805570334, "mean_env_wait_ms": 133.16074293923856}, "policy_reward_mean": {}, "time_since_restore": 8030.116168022156, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 8030.116168022156, "episodes_total": 1435, "episode_reward_max": 284.3583507835865, "episode_reward_mean": 232.5182067722983, "episode_reward_min": 202.00939844746608, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.63838124275208, "timestamp": 1559272334, "episode_len_mean": 325.0, "iterations_since_restore": 62, "training_iteration": 62, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303248c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-12-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.32767262322, "outflow_rate_min": 761.3706709191862, "system_level_velocity_max": 17.140454628754597, "cost2_min": -137.92008930866893, "system_level_velocity_min": 11.600263812691528, "cost1_min": 139.45304870844126, "cost1_max": 206.24706241831248, "cost2_mean": -116.34442767703528, "discrim_loss": 0.5851325988769531, "cost2_max": -98.5018644525121, "cost1_mean": 182.35361547453692, "outflow_rate_mean": 937.9829777709637, "system_level_velocity_mean": 15.001000346658467}}
{"sampler_perf": {"mean_inference_ms": 7.455330633078743, "mean_processing_ms": 10.919694714493861, "mean_env_wait_ms": 133.24336461539446}, "policy_reward_mean": {}, "time_since_restore": 8162.903144836426, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 8162.903144836426, "episodes_total": 1461, "episode_reward_max": 341.7204859033227, "episode_reward_mean": 262.8731388540652, "episode_reward_min": 209.68362455407623, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.78697681427002, "timestamp": 1559272467, "episode_len_mean": 325.0, "iterations_since_restore": 63, "training_iteration": 63, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e0d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ee18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-14-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.9120642142077, "outflow_rate_min": 850.0201708447016, "system_level_velocity_max": 17.097100044049483, "cost2_min": -124.59891445024158, "system_level_velocity_min": 12.809660701741192, "cost1_min": 156.31370356981506, "cost1_max": 204.16678049005992, "cost2_mean": -113.02269214720846, "discrim_loss": 0.6284468770027161, "cost2_max": -97.72167606811905, "cost1_mean": 185.79886520085776, "outflow_rate_mean": 954.6682619461885, "system_level_velocity_mean": 15.293672168473133}}
{"sampler_perf": {"mean_inference_ms": 7.447094909023843, "mean_processing_ms": 10.899899813068979, "mean_env_wait_ms": 133.0315781858964}, "policy_reward_mean": {}, "time_since_restore": 8285.660051822662, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 8285.660051822662, "episodes_total": 1482, "episode_reward_max": 341.9078341089189, "episode_reward_mean": 285.29936443838443, "episode_reward_min": 226.78807993917144, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.75690698623657, "timestamp": 1559272590, "episode_len_mean": 325.0, "iterations_since_restore": 64, "training_iteration": 64, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbe18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-16-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.6762489285998, "outflow_rate_min": 880.911060972671, "system_level_velocity_max": 17.23556795853681, "cost2_min": -127.23508547141267, "system_level_velocity_min": 13.420845213948219, "cost1_min": 165.88639554492414, "cost1_max": 205.7694503935775, "cost2_mean": -110.00890943670314, "discrim_loss": 0.6312929391860962, "cost2_max": -98.09013247744511, "cost1_mean": 189.36965170937097, "outflow_rate_mean": 969.7501959781478, "system_level_velocity_mean": 15.594535909420125}}
{"sampler_perf": {"mean_inference_ms": 7.4442344831815825, "mean_processing_ms": 10.887780832687843, "mean_env_wait_ms": 133.0149550035768}, "policy_reward_mean": {}, "time_since_restore": 8413.392554998398, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 8413.392554998398, "episodes_total": 1505, "episode_reward_max": 308.11122654005885, "episode_reward_mean": 245.11436115374596, "episode_reward_min": 197.6552536932577, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.73250317573547, "timestamp": 1559272718, "episode_len_mean": 325.0, "iterations_since_restore": 65, "training_iteration": 65, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-18-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1030.6882849862914, "outflow_rate_min": 749.7292485405596, "system_level_velocity_max": 16.988919806373193, "cost2_min": -129.44497133278125, "system_level_velocity_min": 11.341919977380966, "cost1_min": 138.83856834476904, "cost1_max": 204.1743764104114, "cost2_mean": -108.0599714802289, "discrim_loss": 0.6204025149345398, "cost2_max": -97.43335679617297, "cost1_mean": 189.30841216683368, "outflow_rate_mean": 970.3028718959107, "system_level_velocity_mean": 15.644572867857157}}
{"sampler_perf": {"mean_inference_ms": 7.458037462733674, "mean_processing_ms": 10.93073874694531, "mean_env_wait_ms": 133.0798439497813}, "policy_reward_mean": {}, "time_since_restore": 8538.710295915604, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 8538.710295915604, "episodes_total": 1530, "episode_reward_max": 250.12780700350413, "episode_reward_mean": 206.4490042220149, "episode_reward_min": 177.95600272755837, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.31774091720581, "timestamp": 1559272843, "episode_len_mean": 325.0, "iterations_since_restore": 66, "training_iteration": 66, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-20-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1032.4409680308527, "outflow_rate_min": 879.4148240717058, "system_level_velocity_max": 16.94881347280246, "cost2_min": -122.68695665363774, "system_level_velocity_min": 13.521487475019379, "cost1_min": 166.48867749061947, "cost1_max": 202.7499570557719, "cost2_mean": -109.20067341611724, "discrim_loss": 0.6063339710235596, "cost2_max": -95.44103092123729, "cost1_mean": 186.30804522749924, "outflow_rate_mean": 956.9775120948968, "system_level_velocity_mean": 15.33059968217562}}
{"sampler_perf": {"mean_inference_ms": 7.449886245691101, "mean_processing_ms": 10.907483441291292, "mean_env_wait_ms": 132.85787410277123}, "policy_reward_mean": {}, "time_since_restore": 8668.935351371765, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 8668.935351371765, "episodes_total": 1552, "episode_reward_max": 254.59908009006176, "episode_reward_mean": 217.38407495236078, "episode_reward_min": 175.07224241853692, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.2250554561615, "timestamp": 1559272973, "episode_len_mean": 325.0, "iterations_since_restore": 67, "training_iteration": 67, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ee18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-22-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1028.9703944114767, "outflow_rate_min": 841.7111986300256, "system_level_velocity_max": 17.00897591823671, "cost2_min": -121.85656016845904, "system_level_velocity_min": 12.89864254741479, "cost1_min": 158.43035556858348, "cost1_max": 203.545371877521, "cost2_mean": -105.26905661949773, "discrim_loss": 0.6706113815307617, "cost2_max": -94.5151402152751, "cost1_mean": 187.85928024628035, "outflow_rate_mean": 966.3290338325584, "system_level_velocity_mean": 15.539881119388543}}
{"sampler_perf": {"mean_inference_ms": 7.456751340595064, "mean_processing_ms": 10.88749186220979, "mean_env_wait_ms": 132.9377859363962}, "policy_reward_mean": {}, "time_since_restore": 8798.248893499374, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 8798.248893499374, "episodes_total": 1572, "episode_reward_max": 311.4817406387883, "episode_reward_mean": 251.9085166959805, "episode_reward_min": 186.57726873783395, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.31354212760925, "timestamp": 1559273103, "episode_len_mean": 325.0, "iterations_since_restore": 68, "training_iteration": 68, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303621e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303620d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-25-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.1964769688443, "outflow_rate_min": 821.8294941314999, "system_level_velocity_max": 17.11715272017848, "cost2_min": -125.37366491392174, "system_level_velocity_min": 12.492002970076626, "cost1_min": 151.61666841971171, "cost1_max": 203.16358299801553, "cost2_mean": -104.32719832610982, "discrim_loss": 0.6582651138305664, "cost2_max": -93.47254815536547, "cost1_mean": 188.98644315510495, "outflow_rate_mean": 972.6033843528279, "system_level_velocity_mean": 15.654074320109919}}
{"sampler_perf": {"mean_inference_ms": 7.459370955650519, "mean_processing_ms": 10.915945896634046, "mean_env_wait_ms": 133.00595567629165}, "policy_reward_mean": {}, "time_since_restore": 8927.426483392715, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 27, "time_total_s": 8927.426483392715, "episodes_total": 1599, "episode_reward_max": 351.3210077993572, "episode_reward_mean": 275.7665689004072, "episode_reward_min": 216.84113148460165, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.17758989334106, "timestamp": 1559273232, "episode_len_mean": 325.0, "iterations_since_restore": 69, "training_iteration": 69, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-27-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.5709957412728, "outflow_rate_min": 884.1295687308882, "system_level_velocity_max": 17.06701776738801, "cost2_min": -119.00907873656314, "system_level_velocity_min": 13.622691394880581, "cost1_min": 167.1762024887326, "cost1_max": 202.8136498001408, "cost2_mean": -107.18998448967639, "discrim_loss": 0.6519478559494019, "cost2_max": -93.23743919197508, "cost1_mean": 183.24866970502117, "outflow_rate_mean": 947.4480809892274, "system_level_velocity_mean": 15.074311343792726}}
{"sampler_perf": {"mean_inference_ms": 7.459541273131401, "mean_processing_ms": 10.921820310431501, "mean_env_wait_ms": 132.71196305247284}, "policy_reward_mean": {}, "time_since_restore": 9046.706974744797, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 9046.706974744797, "episodes_total": 1622, "episode_reward_max": 328.0950940439943, "episode_reward_mean": 283.2914532405165, "episode_reward_min": 239.08600410353392, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.2804913520813, "timestamp": 1559273351, "episode_len_mean": 325.0, "iterations_since_restore": 70, "training_iteration": 70, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303620d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303621e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-29-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.1482400549048, "outflow_rate_min": 867.142836238374, "system_level_velocity_max": 17.11642144203705, "cost2_min": -113.23285482087859, "system_level_velocity_min": 13.048053214556466, "cost1_min": 160.62084775927258, "cost1_max": 202.90967099349913, "cost2_mean": -102.71460184771954, "discrim_loss": 0.6979677677154541, "cost2_max": -92.6883158765927, "cost1_mean": 184.09794316902196, "outflow_rate_mean": 956.1477789162268, "system_level_velocity_mean": 15.211230344607747}}
{"sampler_perf": {"mean_inference_ms": 7.462044068093443, "mean_processing_ms": 10.913929180195336, "mean_env_wait_ms": 132.712271856869}, "policy_reward_mean": {}, "time_since_restore": 9166.707441806793, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 9166.707441806793, "episodes_total": 1642, "episode_reward_max": 292.8634375575348, "episode_reward_mean": 244.04092557348048, "episode_reward_min": 199.88356816675514, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.00046706199646, "timestamp": 1559273471, "episode_len_mean": 325.0, "iterations_since_restore": 71, "training_iteration": 71, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-31-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.9698094551336, "outflow_rate_min": 896.8441392043715, "system_level_velocity_max": 16.98368905345443, "cost2_min": -109.7036589503771, "system_level_velocity_min": 13.898551578203913, "cost1_min": 169.4755832328731, "cost1_max": 202.86779886617126, "cost2_mean": -99.44380202166333, "discrim_loss": 0.6440798044204712, "cost2_max": -90.09571675396795, "cost1_mean": 187.14955880404267, "outflow_rate_mean": 968.4869613082926, "system_level_velocity_mean": 15.53642008604875}}
{"sampler_perf": {"mean_inference_ms": 7.4599984558583925, "mean_processing_ms": 10.925413448294028, "mean_env_wait_ms": 132.7322255618943}, "policy_reward_mean": {}, "time_since_restore": 9298.919650554657, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 9298.919650554657, "episodes_total": 1666, "episode_reward_max": 379.06878184794914, "episode_reward_mean": 258.9586075094497, "episode_reward_min": 186.89428652252536, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.21220874786377, "timestamp": 1559273604, "episode_len_mean": 325.0, "iterations_since_restore": 72, "training_iteration": 72, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bba60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-33-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.3995618306437, "outflow_rate_min": 772.8927436979039, "system_level_velocity_max": 17.019450491609017, "cost2_min": -118.71880708796452, "system_level_velocity_min": 11.419855199264235, "cost1_min": 137.7150530180133, "cost1_max": 202.7357329642807, "cost2_mean": -98.54231825760303, "discrim_loss": 0.7922487854957581, "cost2_max": -90.48883493362214, "cost1_mean": 175.12893214421774, "outflow_rate_mean": 922.1485098547588, "system_level_velocity_mean": 14.494715591383681}}
{"sampler_perf": {"mean_inference_ms": 7.471526105123768, "mean_processing_ms": 10.957441824289988, "mean_env_wait_ms": 132.7414401079935}, "policy_reward_mean": {}, "time_since_restore": 9422.092422962189, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 9422.092422962189, "episodes_total": 1691, "episode_reward_max": 379.7478347234428, "episode_reward_mean": 278.900135753036, "episode_reward_min": 186.55160104297101, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.17277240753174, "timestamp": 1559273727, "episode_len_mean": 325.0, "iterations_since_restore": 73, "training_iteration": 73, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-35-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1026.7985773096386, "outflow_rate_min": 855.8069949657755, "system_level_velocity_max": 16.93857832086947, "cost2_min": -103.76262469388482, "system_level_velocity_min": 13.006692449899129, "cost1_min": 157.4304982263329, "cost1_max": 200.38918812378608, "cost2_mean": -97.18851444658505, "discrim_loss": 0.8034836053848267, "cost2_max": -89.64776892758977, "cost1_mean": 177.35913004595156, "outflow_rate_mean": 932.5302618655996, "system_level_velocity_mean": 14.680739040446026}}
{"sampler_perf": {"mean_inference_ms": 7.4703048922639175, "mean_processing_ms": 10.942380020407926, "mean_env_wait_ms": 132.47977576558114}, "policy_reward_mean": {}, "time_since_restore": 9538.958393335342, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 9538.958393335342, "episodes_total": 1712, "episode_reward_max": 583.5209852796979, "episode_reward_mean": 413.6123645203562, "episode_reward_min": 267.2817333927378, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.86597037315369, "timestamp": 1559273844, "episode_len_mean": 325.0, "iterations_since_restore": 74, "training_iteration": 74, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303622f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-37-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1022.0931820471673, "outflow_rate_min": 790.0261227284309, "system_level_velocity_max": 16.88803293053318, "cost2_min": -103.47328441590629, "system_level_velocity_min": 11.647069903329145, "cost1_min": 140.38239457126195, "cost1_max": 199.24931056234905, "cost2_mean": -88.85607232861207, "discrim_loss": 0.8795022964477539, "cost2_max": -80.72445109822196, "cost1_mean": 174.75068231369286, "outflow_rate_mean": 927.5650984489445, "system_level_velocity_mean": 14.529624270757116}}
{"sampler_perf": {"mean_inference_ms": 7.468622095698626, "mean_processing_ms": 10.94739366558426, "mean_env_wait_ms": 132.50963866132062}, "policy_reward_mean": {}, "time_since_restore": 9657.335020065308, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 9657.335020065308, "episodes_total": 1735, "episode_reward_max": 419.4348288299516, "episode_reward_mean": 334.7031471048097, "episode_reward_min": 269.03527204319835, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.37662672996521, "timestamp": 1559273962, "episode_len_mean": 324.2608695652174, "iterations_since_restore": 75, "training_iteration": 75, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-39-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1026.4199732470709, "outflow_rate_min": 876.5758070934396, "system_level_velocity_max": 17.006637159240718, "cost2_min": -95.93981144789711, "system_level_velocity_min": 13.080515019534264, "cost1_min": 159.04471115763545, "cost1_max": 200.6008271556875, "cost2_mean": -88.91826303071632, "discrim_loss": 0.8766205906867981, "cost2_max": -84.42528591258588, "cost1_mean": 184.62943100986973, "outflow_rate_mean": 967.8089796916046, "system_level_velocity_mean": 15.50355020827041}}
{"sampler_perf": {"mean_inference_ms": 7.473231035837198, "mean_processing_ms": 10.978685065398524, "mean_env_wait_ms": 132.3578740485164}, "policy_reward_mean": {}, "time_since_restore": 9769.453838348389, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 9769.453838348389, "episodes_total": 1761, "episode_reward_max": 491.6569116753526, "episode_reward_mean": 321.54234325308175, "episode_reward_min": 215.5810006679967, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.11881828308105, "timestamp": 1559274074, "episode_len_mean": 325.0, "iterations_since_restore": 76, "training_iteration": 76, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-41-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1019.4900949801944, "outflow_rate_min": 779.1431123916637, "system_level_velocity_max": 16.884364719373238, "cost2_min": -94.71534961638285, "system_level_velocity_min": 11.560200065791477, "cost1_min": 139.80370782613602, "cost1_max": 199.0567587370614, "cost2_mean": -87.71041123946091, "discrim_loss": 0.8301257491111755, "cost2_max": -79.41774593306354, "cost1_mean": 177.48712966087217, "outflow_rate_mean": 938.5623062681706, "system_level_velocity_mean": 14.844294428270624}}
{"sampler_perf": {"mean_inference_ms": 7.47230226102452, "mean_processing_ms": 10.965916949300306, "mean_env_wait_ms": 132.05529281092882}, "policy_reward_mean": {}, "time_since_restore": 9883.175862789154, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 9883.175862789154, "episodes_total": 1782, "episode_reward_max": 586.7531814064132, "episode_reward_mean": 305.3623904130405, "episode_reward_min": 201.82401156332344, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.72202444076538, "timestamp": 1559274188, "episode_len_mean": 325.0, "iterations_since_restore": 77, "training_iteration": 77, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303622f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-43-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.0880539624843, "outflow_rate_min": 788.7126078711456, "system_level_velocity_max": 16.842582504734093, "cost2_min": -95.1495795275891, "system_level_velocity_min": 11.861531113632816, "cost1_min": 142.3091828907731, "cost1_max": 198.4913074237736, "cost2_mean": -87.44710044332695, "discrim_loss": 0.9493230581283569, "cost2_max": -77.55157497865933, "cost1_mean": 176.85641796667088, "outflow_rate_mean": 936.9560165198789, "system_level_velocity_mean": 14.79349705019138}}
{"sampler_perf": {"mean_inference_ms": 7.468799310465733, "mean_processing_ms": 10.958187302036354, "mean_env_wait_ms": 131.98245112472966}, "policy_reward_mean": {}, "time_since_restore": 10001.719594240189, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 10001.719594240189, "episodes_total": 1805, "episode_reward_max": 470.0401608152315, "episode_reward_mean": 317.2614790082013, "episode_reward_min": 199.05153140053153, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.54373145103455, "timestamp": 1559274307, "episode_len_mean": 325.0, "iterations_since_restore": 78, "training_iteration": 78, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-45-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1023.5669367345085, "outflow_rate_min": 857.0453395234757, "system_level_velocity_max": 17.01371287760521, "cost2_min": -93.61282825002655, "system_level_velocity_min": 13.068237823121766, "cost1_min": 158.53425679642112, "cost1_max": 199.59375835843852, "cost2_mean": -87.4146001407109, "discrim_loss": 0.9354181289672852, "cost2_max": -80.04790690456392, "cost1_mean": 180.45629539400718, "outflow_rate_mean": 950.1175095092085, "system_level_velocity_mean": 15.122215032969489}}
{"sampler_perf": {"mean_inference_ms": 7.477770851536868, "mean_processing_ms": 10.987060790432068, "mean_env_wait_ms": 131.90776742300793}, "policy_reward_mean": {}, "time_since_restore": 10121.948999643326, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 10121.948999643326, "episodes_total": 1830, "episode_reward_max": 515.5261622975813, "episode_reward_mean": 356.2886490050377, "episode_reward_min": 258.97382284142077, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.2294054031372, "timestamp": 1559274427, "episode_len_mean": 325.0, "iterations_since_restore": 79, "training_iteration": 79, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbb70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-47-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1030.3405143897683, "outflow_rate_min": 782.8452489053892, "system_level_velocity_max": 17.1047701553695, "cost2_min": -90.97969088391059, "system_level_velocity_min": 11.652714698539645, "cost1_min": 139.94733213977963, "cost1_max": 201.4284882430923, "cost2_mean": -86.47099249294459, "discrim_loss": 0.8698489665985107, "cost2_max": -76.54347040514838, "cost1_mean": 183.9692675602569, "outflow_rate_mean": 962.6182626223602, "system_level_velocity_mean": 15.46988845464914}}
{"sampler_perf": {"mean_inference_ms": 7.470458910319969, "mean_processing_ms": 10.979313470608366, "mean_env_wait_ms": 131.62300675592812}, "policy_reward_mean": {}, "time_since_restore": 10237.047995328903, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 10237.047995328903, "episodes_total": 1853, "episode_reward_max": 599.3536701118574, "episode_reward_mean": 357.26276700749344, "episode_reward_min": 35.053665801882744, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.09899568557739, "timestamp": 1559274542, "episode_len_mean": 307.2608695652174, "iterations_since_restore": 80, "training_iteration": 80, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-49-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.1260893494657, "outflow_rate_min": 514.5009007334598, "system_level_velocity_max": 18.642878542385013, "cost2_min": -91.10942913568044, "system_level_velocity_min": 12.59271938892039, "cost1_min": 22.87995238910796, "cost1_max": 201.3257588958962, "cost2_mean": -83.37219424171427, "discrim_loss": 0.9083549976348877, "cost2_max": -22.885463362867696, "cost1_mean": 176.32818689759387, "outflow_rate_mean": 944.6947773374854, "system_level_velocity_mean": 15.81984782834853}}
{"sampler_perf": {"mean_inference_ms": 7.469823303105862, "mean_processing_ms": 10.968618759023661, "mean_env_wait_ms": 131.48571867971933}, "policy_reward_mean": {}, "time_since_restore": 10345.18367266655, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 10345.18367266655, "episodes_total": 1873, "episode_reward_max": 511.59436876885593, "episode_reward_mean": 382.5480557096016, "episode_reward_min": 248.05590472370386, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.13567733764648, "timestamp": 1559274651, "episode_len_mean": 325.0, "iterations_since_restore": 81, "training_iteration": 81, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303648c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303647b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-50-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.2931484465707, "outflow_rate_min": 809.691970453771, "system_level_velocity_max": 17.223792330122052, "cost2_min": -91.52332839129522, "system_level_velocity_min": 11.918418848944368, "cost1_min": 144.3680350037396, "cost1_max": 202.3246323199803, "cost2_mean": -85.86032306731592, "discrim_loss": 0.8949581384658813, "cost2_max": -78.40135049407363, "cost1_mean": 173.93957153695897, "outflow_rate_mean": 924.4564472488519, "system_level_velocity_mean": 14.566984900653765}}
{"sampler_perf": {"mean_inference_ms": 7.473975843869605, "mean_processing_ms": 10.997930757589717, "mean_env_wait_ms": 131.4123020728653}, "policy_reward_mean": {}, "time_since_restore": 10456.93213891983, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 28, "time_total_s": 10456.93213891983, "episodes_total": 1901, "episode_reward_max": 525.427763462998, "episode_reward_mean": 329.242179987528, "episode_reward_min": 219.58973739668727, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.74846625328064, "timestamp": 1559274762, "episode_len_mean": 325.0, "iterations_since_restore": 82, "training_iteration": 82, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-52-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.7681592912047, "outflow_rate_min": 786.8000281102046, "system_level_velocity_max": 17.215302750462214, "cost2_min": -90.68792286837794, "system_level_velocity_min": 11.659485463775626, "cost1_min": 139.02946217183433, "cost1_max": 202.1753272637381, "cost2_mean": -82.91055715299659, "discrim_loss": 0.9558863639831543, "cost2_max": -71.83488083824984, "cost1_mean": 176.49404914699159, "outflow_rate_mean": 932.9329740583443, "system_level_velocity_mean": 14.830681715239502}}
{"sampler_perf": {"mean_inference_ms": 7.472135025738852, "mean_processing_ms": 10.994913290052107, "mean_env_wait_ms": 131.18926616886586}, "policy_reward_mean": {}, "time_since_restore": 10569.68609881401, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 10569.68609881401, "episodes_total": 1923, "episode_reward_max": 488.629415263189, "episode_reward_mean": 317.01010565561324, "episode_reward_min": 210.68683384358883, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.7539598941803, "timestamp": 1559274876, "episode_len_mean": 325.0, "iterations_since_restore": 83, "training_iteration": 83, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbd08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-54-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1030.9223220407382, "outflow_rate_min": 782.6169504696643, "system_level_velocity_max": 17.247731620579458, "cost2_min": -87.25133980207755, "system_level_velocity_min": 11.703151224180255, "cost1_min": 138.9478093759759, "cost1_max": 201.90380434211164, "cost2_mean": -81.89178827117063, "discrim_loss": 0.960451602935791, "cost2_max": -70.81662742082125, "cost1_mean": 172.97743165652835, "outflow_rate_mean": 919.524611110288, "system_level_velocity_mean": 14.49846505203518}}
{"sampler_perf": {"mean_inference_ms": 7.476749377175667, "mean_processing_ms": 10.978680614728711, "mean_env_wait_ms": 131.15600803061477}, "policy_reward_mean": {}, "time_since_restore": 10682.854764699936, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 10682.854764699936, "episodes_total": 1943, "episode_reward_max": 418.721492620185, "episode_reward_mean": 339.1841299314401, "episode_reward_min": 248.39141569845378, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.1686658859253, "timestamp": 1559274990, "episode_len_mean": 325.0, "iterations_since_restore": 84, "training_iteration": 84, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-56-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1024.1334648843776, "outflow_rate_min": 864.7664153916897, "system_level_velocity_max": 17.16637800868015, "cost2_min": -87.73161731267703, "system_level_velocity_min": 13.14126163265648, "cost1_min": 158.60046969187846, "cost1_max": 201.17625603282744, "cost2_mean": -82.21743243138224, "discrim_loss": 0.9279989004135132, "cost2_max": -73.88611007203377, "cost1_mean": 176.38387522723463, "outflow_rate_mean": 932.2625793837472, "system_level_velocity_mean": 14.826312632397958}}
{"sampler_perf": {"mean_inference_ms": 7.473284898538242, "mean_processing_ms": 10.990778835866463, "mean_env_wait_ms": 130.92643893729363}, "policy_reward_mean": {}, "time_since_restore": 10790.770459890366, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 10790.770459890366, "episodes_total": 1968, "episode_reward_max": 515.1471485290676, "episode_reward_mean": 377.22860139630734, "episode_reward_min": 265.0025946497917, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.91569519042969, "timestamp": 1559275098, "episode_len_mean": 325.0, "iterations_since_restore": 85, "training_iteration": 85, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303628c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303627b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-58-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1026.0031314407026, "outflow_rate_min": 809.6494107666119, "system_level_velocity_max": 17.301317441655087, "cost2_min": -90.1546848936948, "system_level_velocity_min": 12.206437751208703, "cost1_min": 145.93134724946066, "cost1_max": 202.2670790692997, "cost2_mean": -81.0714030745786, "discrim_loss": 0.9562586545944214, "cost2_max": -71.79552257601375, "cost1_mean": 176.29731722698816, "outflow_rate_mean": 929.234232082782, "system_level_velocity_mean": 14.841485138458138}}
{"sampler_perf": {"mean_inference_ms": 7.475157961050903, "mean_processing_ms": 10.998358804426784, "mean_env_wait_ms": 130.805067639751}, "policy_reward_mean": {}, "time_since_restore": 10896.68671131134, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 10896.68671131134, "episodes_total": 1992, "episode_reward_max": 476.4942797720432, "episode_reward_mean": 348.6904915656487, "episode_reward_min": 289.72892362996936, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 105.91625142097473, "timestamp": 1559275204, "episode_len_mean": 325.0, "iterations_since_restore": 86, "training_iteration": 86, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303622f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-00-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.6908712324048, "outflow_rate_min": 839.9629670812793, "system_level_velocity_max": 17.2006932818388, "cost2_min": -87.2892255301796, "system_level_velocity_min": 13.058405347882676, "cost1_min": 156.75875397089, "cost1_max": 201.73763550643486, "cost2_mean": -81.02218172152841, "discrim_loss": 0.8796327710151672, "cost2_max": -69.46788917780344, "cost1_mean": 185.00255217216747, "outflow_rate_mean": 963.3559493555946, "system_level_velocity_mean": 15.655957967619797}}
{"sampler_perf": {"mean_inference_ms": 7.472324697193373, "mean_processing_ms": 10.983459012559727, "mean_env_wait_ms": 130.45200961201195}, "policy_reward_mean": {}, "time_since_restore": 11004.978615760803, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 11004.978615760803, "episodes_total": 2013, "episode_reward_max": 402.2030195388943, "episode_reward_mean": 348.4581941659784, "episode_reward_min": 280.5818595588207, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.29190444946289, "timestamp": 1559275312, "episode_len_mean": 325.0, "iterations_since_restore": 87, "training_iteration": 87, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbf28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-01-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1025.829758465761, "outflow_rate_min": 843.5530030135661, "system_level_velocity_max": 17.150830106987822, "cost2_min": -85.78736920509904, "system_level_velocity_min": 13.094132211551932, "cost1_min": 157.04891792715006, "cost1_max": 200.11763958213584, "cost2_mean": -79.48792652975553, "discrim_loss": 0.9208534955978394, "cost2_max": -70.0820357978481, "cost1_mean": 177.7591275546247, "outflow_rate_mean": 935.2390566199031, "system_level_velocity_mean": 14.99650591026363}}
{"sampler_perf": {"mean_inference_ms": 7.467851533074654, "mean_processing_ms": 10.973157616243645, "mean_env_wait_ms": 130.28366018246732}, "policy_reward_mean": {}, "time_since_restore": 11114.943087816238, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 11114.943087816238, "episodes_total": 2036, "episode_reward_max": 407.895549364388, "episode_reward_mean": 322.1261049007754, "episode_reward_min": 267.57364206016064, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.96447205543518, "timestamp": 1559275422, "episode_len_mean": 325.0, "iterations_since_restore": 88, "training_iteration": 88, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-03-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1025.6841334671667, "outflow_rate_min": 836.4452307443819, "system_level_velocity_max": 17.184829744230488, "cost2_min": -87.7792368294817, "system_level_velocity_min": 12.8173659429755, "cost1_min": 153.11435471224138, "cost1_max": 200.94521378129477, "cost2_mean": -81.10076449986926, "discrim_loss": 0.9150760173797607, "cost2_max": -71.95702540587628, "cost1_mean": 184.95952690734833, "outflow_rate_mean": 963.4160430655975, "system_level_velocity_mean": 15.683923981463678}}
{"sampler_perf": {"mean_inference_ms": 7.474147035701923, "mean_processing_ms": 11.004239182314944, "mean_env_wait_ms": 130.35743331698941}, "policy_reward_mean": {}, "time_since_restore": 11230.230733156204, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 11230.230733156204, "episodes_total": 2062, "episode_reward_max": 379.5584692247212, "episode_reward_mean": 323.5430796723813, "episode_reward_min": 279.8719335272908, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.28764533996582, "timestamp": 1559275537, "episode_len_mean": 325.0, "iterations_since_restore": 89, "training_iteration": 89, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b48c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b47b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-05-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.2167153507316, "outflow_rate_min": 805.7228298217726, "system_level_velocity_max": 17.35363232592219, "cost2_min": -89.66074249940456, "system_level_velocity_min": 12.103852721647767, "cost1_min": 143.3883923751767, "cost1_max": 202.6926246378075, "cost2_mean": -82.86135909925416, "discrim_loss": 0.8698358535766602, "cost2_max": -70.9462746698616, "cost1_mean": 180.44969664057226, "outflow_rate_mean": 945.6601289142384, "system_level_velocity_mean": 15.200507346144805}}
{"sampler_perf": {"mean_inference_ms": 7.475344066321175, "mean_processing_ms": 10.989193795486843, "mean_env_wait_ms": 130.02871744479438}, "policy_reward_mean": {}, "time_since_restore": 11342.762449741364, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 11342.762449741364, "episodes_total": 2083, "episode_reward_max": 371.57107075303793, "episode_reward_mean": 331.9191273092514, "episode_reward_min": 284.38661006093025, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.5317165851593, "timestamp": 1559275650, "episode_len_mean": 325.0, "iterations_since_restore": 90, "training_iteration": 90, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-07-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.0979026179589, "outflow_rate_min": 836.1708936474001, "system_level_velocity_max": 17.387867487501985, "cost2_min": -90.11817915340563, "system_level_velocity_min": 12.799488872450214, "cost1_min": 153.16736280707852, "cost1_max": 203.71985337701335, "cost2_mean": -83.72499997659096, "discrim_loss": 0.8710328340530396, "cost2_max": -73.4533281669913, "cost1_mean": 184.9009475503369, "outflow_rate_mean": 964.0506409276439, "system_level_velocity_mean": 15.622489248501541}}
{"sampler_perf": {"mean_inference_ms": 7.469556130533542, "mean_processing_ms": 10.980258392826839, "mean_env_wait_ms": 129.86712845178286}, "policy_reward_mean": {}, "time_since_restore": 11454.565975904465, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 11454.565975904465, "episodes_total": 2106, "episode_reward_max": 408.0533439926803, "episode_reward_mean": 344.1393428867602, "episode_reward_min": 308.53956854343414, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.8035261631012, "timestamp": 1559275762, "episode_len_mean": 325.0, "iterations_since_restore": 91, "training_iteration": 91, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-09-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.5100394818533, "outflow_rate_min": 841.453849561209, "system_level_velocity_max": 17.35773345310511, "cost2_min": -87.08885417912158, "system_level_velocity_min": 12.988302894076831, "cost1_min": 156.16155978015132, "cost1_max": 203.19329115777214, "cost2_mean": -81.68459657592732, "discrim_loss": 0.8560697436332703, "cost2_max": -73.90017857986007, "cost1_mean": 181.93870828881884, "outflow_rate_mean": 950.1513835567478, "system_level_velocity_mean": 15.370759711106553}}
{"sampler_perf": {"mean_inference_ms": 7.474779210241496, "mean_processing_ms": 11.011719765524038, "mean_env_wait_ms": 129.83952427934548}, "policy_reward_mean": {}, "time_since_restore": 11562.25499844551, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 11562.25499844551, "episodes_total": 2131, "episode_reward_max": 426.842425968498, "episode_reward_mean": 351.2737141357362, "episode_reward_min": 305.0388149470091, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.68902254104614, "timestamp": 1559275870, "episode_len_mean": 325.0, "iterations_since_restore": 92, "training_iteration": 92, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-11-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.2185188575647, "outflow_rate_min": 817.3063130387828, "system_level_velocity_max": 17.37522888440425, "cost2_min": -88.46575434965183, "system_level_velocity_min": 12.748566025817345, "cost1_min": 150.44051896819917, "cost1_max": 202.82180893757894, "cost2_mean": -81.55893688749079, "discrim_loss": 0.8821823596954346, "cost2_max": -74.02649608446133, "cost1_mean": 181.18684105265106, "outflow_rate_mean": 947.8502723714778, "system_level_velocity_mean": 15.335695768780342}}
{"sampler_perf": {"mean_inference_ms": 7.469826906044008, "mean_processing_ms": 10.994118611427313, "mean_env_wait_ms": 129.47575365075045}, "policy_reward_mean": {}, "time_since_restore": 11671.208460092545, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 11671.208460092545, "episodes_total": 2153, "episode_reward_max": 397.95697317644954, "episode_reward_mean": 339.22873870422006, "episode_reward_min": 306.4220258593559, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.95346164703369, "timestamp": 1559275979, "episode_len_mean": 325.0, "iterations_since_restore": 93, "training_iteration": 93, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b41e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b40d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-12-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.9120735664733, "outflow_rate_min": 801.1879003793255, "system_level_velocity_max": 17.30734645337928, "cost2_min": -87.58230980418169, "system_level_velocity_min": 12.126757395317119, "cost1_min": 143.38675875352158, "cost1_max": 202.40160564495704, "cost2_mean": -81.27513816925224, "discrim_loss": 0.8645123243331909, "cost2_max": -67.36285254155442, "cost1_mean": 180.23174959784163, "outflow_rate_mean": 942.904704368644, "system_level_velocity_mean": 15.224184418075385}}
{"sampler_perf": {"mean_inference_ms": 7.4737921541371035, "mean_processing_ms": 10.990797876595494, "mean_env_wait_ms": 129.3937740504189}, "policy_reward_mean": {}, "time_since_restore": 11783.598169326782, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 11783.598169326782, "episodes_total": 2174, "episode_reward_max": 391.0786864608526, "episode_reward_mean": 327.8178763573191, "episode_reward_min": 289.6516776531935, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.38970923423767, "timestamp": 1559276091, "episode_len_mean": 322.3333333333333, "iterations_since_restore": 94, "training_iteration": 94, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-14-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1031.1782906289145, "outflow_rate_min": 803.4496233666536, "system_level_velocity_max": 17.31489055929746, "cost2_min": -87.6995942780794, "system_level_velocity_min": 12.10650892485725, "cost1_min": 145.668073477692, "cost1_max": 202.8336374546796, "cost2_mean": -81.40613074091792, "discrim_loss": 0.8424244523048401, "cost2_max": -70.29003335358226, "cost1_mean": 179.98785499819755, "outflow_rate_mean": 943.796056845755, "system_level_velocity_mean": 15.306366340398815}}
{"sampler_perf": {"mean_inference_ms": 7.4757264169281825, "mean_processing_ms": 11.006702809726576, "mean_env_wait_ms": 129.34797580565657}, "policy_reward_mean": {}, "time_since_restore": 11896.318830251694, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 27, "time_total_s": 11896.318830251694, "episodes_total": 2201, "episode_reward_max": 383.34452118724585, "episode_reward_mean": 329.7326895898829, "episode_reward_min": 290.19170735776424, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.7206609249115, "timestamp": 1559276204, "episode_len_mean": 325.0, "iterations_since_restore": 95, "training_iteration": 95, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-16-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.1675286141883, "outflow_rate_min": 794.2112224957489, "system_level_velocity_max": 17.321653612461446, "cost2_min": -89.71477225279816, "system_level_velocity_min": 11.729774194787243, "cost1_min": 137.28050365301, "cost1_max": 202.64688247887477, "cost2_mean": -79.66786653160078, "discrim_loss": 0.8593681454658508, "cost2_max": -69.32425421922237, "cost1_mean": 173.96539838296871, "outflow_rate_mean": 919.5501539910962, "system_level_velocity_mean": 14.663216192582562}}
{"sampler_perf": {"mean_inference_ms": 7.475371420599365, "mean_processing_ms": 11.002201071641785, "mean_env_wait_ms": 129.10102068197784}, "policy_reward_mean": {}, "time_since_restore": 12005.856959819794, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 12005.856959819794, "episodes_total": 2223, "episode_reward_max": 356.7355519719422, "episode_reward_mean": 316.448136638088, "episode_reward_min": 285.08569176495075, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.53812956809998, "timestamp": 1559276314, "episode_len_mean": 325.0, "iterations_since_restore": 96, "training_iteration": 96, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-18-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.2714023585265, "outflow_rate_min": 787.6763181290952, "system_level_velocity_max": 17.52100252222845, "cost2_min": -89.90054723000146, "system_level_velocity_min": 11.739636531092755, "cost1_min": 138.0136123841436, "cost1_max": 205.01811439748235, "cost2_mean": -83.82551529053099, "discrim_loss": 0.8237015008926392, "cost2_max": -70.49561123353895, "cost1_mean": 181.00569334080282, "outflow_rate_mean": 948.8488611025448, "system_level_velocity_mean": 15.277313177266642}}
{"sampler_perf": {"mean_inference_ms": 7.474967268700896, "mean_processing_ms": 10.995203986518371, "mean_env_wait_ms": 129.07174944908758}, "policy_reward_mean": {}, "time_since_restore": 12119.77688574791, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 12119.77688574791, "episodes_total": 2243, "episode_reward_max": 384.4340426046401, "episode_reward_mean": 321.0063388674054, "episode_reward_min": 289.65318001806736, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.91992592811584, "timestamp": 1559276428, "episode_len_mean": 324.0, "iterations_since_restore": 97, "training_iteration": 97, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79304250d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-20-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.5436192179757, "outflow_rate_min": 773.0156137825772, "system_level_velocity_max": 17.65912091398216, "cost2_min": -92.8496900670545, "system_level_velocity_min": 11.584163619229555, "cost1_min": 137.18316403933284, "cost1_max": 206.48880279945286, "cost2_mean": -86.51675598831557, "discrim_loss": 0.8381349444389343, "cost2_max": -67.6772139892651, "cost1_mean": 183.99653198591918, "outflow_rate_mean": 957.9356847220782, "system_level_velocity_mean": 15.579503112138772}}
{"sampler_perf": {"mean_inference_ms": 7.474301921512166, "mean_processing_ms": 11.002882365682442, "mean_env_wait_ms": 128.95284490950834}, "policy_reward_mean": {}, "time_since_restore": 12235.640243053436, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 12235.640243053436, "episodes_total": 2268, "episode_reward_max": 402.6904286146164, "episode_reward_mean": 336.9334647862613, "episode_reward_min": 308.45870393514633, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.86335730552673, "timestamp": 1559276544, "episode_len_mean": 325.0, "iterations_since_restore": 98, "training_iteration": 98, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303248c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-22-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.0881657636396, "outflow_rate_min": 840.7530522063461, "system_level_velocity_max": 17.690160206526663, "cost2_min": -93.19601766821916, "system_level_velocity_min": 12.732017697134685, "cost1_min": 153.5083642780256, "cost1_max": 207.36891333552632, "cost2_mean": -87.03500787263388, "discrim_loss": 0.8336373567581177, "cost2_max": -78.5734777546524, "cost1_mean": 181.9165056650121, "outflow_rate_mean": 949.4863054904231, "system_level_velocity_mean": 15.248331005856063}}
{"sampler_perf": {"mean_inference_ms": 7.482342218288727, "mean_processing_ms": 11.026025880390758, "mean_env_wait_ms": 128.91589987394235}, "policy_reward_mean": {}, "time_since_restore": 12347.814285755157, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 12347.814285755157, "episodes_total": 2294, "episode_reward_max": 382.12584787607193, "episode_reward_mean": 325.6869594846637, "episode_reward_min": 39.68477942049503, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.17404270172119, "timestamp": 1559276658, "episode_len_mean": 313.2692307692308, "iterations_since_restore": 99, "training_iteration": 99, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-24-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.8557803428503, "outflow_rate_min": 503.9611403287334, "system_level_velocity_max": 17.70551857652959, "cost2_min": -91.98946201512521, "system_level_velocity_min": 12.19552940214208, "cost1_min": 25.412653089310442, "cost1_max": 205.90001646596943, "cost2_mean": -83.90154649423314, "discrim_loss": 0.8095176815986633, "cost2_max": -24.066546296982708, "cost1_mean": 178.96994090744678, "outflow_rate_mean": 945.0252207118093, "system_level_velocity_mean": 15.717465991856667}}
{"sampler_perf": {"mean_inference_ms": 7.480768705704067, "mean_processing_ms": 11.016352710031027, "mean_env_wait_ms": 128.81463916114294}, "policy_reward_mean": {}, "time_since_restore": 12463.427952051163, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 12463.427952051163, "episodes_total": 2315, "episode_reward_max": 415.1426472067833, "episode_reward_mean": 322.021746723957, "episode_reward_min": 31.560960471630096, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.61366629600525, "timestamp": 1559276774, "episode_len_mean": 311.1904761904762, "iterations_since_restore": 100, "training_iteration": 100, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-26-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.3493603480283, "outflow_rate_min": 483.6443293231292, "system_level_velocity_max": 18.610901172470456, "cost2_min": -92.38922314619452, "system_level_velocity_min": 12.853921293689261, "cost1_min": 23.104570357840693, "cost1_max": 206.13925671389768, "cost2_mean": -83.38922171328362, "discrim_loss": 0.8155070543289185, "cost2_max": -23.872662512937016, "cost1_mean": 175.7279125591426, "outflow_rate_mean": 932.814005277414, "system_level_velocity_mean": 15.580469591239702}}
{"sampler_perf": {"mean_inference_ms": 7.4763452711511595, "mean_processing_ms": 11.001287229046456, "mean_env_wait_ms": 128.63295805475786}, "policy_reward_mean": {}, "time_since_restore": 12575.803387880325, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 12575.803387880325, "episodes_total": 2338, "episode_reward_max": 408.9936847873032, "episode_reward_mean": 329.66480467808634, "episode_reward_min": 292.84603905677795, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.3754358291626, "timestamp": 1559276886, "episode_len_mean": 325.0, "iterations_since_restore": 101, "training_iteration": 101, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdb70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd9d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bda60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-28-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.4296949505458, "outflow_rate_min": 769.5026513164346, "system_level_velocity_max": 17.75946213668567, "cost2_min": -92.45979577309555, "system_level_velocity_min": 11.524754711465814, "cost1_min": 136.79229715601468, "cost1_max": 208.02465754703633, "cost2_mean": -85.84114476471588, "discrim_loss": 0.796820878982544, "cost2_max": -68.88159755235819, "cost1_mean": 181.4707143799064, "outflow_rate_mean": 947.4225166691074, "system_level_velocity_mean": 15.269892032011425}}
{"sampler_perf": {"mean_inference_ms": 7.483776626532945, "mean_processing_ms": 11.032839824568468, "mean_env_wait_ms": 128.69014824069743}, "policy_reward_mean": {}, "time_since_restore": 12689.092560529709, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 12689.092560529709, "episodes_total": 2364, "episode_reward_max": 353.0611586421728, "episode_reward_mean": 312.74770385743335, "episode_reward_min": 287.845415443182, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.28917264938354, "timestamp": 1559277000, "episode_len_mean": 325.0, "iterations_since_restore": 102, "training_iteration": 102, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-30-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.8579515295835, "outflow_rate_min": 888.7592147301912, "system_level_velocity_max": 17.598820594794397, "cost2_min": -93.72559011056983, "system_level_velocity_min": 13.699767873287861, "cost1_min": 164.51013569285666, "cost1_max": 206.7300853788273, "cost2_mean": -88.99461181250847, "discrim_loss": 0.8074657917022705, "cost2_max": -79.28701927904922, "cost1_mean": 193.7985246724209, "outflow_rate_mean": 992.8729233342193, "system_level_velocity_mean": 16.34180135990959}}
{"sampler_perf": {"mean_inference_ms": 7.486710053369631, "mean_processing_ms": 11.019888973537014, "mean_env_wait_ms": 128.4427783514228}, "policy_reward_mean": {}, "time_since_restore": 12802.626841545105, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 12802.626841545105, "episodes_total": 2385, "episode_reward_max": 376.023810274899, "episode_reward_mean": 313.81700337270183, "episode_reward_min": 281.68074472248554, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.53428101539612, "timestamp": 1559277113, "episode_len_mean": 325.0, "iterations_since_restore": 103, "training_iteration": 103, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348bf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-31-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.6675891025325, "outflow_rate_min": 801.8050826000969, "system_level_velocity_max": 17.567420479956105, "cost2_min": -91.92174707334354, "system_level_velocity_min": 12.117848101527024, "cost1_min": 144.03402998793425, "cost1_max": 206.32622796613978, "cost2_mean": -85.87390369992455, "discrim_loss": 0.7915878295898438, "cost2_max": -70.63769627331703, "cost1_mean": 182.47970623594952, "outflow_rate_mean": 951.3726437561579, "system_level_velocity_mean": 15.336873465039647}}
{"sampler_perf": {"mean_inference_ms": 7.482852337588664, "mean_processing_ms": 11.012915817140623, "mean_env_wait_ms": 128.29720592457156}, "policy_reward_mean": {}, "time_since_restore": 12916.53018450737, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 12916.53018450737, "episodes_total": 2408, "episode_reward_max": 386.00494427233934, "episode_reward_mean": 302.287983674637, "episode_reward_min": 258.95063860714436, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.90334296226501, "timestamp": 1559277227, "episode_len_mean": 324.1304347826087, "iterations_since_restore": 104, "training_iteration": 104, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-33-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.58687185683, "outflow_rate_min": 841.1160913951475, "system_level_velocity_max": 17.779401325980373, "cost2_min": -93.16433293971046, "system_level_velocity_min": 12.619034950506553, "cost1_min": 150.9197565753394, "cost1_max": 208.19605083802827, "cost2_mean": -87.48399436225759, "discrim_loss": 0.7672446370124817, "cost2_max": -72.4899202066662, "cost1_mean": 188.11100407708483, "outflow_rate_mean": 971.5207414792042, "system_level_velocity_mean": 15.88335643966751}}
{"sampler_perf": {"mean_inference_ms": 7.495798026981109, "mean_processing_ms": 11.032450672703739, "mean_env_wait_ms": 128.3681669326327}, "policy_reward_mean": {}, "time_since_restore": 13027.877083063126, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 13027.877083063126, "episodes_total": 2432, "episode_reward_max": 376.935368116945, "episode_reward_mean": 289.8819807759719, "episode_reward_min": 254.561027020216, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.34689855575562, "timestamp": 1559277339, "episode_len_mean": 325.0, "iterations_since_restore": 105, "training_iteration": 105, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b87b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303659d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303658c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-35-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.4953925412995, "outflow_rate_min": 824.7483960985116, "system_level_velocity_max": 17.70476649390057, "cost2_min": -93.73200208594426, "system_level_velocity_min": 12.680312117258117, "cost1_min": 150.02340508963078, "cost1_max": 207.03406984845773, "cost2_mean": -87.37630354601039, "discrim_loss": 0.7638386487960815, "cost2_max": -73.7323452899574, "cost1_mean": 186.97943959599397, "outflow_rate_mean": 967.1856984883322, "system_level_velocity_mean": 15.747401207073326}}
{"sampler_perf": {"mean_inference_ms": 7.49270696690257, "mean_processing_ms": 11.040429305105201, "mean_env_wait_ms": 128.11345853633122}, "policy_reward_mean": {}, "time_since_restore": 13136.293781995773, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 13136.293781995773, "episodes_total": 2456, "episode_reward_max": 322.5373880416155, "episode_reward_mean": 274.4107065311012, "episode_reward_min": 20.80777135491371, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.4166989326477, "timestamp": 1559277447, "episode_len_mean": 312.5833333333333, "iterations_since_restore": 106, "training_iteration": 106, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303241e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-37-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.9118473865317, "outflow_rate_min": 444.6769763958757, "system_level_velocity_max": 17.77847820614806, "cost2_min": -92.92009778269981, "system_level_velocity_min": 13.334773112551769, "cost1_min": 18.03201454691058, "cost1_max": 207.41327342910807, "cost2_mean": -84.42348897479461, "discrim_loss": 0.7408838272094727, "cost2_max": -20.867785195943593, "cost1_mean": 180.35845537024895, "outflow_rate_mean": 946.6657095060106, "system_level_velocity_mean": 15.846671140800785}}
{"sampler_perf": {"mean_inference_ms": 7.493232805683774, "mean_processing_ms": 11.03052014518549, "mean_env_wait_ms": 127.99929883312424}, "policy_reward_mean": {}, "time_since_restore": 13246.686056613922, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 13246.686056613922, "episodes_total": 2478, "episode_reward_max": 345.57160706073046, "episode_reward_mean": 296.866734581047, "episode_reward_min": 197.7491875514388, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.3922746181488, "timestamp": 1559277558, "episode_len_mean": 320.22727272727275, "iterations_since_restore": 107, "training_iteration": 107, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ae400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ae378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ae2f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-39-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.106348740394, "outflow_rate_min": 782.6658946290003, "system_level_velocity_max": 17.469186422602547, "cost2_min": -91.5316862322517, "system_level_velocity_min": 13.06046563030204, "cost1_min": 120.25152673618288, "cost1_max": 204.84155802939577, "cost2_mean": -85.89138747982207, "discrim_loss": 0.779097318649292, "cost2_max": -69.76602461832023, "cost1_mean": 184.30317809503651, "outflow_rate_mean": 961.7574864001497, "system_level_velocity_mean": 15.736013310064537}}
{"sampler_perf": {"mean_inference_ms": 7.492481796840472, "mean_processing_ms": 11.012914016018263, "mean_env_wait_ms": 127.85151685583183}, "policy_reward_mean": {}, "time_since_restore": 13355.624615907669, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 13355.624615907669, "episodes_total": 2502, "episode_reward_max": 431.79136114101857, "episode_reward_mean": 320.0258322346878, "episode_reward_min": 261.0508856624365, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.93855929374695, "timestamp": 1559277667, "episode_len_mean": 324.25, "iterations_since_restore": 108, "training_iteration": 108, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-41-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.3683619109543, "outflow_rate_min": 775.8679562504454, "system_level_velocity_max": 17.487807536956776, "cost2_min": -90.99867033017199, "system_level_velocity_min": 11.504228019340257, "cost1_min": 135.11705884856278, "cost1_max": 204.58832482442514, "cost2_mean": -84.46964338280647, "discrim_loss": 0.7579971551895142, "cost2_max": -71.36041597061022, "cost1_mean": 183.43295596486803, "outflow_rate_mean": 956.6094104006288, "system_level_velocity_mean": 15.515659632977782}}
{"sampler_perf": {"mean_inference_ms": 7.495761040273872, "mean_processing_ms": 11.0487660435475, "mean_env_wait_ms": 127.78435480456933}, "policy_reward_mean": {}, "time_since_restore": 13469.25708937645, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 13469.25708937645, "episodes_total": 2526, "episode_reward_max": 396.9260184317827, "episode_reward_mean": 313.1932704847616, "episode_reward_min": 266.20499354600906, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.63247346878052, "timestamp": 1559277780, "episode_len_mean": 325.0, "iterations_since_restore": 109, "training_iteration": 109, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb6a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-43-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.0450066212843, "outflow_rate_min": 840.087658009269, "system_level_velocity_max": 17.35023643026823, "cost2_min": -90.08226898366331, "system_level_velocity_min": 13.040081689433858, "cost1_min": 155.89734768513645, "cost1_max": 203.42268045950465, "cost2_mean": -83.4837145371542, "discrim_loss": 0.7400970458984375, "cost2_max": -71.04339055367863, "cost1_mean": 181.89784515926075, "outflow_rate_mean": 948.7276641523107, "system_level_velocity_mean": 15.31788943604773}}
{"sampler_perf": {"mean_inference_ms": 7.4946481295326635, "mean_processing_ms": 11.032549550220097, "mean_env_wait_ms": 127.70504504180315}, "policy_reward_mean": {}, "time_since_restore": 13580.244374036789, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 13580.244374036789, "episodes_total": 2547, "episode_reward_max": 461.0968234427273, "episode_reward_mean": 297.3535717956367, "episode_reward_min": 229.44436156749725, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.98728466033936, "timestamp": 1559277892, "episode_len_mean": 325.0, "iterations_since_restore": 110, "training_iteration": 110, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-44-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.363028938147, "outflow_rate_min": 775.7714166899138, "system_level_velocity_max": 17.714867294405042, "cost2_min": -90.3887383491498, "system_level_velocity_min": 11.73098430434212, "cost1_min": 138.92754839157539, "cost1_max": 207.84166713101945, "cost2_mean": -84.64727930535571, "discrim_loss": 0.7438413500785828, "cost2_max": -70.56357723852469, "cost1_mean": 178.38830212920564, "outflow_rate_mean": 935.7186111755831, "system_level_velocity_mean": 14.979601296626218}}
{"sampler_perf": {"mean_inference_ms": 7.492905303787003, "mean_processing_ms": 11.020542833635002, "mean_env_wait_ms": 127.54881198673331}, "policy_reward_mean": {}, "time_since_restore": 13694.551916360855, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 13694.551916360855, "episodes_total": 2572, "episode_reward_max": 406.3402981646359, "episode_reward_mean": 261.7624452234805, "episode_reward_min": 209.1498586833477, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.30754232406616, "timestamp": 1559278006, "episode_len_mean": 325.0, "iterations_since_restore": 111, "training_iteration": 111, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b87b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-46-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.6837431432277, "outflow_rate_min": 781.9892873865767, "system_level_velocity_max": 17.676068029501856, "cost2_min": -92.90706651999547, "system_level_velocity_min": 11.639025620162943, "cost1_min": 136.52100780926548, "cost1_max": 207.1316892963818, "cost2_mean": -85.88051828895273, "discrim_loss": 0.7352536916732788, "cost2_max": -70.34075894286154, "cost1_mean": 183.92720256317534, "outflow_rate_mean": 956.3437061344304, "system_level_velocity_mean": 15.504962822791885}}
{"sampler_perf": {"mean_inference_ms": 7.4975161593007185, "mean_processing_ms": 11.05313581522941, "mean_env_wait_ms": 127.53762434226296}, "policy_reward_mean": {}, "time_since_restore": 13810.161857366562, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 13810.161857366562, "episodes_total": 2596, "episode_reward_max": 390.34052387066185, "episode_reward_mean": 252.22545208246447, "episode_reward_min": 206.63996490836143, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.60994100570679, "timestamp": 1559278122, "episode_len_mean": 325.0, "iterations_since_restore": 112, "training_iteration": 112, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-48-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.6968165881742, "outflow_rate_min": 805.4889636571808, "system_level_velocity_max": 17.74585912309117, "cost2_min": -93.56549924944393, "system_level_velocity_min": 12.151799870119854, "cost1_min": 144.30932726084927, "cost1_max": 207.2397254728117, "cost2_mean": -84.7643697928627, "discrim_loss": 0.7443096041679382, "cost2_max": -70.54531182484882, "cost1_mean": 181.44711674283676, "outflow_rate_mean": 947.0521893528017, "system_level_velocity_mean": 15.283487593023736}}
{"sampler_perf": {"mean_inference_ms": 7.496362731944305, "mean_processing_ms": 11.02741953152161, "mean_env_wait_ms": 127.46088819021834}, "policy_reward_mean": {}, "time_since_restore": 13921.44668006897, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 20, "time_total_s": 13921.44668006897, "episodes_total": 2616, "episode_reward_max": 416.24479819089174, "episode_reward_mean": 284.7253014596179, "episode_reward_min": 246.47668757289648, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.28482270240784, "timestamp": 1559278233, "episode_len_mean": 325.0, "iterations_since_restore": 113, "training_iteration": 113, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-50-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1026.880673635082, "outflow_rate_min": 783.305827022897, "system_level_velocity_max": 17.24264049198097, "cost2_min": -92.10134060524155, "system_level_velocity_min": 11.96008503632567, "cost1_min": 142.00778096786036, "cost1_max": 203.70724047022884, "cost2_mean": -84.66809491657878, "discrim_loss": 0.723150908946991, "cost2_max": -69.87596331808714, "cost1_mean": 180.79744542953057, "outflow_rate_mean": 942.3274763321155, "system_level_velocity_mean": 15.1904046183781}}
{"sampler_perf": {"mean_inference_ms": 7.491508091414359, "mean_processing_ms": 11.027850906307465, "mean_env_wait_ms": 127.33067060562776}, "policy_reward_mean": {}, "time_since_restore": 14030.890462636948, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 14030.890462636948, "episodes_total": 2640, "episode_reward_max": 359.31783531419933, "episode_reward_mean": 304.0166882995982, "episode_reward_min": 255.04329381883144, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.4437825679779, "timestamp": 1559278343, "episode_len_mean": 324.1666666666667, "iterations_since_restore": 114, "training_iteration": 114, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ad90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ad08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034abf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ac80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-52-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.1837004726299, "outflow_rate_min": 868.6182629292773, "system_level_velocity_max": 17.838848431963562, "cost2_min": -92.02630562417298, "system_level_velocity_min": 13.43763032271633, "cost1_min": 157.97742398577208, "cost1_max": 208.5488003259332, "cost2_mean": -87.00424926212139, "discrim_loss": 0.6884267330169678, "cost2_max": -74.5243307846994, "cost1_mean": 188.82024649351078, "outflow_rate_mean": 976.266029359706, "system_level_velocity_mean": 15.963402221182237}}
{"sampler_perf": {"mean_inference_ms": 7.497649201821485, "mean_processing_ms": 11.042779374900201, "mean_env_wait_ms": 127.3703608033172}, "policy_reward_mean": {}, "time_since_restore": 14146.314775943756, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 14146.314775943756, "episodes_total": 2665, "episode_reward_max": 485.2911545932293, "episode_reward_mean": 326.9956231496669, "episode_reward_min": 279.9428201466799, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.42431330680847, "timestamp": 1559278462, "episode_len_mean": 325.0, "iterations_since_restore": 115, "training_iteration": 115, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-54-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.8645216643863, "outflow_rate_min": 774.8284399256402, "system_level_velocity_max": 17.570985147802094, "cost2_min": -90.92513169943562, "system_level_velocity_min": 11.547795072955761, "cost1_min": 134.94375898319794, "cost1_max": 205.8572185507253, "cost2_mean": -84.65584887914532, "discrim_loss": 0.7199375629425049, "cost2_max": -71.32259324895035, "cost1_mean": 177.63127818049648, "outflow_rate_mean": 932.8684706755447, "system_level_velocity_mean": 14.90830700800823}}
{"sampler_perf": {"mean_inference_ms": 7.496649722057775, "mean_processing_ms": 11.032106968606422, "mean_env_wait_ms": 127.15309683395778}, "policy_reward_mean": {}, "time_since_restore": 14255.57954287529, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 14255.57954287529, "episodes_total": 2686, "episode_reward_max": 369.02062352001667, "episode_reward_mean": 280.0559730770155, "episode_reward_min": 228.80117412656546, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.26476693153381, "timestamp": 1559278571, "episode_len_mean": 325.0, "iterations_since_restore": 116, "training_iteration": 116, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-56-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1032.2168432098474, "outflow_rate_min": 776.7417324502985, "system_level_velocity_max": 17.482928015986516, "cost2_min": -91.48900902981859, "system_level_velocity_min": 11.680741058470733, "cost1_min": 136.6732527731476, "cost1_max": 204.92167118500117, "cost2_mean": -83.83026118408291, "discrim_loss": 0.6815850138664246, "cost2_max": -68.40931263494707, "cost1_mean": 180.5679724368934, "outflow_rate_mean": 942.5472388411962, "system_level_velocity_mean": 15.199351563920985}}
{"sampler_perf": {"mean_inference_ms": 7.491450551443253, "mean_processing_ms": 11.034139205041788, "mean_env_wait_ms": 127.11410530817945}, "policy_reward_mean": {}, "time_since_restore": 14368.79033255577, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 14368.79033255577, "episodes_total": 2710, "episode_reward_max": 324.25896414835006, "episode_reward_mean": 248.6311341318069, "episode_reward_min": 205.1907036304474, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.21078968048096, "timestamp": 1559278684, "episode_len_mean": 325.0, "iterations_since_restore": 117, "training_iteration": 117, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303247b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-58-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.7901846583932, "outflow_rate_min": 812.5516893608949, "system_level_velocity_max": 17.47028273078123, "cost2_min": -91.3443490407285, "system_level_velocity_min": 12.495316447947488, "cost1_min": 147.68654036516762, "cost1_max": 204.37826527694097, "cost2_mean": -83.55106434800147, "discrim_loss": 0.7166993618011475, "cost2_max": -71.60133530789749, "cost1_mean": 180.36263952875188, "outflow_rate_mean": 942.2155430028696, "system_level_velocity_mean": 15.191158629180704}}
{"sampler_perf": {"mean_inference_ms": 7.49708010114628, "mean_processing_ms": 11.04758637821512, "mean_env_wait_ms": 127.07808905955775}, "policy_reward_mean": {}, "time_since_restore": 14478.717584848404, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 14478.717584848404, "episodes_total": 2736, "episode_reward_max": 367.6837690733373, "episode_reward_mean": 230.69143201546888, "episode_reward_min": 23.323149763047695, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.92725229263306, "timestamp": 1559278794, "episode_len_mean": 308.53846153846155, "iterations_since_restore": 118, "training_iteration": 118, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf2f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-59-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1027.8621808785824, "outflow_rate_min": 516.5375004973323, "system_level_velocity_max": 18.7234229407966, "cost2_min": -91.84851632208925, "system_level_velocity_min": 12.21901301459697, "cost1_min": 22.95446355985278, "cost1_max": 203.46002712427378, "cost2_mean": -80.90073779193754, "discrim_loss": 0.697827935218811, "cost2_max": -23.00217884793541, "cost1_mean": 173.17686808690272, "outflow_rate_mean": 926.1590050481572, "system_level_velocity_mean": 15.510481792944462}}
{"sampler_perf": {"mean_inference_ms": 7.494753014206746, "mean_processing_ms": 11.040328376991496, "mean_env_wait_ms": 126.89206302553806}, "policy_reward_mean": {}, "time_since_restore": 14591.046076774597, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 14591.046076774597, "episodes_total": 2757, "episode_reward_max": 343.6521848887205, "episode_reward_mean": 256.70419818961193, "episode_reward_min": 218.80519327521324, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.32849192619324, "timestamp": 1559278907, "episode_len_mean": 325.0, "iterations_since_restore": 119, "training_iteration": 119, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-01-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.996228386415, "outflow_rate_min": 830.0375566445111, "system_level_velocity_max": 17.655326496883095, "cost2_min": -91.03644803568749, "system_level_velocity_min": 12.865177941367342, "cost1_min": 152.78117370058456, "cost1_max": 206.16444636503746, "cost2_mean": -84.8563293931765, "discrim_loss": 0.6669605374336243, "cost2_max": -70.08754968302956, "cost1_mean": 184.43927416261218, "outflow_rate_mean": 957.0400766201499, "system_level_velocity_mean": 15.542174632961416}}
{"sampler_perf": {"mean_inference_ms": 7.493099030352975, "mean_processing_ms": 11.04247746724778, "mean_env_wait_ms": 126.90976373677292}, "policy_reward_mean": {}, "time_since_restore": 14702.908259391785, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 14702.908259391785, "episodes_total": 2780, "episode_reward_max": 391.8516582753509, "episode_reward_mean": 287.3009723296146, "episode_reward_min": 237.14114658534527, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.8621826171875, "timestamp": 1559279019, "episode_len_mean": 325.0, "iterations_since_restore": 120, "training_iteration": 120, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf6a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-03-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.2539787756248, "outflow_rate_min": 783.477996091065, "system_level_velocity_max": 17.567625789902188, "cost2_min": -90.39489789161146, "system_level_velocity_min": 11.765600056295046, "cost1_min": 138.74118696428891, "cost1_max": 205.42197403225646, "cost2_mean": -83.2783823175791, "discrim_loss": 0.687572181224823, "cost2_max": -68.63243450695441, "cost1_mean": 177.06246877452247, "outflow_rate_mean": 931.6190567829551, "system_level_velocity_mean": 14.909866268616243}}
{"sampler_perf": {"mean_inference_ms": 7.493284177442646, "mean_processing_ms": 11.035852588756052, "mean_env_wait_ms": 126.80632525319527}, "policy_reward_mean": {}, "time_since_restore": 14814.516008853912, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 14814.516008853912, "episodes_total": 2804, "episode_reward_max": 308.8193218484521, "episode_reward_mean": 276.5959774398555, "episode_reward_min": 230.3727591484785, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.60774946212769, "timestamp": 1559279130, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 121, "training_iteration": 121, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303248c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-05-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1028.0256870921078, "outflow_rate_min": 867.2545155597304, "system_level_velocity_max": 17.672255470296694, "cost2_min": -91.35576679373935, "system_level_velocity_min": 13.475621493314023, "cost1_min": 161.08487251581164, "cost1_max": 203.3212214460969, "cost2_mean": -85.8380031096849, "discrim_loss": 0.6586251258850098, "cost2_max": -77.31301938569678, "cost1_mean": 186.48769338076508, "outflow_rate_mean": 967.9120578754182, "system_level_velocity_mean": 15.798324863191489}}
{"sampler_perf": {"mean_inference_ms": 7.497687075441765, "mean_processing_ms": 11.064655647316679, "mean_env_wait_ms": 126.77864371583576}, "policy_reward_mean": {}, "time_since_restore": 14929.669323444366, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 14929.669323444366, "episodes_total": 2827, "episode_reward_max": 425.71320617944, "episode_reward_mean": 292.41776255550593, "episode_reward_min": 231.39776095747948, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.1533145904541, "timestamp": 1559279246, "episode_len_mean": 325.0, "iterations_since_restore": 122, "training_iteration": 122, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-07-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.1136288311955, "outflow_rate_min": 780.4038254710118, "system_level_velocity_max": 17.565139081634427, "cost2_min": -90.73356436063919, "system_level_velocity_min": 11.766699213106135, "cost1_min": 137.7768491534129, "cost1_max": 205.27381199267396, "cost2_mean": -81.82896884955169, "discrim_loss": 0.7076890468597412, "cost2_max": -67.33257609383885, "cost1_mean": 176.11269601327822, "outflow_rate_mean": 924.9808784762819, "system_level_velocity_mean": 14.849720848329557}}
{"sampler_perf": {"mean_inference_ms": 7.496362798088261, "mean_processing_ms": 11.054791759001247, "mean_env_wait_ms": 126.7164444228564}, "policy_reward_mean": {}, "time_since_restore": 15040.368696451187, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 15040.368696451187, "episodes_total": 2848, "episode_reward_max": 289.3432343825698, "episode_reward_mean": 246.63886631967588, "episode_reward_min": 218.37632299214602, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.69937300682068, "timestamp": 1559279356, "episode_len_mean": 325.0, "iterations_since_restore": 123, "training_iteration": 123, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf2f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-09-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.2890355841203, "outflow_rate_min": 844.4101270395073, "system_level_velocity_max": 17.516767515454855, "cost2_min": -91.03417281331971, "system_level_velocity_min": 12.836996461602713, "cost1_min": 153.39723492818098, "cost1_max": 204.96237861540862, "cost2_mean": -85.72193610653096, "discrim_loss": 0.6666967272758484, "cost2_max": -76.04700713445172, "cost1_mean": 187.36155062457544, "outflow_rate_mean": 970.7510130532404, "system_level_velocity_mean": 15.803702844487711}}
{"sampler_perf": {"mean_inference_ms": 7.492739475147507, "mean_processing_ms": 11.04431870232318, "mean_env_wait_ms": 126.56936035709057}, "policy_reward_mean": {}, "time_since_restore": 15151.30993103981, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 15151.30993103981, "episodes_total": 2874, "episode_reward_max": 303.9824378248304, "episode_reward_mean": 241.89829191852075, "episode_reward_min": 213.7783754169941, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.94123458862305, "timestamp": 1559279467, "episode_len_mean": 325.0, "iterations_since_restore": 124, "training_iteration": 124, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-11-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.0078187288266, "outflow_rate_min": 826.151674211768, "system_level_velocity_max": 17.55682241303009, "cost2_min": -91.34854078198788, "system_level_velocity_min": 12.847580135868377, "cost1_min": 153.96189271942626, "cost1_max": 205.08729144410208, "cost2_mean": -85.07950191150134, "discrim_loss": 0.6545382738113403, "cost2_max": -73.44951096904038, "cost1_mean": 186.47898646538687, "outflow_rate_mean": 964.0795453281067, "system_level_velocity_mean": 15.726420524150335}}
{"sampler_perf": {"mean_inference_ms": 7.4976223611061465, "mean_processing_ms": 11.071373345170318, "mean_env_wait_ms": 126.52978674946817}, "policy_reward_mean": {}, "time_since_restore": 15264.054876089096, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 15264.054876089096, "episodes_total": 2897, "episode_reward_max": 396.0934744030237, "episode_reward_mean": 247.03598827358496, "episode_reward_min": 205.42201936990023, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.74494504928589, "timestamp": 1559279580, "episode_len_mean": 325.0, "iterations_since_restore": 125, "training_iteration": 125, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79304250d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-13-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.9149957848158, "outflow_rate_min": 798.5980436481765, "system_level_velocity_max": 17.377957704799673, "cost2_min": -92.16418702507028, "system_level_velocity_min": 11.918314626109504, "cost1_min": 141.6817096722802, "cost1_max": 203.92509876029874, "cost2_mean": -83.56594278894161, "discrim_loss": 0.6673675775527954, "cost2_max": -72.86139051484541, "cost1_mean": 181.62824096962046, "outflow_rate_mean": 945.9989729991762, "system_level_velocity_mean": 15.302889430937883}}
{"sampler_perf": {"mean_inference_ms": 7.495680831433667, "mean_processing_ms": 11.053748426535167, "mean_env_wait_ms": 126.47338950243991}, "policy_reward_mean": {}, "time_since_restore": 15378.897291183472, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 15378.897291183472, "episodes_total": 2918, "episode_reward_max": 403.56337278336287, "episode_reward_mean": 254.96692483650432, "episode_reward_min": 206.55702555924654, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.84241509437561, "timestamp": 1559279695, "episode_len_mean": 324.04761904761904, "iterations_since_restore": 126, "training_iteration": 126, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-14-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.9998238703258, "outflow_rate_min": 805.9043251408303, "system_level_velocity_max": 17.67671669351506, "cost2_min": -90.43287095099015, "system_level_velocity_min": 12.073415000858008, "cost1_min": 143.20986170750302, "cost1_max": 206.80204409535375, "cost2_mean": -84.16738089014522, "discrim_loss": 0.6445540189743042, "cost2_max": -70.863183093539, "cost1_mean": 182.97464410515911, "outflow_rate_mean": 954.5402722929905, "system_level_velocity_mean": 15.510288075273087}}
{"sampler_perf": {"mean_inference_ms": 7.488599310909038, "mean_processing_ms": 11.045209397044927, "mean_env_wait_ms": 126.28139019961945}, "policy_reward_mean": {}, "time_since_restore": 15487.794853925705, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 15487.794853925705, "episodes_total": 2942, "episode_reward_max": 366.8572699651122, "episode_reward_mean": 251.66116600320674, "episode_reward_min": 214.68702985346317, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.89756274223328, "timestamp": 1559279804, "episode_len_mean": 325.0, "iterations_since_restore": 127, "training_iteration": 127, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ad488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ad400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ad2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ad378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-16-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.1553818854934, "outflow_rate_min": 775.7594275375187, "system_level_velocity_max": 17.481098407049217, "cost2_min": -90.64048055039488, "system_level_velocity_min": 11.76072875780638, "cost1_min": 136.84074399505306, "cost1_max": 205.05440656107913, "cost2_mean": -85.92874519092682, "discrim_loss": 0.6674709320068359, "cost2_max": -68.29047492457795, "cost1_mean": 188.6829437838193, "outflow_rate_mean": 975.7681770829221, "system_level_velocity_mean": 15.981371759531802}}
{"sampler_perf": {"mean_inference_ms": 7.49657041470969, "mean_processing_ms": 11.065863578756142, "mean_env_wait_ms": 126.32776022881261}, "policy_reward_mean": {}, "time_since_restore": 15599.888914823532, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 15599.888914823532, "episodes_total": 2966, "episode_reward_max": 288.3594857379794, "episode_reward_mean": 258.69418688234873, "episode_reward_min": 227.8889924287796, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.09406089782715, "timestamp": 1559279916, "episode_len_mean": 325.0, "iterations_since_restore": 128, "training_iteration": 128, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-18-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.8390998202071, "outflow_rate_min": 765.0864520126532, "system_level_velocity_max": 17.43524838795423, "cost2_min": -89.24559408791316, "system_level_velocity_min": 11.678436684678571, "cost1_min": 136.6097240696272, "cost1_max": 203.89295453341984, "cost2_mean": -82.8894564605415, "discrim_loss": 0.6581587791442871, "cost2_max": -71.19788213440265, "cost1_mean": 178.10629616370954, "outflow_rate_mean": 934.4988342130628, "system_level_velocity_mean": 15.013397422042315}}
{"sampler_perf": {"mean_inference_ms": 7.493195599023685, "mean_processing_ms": 11.06392184888399, "mean_env_wait_ms": 126.11091621907828}, "policy_reward_mean": {}, "time_since_restore": 15707.63368153572, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 15707.63368153572, "episodes_total": 2988, "episode_reward_max": 288.3340828642249, "episode_reward_mean": 248.99361868397418, "episode_reward_min": 161.64870492368937, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 107.74476671218872, "timestamp": 1559280024, "episode_len_mean": 320.09090909090907, "iterations_since_restore": 129, "training_iteration": 129, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba8c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-20-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.5515087003437, "outflow_rate_min": 814.3853215848452, "system_level_velocity_max": 17.410428792224597, "cost2_min": -90.42277849713602, "system_level_velocity_min": 13.2447750882248, "cost1_min": 125.90860516851049, "cost1_max": 203.61326141757968, "cost2_mean": -81.69556764328408, "discrim_loss": 0.6451237797737122, "cost2_max": -69.9129081479604, "cost1_mean": 178.7405469877621, "outflow_rate_mean": 939.2082769483927, "system_level_velocity_mean": 15.32261115717133}}
{"sampler_perf": {"mean_inference_ms": 7.48769987067504, "mean_processing_ms": 11.054896301490533, "mean_env_wait_ms": 126.00519402104045}, "policy_reward_mean": {}, "time_since_restore": 15816.659027576447, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 15816.659027576447, "episodes_total": 3014, "episode_reward_max": 386.0444872006774, "episode_reward_mean": 231.92353438349585, "episode_reward_min": 127.57884141802788, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 109.02534604072571, "timestamp": 1559280133, "episode_len_mean": 316.2307692307692, "iterations_since_restore": 130, "training_iteration": 130, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-22-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.218858390872, "outflow_rate_min": 802.7778044448474, "system_level_velocity_max": 17.627591078032317, "cost2_min": -90.23004681541546, "system_level_velocity_min": 12.265378511944691, "cost1_min": 131.0257294176767, "cost1_max": 206.2362384074021, "cost2_mean": -82.15695811858615, "discrim_loss": 0.6632561087608337, "cost2_max": -68.456948994117, "cost1_mean": 176.92034081843906, "outflow_rate_mean": 936.6679256505806, "system_level_velocity_mean": 15.358737326003883}}
{"sampler_perf": {"mean_inference_ms": 7.4930518822264505, "mean_processing_ms": 11.064152868014764, "mean_env_wait_ms": 126.07904484628538}, "policy_reward_mean": {}, "time_since_restore": 15928.472378969193, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 15928.472378969193, "episodes_total": 3036, "episode_reward_max": 387.8599953390658, "episode_reward_mean": 235.3504335489124, "episode_reward_min": 129.34128780663013, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.81335139274597, "timestamp": 1559280245, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 131, "training_iteration": 131, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-24-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.2698603674512, "outflow_rate_min": 802.6667339996958, "system_level_velocity_max": 17.801758486424582, "cost2_min": -91.1515005208662, "system_level_velocity_min": 12.124374892441512, "cost1_min": 133.5621801001998, "cost1_max": 206.0657437187549, "cost2_mean": -83.79945490051381, "discrim_loss": 0.655281662940979, "cost2_max": -70.32556810896297, "cost1_mean": 178.5659149715027, "outflow_rate_mean": 941.1038380378432, "system_level_velocity_mean": 15.36408704514382}}
{"sampler_perf": {"mean_inference_ms": 7.490835448305603, "mean_processing_ms": 11.073981384899973, "mean_env_wait_ms": 125.8507123015083}, "policy_reward_mean": {}, "time_since_restore": 16043.210985183716, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 16043.210985183716, "episodes_total": 3059, "episode_reward_max": 282.7607593536377, "episode_reward_mean": 241.16883989836535, "episode_reward_min": 208.66514391452074, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.73860621452332, "timestamp": 1559280360, "episode_len_mean": 325.0, "iterations_since_restore": 132, "training_iteration": 132, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-26-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.158334451938, "outflow_rate_min": 869.5856817621473, "system_level_velocity_max": 17.670428940010293, "cost2_min": -92.30627055498262, "system_level_velocity_min": 13.523846086827323, "cost1_min": 160.9883001216803, "cost1_max": 206.89947964582748, "cost2_mean": -86.53573085031758, "discrim_loss": 0.6842072010040283, "cost2_max": -79.5137099662247, "cost1_mean": 186.8631859708814, "outflow_rate_mean": 968.3397259847128, "system_level_velocity_mean": 15.784895899693456}}
{"sampler_perf": {"mean_inference_ms": 7.487737424471393, "mean_processing_ms": 11.051951506630015, "mean_env_wait_ms": 125.81753622604629}, "policy_reward_mean": {}, "time_since_restore": 16151.305983304977, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 16151.305983304977, "episodes_total": 3082, "episode_reward_max": 420.68716329336166, "episode_reward_mean": 282.6646429245239, "episode_reward_min": 231.7245106548071, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 108.0949981212616, "timestamp": 1559280468, "episode_len_mean": 325.0, "iterations_since_restore": 133, "training_iteration": 133, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-27-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.786397552358, "outflow_rate_min": 780.3297620998169, "system_level_velocity_max": 17.696954656940292, "cost2_min": -91.5067323476376, "system_level_velocity_min": 11.89400321860927, "cost1_min": 138.69889304330502, "cost1_max": 206.6168024506212, "cost2_mean": -84.7784908281015, "discrim_loss": 0.7028768062591553, "cost2_max": -70.13637756396233, "cost1_mean": 181.8867923967378, "outflow_rate_mean": 947.6879664339777, "system_level_velocity_mean": 15.331045468755221}}
{"sampler_perf": {"mean_inference_ms": 7.488436414759413, "mean_processing_ms": 11.063521581250862, "mean_env_wait_ms": 125.82798231829959}, "policy_reward_mean": {}, "time_since_restore": 16264.762835741043, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 16264.762835741043, "episodes_total": 3106, "episode_reward_max": 323.8990547657013, "episode_reward_mean": 273.8605050527646, "episode_reward_min": 240.17674726247787, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.45685243606567, "timestamp": 1559280583, "episode_len_mean": 325.0, "iterations_since_restore": 134, "training_iteration": 134, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-29-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.7846920409906, "outflow_rate_min": 843.3165305258631, "system_level_velocity_max": 17.560682876949105, "cost2_min": -94.90357314873158, "system_level_velocity_min": 12.84683082669608, "cost1_min": 153.7077808882047, "cost1_max": 206.63771863726078, "cost2_mean": -87.84270840021664, "discrim_loss": 0.655933141708374, "cost2_max": -76.74163087661492, "cost1_mean": 184.73280990336457, "outflow_rate_mean": 957.7585659968521, "system_level_velocity_mean": 15.495449434029263}}
{"sampler_perf": {"mean_inference_ms": 7.494034078650896, "mean_processing_ms": 11.081548780497528, "mean_env_wait_ms": 125.76477137879162}, "policy_reward_mean": {}, "time_since_restore": 16383.811808347702, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 16383.811808347702, "episodes_total": 3129, "episode_reward_max": 448.91794473305345, "episode_reward_mean": 279.7730526121981, "episode_reward_min": 177.51805682480335, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.04897260665894, "timestamp": 1559280705, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 135, "training_iteration": 135, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfc80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfe18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf0d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-31-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.2695723955762, "outflow_rate_min": 765.9534782077346, "system_level_velocity_max": 17.696921844791056, "cost2_min": -93.04650021294935, "system_level_velocity_min": 11.5923157710289, "cost1_min": 113.53296332546225, "cost1_max": 207.45654780562353, "cost2_mean": -87.46241034969798, "discrim_loss": 0.7250180840492249, "cost2_max": -71.0579392229333, "cost1_mean": 176.87061486567202, "outflow_rate_mean": 935.1313640667945, "system_level_velocity_mean": 15.07375434289039}}
{"sampler_perf": {"mean_inference_ms": 7.494591651119709, "mean_processing_ms": 11.058765195744488, "mean_env_wait_ms": 125.76519088447851}, "policy_reward_mean": {}, "time_since_restore": 16500.51601600647, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 16500.51601600647, "episodes_total": 3150, "episode_reward_max": 305.4720659889281, "episode_reward_mean": 258.2587882192539, "episode_reward_min": 216.5782377384603, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.7042076587677, "timestamp": 1559280822, "episode_len_mean": 325.0, "iterations_since_restore": 136, "training_iteration": 136, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-33-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.8646725035617, "outflow_rate_min": 872.7237980654223, "system_level_velocity_max": 17.65192255307821, "cost2_min": -94.79790083642692, "system_level_velocity_min": 13.439973503126614, "cost1_min": 162.16614952528514, "cost1_max": 207.3599066543697, "cost2_mean": -88.84252934697344, "discrim_loss": 0.7148871421813965, "cost2_max": -80.81178530286738, "cost1_mean": 184.02320514769343, "outflow_rate_mean": 955.4406968466362, "system_level_velocity_mean": 15.458183889464006}}
{"sampler_perf": {"mean_inference_ms": 7.491259551854386, "mean_processing_ms": 11.068145187092844, "mean_env_wait_ms": 125.73609411616374}, "policy_reward_mean": {}, "time_since_restore": 16614.73024702072, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 16614.73024702072, "episodes_total": 3176, "episode_reward_max": 423.86801160499454, "episode_reward_mean": 264.0382068286865, "episode_reward_min": 27.16331571340561, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.21423101425171, "timestamp": 1559280936, "episode_len_mean": 313.84615384615387, "iterations_since_restore": 137, "training_iteration": 137, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-35-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.7211545213534, "outflow_rate_min": 460.7989278777953, "system_level_velocity_max": 18.351553886880115, "cost2_min": -93.5246944233803, "system_level_velocity_min": 12.036886454042588, "cost1_min": 22.941909662642384, "cost1_max": 207.51035530228918, "cost2_mean": -86.52118859640915, "discrim_loss": 0.7753015756607056, "cost2_max": -25.25422819894116, "cost1_mean": 181.87171562311008, "outflow_rate_mean": 953.0035558179222, "system_level_velocity_mean": 15.943676358385906}}
{"sampler_perf": {"mean_inference_ms": 7.498785359220496, "mean_processing_ms": 11.084762942822769, "mean_env_wait_ms": 125.69937579617499}, "policy_reward_mean": {}, "time_since_restore": 16727.45117545128, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 16727.45117545128, "episodes_total": 3199, "episode_reward_max": 568.7975354269147, "episode_reward_mean": 363.59226862122506, "episode_reward_min": 268.9698403030634, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.72092843055725, "timestamp": 1559281049, "episode_len_mean": 325.0, "iterations_since_restore": 138, "training_iteration": 138, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfb70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf7b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-37-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.641470380406, "outflow_rate_min": 795.2984487077705, "system_level_velocity_max": 17.588734517511096, "cost2_min": -94.32063789613802, "system_level_velocity_min": 12.065219417337804, "cost1_min": 142.21431023387942, "cost1_max": 206.99393699251763, "cost2_mean": -87.34802595784849, "discrim_loss": 0.8518053889274597, "cost2_max": -71.23745373060456, "cost1_mean": 179.52096358964695, "outflow_rate_mean": 938.9704188138895, "system_level_velocity_mean": 15.061704335740313}}
{"sampler_perf": {"mean_inference_ms": 7.497244182220912, "mean_processing_ms": 11.067732234205877, "mean_env_wait_ms": 125.6547516313061}, "policy_reward_mean": {}, "time_since_restore": 16838.214736700058, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 16838.214736700058, "episodes_total": 3220, "episode_reward_max": 398.5804209113121, "episode_reward_mean": 358.2541501476829, "episode_reward_min": 307.1427507214248, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.7635612487793, "timestamp": 1559281160, "episode_len_mean": 325.0, "iterations_since_restore": 139, "training_iteration": 139, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-39-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.4121063963164, "outflow_rate_min": 861.9308726404838, "system_level_velocity_max": 17.711672994704593, "cost2_min": -94.56294882939099, "system_level_velocity_min": 13.313281049387758, "cost1_min": 160.46035254889213, "cost1_max": 207.7949145172202, "cost2_mean": -88.76318849269178, "discrim_loss": 0.8146659135818481, "cost2_max": -80.55545324062258, "cost1_mean": 184.30512024632623, "outflow_rate_mean": 958.1195656827609, "system_level_velocity_mean": 15.473762206606317}}
{"sampler_perf": {"mean_inference_ms": 7.490191867415767, "mean_processing_ms": 11.055521477613095, "mean_env_wait_ms": 125.50512193208664}, "policy_reward_mean": {}, "time_since_restore": 16949.430293560028, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 16949.430293560028, "episodes_total": 3245, "episode_reward_max": 404.6368462443352, "episode_reward_mean": 345.4790035733953, "episode_reward_min": 296.57668582350016, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.21555685997009, "timestamp": 1559281271, "episode_len_mean": 325.0, "iterations_since_restore": 140, "training_iteration": 140, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be8c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-41-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.344724677419, "outflow_rate_min": 819.2402839854099, "system_level_velocity_max": 17.657626586274734, "cost2_min": -97.51028054124676, "system_level_velocity_min": 12.31645554182059, "cost1_min": 148.7907442367695, "cost1_max": 207.11695768592227, "cost2_mean": -88.39279606242143, "discrim_loss": 0.88199782371521, "cost2_max": -74.38100248503977, "cost1_mean": 180.2119802759389, "outflow_rate_mean": 942.7690270879137, "system_level_velocity_mean": 15.090808474091101}}
{"sampler_perf": {"mean_inference_ms": 7.500407997556464, "mean_processing_ms": 11.080687298635587, "mean_env_wait_ms": 125.61162560326936}, "policy_reward_mean": {}, "time_since_restore": 17063.488515853882, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17063.488515853882, "episodes_total": 3268, "episode_reward_max": 533.1479360386729, "episode_reward_mean": 364.89560544535357, "episode_reward_min": 289.4696911238134, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.05822229385376, "timestamp": 1559281385, "episode_len_mean": 325.0, "iterations_since_restore": 141, "training_iteration": 141, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-43-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.7937162833482, "outflow_rate_min": 788.0585053419828, "system_level_velocity_max": 17.640354159792647, "cost2_min": -97.35829334088609, "system_level_velocity_min": 11.966557389769292, "cost1_min": 140.83792708947863, "cost1_max": 207.5692033713281, "cost2_mean": -91.19091486703982, "discrim_loss": 0.9409185647964478, "cost2_max": -75.77083868890074, "cost1_mean": 183.37527858335045, "outflow_rate_mean": 955.244141395133, "system_level_velocity_mean": 15.357766899101925}}
{"sampler_perf": {"mean_inference_ms": 7.499335174339385, "mean_processing_ms": 11.071397405606756, "mean_env_wait_ms": 125.46499711893644}, "policy_reward_mean": {}, "time_since_restore": 17179.916064739227, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 17179.916064739227, "episodes_total": 3290, "episode_reward_max": 423.5480007044971, "episode_reward_mean": 365.6154487420043, "episode_reward_min": 295.5832400172949, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.42754888534546, "timestamp": 1559281502, "episode_len_mean": 323.72727272727275, "iterations_since_restore": 142, "training_iteration": 142, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bab70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302baae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba9d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302baa60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-45-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.8120886841145, "outflow_rate_min": 805.8840466946206, "system_level_velocity_max": 17.659198356393134, "cost2_min": -97.30916680238784, "system_level_velocity_min": 12.843928174776643, "cost1_min": 140.26431071373634, "cost1_max": 208.846473548546, "cost2_mean": -90.58771330075031, "discrim_loss": 0.9746938943862915, "cost2_max": -75.15692807784812, "cost1_mean": 178.07518914074487, "outflow_rate_mean": 934.2891312928158, "system_level_velocity_mean": 14.922017172552627}}
{"sampler_perf": {"mean_inference_ms": 7.494098307417422, "mean_processing_ms": 11.058479252290974, "mean_env_wait_ms": 125.42098957352856}, "policy_reward_mean": {}, "time_since_restore": 17295.718256235123, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 17295.718256235123, "episodes_total": 3316, "episode_reward_max": 459.5462258681655, "episode_reward_mean": 362.50614631498377, "episode_reward_min": 114.16861729696393, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.80219149589539, "timestamp": 1559281618, "episode_len_mean": 312.88461538461536, "iterations_since_restore": 143, "training_iteration": 143, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-46-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.5978472448494, "outflow_rate_min": 725.7319019184783, "system_level_velocity_max": 18.31407939480034, "cost2_min": -97.99079638237117, "system_level_velocity_min": 13.181294990165082, "cost1_min": 77.74533976626766, "cost1_max": 207.50517813433413, "cost2_mean": -90.49228549928074, "discrim_loss": 0.9501210451126099, "cost2_max": -52.31241373435877, "cost1_mean": 181.48255398292153, "outflow_rate_mean": 956.5110220941386, "system_level_velocity_mean": 15.858403644612224}}
{"sampler_perf": {"mean_inference_ms": 7.502800887176306, "mean_processing_ms": 11.088486196138035, "mean_env_wait_ms": 125.54716465194612}, "policy_reward_mean": {}, "time_since_restore": 17416.718160152435, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17416.718160152435, "episodes_total": 3339, "episode_reward_max": 530.5778601616621, "episode_reward_mean": 426.7932967718934, "episode_reward_min": 329.9417803660035, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.99990391731262, "timestamp": 1559281739, "episode_len_mean": 323.7826086956522, "iterations_since_restore": 144, "training_iteration": 144, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bebf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bec80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bed08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-48-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.2509921110716, "outflow_rate_min": 784.1192850700232, "system_level_velocity_max": 17.630550428736203, "cost2_min": -96.98404085802579, "system_level_velocity_min": 11.741203732419391, "cost1_min": 140.43500772820155, "cost1_max": 207.63707180724293, "cost2_mean": -89.17239983311649, "discrim_loss": 0.9282832145690918, "cost2_max": -76.17684645732984, "cost1_mean": 179.9890376460789, "outflow_rate_mean": 945.9668006158325, "system_level_velocity_mean": 15.126421021679832}}
{"sampler_perf": {"mean_inference_ms": 7.504104423295177, "mean_processing_ms": 11.089838964700926, "mean_env_wait_ms": 125.44089300045034}, "policy_reward_mean": {}, "time_since_restore": 17530.20868897438, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17530.20868897438, "episodes_total": 3362, "episode_reward_max": 472.1782439574599, "episode_reward_mean": 395.67221406239855, "episode_reward_min": 34.06683298945427, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.49052882194519, "timestamp": 1559281852, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 145, "training_iteration": 145, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-50-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.8288334576996, "outflow_rate_min": 494.27405165189856, "system_level_velocity_max": 17.959006015145782, "cost2_min": -97.38024232560353, "system_level_velocity_min": 13.036915470355591, "cost1_min": 18.05578989438273, "cost1_max": 208.39549135825305, "cost2_mean": -86.89714300369945, "discrim_loss": 0.9219681024551392, "cost2_max": -18.93661796628708, "cost1_mean": 175.8630828658955, "outflow_rate_mean": 934.9892775061024, "system_level_velocity_mean": 15.442970138181193}}
{"sampler_perf": {"mean_inference_ms": 7.498122830004566, "mean_processing_ms": 11.07312337410266, "mean_env_wait_ms": 125.42248722114695}, "policy_reward_mean": {}, "time_since_restore": 17647.63657450676, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17647.63657450676, "episodes_total": 3385, "episode_reward_max": 523.4666687296703, "episode_reward_mean": 400.5172944103732, "episode_reward_min": 336.0507468804717, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.42788553237915, "timestamp": 1559281970, "episode_len_mean": 325.0, "iterations_since_restore": 146, "training_iteration": 146, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-52-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.4243916118473, "outflow_rate_min": 787.1269757405038, "system_level_velocity_max": 17.5282053947119, "cost2_min": -97.06381958032134, "system_level_velocity_min": 11.987506697103838, "cost1_min": 141.20300183886303, "cost1_max": 207.34349154615109, "cost2_mean": -89.4939830719592, "discrim_loss": 0.8821901082992554, "cost2_max": -74.27508936022159, "cost1_mean": 181.22256710469586, "outflow_rate_mean": 950.4588029544115, "system_level_velocity_mean": 15.168552800643296}}
{"sampler_perf": {"mean_inference_ms": 7.4977265199148, "mean_processing_ms": 11.089680112202048, "mean_env_wait_ms": 125.40470615889856}, "policy_reward_mean": {}, "time_since_restore": 17762.17399430275, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 17762.17399430275, "episodes_total": 3411, "episode_reward_max": 439.23922561481595, "episode_reward_mean": 356.21114533240547, "episode_reward_min": 27.074132680892944, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.53741979598999, "timestamp": 1559282086, "episode_len_mean": 313.84615384615387, "iterations_since_restore": 147, "training_iteration": 147, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-54-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.2021012085336, "outflow_rate_min": 477.1206855028346, "system_level_velocity_max": 18.528783861957667, "cost2_min": -97.54030386929617, "system_level_velocity_min": 13.049637086903436, "cost1_min": 23.054074289498274, "cost1_max": 205.92956881117993, "cost2_mean": -87.61776359308185, "discrim_loss": 0.9059352874755859, "cost2_max": -24.594131582932977, "cost1_mean": 174.82222852193078, "outflow_rate_mean": 927.3065633663211, "system_level_velocity_mean": 15.226775572810858}}
{"sampler_perf": {"mean_inference_ms": 7.503240332056991, "mean_processing_ms": 11.106521817131105, "mean_env_wait_ms": 125.37938717659264}, "policy_reward_mean": {}, "time_since_restore": 17875.599672317505, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17875.599672317505, "episodes_total": 3434, "episode_reward_max": 446.62788279447705, "episode_reward_mean": 352.99883771068215, "episode_reward_min": 29.605683833360672, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.42567801475525, "timestamp": 1559282200, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 148, "training_iteration": 148, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034e6a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034e620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034e510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034e598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-56-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.9553336238619, "outflow_rate_min": 444.6769763958757, "system_level_velocity_max": 17.67068784456266, "cost2_min": -98.42468979341561, "system_level_velocity_min": 11.706747989626935, "cost1_min": 18.069954369559706, "cost1_max": 208.54618742476967, "cost2_mean": -86.30943733513006, "discrim_loss": 0.9039258360862732, "cost2_max": -20.951497154217414, "cost1_mean": 171.44557429578913, "outflow_rate_mean": 915.4319318641469, "system_level_velocity_mean": 15.03918607134043}}
{"sampler_perf": {"mean_inference_ms": 7.503796152919566, "mean_processing_ms": 11.091186483032716, "mean_env_wait_ms": 125.42950366109112}, "policy_reward_mean": {}, "time_since_restore": 17989.268430948257, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 17989.268430948257, "episodes_total": 3457, "episode_reward_max": 417.7937399279326, "episode_reward_mean": 374.1211379545275, "episode_reward_min": 120.27000444382429, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.66875863075256, "timestamp": 1559282315, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 149, "training_iteration": 149, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303658c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-58-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.0644392666097, "outflow_rate_min": 732.9573078868228, "system_level_velocity_max": 18.49684043658181, "cost2_min": -96.4016780645479, "system_level_velocity_min": 13.07784071203178, "cost1_min": 78.32517027506849, "cost1_max": 207.14139390897412, "cost2_mean": -87.88560626866901, "discrim_loss": 0.870150625705719, "cost2_max": -52.42425049468462, "cost1_mean": 173.9409019206814, "outflow_rate_mean": 929.5663339841833, "system_level_velocity_mean": 15.023189345060821}}
{"sampler_perf": {"mean_inference_ms": 7.498402800035424, "mean_processing_ms": 11.079423464555765, "mean_env_wait_ms": 125.39228329521377}, "policy_reward_mean": {}, "time_since_restore": 18108.05629348755, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 18108.05629348755, "episodes_total": 3481, "episode_reward_max": 492.0372989308089, "episode_reward_mean": 388.30403152042226, "episode_reward_min": 332.6744414418936, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.78786253929138, "timestamp": 1559282436, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 150, "training_iteration": 150, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-00-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.6915932010195, "outflow_rate_min": 796.0662397258114, "system_level_velocity_max": 17.555924513584852, "cost2_min": -98.20210802446208, "system_level_velocity_min": 12.084082544579253, "cost1_min": 143.00467763480947, "cost1_max": 206.908205450935, "cost2_mean": -89.61290158572167, "discrim_loss": 0.8994847536087036, "cost2_max": -73.37562074563759, "cost1_mean": 179.62064179161908, "outflow_rate_mean": 945.0851101497495, "system_level_velocity_mean": 15.115134157030367}}
{"sampler_perf": {"mean_inference_ms": 7.504976894547713, "mean_processing_ms": 11.100264099843143, "mean_env_wait_ms": 125.34186798308893}, "policy_reward_mean": {}, "time_since_restore": 18227.365756988525, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 18227.365756988525, "episodes_total": 3503, "episode_reward_max": 389.337381310761, "episode_reward_mean": 360.9363874961537, "episode_reward_min": 315.1985650882125, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.30946350097656, "timestamp": 1559282556, "episode_len_mean": 323.72727272727275, "iterations_since_restore": 151, "training_iteration": 151, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be2f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bed90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-02-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.541849886088, "outflow_rate_min": 862.1989765456316, "system_level_velocity_max": 17.73687589783651, "cost2_min": -95.97238979693549, "system_level_velocity_min": 13.412009464333588, "cost1_min": 162.07780648078165, "cost1_max": 206.02844978471157, "cost2_mean": -89.63901272590037, "discrim_loss": 0.8651086091995239, "cost2_max": -80.85323880293971, "cost1_mean": 178.93620376975306, "outflow_rate_mean": 942.1332025017217, "system_level_velocity_mean": 15.007376353851017}}
{"sampler_perf": {"mean_inference_ms": 7.506643437654917, "mean_processing_ms": 11.100116391927624, "mean_env_wait_ms": 125.42671530836}, "policy_reward_mean": {}, "time_since_restore": 18343.0673494339, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 18343.0673494339, "episodes_total": 3526, "episode_reward_max": 402.7054171208292, "episode_reward_mean": 348.58660311095986, "episode_reward_min": 327.9653203599155, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.70159244537354, "timestamp": 1559282671, "episode_len_mean": 325.0, "iterations_since_restore": 152, "training_iteration": 152, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302beae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-04-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1048.9151499504599, "outflow_rate_min": 861.0898690532975, "system_level_velocity_max": 17.69146134882908, "cost2_min": -99.17514056793368, "system_level_velocity_min": 13.345469563771912, "cost1_min": 160.81425602103462, "cost1_max": 208.0274213920518, "cost2_mean": -91.38801955936997, "discrim_loss": 0.9317774772644043, "cost2_max": -82.46214511670091, "cost1_mean": 184.19623277593237, "outflow_rate_mean": 960.3269326180767, "system_level_velocity_mean": 15.429483201106155}}
{"sampler_perf": {"mean_inference_ms": 7.504560455275997, "mean_processing_ms": 11.080906219338479, "mean_env_wait_ms": 125.37912585428354}, "policy_reward_mean": {}, "time_since_restore": 18459.713230371475, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 18459.713230371475, "episodes_total": 3550, "episode_reward_max": 433.3161624041386, "episode_reward_mean": 350.26452883239836, "episode_reward_min": 40.612404219806194, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.6458809375763, "timestamp": 1559282788, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 153, "training_iteration": 153, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c18c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-06-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.994947179318, "outflow_rate_min": 477.1206855028346, "system_level_velocity_max": 17.815589450154615, "cost2_min": -98.212936020971, "system_level_velocity_min": 11.242564624613749, "cost1_min": 22.560723263785203, "cost1_max": 207.12243983038962, "cost2_mean": -86.65204145508996, "discrim_loss": 0.9175165891647339, "cost2_max": -25.07228795806658, "cost1_mean": 171.10438545741997, "outflow_rate_mean": 915.3101811190418, "system_level_velocity_mean": 14.958500417696209}}
{"sampler_perf": {"mean_inference_ms": 7.506919484525696, "mean_processing_ms": 11.10479076941477, "mean_env_wait_ms": 125.34291697985748}, "policy_reward_mean": {}, "time_since_restore": 18577.86107635498, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 18577.86107635498, "episodes_total": 3573, "episode_reward_max": 492.09455447021173, "episode_reward_mean": 390.28463221113856, "episode_reward_min": 350.6516243889928, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.14784598350525, "timestamp": 1559282906, "episode_len_mean": 325.0, "iterations_since_restore": 154, "training_iteration": 154, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79304250d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-08-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.5954270812065, "outflow_rate_min": 787.8430490516562, "system_level_velocity_max": 17.76081748274963, "cost2_min": -96.7221571944865, "system_level_velocity_min": 11.711284682482948, "cost1_min": 139.39178508498304, "cost1_max": 208.13453549004555, "cost2_mean": -89.36339669786366, "discrim_loss": 0.8991172313690186, "cost2_max": -76.92199516099116, "cost1_mean": 177.6266452492032, "outflow_rate_mean": 934.7759507134551, "system_level_velocity_mean": 14.83069870733597}}
{"sampler_perf": {"mean_inference_ms": 7.513508007844609, "mean_processing_ms": 11.109014083681219, "mean_env_wait_ms": 125.40692571131629}, "policy_reward_mean": {}, "time_since_restore": 18692.403036117554, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 18692.403036117554, "episodes_total": 3596, "episode_reward_max": 485.0645095333457, "episode_reward_mean": 401.4484542992128, "episode_reward_min": 369.97278935462236, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.54195976257324, "timestamp": 1559283021, "episode_len_mean": 325.0, "iterations_since_restore": 155, "training_iteration": 155, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303242f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-10-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.1657848087232, "outflow_rate_min": 781.474039242976, "system_level_velocity_max": 17.374008128453006, "cost2_min": -95.74635271065726, "system_level_velocity_min": 11.629014097518555, "cost1_min": 137.61643415983593, "cost1_max": 206.05785189196254, "cost2_mean": -88.30464619341025, "discrim_loss": 0.9083316326141357, "cost2_max": -75.15225524693838, "cost1_mean": 175.82788985151683, "outflow_rate_mean": 925.3526718924537, "system_level_velocity_mean": 14.670388410025808}}
{"sampler_perf": {"mean_inference_ms": 7.508526733284231, "mean_processing_ms": 11.091639844098937, "mean_env_wait_ms": 125.3838259617499}, "policy_reward_mean": {}, "time_since_restore": 18810.045835256577, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 18810.045835256577, "episodes_total": 3620, "episode_reward_max": 404.19738806411624, "episode_reward_mean": 382.8958911427956, "episode_reward_min": 360.7381381150335, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.64279913902283, "timestamp": 1559283141, "episode_len_mean": 325.0, "iterations_since_restore": 156, "training_iteration": 156, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302beb70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302beea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bef28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-12-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.3076953056068, "outflow_rate_min": 886.5361503248765, "system_level_velocity_max": 17.637969851589208, "cost2_min": -97.60170639844326, "system_level_velocity_min": 13.709938846984766, "cost1_min": 166.32093254350065, "cost1_max": 208.09280295492857, "cost2_mean": -90.99493165949912, "discrim_loss": 0.8743207454681396, "cost2_max": -84.34542844992322, "cost1_mean": 185.06882365143903, "outflow_rate_mean": 965.2341788428809, "system_level_velocity_mean": 15.523369618278275}}
{"sampler_perf": {"mean_inference_ms": 7.511391295039789, "mean_processing_ms": 11.11406395825864, "mean_env_wait_ms": 125.33403487426112}, "policy_reward_mean": {}, "time_since_restore": 18925.61433982849, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 18925.61433982849, "episodes_total": 3644, "episode_reward_max": 434.35979734454304, "episode_reward_mean": 365.4781233019118, "episode_reward_min": 139.90323862433434, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.56850457191467, "timestamp": 1559283256, "episode_len_mean": 316.3333333333333, "iterations_since_restore": 157, "training_iteration": 157, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303659d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-14-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.8957781265483, "outflow_rate_min": 730.6152130144177, "system_level_velocity_max": 18.634544214021734, "cost2_min": -96.48288410929847, "system_level_velocity_min": 11.643796495515236, "cost1_min": 78.1096819540868, "cost1_max": 208.41375993678443, "cost2_mean": -86.36010850763587, "discrim_loss": 0.9628276228904724, "cost2_max": -52.41702347447677, "cost1_mean": 169.62328848137932, "outflow_rate_mean": 911.331577151184, "system_level_velocity_mean": 14.66575273004428}}
{"sampler_perf": {"mean_inference_ms": 7.515346873776454, "mean_processing_ms": 11.118827851655784, "mean_env_wait_ms": 125.3844304706197}, "policy_reward_mean": {}, "time_since_restore": 19041.385982751846, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 19041.385982751846, "episodes_total": 3667, "episode_reward_max": 406.3694445034489, "episode_reward_mean": 374.6479371207483, "episode_reward_min": 346.64999263361096, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.7716429233551, "timestamp": 1559283372, "episode_len_mean": 325.0, "iterations_since_restore": 158, "training_iteration": 158, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-16-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.0446682762758, "outflow_rate_min": 878.9623812057533, "system_level_velocity_max": 17.713231872104135, "cost2_min": -98.15005265668003, "system_level_velocity_min": 13.711553985115444, "cost1_min": 164.4022165663785, "cost1_max": 208.17798448861157, "cost2_mean": -90.46023209064226, "discrim_loss": 0.9462764859199524, "cost2_max": -80.76926565907519, "cost1_mean": 185.18756075772623, "outflow_rate_mean": 961.29396932335, "system_level_velocity_mean": 15.507436956496047}}
{"sampler_perf": {"mean_inference_ms": 7.5096050856480545, "mean_processing_ms": 11.100751717030967, "mean_env_wait_ms": 125.31623803525781}, "policy_reward_mean": {}, "time_since_restore": 19157.61265516281, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 19157.61265516281, "episodes_total": 3690, "episode_reward_max": 505.9068684093654, "episode_reward_mean": 411.5783713483707, "episode_reward_min": 149.0728378891945, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.22667241096497, "timestamp": 1559283489, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 159, "training_iteration": 159, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bed08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-18-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.060949249401, "outflow_rate_min": 741.4515605727015, "system_level_velocity_max": 18.648245550990534, "cost2_min": -97.18357888573054, "system_level_velocity_min": 12.419449460067487, "cost1_min": 77.59402642031517, "cost1_max": 207.6120313294408, "cost2_mean": -87.97091709852563, "discrim_loss": 0.966248095035553, "cost2_max": -51.80128360302287, "cost1_mean": 176.25825201848713, "outflow_rate_mean": 937.9697717112904, "system_level_velocity_mean": 15.276397591797478}}
{"sampler_perf": {"mean_inference_ms": 7.5116479119296535, "mean_processing_ms": 11.115100102241533, "mean_env_wait_ms": 125.31502080095873}, "policy_reward_mean": {}, "time_since_restore": 19275.62442946434, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 19275.62442946434, "episodes_total": 3714, "episode_reward_max": 568.0613274909556, "episode_reward_mean": 441.4928965192909, "episode_reward_min": 383.6657986342907, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.01177430152893, "timestamp": 1559283607, "episode_len_mean": 325.0, "iterations_since_restore": 160, "training_iteration": 160, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-20-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.5655701316625, "outflow_rate_min": 771.0902509275605, "system_level_velocity_max": 17.351049582582146, "cost2_min": -95.9023977138144, "system_level_velocity_min": 11.460603557538159, "cost1_min": 136.7536121256344, "cost1_max": 206.50246957884346, "cost2_mean": -86.16701694901452, "discrim_loss": 0.9762824773788452, "cost2_max": -70.81439683246037, "cost1_mean": 171.67523270259184, "outflow_rate_mean": 914.4499507528957, "system_level_velocity_mean": 14.34934536469215}}
{"sampler_perf": {"mean_inference_ms": 7.517127089271387, "mean_processing_ms": 11.122022847493739, "mean_env_wait_ms": 125.30787548751981}, "policy_reward_mean": {}, "time_since_restore": 19394.07172513008, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 19394.07172513008, "episodes_total": 3737, "episode_reward_max": 483.2679771371186, "episode_reward_mean": 418.5105055669606, "episode_reward_min": 378.23193007707596, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.44729566574097, "timestamp": 1559283727, "episode_len_mean": 325.0, "iterations_since_restore": 161, "training_iteration": 161, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b41e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b40d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-22-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.432693316298, "outflow_rate_min": 854.0690149000835, "system_level_velocity_max": 17.564868909708444, "cost2_min": -96.21453142226284, "system_level_velocity_min": 13.188406061593874, "cost1_min": 158.07585209924886, "cost1_max": 207.32202281966232, "cost2_mean": -86.99902799236959, "discrim_loss": 0.9224401712417603, "cost2_max": -79.68531228668263, "cost1_mean": 173.00212058575212, "outflow_rate_mean": 918.5590807675051, "system_level_velocity_mean": 14.441775072829344}}
{"sampler_perf": {"mean_inference_ms": 7.518876793144388, "mean_processing_ms": 11.115828226163611, "mean_env_wait_ms": 125.40689362407392}, "policy_reward_mean": {}, "time_since_restore": 19513.53978919983, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 19513.53978919983, "episodes_total": 3758, "episode_reward_max": 506.3020604159683, "episode_reward_mean": 409.39663662537487, "episode_reward_min": 364.3623354434967, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.46806406974792, "timestamp": 1559283846, "episode_len_mean": 325.0, "iterations_since_restore": 162, "training_iteration": 162, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-24-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.1033237141658, "outflow_rate_min": 785.367618754304, "system_level_velocity_max": 17.619094762630983, "cost2_min": -97.57580642583724, "system_level_velocity_min": 12.027262505879271, "cost1_min": 143.78857042163452, "cost1_max": 208.16556454377454, "cost2_mean": -90.59881712435076, "discrim_loss": 0.9976293444633484, "cost2_max": -73.13981787337642, "cost1_mean": 181.4889369152647, "outflow_rate_mean": 949.7246560379511, "system_level_velocity_mean": 15.185339496341147}}
{"sampler_perf": {"mean_inference_ms": 7.514591581099495, "mean_processing_ms": 11.113596965636969, "mean_env_wait_ms": 125.33719463869576}, "policy_reward_mean": {}, "time_since_restore": 19634.159269332886, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 19634.159269332886, "episodes_total": 3784, "episode_reward_max": 513.4299343419261, "episode_reward_mean": 434.95347988110063, "episode_reward_min": 376.25552747398615, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.61948013305664, "timestamp": 1559283967, "episode_len_mean": 325.0, "iterations_since_restore": 163, "training_iteration": 163, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b41e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-26-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.633302575463, "outflow_rate_min": 832.9756504544098, "system_level_velocity_max": 17.613474996040836, "cost2_min": -96.93735886784053, "system_level_velocity_min": 12.814773657546574, "cost1_min": 155.74905900880634, "cost1_max": 207.50607256836793, "cost2_mean": -88.42252551578636, "discrim_loss": 0.9849190711975098, "cost2_max": -79.68772307414253, "cost1_mean": 176.93708895572897, "outflow_rate_mean": 935.6403778655689, "system_level_velocity_mean": 14.809817138392656}}
{"sampler_perf": {"mean_inference_ms": 7.517587848083831, "mean_processing_ms": 11.111116928884394, "mean_env_wait_ms": 125.32742483679095}, "policy_reward_mean": {}, "time_since_restore": 19751.422736644745, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 19751.422736644745, "episodes_total": 3806, "episode_reward_max": 584.5105344355106, "episode_reward_mean": 439.22885941239923, "episode_reward_min": 38.7233207821846, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.26346731185913, "timestamp": 1559284084, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 164, "training_iteration": 164, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-28-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.8178684831273, "outflow_rate_min": 477.24354782665716, "system_level_velocity_max": 17.539528773426053, "cost2_min": -96.08161125503817, "system_level_velocity_min": 9.815787966579096, "cost1_min": 17.778810187467347, "cost1_max": 206.6401130851774, "cost2_mean": -85.01226402228181, "discrim_loss": 1.0038553476333618, "cost2_max": -17.513593494225205, "cost1_mean": 170.30488283284873, "outflow_rate_mean": 915.8848406413402, "system_level_velocity_mean": 14.960001467265336}}
{"sampler_perf": {"mean_inference_ms": 7.522708245137806, "mean_processing_ms": 11.1250944182267, "mean_env_wait_ms": 125.41239573475761}, "policy_reward_mean": {}, "time_since_restore": 19870.38675236702, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 19870.38675236702, "episodes_total": 3829, "episode_reward_max": 567.5690066562966, "episode_reward_mean": 447.4284308071086, "episode_reward_min": 389.09142899140716, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.96401572227478, "timestamp": 1559284203, "episode_len_mean": 324.2173913043478, "iterations_since_restore": 165, "training_iteration": 165, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ab70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-30-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.7409901816961, "outflow_rate_min": 797.7055804827818, "system_level_velocity_max": 17.310433806410785, "cost2_min": -96.86041521604625, "system_level_velocity_min": 11.943072553535504, "cost1_min": 143.26078313471766, "cost1_max": 205.20260837166353, "cost2_mean": -86.5447658160053, "discrim_loss": 0.9764792919158936, "cost2_max": -73.63186204346101, "cost1_mean": 173.8343098220728, "outflow_rate_mean": 921.0030574734163, "system_level_velocity_mean": 14.566164005263918}}
{"sampler_perf": {"mean_inference_ms": 7.517470292628612, "mean_processing_ms": 11.10200063201796, "mean_env_wait_ms": 125.38670577322547}, "policy_reward_mean": {}, "time_since_restore": 19993.111181020737, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 19993.111181020737, "episodes_total": 3852, "episode_reward_max": 502.8735600062646, "episode_reward_mean": 417.35969518813425, "episode_reward_min": 377.839725099504, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.72442865371704, "timestamp": 1559284326, "episode_len_mean": 325.0, "iterations_since_restore": 166, "training_iteration": 166, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-32-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.7243450212793, "outflow_rate_min": 823.4905058029549, "system_level_velocity_max": 17.616538639672644, "cost2_min": -97.65487306326034, "system_level_velocity_min": 12.512064146993605, "cost1_min": 150.43079393094735, "cost1_max": 207.6535243130361, "cost2_mean": -86.98651033042796, "discrim_loss": 0.9387563467025757, "cost2_max": -79.82339285442082, "cost1_mean": 174.74555744128534, "outflow_rate_mean": 925.6593169709547, "system_level_velocity_mean": 14.637054998886885}}
{"sampler_perf": {"mean_inference_ms": 7.5199494136398926, "mean_processing_ms": 11.116420233312393, "mean_env_wait_ms": 125.33791957316932}, "policy_reward_mean": {}, "time_since_restore": 20113.126750707626, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 20113.126750707626, "episodes_total": 3875, "episode_reward_max": 568.295077715069, "episode_reward_mean": 428.9553986197216, "episode_reward_min": 379.76417219638824, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.01556968688965, "timestamp": 1559284446, "episode_len_mean": 325.0, "iterations_since_restore": 167, "training_iteration": 167, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-34-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.4598452778582, "outflow_rate_min": 670.0971601984204, "system_level_velocity_max": 17.587619041432916, "cost2_min": -96.66041512241796, "system_level_velocity_min": 10.002877659066918, "cost1_min": 119.65839017074919, "cost1_max": 208.27662776266158, "cost2_mean": -88.58041200572086, "discrim_loss": 0.9978973865509033, "cost2_max": -72.26979648944507, "cost1_mean": 181.17275551910967, "outflow_rate_mean": 945.4415658855316, "system_level_velocity_mean": 15.169126032331224}}
{"sampler_perf": {"mean_inference_ms": 7.526334669409085, "mean_processing_ms": 11.13268166604843, "mean_env_wait_ms": 125.35738951389847}, "policy_reward_mean": {}, "time_since_restore": 20234.37370324135, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 26, "time_total_s": 20234.37370324135, "episodes_total": 3901, "episode_reward_max": 570.7123727493454, "episode_reward_mean": 411.5038782880158, "episode_reward_min": 32.4525156840682, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.24695253372192, "timestamp": 1559284568, "episode_len_mean": 302.38461538461536, "iterations_since_restore": 168, "training_iteration": 168, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a2f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-36-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.647209594853, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 18.614542477087646, "cost2_min": -95.9968366369718, "system_level_velocity_min": 12.774280326240604, "cost1_min": 17.916530350503464, "cost1_max": 208.7786448896406, "cost2_mean": -81.63703026158426, "discrim_loss": 0.9982312917709351, "cost2_max": -21.48625246355693, "cost1_mean": 165.4769632789559, "outflow_rate_mean": 900.0194799566938, "system_level_velocity_mean": 15.115418359572166}}
{"sampler_perf": {"mean_inference_ms": 7.517673423375731, "mean_processing_ms": 11.110451037493673, "mean_env_wait_ms": 125.36882713984713}, "policy_reward_mean": {}, "time_since_restore": 20352.405348539352, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 20352.405348539352, "episodes_total": 3924, "episode_reward_max": 518.34835260408, "episode_reward_mean": 430.61744453536556, "episode_reward_min": 399.9040413349867, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.03164529800415, "timestamp": 1559284686, "episode_len_mean": 325.0, "iterations_since_restore": 169, "training_iteration": 169, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303248c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303242f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-38-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.9231295827283, "outflow_rate_min": 798.7892899398405, "system_level_velocity_max": 17.567023711651874, "cost2_min": -96.5103677358478, "system_level_velocity_min": 11.96601802199325, "cost1_min": 143.4447684489854, "cost1_max": 207.5605939660723, "cost2_mean": -86.63460508160978, "discrim_loss": 0.9677978754043579, "cost2_max": -72.93084439994442, "cost1_mean": 179.12703771788637, "outflow_rate_mean": 939.32237821069, "system_level_velocity_mean": 14.979686991836452}}
{"sampler_perf": {"mean_inference_ms": 7.519698538805563, "mean_processing_ms": 11.123843398101512, "mean_env_wait_ms": 125.29043191609995}, "policy_reward_mean": {}, "time_since_restore": 20478.52836704254, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 20478.52836704254, "episodes_total": 3947, "episode_reward_max": 508.94754592096433, "episode_reward_mean": 404.97464273845316, "episode_reward_min": 369.94412142038345, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.12301850318909, "timestamp": 1559284812, "episode_len_mean": 323.7826086956522, "iterations_since_restore": 170, "training_iteration": 170, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c20d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c21e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-40-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.9676548774532, "outflow_rate_min": 858.5805812258363, "system_level_velocity_max": 17.62258020345592, "cost2_min": -98.69913646778522, "system_level_velocity_min": 12.834890688012882, "cost1_min": 150.6181620888665, "cost1_max": 207.42952178043424, "cost2_mean": -88.38743135744427, "discrim_loss": 0.948228657245636, "cost2_max": -77.98782481069928, "cost1_mean": 180.82505557294172, "outflow_rate_mean": 950.2988080919653, "system_level_velocity_mean": 15.240104677111919}}
{"sampler_perf": {"mean_inference_ms": 7.524163041117025, "mean_processing_ms": 11.134062050503994, "mean_env_wait_ms": 125.3068320319958}, "policy_reward_mean": {}, "time_since_restore": 20598.227865219116, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 20598.227865219116, "episodes_total": 3971, "episode_reward_max": 694.6744773190003, "episode_reward_mean": 410.7663897984797, "episode_reward_min": 368.72308449447155, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.6994981765747, "timestamp": 1559284932, "episode_len_mean": 325.0, "iterations_since_restore": 171, "training_iteration": 171, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-42-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.4326685617928, "outflow_rate_min": 680.2896201338032, "system_level_velocity_max": 17.699653245753098, "cost2_min": -95.81455508344683, "system_level_velocity_min": 10.178979793482402, "cost1_min": 120.75046421962105, "cost1_max": 207.8067972423853, "cost2_mean": -84.30197465125038, "discrim_loss": 0.9571267366409302, "cost2_max": -72.26268517093912, "cost1_mean": 172.33350306212574, "outflow_rate_mean": 911.6262067115717, "system_level_velocity_mean": 14.43627188241127}}
{"sampler_perf": {"mean_inference_ms": 7.522620507710355, "mean_processing_ms": 11.115545129592643, "mean_env_wait_ms": 125.31581603849732}, "policy_reward_mean": {}, "time_since_restore": 20724.70572066307, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 20724.70572066307, "episodes_total": 3992, "episode_reward_max": 816.5048195235431, "episode_reward_mean": 438.39396973003056, "episode_reward_min": 382.4899220056832, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.47785544395447, "timestamp": 1559285058, "episode_len_mean": 325.0, "iterations_since_restore": 172, "training_iteration": 172, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-44-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.0162624644813, "outflow_rate_min": 755.8807016364306, "system_level_velocity_max": 17.641230269568297, "cost2_min": -97.18235545902492, "system_level_velocity_min": 11.096139258493046, "cost1_min": 132.98563547683472, "cost1_max": 207.1284631166575, "cost2_mean": -85.26975180143546, "discrim_loss": 1.0220904350280762, "cost2_max": -71.58666846996934, "cost1_mean": 173.47837241200602, "outflow_rate_mean": 913.0998738869404, "system_level_velocity_mean": 14.510266395922383}}
{"sampler_perf": {"mean_inference_ms": 7.5188489956232525, "mean_processing_ms": 11.117627716523096, "mean_env_wait_ms": 125.3286951857265}, "policy_reward_mean": {}, "time_since_restore": 20854.423360824585, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 20854.423360824585, "episodes_total": 4017, "episode_reward_max": 659.5584895233624, "episode_reward_mean": 469.25371962633915, "episode_reward_min": 410.14647120796144, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.71764016151428, "timestamp": 1559285188, "episode_len_mean": 325.0, "iterations_since_restore": 173, "training_iteration": 173, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-46-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.1356696162848, "outflow_rate_min": 664.8835037094514, "system_level_velocity_max": 17.67483909776416, "cost2_min": -95.38158133090604, "system_level_velocity_min": 9.948585594998674, "cost1_min": 118.06955059106221, "cost1_max": 208.11651681597866, "cost2_mean": -81.83075117555137, "discrim_loss": 0.9970313906669617, "cost2_max": -68.55559304295583, "cost1_mean": 164.3100745836773, "outflow_rate_mean": 878.6006587036559, "system_level_velocity_mean": 13.736473337198845}}
{"sampler_perf": {"mean_inference_ms": 7.525412897735871, "mean_processing_ms": 11.132318820348472, "mean_env_wait_ms": 125.4268890518949}, "policy_reward_mean": {}, "time_since_restore": 20996.45939540863, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 20996.45939540863, "episodes_total": 4040, "episode_reward_max": 814.4997722618282, "episode_reward_mean": 494.3756680102334, "episode_reward_min": 419.85967741906643, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.0360345840454, "timestamp": 1559285330, "episode_len_mean": 325.0, "iterations_since_restore": 174, "training_iteration": 174, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b49d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b46a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-48-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.2045912456304, "outflow_rate_min": 740.32490938333, "system_level_velocity_max": 17.62783965550836, "cost2_min": -96.90693565957567, "system_level_velocity_min": 11.199841453309551, "cost1_min": 133.52960661953603, "cost1_max": 208.0595981649638, "cost2_mean": -83.67975330319676, "discrim_loss": 1.0055779218673706, "cost2_max": -71.19356428768174, "cost1_mean": 171.58662247662537, "outflow_rate_mean": 908.7098477847499, "system_level_velocity_mean": 14.422706111574655}}
{"sampler_perf": {"mean_inference_ms": 7.524955687664616, "mean_processing_ms": 11.122080244025513, "mean_env_wait_ms": 125.3851925851289}, "policy_reward_mean": {}, "time_since_restore": 21134.692285060883, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 21134.692285060883, "episodes_total": 4061, "episode_reward_max": 790.0914315561531, "episode_reward_mean": 501.09574681083075, "episode_reward_min": 390.97051914967597, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.2328896522522, "timestamp": 1559285468, "episode_len_mean": 325.0, "iterations_since_restore": 175, "training_iteration": 175, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c26a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-51-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.7690347939636, "outflow_rate_min": 569.2378151096757, "system_level_velocity_max": 17.531823650211912, "cost2_min": -97.36637944151535, "system_level_velocity_min": 8.64796770002807, "cost1_min": 100.65796030767045, "cost1_max": 207.67439100729206, "cost2_mean": -83.69210935870238, "discrim_loss": 0.9990745782852173, "cost2_max": -61.005047426546135, "cost1_mean": 166.91496810718854, "outflow_rate_mean": 888.0443681596944, "system_level_velocity_mean": 14.028026931225778}}
{"sampler_perf": {"mean_inference_ms": 7.52064103586244, "mean_processing_ms": 11.119671692986449, "mean_env_wait_ms": 125.46676705410458}, "policy_reward_mean": {}, "time_since_restore": 21272.293962717056, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 21272.293962717056, "episodes_total": 4086, "episode_reward_max": 679.2179565075785, "episode_reward_mean": 480.3606210689619, "episode_reward_min": 399.41095924936235, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.6016776561737, "timestamp": 1559285606, "episode_len_mean": 324.2, "iterations_since_restore": 176, "training_iteration": 176, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b48c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b42f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-53-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1048.805140088244, "outflow_rate_min": 645.1850677186245, "system_level_velocity_max": 17.700256966471958, "cost2_min": -96.92089119289298, "system_level_velocity_min": 9.065733180563933, "cost1_min": 107.24280700824269, "cost1_max": 208.0664541894276, "cost2_mean": -80.81626216607123, "discrim_loss": 0.9144256114959717, "cost2_max": -69.20445522370699, "cost1_mean": 158.85219416650116, "outflow_rate_mean": 860.8822087203869, "system_level_velocity_mean": 13.40748575622087}}
{"sampler_perf": {"mean_inference_ms": 7.5285710246331226, "mean_processing_ms": 11.132048327000238, "mean_env_wait_ms": 125.6365499640589}, "policy_reward_mean": {}, "time_since_restore": 21406.147658348083, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 22, "time_total_s": 21406.147658348083, "episodes_total": 4108, "episode_reward_max": 613.8885907091899, "episode_reward_mean": 482.00975939908744, "episode_reward_min": 396.2559605455026, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.85369563102722, "timestamp": 1559285740, "episode_len_mean": 325.0, "iterations_since_restore": 177, "training_iteration": 177, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b47b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b40d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-55-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.548921160703, "outflow_rate_min": 686.3469315915474, "system_level_velocity_max": 17.658917980941954, "cost2_min": -96.33313981503863, "system_level_velocity_min": 10.125434095077516, "cost1_min": 121.30822586912359, "cost1_max": 208.41477487930385, "cost2_mean": -80.53069161533594, "discrim_loss": 0.9606170654296875, "cost2_max": -69.47760803751775, "cost1_mean": 156.86983620117644, "outflow_rate_mean": 844.2412651752707, "system_level_velocity_mean": 13.139802463743647}}
{"sampler_perf": {"mean_inference_ms": 7.5288604151217, "mean_processing_ms": 11.13763845373209, "mean_env_wait_ms": 125.62479374837353}, "policy_reward_mean": {}, "time_since_restore": 21540.05989575386, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 21540.05989575386, "episodes_total": 4132, "episode_reward_max": 567.2750244881026, "episode_reward_mean": 463.1259423821951, "episode_reward_min": 44.77095025777817, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.91223740577698, "timestamp": 1559285874, "episode_len_mean": 312.5833333333333, "iterations_since_restore": 178, "training_iteration": 178, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-57-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.0584488063048, "outflow_rate_min": 496.0238329292389, "system_level_velocity_max": 19.213440432277654, "cost2_min": -97.72313676730468, "system_level_velocity_min": 9.544698118505044, "cost1_min": 18.044266247772832, "cost1_max": 208.05840346167912, "cost2_mean": -79.92016563519697, "discrim_loss": 0.9561440944671631, "cost2_max": -18.912012608744394, "cost1_mean": 157.06106527925192, "outflow_rate_mean": 854.3177234103354, "system_level_velocity_mean": 13.890347762220287}}
{"sampler_perf": {"mean_inference_ms": 7.524223175275431, "mean_processing_ms": 11.115681744724965, "mean_env_wait_ms": 125.76777209281227}, "policy_reward_mean": {}, "time_since_restore": 21684.207614421844, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 21684.207614421844, "episodes_total": 4155, "episode_reward_max": 524.655622928869, "episode_reward_mean": 440.679808767315, "episode_reward_min": 361.28079237788916, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 144.147718667984, "timestamp": 1559286018, "episode_len_mean": 325.0, "iterations_since_restore": 179, "training_iteration": 179, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c29d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-00-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1028.9216885979388, "outflow_rate_min": 545.833934129, "system_level_velocity_max": 17.1023193846268, "cost2_min": -94.6606780233748, "system_level_velocity_min": 8.429778735693235, "cost1_min": 98.31237446169516, "cost1_max": 203.522384346112, "cost2_mean": -77.519232857778, "discrim_loss": 0.8791778087615967, "cost2_max": -57.84542941795509, "cost1_mean": 147.33688626186137, "outflow_rate_mean": 802.3965203705104, "system_level_velocity_mean": 12.370623046161787}}
{"sampler_perf": {"mean_inference_ms": 7.528073608676447, "mean_processing_ms": 11.137423633147767, "mean_env_wait_ms": 125.78614556862954}, "policy_reward_mean": {}, "time_since_restore": 21820.17371892929, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 21820.17371892929, "episodes_total": 4179, "episode_reward_max": 540.0933384075761, "episode_reward_mean": 427.909824482694, "episode_reward_min": 61.722443744540215, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.9661045074463, "timestamp": 1559286154, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 180, "training_iteration": 180, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c22f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c26a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-02-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1014.3816032838852, "outflow_rate_min": 479.24583308252767, "system_level_velocity_max": 18.511333821762253, "cost2_min": -96.09617627190909, "system_level_velocity_min": 8.940863696160893, "cost1_min": 22.98475962288908, "cost1_max": 201.48457406969658, "cost2_mean": -75.84765205001308, "discrim_loss": 0.8564323782920837, "cost2_max": -24.61762815690783, "cost1_mean": 143.6387463000933, "outflow_rate_mean": 795.6374204522517, "system_level_velocity_mean": 12.736458183710804}}
{"sampler_perf": {"mean_inference_ms": 7.530803985171945, "mean_processing_ms": 11.146861541484686, "mean_env_wait_ms": 125.84811140598372}, "policy_reward_mean": {}, "time_since_restore": 21964.56193447113, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 25, "time_total_s": 21964.56193447113, "episodes_total": 4204, "episode_reward_max": 578.537945151329, "episode_reward_mean": 427.4493283141474, "episode_reward_min": 68.55390793085098, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 144.3882155418396, "timestamp": 1559286299, "episode_len_mean": 313.4, "iterations_since_restore": 181, "training_iteration": 181, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-04-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.3442911299187, "outflow_rate_min": 506.5568824271422, "system_level_velocity_max": 18.821732447933623, "cost2_min": -98.46048901089799, "system_level_velocity_min": 8.94380096936016, "cost1_min": 23.167936425656386, "cost1_max": 206.69242180900562, "cost2_mean": -79.47963831257441, "discrim_loss": 0.8305410146713257, "cost2_max": -23.106147777626937, "cost1_mean": 155.31345192628433, "outflow_rate_mean": 844.505920579853, "system_level_velocity_mean": 13.73448484669452}}
{"sampler_perf": {"mean_inference_ms": 7.5272732777005755, "mean_processing_ms": 11.119591303492564, "mean_env_wait_ms": 126.05136597354233}, "policy_reward_mean": {}, "time_since_restore": 22107.678985118866, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 23, "time_total_s": 22107.678985118866, "episodes_total": 4227, "episode_reward_max": 552.7486278116703, "episode_reward_mean": 414.7638156351269, "episode_reward_min": 302.10504725947976, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 143.1170506477356, "timestamp": 1559286442, "episode_len_mean": 325.0, "iterations_since_restore": 182, "training_iteration": 182, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-07-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1046.5671276473875, "outflow_rate_min": 544.867588319471, "system_level_velocity_max": 17.70099190563714, "cost2_min": -97.48405337230338, "system_level_velocity_min": 8.726217488036184, "cost1_min": 103.69288678562046, "cost1_max": 207.95009539669758, "cost2_mean": -81.27483874363443, "discrim_loss": 0.8471034169197083, "cost2_max": -64.8780892971805, "cost1_mean": 159.0158877594052, "outflow_rate_mean": 847.6915129151604, "system_level_velocity_mean": 13.392970798700862}}
{"sampler_perf": {"mean_inference_ms": 7.5302082602311105, "mean_processing_ms": 11.144403632771294, "mean_env_wait_ms": 126.11107501418553}, "policy_reward_mean": {}, "time_since_restore": 22254.34488248825, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 22254.34488248825, "episodes_total": 4251, "episode_reward_max": 559.1750681623816, "episode_reward_mean": 355.90111353768833, "episode_reward_min": 67.23014083504677, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 146.66589736938477, "timestamp": 1559286589, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 183, "training_iteration": 183, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c19d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-09-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.051473198852, "outflow_rate_min": 514.5009007334598, "system_level_velocity_max": 18.8042756339249, "cost2_min": -94.98889038572571, "system_level_velocity_min": 8.3876046094809, "cost1_min": 23.057541535901446, "cost1_max": 207.0454027359117, "cost2_mean": -74.3640096897014, "discrim_loss": 0.7984240651130676, "cost2_max": -23.072582001475347, "cost1_mean": 140.0853321084943, "outflow_rate_mean": 780.9747740789076, "system_level_velocity_mean": 12.526932341949042}}
{"sampler_perf": {"mean_inference_ms": 7.534156128045123, "mean_processing_ms": 11.151952671449488, "mean_env_wait_ms": 126.25245828303315}, "policy_reward_mean": {}, "time_since_restore": 22397.872854948044, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 24, "time_total_s": 22397.872854948044, "episodes_total": 4275, "episode_reward_max": 698.6262441277504, "episode_reward_mean": 429.52936941974986, "episode_reward_min": 278.9790533061605, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 143.5279724597931, "timestamp": 1559286732, "episode_len_mean": 325.0, "iterations_since_restore": 184, "training_iteration": 184, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b9048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303757b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-12-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1038.3581472394615, "outflow_rate_min": 546.6061565411103, "system_level_velocity_max": 17.52759261810955, "cost2_min": -97.96080174541639, "system_level_velocity_min": 7.912808112431521, "cost1_min": 95.59944452816869, "cost1_max": 206.63728282449324, "cost2_mean": -78.21141904920404, "discrim_loss": 0.8070803880691528, "cost2_max": -58.52442662796475, "cost1_mean": 149.83678806708534, "outflow_rate_mean": 811.7582452502994, "system_level_velocity_mean": 12.634400838669363}}
{"sampler_perf": {"mean_inference_ms": 7.532437617867939, "mean_processing_ms": 11.133395516028397, "mean_env_wait_ms": 126.32501935715726}, "policy_reward_mean": {}, "time_since_restore": 22530.5186355114, "experiment_id": "0cb68860c4e14449a3237b01af8cc912", "episodes_this_iter": 21, "time_total_s": 22530.5186355114, "episodes_total": 4296, "episode_reward_max": 746.2669101059437, "episode_reward_mean": 502.13911749474244, "episode_reward_min": 302.1137656910869, "off_policy_estimator": {}, "timesteps_total": null, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.6457805633545, "timestamp": 1559286865, "episode_len_mean": 325.0, "iterations_since_restore": 185, "training_iteration": 185, "node_ip": "10.138.0.2", "pid": 7166, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "output_max_file_size": 67108864, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "use_lstm": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20}, "custom_resources_per_worker": {}, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "discrim_lr": 0.005, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "vf_clip_param": 1000000.0, "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c10d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "sgd_minibatch_size": 128, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-14-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.2408704995478, "outflow_rate_min": 566.6585626287691, "system_level_velocity_max": 17.717706857245414, "cost2_min": -96.8538811718707, "system_level_velocity_min": 8.612001613418803, "cost1_min": 101.06199585172206, "cost1_max": 209.01761640129578, "cost2_mean": -80.04316198710741, "discrim_loss": 0.8343051671981812, "cost2_max": -60.432873749153636, "cost1_mean": 159.07525728454286, "outflow_rate_mean": 851.9278732378821, "system_level_velocity_mean": 13.457194772090883}}

{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 146.36627793312073, "sampler_perf": {"mean_inference_ms": 7.688293825294302, "mean_processing_ms": 9.373382753760774, "mean_env_wait_ms": 133.84593498214744}, "episodes_this_iter": 20, "episodes_total": 20, "time_total_s": 146.36627793312073, "episode_reward_max": 781.4197892546654, "off_policy_estimator": {}, "episode_reward_min": 498.07017010450363, "episode_reward_mean": 648.8484518796206, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 146.36627793312073, "timestamp": 1559264427, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 1, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-00-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 787.3006652222717, "cost1_mean": 122.22906479992328, "system_level_velocity_max": 11.229979158049037, "cost2_min": -72.280031394729, "outflow_rate_min": 672.2662181875679, "system_level_velocity_min": 8.109728884697635, "cost2_max": -32.18480483867213, "cost1_max": 135.37149219964877, "cost2_mean": -49.56622297249033, "cost1_min": 97.04907381948023, "discrim_loss": 1.3864905834197998, "outflow_rate_mean": 727.4915566638746, "system_level_velocity_mean": 10.133599860334751}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 267.7277388572693, "sampler_perf": {"mean_inference_ms": 7.642038213182178, "mean_processing_ms": 9.891666451110433, "mean_env_wait_ms": 131.12512114522934}, "episodes_this_iter": 20, "episodes_total": 40, "time_total_s": 267.7277388572693, "episode_reward_max": 804.690617442131, "off_policy_estimator": {}, "episode_reward_min": 482.39847630262375, "episode_reward_mean": 642.2110554367304, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 121.36146092414856, "timestamp": 1559264549, "episode_len_mean": 325.0, "iterations_since_restore": 2, "training_iteration": 2, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303756a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-02-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 817.5992974728899, "cost1_mean": 115.79730669600875, "system_level_velocity_max": 12.175111377693582, "cost2_min": -73.78773598256348, "outflow_rate_min": 567.1861990423544, "system_level_velocity_min": 8.488780419009657, "cost2_max": -24.830800179768787, "cost1_max": 147.729043957058, "cost2_mean": -45.519370846731626, "cost1_min": 100.71851171049256, "discrim_loss": 1.356874942779541, "outflow_rate_mean": 705.0418520508626, "system_level_velocity_mean": 9.677245210503921}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 382.31890177726746, "sampler_perf": {"mean_inference_ms": 7.5239692354986065, "mean_processing_ms": 9.914651588565347, "mean_env_wait_ms": 130.26616754451365}, "episodes_this_iter": 20, "episodes_total": 60, "time_total_s": 382.31890177726746, "episode_reward_max": 876.3391510248184, "off_policy_estimator": {}, "episode_reward_min": 499.7176437973976, "episode_reward_mean": 668.8647068917751, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 114.59116291999817, "timestamp": 1559264664, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 3, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039bc80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039be18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039bd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039bd08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-04-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 823.5910911193658, "cost1_mean": 116.80947687967175, "system_level_velocity_max": 11.10724436748205, "cost2_min": -79.83421271547112, "outflow_rate_min": 552.3337603770285, "system_level_velocity_min": 8.396708062839657, "cost2_max": -31.62836487579231, "cost1_max": 135.0632273940559, "cost2_mean": -48.26723717926201, "cost1_min": 101.99306280436963, "discrim_loss": 1.3165687322616577, "outflow_rate_mean": 693.1708697163217, "system_level_velocity_mean": 9.710506659706015}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 504.5483350753784, "sampler_perf": {"mean_inference_ms": 7.503599703374069, "mean_processing_ms": 10.850015250243706, "mean_env_wait_ms": 129.72016683636448}, "episodes_this_iter": 31, "episodes_total": 91, "time_total_s": 504.5483350753784, "episode_reward_max": 787.6346334517002, "off_policy_estimator": {}, "episode_reward_min": 47.36337673664093, "episode_reward_mean": 624.8498942054088, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 122.22943329811096, "timestamp": 1559264787, "episode_len_mean": 315.38709677419354, "iterations_since_restore": 4, "training_iteration": 4, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033a950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033a8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033a840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033a7b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-06-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 792.1446441971575, "cost1_mean": 113.48720219814115, "system_level_velocity_max": 16.765640976545583, "cost2_min": -83.2599926087179, "outflow_rate_min": 454.1881787896761, "system_level_velocity_min": 7.630931081114171, "cost2_max": -18.592009235334178, "cost1_max": 133.50786856849192, "cost2_mean": -44.915244087115774, "cost1_min": 17.43802906671644, "discrim_loss": 1.2762129306793213, "outflow_rate_mean": 692.8019308159971, "system_level_velocity_mean": 9.92253198287666}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 624.2336161136627, "sampler_perf": {"mean_inference_ms": 7.4897586949002894, "mean_processing_ms": 10.749773694008473, "mean_env_wait_ms": 129.4956308337918}, "episodes_this_iter": 21, "episodes_total": 112, "time_total_s": 624.2336161136627, "episode_reward_max": 778.8806408345699, "off_policy_estimator": {}, "episode_reward_min": 70.21056264638901, "episode_reward_mean": 586.7163428515196, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 119.6852810382843, "timestamp": 1559264907, "episode_len_mean": 311.1904761904762, "iterations_since_restore": 5, "training_iteration": 5, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-08-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 803.3689295071913, "cost1_mean": 122.73083563027342, "system_level_velocity_max": 18.42079767085709, "cost2_min": -75.75903425220068, "outflow_rate_min": 473.8308088401575, "system_level_velocity_min": 9.008260243155368, "cost2_max": -23.045350015534066, "cost1_max": 146.68860945357608, "cost2_mean": -51.07489384962775, "cost1_min": 22.990698932555265, "discrim_loss": 1.2207934856414795, "outflow_rate_mean": 726.2562930992818, "system_level_velocity_mean": 10.95250248534322}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 752.4879126548767, "sampler_perf": {"mean_inference_ms": 7.553814745193003, "mean_processing_ms": 10.60263034741737, "mean_env_wait_ms": 131.88194292594372}, "episodes_this_iter": 20, "episodes_total": 132, "time_total_s": 752.4879126548767, "episode_reward_max": 728.6877563595772, "off_policy_estimator": {}, "episode_reward_min": 392.54848600924015, "episode_reward_mean": 628.6668352909386, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 128.254296541214, "timestamp": 1559265036, "episode_len_mean": 325.0, "iterations_since_restore": 6, "training_iteration": 6, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039bd90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039bd08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039bc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039bbf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-10-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 824.562039775903, "cost1_mean": 137.19656609162524, "system_level_velocity_max": 12.417598133522512, "cost2_min": -76.96501546399378, "outflow_rate_min": 712.2084572457, "system_level_velocity_min": 9.80323328687621, "cost2_max": -36.95370103436404, "cost1_max": 150.94607708545533, "cost2_mean": -59.94721319719963, "cost1_min": 117.21614795608409, "discrim_loss": 1.1996400356292725, "outflow_rate_mean": 768.1654283228347, "system_level_velocity_mean": 11.328031121943269}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 880.5696229934692, "sampler_perf": {"mean_inference_ms": 7.5966454260554945, "mean_processing_ms": 10.993265610743743, "mean_env_wait_ms": 132.86169352156392}, "episodes_this_iter": 30, "episodes_total": 162, "time_total_s": 880.5696229934692, "episode_reward_max": 880.9545973986387, "off_policy_estimator": {}, "episode_reward_min": 471.1519934386015, "episode_reward_mean": 740.4398176215589, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 128.08171033859253, "timestamp": 1559265166, "episode_len_mean": 325.0, "iterations_since_restore": 7, "training_iteration": 7, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303756a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-12-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.0246578201105, "cost1_mean": 158.51438062259112, "system_level_velocity_max": 16.20597141255863, "cost2_min": -111.26337154678922, "outflow_rate_min": 619.7639470710712, "system_level_velocity_min": 8.838497002901292, "cost2_max": -47.160879967378186, "cost1_max": 198.4259143931863, "cost2_mean": -86.78206965281423, "cost1_min": 106.75165062629128, "discrim_loss": 1.3609925508499146, "outflow_rate_mean": 845.6625428728368, "system_level_velocity_mean": 13.002350404044483}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1015.3546707630157, "sampler_perf": {"mean_inference_ms": 7.613557562234502, "mean_processing_ms": 10.771636322446115, "mean_env_wait_ms": 134.02826952111855}, "episodes_this_iter": 20, "episodes_total": 182, "time_total_s": 1015.3546707630157, "episode_reward_max": 908.6191000342369, "off_policy_estimator": {}, "episode_reward_min": 728.8592460229993, "episode_reward_mean": 847.3511967007071, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.7850477695465, "timestamp": 1559265302, "episode_len_mean": 325.0, "iterations_since_restore": 8, "training_iteration": 8, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303401e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303400d0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-15-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.9143052619763, "cost1_mean": 176.50366761499555, "system_level_velocity_max": 17.703153305852965, "cost2_min": -131.05751600971678, "outflow_rate_min": 672.1537979230881, "system_level_velocity_min": 8.98274061155173, "cost2_max": -88.96996937568592, "cost1_max": 214.09152330270445, "cost2_mean": -113.2573823417154, "cost1_min": 108.93493639523516, "discrim_loss": 1.518718957901001, "outflow_rate_mean": 912.5443327645532, "system_level_velocity_mean": 14.565080509129785}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1148.184730052948, "sampler_perf": {"mean_inference_ms": 7.5991660749412535, "mean_processing_ms": 10.644318103578385, "mean_env_wait_ms": 135.27276336555218}, "episodes_this_iter": 20, "episodes_total": 202, "time_total_s": 1148.184730052948, "episode_reward_max": 905.9927580058575, "off_policy_estimator": {}, "episode_reward_min": 772.545179322362, "episode_reward_mean": 836.0137228447944, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 132.83005928993225, "timestamp": 1559265436, "episode_len_mean": 325.0, "iterations_since_restore": 9, "training_iteration": 9, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-17-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.5954714591726, "cost1_mean": 174.99049256195076, "system_level_velocity_max": 17.986515742408887, "cost2_min": -139.2402592486074, "outflow_rate_min": 797.4585446481842, "system_level_velocity_min": 12.070379781023428, "cost2_max": -104.79512999032012, "cost1_max": 216.67234855525948, "cost2_mean": -122.56025080339796, "cost1_min": 144.7487265915524, "discrim_loss": 1.6002663373947144, "outflow_rate_mean": 920.3650670151034, "system_level_velocity_mean": 14.633599450551111}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1281.1936328411102, "sampler_perf": {"mean_inference_ms": 7.604467846555499, "mean_processing_ms": 10.85410418901755, "mean_env_wait_ms": 135.68273248948014}, "episodes_this_iter": 28, "episodes_total": 230, "time_total_s": 1281.1936328411102, "episode_reward_max": 826.2699261978269, "off_policy_estimator": {}, "episode_reward_min": 691.4061332643032, "episode_reward_mean": 753.4871681061175, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.00890278816223, "timestamp": 1559265569, "episode_len_mean": 325.0, "iterations_since_restore": 10, "training_iteration": 10, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79304250d0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-19-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1084.7564848232814, "cost1_mean": 185.75865774103445, "system_level_velocity_max": 18.74128655194746, "cost2_min": -161.55544667781942, "outflow_rate_min": 797.1270492091951, "system_level_velocity_min": 12.115363226358353, "cost2_max": -107.88829246649496, "cost1_max": 223.04717967091096, "cost2_mean": -124.24894387618089, "cost1_min": 143.437859676369, "discrim_loss": 1.5122225284576416, "outflow_rate_mean": 963.7634093779586, "system_level_velocity_mean": 15.599924114334764}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1410.8390986919403, "sampler_perf": {"mean_inference_ms": 7.5916415766804075, "mean_processing_ms": 10.82203533375697, "mean_env_wait_ms": 135.33202399328673}, "episodes_this_iter": 22, "episodes_total": 252, "time_total_s": 1410.8390986919403, "episode_reward_max": 781.0909710302949, "off_policy_estimator": {}, "episode_reward_min": 657.3091819882393, "episode_reward_mean": 694.6502247198739, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 129.64546585083008, "timestamp": 1559265701, "episode_len_mean": 325.0, "iterations_since_restore": 11, "training_iteration": 11, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303400d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303406a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-21-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1090.9444469941968, "cost1_mean": 194.69164128724125, "system_level_velocity_max": 18.83265724341463, "cost2_min": -146.4408377029751, "outflow_rate_min": 847.8907148739578, "system_level_velocity_min": 12.71991890540562, "cost2_max": -112.9689135874889, "cost1_max": 224.726205846692, "cost2_mean": -127.54356665416186, "cost1_min": 151.88096879735906, "discrim_loss": 1.5347607135772705, "outflow_rate_mean": 991.5004611437137, "system_level_velocity_mean": 16.33398420048253}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1542.886914730072, "sampler_perf": {"mean_inference_ms": 7.604048114002275, "mean_processing_ms": 10.748672747456729, "mean_env_wait_ms": 135.55909436078804}, "episodes_this_iter": 21, "episodes_total": 273, "time_total_s": 1542.886914730072, "episode_reward_max": 679.8719999194145, "off_policy_estimator": {}, "episode_reward_min": 232.39842227101326, "episode_reward_mean": 635.9567702668054, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 132.0478160381317, "timestamp": 1559265833, "episode_len_mean": 315.0952380952381, "iterations_since_restore": 12, "training_iteration": 12, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930344bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930344b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930344ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-23-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1092.064098919653, "cost1_mean": 185.0960875597774, "system_level_velocity_max": 19.000093884338252, "cost2_min": -151.30041302798924, "outflow_rate_min": 733.1447067788461, "system_level_velocity_min": 13.014211096206846, "cost2_max": -63.02618459593063, "cost1_max": 226.15274939331908, "cost2_mean": -127.77506620287897, "cost1_min": 80.93767885510613, "discrim_loss": 1.4429552555084229, "outflow_rate_mean": 970.7238653284481, "system_level_velocity_mean": 16.186398979421636}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1675.0488245487213, "sampler_perf": {"mean_inference_ms": 7.58257904820377, "mean_processing_ms": 10.888093285160396, "mean_env_wait_ms": 136.35652374904205}, "episodes_this_iter": 27, "episodes_total": 300, "time_total_s": 1675.0488245487213, "episode_reward_max": 648.0608424842358, "off_policy_estimator": {}, "episode_reward_min": 608.842678040266, "episode_reward_mean": 627.1832695117703, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 132.1619098186493, "timestamp": 1559265965, "episode_len_mean": 325.0, "iterations_since_restore": 13, "training_iteration": 13, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c38c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3c80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-26-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.8070682022942, "cost1_mean": 172.1271567891019, "system_level_velocity_max": 18.296907933940002, "cost2_min": -154.49329629940135, "outflow_rate_min": 851.324265705226, "system_level_velocity_min": 12.803611713223763, "cost2_max": -124.79819783183765, "cost1_max": 217.8571356759175, "cost2_mean": -136.46234991061633, "cost1_min": 151.0167413046235, "discrim_loss": 1.3168108463287354, "outflow_rate_mean": 925.677287449105, "system_level_velocity_mean": 14.551701730170585}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1802.0635323524475, "sampler_perf": {"mean_inference_ms": 7.570479278839546, "mean_processing_ms": 10.878286756461392, "mean_env_wait_ms": 136.62031968912132}, "episodes_this_iter": 22, "episodes_total": 322, "time_total_s": 1802.0635323524475, "episode_reward_max": 640.9607859253883, "off_policy_estimator": {}, "episode_reward_min": 597.0219608843327, "episode_reward_mean": 612.7536980394613, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 127.0147078037262, "timestamp": 1559266092, "episode_len_mean": 325.0, "iterations_since_restore": 14, "training_iteration": 14, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f9d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f840>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-28-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1084.4196282668825, "cost1_mean": 179.70434895787395, "system_level_velocity_max": 18.80556538322122, "cost2_min": -163.75426828100876, "outflow_rate_min": 814.3888475576239, "system_level_velocity_min": 12.359401183506284, "cost2_max": -118.55701912063657, "cost1_max": 226.20648431701034, "cost2_mean": -137.01659784172688, "cost1_min": 147.06342092074067, "discrim_loss": 1.315447449684143, "outflow_rate_mean": 947.7027473828434, "system_level_velocity_mean": 15.167635889395605}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1931.170742034912, "sampler_perf": {"mean_inference_ms": 7.604134927856171, "mean_processing_ms": 10.832508444908676, "mean_env_wait_ms": 137.07140766706647}, "episodes_this_iter": 21, "episodes_total": 343, "time_total_s": 1931.170742034912, "episode_reward_max": 642.8747348636389, "off_policy_estimator": {}, "episode_reward_min": 613.2292953431606, "episode_reward_mean": 623.4942821555194, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 129.1072096824646, "timestamp": 1559266222, "episode_len_mean": 325.0, "iterations_since_restore": 15, "training_iteration": 15, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303757b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-30-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1087.598395520609, "cost1_mean": 188.08393121009794, "system_level_velocity_max": 18.81106703718221, "cost2_min": -153.06060186728865, "outflow_rate_min": 852.9202729594252, "system_level_velocity_min": 12.776543407907445, "cost2_max": -117.16884869850638, "cost1_max": 224.54401927753983, "cost2_mean": -132.093266393265, "cost1_min": 152.063549052911, "discrim_loss": 1.2771700620651245, "outflow_rate_mean": 977.9326269767544, "system_level_velocity_mean": 15.865129627115317}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2067.699266433716, "sampler_perf": {"mean_inference_ms": 7.6184735378814965, "mean_processing_ms": 10.772680000567096, "mean_env_wait_ms": 138.2239279334977}, "episodes_this_iter": 20, "episodes_total": 363, "time_total_s": 2067.699266433716, "episode_reward_max": 695.1990772634745, "off_policy_estimator": {}, "episode_reward_min": 629.3267582654953, "episode_reward_mean": 660.7425555840134, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 136.5285243988037, "timestamp": 1559266359, "episode_len_mean": 325.0, "iterations_since_restore": 16, "training_iteration": 16, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035fd08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-32-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.730193183614, "cost1_mean": 177.20193953642757, "system_level_velocity_max": 18.66711570358119, "cost2_min": -151.48635486643536, "outflow_rate_min": 881.1623921406771, "system_level_velocity_min": 13.59235870113831, "cost2_max": -116.89048315374131, "cost1_max": 224.27848302419955, "cost2_mean": -135.83153426167615, "cost1_min": 159.65336272394813, "discrim_loss": 1.2156702280044556, "outflow_rate_mean": 939.1615997740662, "system_level_velocity_mean": 14.941561997932592}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2199.63773560524, "sampler_perf": {"mean_inference_ms": 7.614622200449219, "mean_processing_ms": 10.927762706409625, "mean_env_wait_ms": 138.22950254953037}, "episodes_this_iter": 29, "episodes_total": 392, "time_total_s": 2199.63773560524, "episode_reward_max": 779.2240268141031, "off_policy_estimator": {}, "episode_reward_min": 671.3834872096777, "episode_reward_mean": 711.7627599465436, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 131.93846917152405, "timestamp": 1559266494, "episode_len_mean": 325.0, "iterations_since_restore": 17, "training_iteration": 17, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340c80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-34-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1085.5570151164354, "cost1_mean": 181.21296807914536, "system_level_velocity_max": 18.74257057997146, "cost2_min": -164.60796937693826, "outflow_rate_min": 723.1080452694564, "system_level_velocity_min": 10.769489525729766, "cost2_max": -112.25862130372641, "cost1_max": 223.3931252832324, "cost2_mean": -130.95521185722484, "cost1_min": 127.75502209553305, "discrim_loss": 1.3331822156906128, "outflow_rate_mean": 948.9122419596347, "system_level_velocity_mean": 15.282334731106987}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2324.9068863391876, "sampler_perf": {"mean_inference_ms": 7.62834378781553, "mean_processing_ms": 10.92131162629823, "mean_env_wait_ms": 138.18782645363598}, "episodes_this_iter": 21, "episodes_total": 413, "time_total_s": 2324.9068863391876, "episode_reward_max": 772.7957187891006, "off_policy_estimator": {}, "episode_reward_min": 699.5455246567726, "episode_reward_mean": 737.4233537341157, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 125.26915073394775, "timestamp": 1559266622, "episode_len_mean": 325.0, "iterations_since_restore": 18, "training_iteration": 18, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303401e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303406a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-37-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.5957068194398, "cost1_mean": 186.56410063875416, "system_level_velocity_max": 18.533455545630552, "cost2_min": -142.67794066040403, "outflow_rate_min": 844.4152218405239, "system_level_velocity_min": 12.673066008782396, "cost2_max": -113.66021517990626, "cost1_max": 222.26155520275182, "cost2_mean": -125.90674297900921, "cost1_min": 149.26952101096052, "discrim_loss": 1.3364938497543335, "outflow_rate_mean": 967.2557059752911, "system_level_velocity_mean": 15.667039138047436}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2455.658297777176, "sampler_perf": {"mean_inference_ms": 7.633000344997892, "mean_processing_ms": 10.856555247840513, "mean_env_wait_ms": 138.47404125238518}, "episodes_this_iter": 20, "episodes_total": 433, "time_total_s": 2455.658297777176, "episode_reward_max": 794.8645521253347, "off_policy_estimator": {}, "episode_reward_min": 711.2593694329262, "episode_reward_mean": 756.1212214440108, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.75141143798828, "timestamp": 1559266753, "episode_len_mean": 325.0, "iterations_since_restore": 19, "training_iteration": 19, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ec80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ebf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-39-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1080.6263903861357, "cost1_mean": 184.40442188032975, "system_level_velocity_max": 18.387554806249984, "cost2_min": -147.02384591158278, "outflow_rate_min": 863.4990978363289, "system_level_velocity_min": 13.109495604017004, "cost2_max": -106.36275844837239, "cost1_max": 220.37643511568828, "cost2_mean": -124.82660847253071, "cost1_min": 154.6208943907926, "discrim_loss": 1.4002509117126465, "outflow_rate_mean": 962.1687280496046, "system_level_velocity_mean": 15.47815110089535}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2589.1357188224792, "sampler_perf": {"mean_inference_ms": 7.627885038883836, "mean_processing_ms": 10.935854515726907, "mean_env_wait_ms": 138.87950669417825}, "episodes_this_iter": 29, "episodes_total": 462, "time_total_s": 2589.1357188224792, "episode_reward_max": 808.8593360185623, "off_policy_estimator": {}, "episode_reward_min": 680.030523404479, "episode_reward_mean": 749.3230369386488, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.47742104530334, "timestamp": 1559266886, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 20, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375bf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-41-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1078.472920208519, "cost1_mean": 183.13203204732417, "system_level_velocity_max": 18.397063926232256, "cost2_min": -140.87523803122514, "outflow_rate_min": 814.1505855079575, "system_level_velocity_min": 12.182253103511774, "cost2_max": -108.75075030386404, "cost1_max": 219.93991387003595, "cost2_mean": -121.65933376724544, "cost1_min": 145.17182398765436, "discrim_loss": 1.4078409671783447, "outflow_rate_mean": 954.3262393065999, "system_level_velocity_mean": 15.359295502630356}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2717.1203858852386, "sampler_perf": {"mean_inference_ms": 7.634171168205497, "mean_processing_ms": 10.908052303579776, "mean_env_wait_ms": 138.6809169747513}, "episodes_this_iter": 21, "episodes_total": 483, "time_total_s": 2717.1203858852386, "episode_reward_max": 801.9665246978402, "off_policy_estimator": {}, "episode_reward_min": 677.2307792454958, "episode_reward_mean": 729.7341857226122, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 127.9846670627594, "timestamp": 1559267016, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 21, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035fbf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035fb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035fae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035fa60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-43-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.167581367568, "cost1_mean": 188.33610682615256, "system_level_velocity_max": 18.100622899877155, "cost2_min": -139.7352684790793, "outflow_rate_min": 775.6894160882996, "system_level_velocity_min": 11.716243568718982, "cost2_max": -106.38085437694832, "cost1_max": 217.07889875619037, "cost2_mean": -117.31884638766505, "cost1_min": 138.22202093796136, "discrim_loss": 1.42758047580719, "outflow_rate_mean": 964.0072291251187, "system_level_velocity_mean": 15.662650446835446}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2843.3835616111755, "sampler_perf": {"mean_inference_ms": 7.628868581396067, "mean_processing_ms": 10.841001556046939, "mean_env_wait_ms": 138.9862266354659}, "episodes_this_iter": 20, "episodes_total": 503, "time_total_s": 2843.3835616111755, "episode_reward_max": 840.4406582638621, "off_policy_estimator": {}, "episode_reward_min": 658.1754172742367, "episode_reward_mean": 734.213877145201, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 126.26317572593689, "timestamp": 1559267144, "episode_len_mean": 325.0, "iterations_since_restore": 22, "training_iteration": 22, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-45-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.0567937995381, "cost1_mean": 179.77859925197157, "system_level_velocity_max": 17.32269180443134, "cost2_min": -131.4690115852714, "outflow_rate_min": 738.2032718825286, "system_level_velocity_min": 11.082573665607294, "cost2_max": -102.95714348672911, "cost1_max": 208.6585108163082, "cost2_mean": -113.54999403838653, "cost1_min": 130.38756050076776, "discrim_loss": 1.4528594017028809, "outflow_rate_mean": 933.7792954438489, "system_level_velocity_mean": 14.959623049324751}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2975.0359468460083, "sampler_perf": {"mean_inference_ms": 7.636354315789382, "mean_processing_ms": 10.922585839847478, "mean_env_wait_ms": 139.25226392257377}, "episodes_this_iter": 27, "episodes_total": 530, "time_total_s": 2975.0359468460083, "episode_reward_max": 791.6937032192945, "off_policy_estimator": {}, "episode_reward_min": 652.4270384907722, "episode_reward_mean": 711.2751441998063, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 131.65238523483276, "timestamp": 1559267276, "episode_len_mean": 325.0, "iterations_since_restore": 23, "training_iteration": 23, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303610d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79306d3f28>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-47-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1024.5238386710623, "cost1_mean": 183.29671229529708, "system_level_velocity_max": 16.865474892634317, "cost2_min": -136.4593589002451, "outflow_rate_min": 813.5814919850924, "system_level_velocity_min": 12.6820204706432, "cost2_max": -101.25524187016741, "cost1_max": 205.52546836328207, "cost2_mean": -114.16118430942025, "cost1_min": 150.6748520385943, "discrim_loss": 1.4354379177093506, "outflow_rate_mean": 942.9719714860743, "system_level_velocity_mean": 15.12249307092729}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3105.6550767421722, "sampler_perf": {"mean_inference_ms": 7.631429136504113, "mean_processing_ms": 10.948353052955273, "mean_env_wait_ms": 139.16740647639517}, "episodes_this_iter": 23, "episodes_total": 553, "time_total_s": 3105.6550767421722, "episode_reward_max": 781.5054944753647, "off_policy_estimator": {}, "episode_reward_min": 651.9906178116798, "episode_reward_mean": 694.1538288858922, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.61912989616394, "timestamp": 1559267407, "episode_len_mean": 325.0, "iterations_since_restore": 24, "training_iteration": 24, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303756a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-50-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1019.7725993394703, "cost1_mean": 177.93813190230642, "system_level_velocity_max": 16.829099503469024, "cost2_min": -125.85092039711517, "outflow_rate_min": 773.8950843171554, "system_level_velocity_min": 11.730860833319484, "cost2_max": -92.88502964919292, "cost1_max": 204.34215059521577, "cost2_mean": -113.04549023212546, "cost1_min": 139.0483252330293, "discrim_loss": 1.4328032732009888, "outflow_rate_mean": 918.0697376648619, "system_level_velocity_mean": 14.595869142994855}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3230.072071313858, "sampler_perf": {"mean_inference_ms": 7.618570117961629, "mean_processing_ms": 10.897907772850505, "mean_env_wait_ms": 138.9762623139327}, "episodes_this_iter": 20, "episodes_total": 573, "time_total_s": 3230.072071313858, "episode_reward_max": 771.4578660875559, "off_policy_estimator": {}, "episode_reward_min": 645.0340864062309, "episode_reward_mean": 680.2374135024845, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 124.41699457168579, "timestamp": 1559267531, "episode_len_mean": 325.0, "iterations_since_restore": 25, "training_iteration": 25, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-52-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.0433493407547, "cost1_mean": 174.28883789434792, "system_level_velocity_max": 15.757453741780537, "cost2_min": -118.39437927288868, "outflow_rate_min": 754.7795039906407, "system_level_velocity_min": 11.517780411632241, "cost2_max": -99.55679971570831, "cost1_max": 191.00480086286933, "cost2_mean": -109.36029877979745, "cost1_min": 138.01358282425412, "discrim_loss": 1.397176742553711, "outflow_rate_mean": 905.4003956683707, "system_level_velocity_mean": 14.232761014582048}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3357.3106982707977, "sampler_perf": {"mean_inference_ms": 7.613889277563784, "mean_processing_ms": 10.914996224621301, "mean_env_wait_ms": 138.95803506487917}, "episodes_this_iter": 27, "episodes_total": 600, "time_total_s": 3357.3106982707977, "episode_reward_max": 735.6172544360161, "off_policy_estimator": {}, "episode_reward_min": 636.1684314012527, "episode_reward_mean": 660.0925701911802, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 127.2386269569397, "timestamp": 1559267658, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 26, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303757b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-54-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 947.6512405020724, "cost1_mean": 174.088381515025, "system_level_velocity_max": 14.973678952536813, "cost2_min": -126.90405648601592, "outflow_rate_min": 769.6487562285872, "system_level_velocity_min": 11.840855244638325, "cost2_max": -94.61656594885747, "cost1_max": 183.67539217807257, "cost2_mean": -107.0744773819076, "cost1_min": 144.14465808699248, "discrim_loss": 1.3472580909729004, "outflow_rate_mean": 904.4385528757201, "system_level_velocity_mean": 14.191331448313983}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3484.460587501526, "sampler_perf": {"mean_inference_ms": 7.603638017148121, "mean_processing_ms": 10.9404720237248, "mean_env_wait_ms": 138.72016872346273}, "episodes_this_iter": 23, "episodes_total": 623, "time_total_s": 3484.460587501526, "episode_reward_max": 757.9603680074215, "off_policy_estimator": {}, "episode_reward_min": 58.55799090862274, "episode_reward_mean": 650.0748202321322, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 127.14988923072815, "timestamp": 1559267786, "episode_len_mean": 312.4782608695652, "iterations_since_restore": 27, "training_iteration": 27, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303609d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303608c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-56-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 943.6832591624944, "cost1_mean": 160.46399361290676, "system_level_velocity_max": 18.464873261015068, "cost2_min": -121.82517950167409, "outflow_rate_min": 491.83848509259093, "system_level_velocity_min": 11.46715438373561, "cost2_max": -23.19739116959953, "cost1_max": 182.72671156836847, "cost2_mean": -97.81627316251388, "cost1_min": 24.199480514388714, "discrim_loss": 1.342939853668213, "outflow_rate_mean": 860.1960142527479, "system_level_velocity_mean": 13.773942892245055}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3618.9321484565735, "sampler_perf": {"mean_inference_ms": 7.607850795203349, "mean_processing_ms": 10.922302959382224, "mean_env_wait_ms": 139.05603888661813}, "episodes_this_iter": 21, "episodes_total": 644, "time_total_s": 3618.9321484565735, "episode_reward_max": 725.702727586031, "off_policy_estimator": {}, "episode_reward_min": 682.026210308075, "episode_reward_mean": 703.7419273399171, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.4715609550476, "timestamp": 1559267920, "episode_len_mean": 325.0, "iterations_since_restore": 28, "training_iteration": 28, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303597b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-58-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 899.4518758417686, "cost1_mean": 155.97039645489804, "system_level_velocity_max": 14.015632206718823, "cost2_min": -118.45179553856312, "outflow_rate_min": 780.3784739827528, "system_level_velocity_min": 11.667510517799546, "cost2_max": -81.25103266620255, "cost1_max": 172.24875884109377, "cost2_mean": -104.19972844864168, "cost1_min": 142.81894388032768, "discrim_loss": 1.3053381443023682, "outflow_rate_mean": 835.0972437166756, "system_level_velocity_mean": 12.734541671233506}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3756.0705411434174, "sampler_perf": {"mean_inference_ms": 7.6136397885747895, "mean_processing_ms": 10.865661460094618, "mean_env_wait_ms": 139.45837936578505}, "episodes_this_iter": 20, "episodes_total": 664, "time_total_s": 3756.0705411434174, "episode_reward_max": 747.2718909680843, "off_policy_estimator": {}, "episode_reward_min": 676.695022881031, "episode_reward_mean": 700.4402221783996, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 137.13839268684387, "timestamp": 1559268059, "episode_len_mean": 325.0, "iterations_since_restore": 29, "training_iteration": 29, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303592f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303596a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359048>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-00-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 934.255812308275, "cost1_mean": 166.32829163239603, "system_level_velocity_max": 14.53842793326476, "cost2_min": -130.71092423191163, "outflow_rate_min": 796.748161220507, "system_level_velocity_min": 12.172128500535417, "cost2_max": -91.66082525536524, "cost1_max": 178.79471595613063, "cost2_mean": -106.05850430261994, "cost1_min": 148.57976991031703, "discrim_loss": 1.2856805324554443, "outflow_rate_mean": 876.7975365796243, "system_level_velocity_mean": 13.52522507910842}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3889.8010878562927, "sampler_perf": {"mean_inference_ms": 7.618397760058817, "mean_processing_ms": 10.914551074144343, "mean_env_wait_ms": 139.67980302425553}, "episodes_this_iter": 29, "episodes_total": 693, "time_total_s": 3889.8010878562927, "episode_reward_max": 802.8465766012669, "off_policy_estimator": {}, "episode_reward_min": 677.3912427425385, "episode_reward_mean": 716.5395154983833, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.73054671287537, "timestamp": 1559268193, "episode_len_mean": 325.0, "iterations_since_restore": 30, "training_iteration": 30, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ed90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ee18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-03-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 944.01542886574, "cost1_mean": 172.34358193389622, "system_level_velocity_max": 15.144870992696546, "cost2_min": -122.80845050467678, "outflow_rate_min": 701.8164781280761, "system_level_velocity_min": 11.059426745953454, "cost2_max": -95.45861383668833, "cost1_max": 185.31766597262623, "cost2_mean": -109.92839493618295, "cost1_min": 134.05603185511956, "discrim_loss": 1.2863552570343018, "outflow_rate_mean": 896.1379643016483, "system_level_velocity_mean": 14.058914037298653}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4022.966540336609, "sampler_perf": {"mean_inference_ms": 7.6321419067940015, "mean_processing_ms": 10.924787730116687, "mean_env_wait_ms": 139.90270252454312}, "episodes_this_iter": 21, "episodes_total": 714, "time_total_s": 4022.966540336609, "episode_reward_max": 802.4279977083206, "off_policy_estimator": {}, "episode_reward_min": 679.9055635929108, "episode_reward_mean": 710.8519768544605, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.16545248031616, "timestamp": 1559268326, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 31, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303337b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303336a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-05-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 949.6729667725691, "cost1_mean": 173.0102130402534, "system_level_velocity_max": 15.028825108438745, "cost2_min": -127.23346764698334, "outflow_rate_min": 758.5252912607413, "system_level_velocity_min": 11.634361683299804, "cost2_max": -97.7152260265858, "cost1_max": 184.36085720134645, "cost2_mean": -109.78881534372128, "cost1_min": 140.98817578392175, "discrim_loss": 1.267518162727356, "outflow_rate_mean": 900.2695279897489, "system_level_velocity_mean": 14.102384959450056}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4153.8905165195465, "sampler_perf": {"mean_inference_ms": 7.633241339180051, "mean_processing_ms": 10.889052647381273, "mean_env_wait_ms": 140.25129763207173}, "episodes_this_iter": 20, "episodes_total": 734, "time_total_s": 4153.8905165195465, "episode_reward_max": 744.9149942100048, "off_policy_estimator": {}, "episode_reward_min": 645.0643703639507, "episode_reward_mean": 677.5317154943943, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.92397618293762, "timestamp": 1559268458, "episode_len_mean": 325.0, "iterations_since_restore": 32, "training_iteration": 32, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303756a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-07-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 941.5729528042086, "cost1_mean": 175.95549630942477, "system_level_velocity_max": 15.016756656912053, "cost2_min": -118.28484341767273, "outflow_rate_min": 833.1978815808036, "system_level_velocity_min": 12.819952296602098, "cost2_max": -95.36578333749387, "cost1_max": 183.19413205247253, "cost2_mean": -107.19289937448943, "cost1_min": 157.82960885424208, "discrim_loss": 1.2611371278762817, "outflow_rate_mean": 912.9559915528338, "system_level_velocity_mean": 14.334198020380668}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4291.578955411911, "sampler_perf": {"mean_inference_ms": 7.6424097879940724, "mean_processing_ms": 10.947042840719913, "mean_env_wait_ms": 140.48629339363387}, "episodes_this_iter": 29, "episodes_total": 763, "time_total_s": 4291.578955411911, "episode_reward_max": 738.533323854208, "off_policy_estimator": {}, "episode_reward_min": 592.1376726329327, "episode_reward_mean": 636.3685511350632, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 137.6884388923645, "timestamp": 1559268596, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 33, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375e18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-09-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 960.0359331934045, "cost1_mean": 175.92574124120196, "system_level_velocity_max": 15.28421215023362, "cost2_min": -123.03859694431318, "outflow_rate_min": 676.2907091574906, "system_level_velocity_min": 10.304011860322982, "cost2_max": -98.36517113198542, "cost1_max": 186.63272501168007, "cost2_mean": -110.27815470610673, "cost1_min": 124.42144557796588, "discrim_loss": 1.2563884258270264, "outflow_rate_mean": 909.1502953072472, "system_level_velocity_mean": 14.337775452997194}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4422.20875787735, "sampler_perf": {"mean_inference_ms": 7.639976910182407, "mean_processing_ms": 10.920345502284727, "mean_env_wait_ms": 140.48625946063623}, "episodes_this_iter": 20, "episodes_total": 783, "time_total_s": 4422.20875787735, "episode_reward_max": 683.3208620250225, "off_policy_estimator": {}, "episode_reward_min": 545.2256390750408, "episode_reward_mean": 597.6397028997541, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.62980246543884, "timestamp": 1559268727, "episode_len_mean": 325.0, "iterations_since_restore": 34, "training_iteration": 34, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-12-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.016581613752, "cost1_mean": 169.46042444343203, "system_level_velocity_max": 15.635285786478473, "cost2_min": -129.4795329865243, "outflow_rate_min": 697.3885311049622, "system_level_velocity_min": 10.793595051798066, "cost2_max": -100.87527925108932, "cost1_max": 191.81865094991508, "cost2_mean": -113.10234951943434, "cost1_min": 128.1276687050142, "discrim_loss": 1.2346618175506592, "outflow_rate_mean": 880.545721493376, "system_level_velocity_mean": 13.896393212609098}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4548.5375893116, "sampler_perf": {"mean_inference_ms": 7.64232713344316, "mean_processing_ms": 10.903337786936529, "mean_env_wait_ms": 140.405527810421}, "episodes_this_iter": 21, "episodes_total": 804, "time_total_s": 4548.5375893116, "episode_reward_max": 616.9264533370733, "off_policy_estimator": {}, "episode_reward_min": 527.8538347184658, "episode_reward_mean": 562.8391834178141, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 126.32883143424988, "timestamp": 1559268855, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 35, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e6a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-14-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 996.9708259190136, "cost1_mean": 183.23382958842404, "system_level_velocity_max": 16.145432463315704, "cost2_min": -121.91509211524139, "outflow_rate_min": 827.0567346850722, "system_level_velocity_min": 12.868320626879303, "cost2_max": -100.03744681816264, "cost1_max": 197.36958533680883, "cost2_mean": -111.71241215265903, "cost1_min": 157.377145319843, "discrim_loss": 1.240496039390564, "outflow_rate_mean": 939.1106916185021, "system_level_velocity_mean": 14.98396137637089}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4679.188704252243, "sampler_perf": {"mean_inference_ms": 7.642745833997241, "mean_processing_ms": 10.930061824346337, "mean_env_wait_ms": 140.4887894015364}, "episodes_this_iter": 27, "episodes_total": 831, "time_total_s": 4679.188704252243, "episode_reward_max": 641.5014206767082, "off_policy_estimator": {}, "episode_reward_min": 544.2924325764179, "episode_reward_mean": 578.3181453783203, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.6511149406433, "timestamp": 1559268986, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 36, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-16-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1025.6538555480931, "cost1_mean": 184.13129970863545, "system_level_velocity_max": 16.742265130147956, "cost2_min": -140.89961358601084, "outflow_rate_min": 788.4526942652632, "system_level_velocity_min": 11.79675998563127, "cost2_max": -99.58083647315456, "cost1_max": 202.75651971541532, "cost2_mean": -115.16942087354143, "cost1_min": 144.84937299106696, "discrim_loss": 1.2340028285980225, "outflow_rate_mean": 943.0592480162139, "system_level_velocity_mean": 15.074108319604148}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4806.971877813339, "sampler_perf": {"mean_inference_ms": 7.645394132194636, "mean_processing_ms": 10.922372651030411, "mean_env_wait_ms": 140.42580738053445}, "episodes_this_iter": 22, "episodes_total": 853, "time_total_s": 4806.971877813339, "episode_reward_max": 659.8269316703081, "off_policy_estimator": {}, "episode_reward_min": 567.6456641554832, "episode_reward_mean": 613.8084108754992, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 127.78317356109619, "timestamp": 1559269114, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 37, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333d08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303336a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333bf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-18-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.4333037306576, "cost1_mean": 182.35686464057426, "system_level_velocity_max": 17.07476995309882, "cost2_min": -142.61126755543262, "outflow_rate_min": 821.8186424671364, "system_level_velocity_min": 12.659424826953238, "cost2_max": -103.81689903549062, "cost1_max": 206.685314052252, "cost2_mean": -117.30730590803324, "cost1_min": 151.15572951765085, "discrim_loss": 1.2507686614990234, "outflow_rate_mean": 940.3093196550708, "system_level_velocity_mean": 15.06266054139847}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4941.455005168915, "sampler_perf": {"mean_inference_ms": 7.655111946179341, "mean_processing_ms": 10.91072599832649, "mean_env_wait_ms": 140.47901238560385}, "episodes_this_iter": 21, "episodes_total": 874, "time_total_s": 4941.455005168915, "episode_reward_max": 639.5298811644316, "off_policy_estimator": {}, "episode_reward_min": 577.9157929122448, "episode_reward_mean": 606.9960787055038, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.48312735557556, "timestamp": 1559269252, "episode_len_mean": 325.0, "iterations_since_restore": 38, "training_iteration": 38, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ef28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-20-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.5432115728404, "cost1_mean": 177.41636948495395, "system_level_velocity_max": 17.367455894969435, "cost2_min": -141.23844497916542, "outflow_rate_min": 708.9962539245425, "system_level_velocity_min": 10.332214693641463, "cost2_max": -103.57867036099924, "cost1_max": 209.80732295679104, "cost2_mean": -119.74055202124434, "cost1_min": 122.95848749753956, "discrim_loss": 1.2359230518341064, "outflow_rate_mean": 919.4142542617803, "system_level_velocity_mean": 14.685611155226525}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5070.885910987854, "sampler_perf": {"mean_inference_ms": 7.656818266227678, "mean_processing_ms": 10.923542590629964, "mean_env_wait_ms": 140.5409079570429}, "episodes_this_iter": 27, "episodes_total": 901, "time_total_s": 5070.885910987854, "episode_reward_max": 599.2678289115429, "off_policy_estimator": {}, "episode_reward_min": 555.4740967452526, "episode_reward_mean": 574.5258614078716, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 129.4309058189392, "timestamp": 1559269381, "episode_len_mean": 325.0, "iterations_since_restore": 39, "training_iteration": 39, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c39d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c37b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3c80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-23-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.7837369083668, "cost1_mean": 186.32476843384055, "system_level_velocity_max": 17.525678907630393, "cost2_min": -142.64766096880203, "outflow_rate_min": 809.931215018607, "system_level_velocity_min": 12.174292773999843, "cost2_max": -103.15331050301627, "cost1_max": 211.67101904407576, "cost2_mean": -116.41364294305193, "cost1_min": 145.71951453215223, "discrim_loss": 1.2331417798995972, "outflow_rate_mean": 957.938690885145, "system_level_velocity_mean": 15.453521116740788}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5200.973716497421, "sampler_perf": {"mean_inference_ms": 7.648739799557816, "mean_processing_ms": 10.91586184872051, "mean_env_wait_ms": 140.44217757018504}, "episodes_this_iter": 22, "episodes_total": 923, "time_total_s": 5200.973716497421, "episode_reward_max": 571.837217181921, "off_policy_estimator": {}, "episode_reward_min": 528.5574026852846, "episode_reward_mean": 539.9813722368668, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.08780550956726, "timestamp": 1559269513, "episode_len_mean": 325.0, "iterations_since_restore": 40, "training_iteration": 40, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79304250d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425048>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-25-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1064.1244262434907, "cost1_mean": 181.6247340009176, "system_level_velocity_max": 17.802491791800076, "cost2_min": -143.23118576066372, "outflow_rate_min": 774.4081230510553, "system_level_velocity_min": 11.731708286801878, "cost2_max": -107.80416357884542, "cost1_max": 213.49985168145372, "cost2_mean": -120.83381003605676, "cost1_min": 140.28864905871723, "discrim_loss": 1.197481632232666, "outflow_rate_mean": 940.90989640902, "system_level_velocity_mean": 15.05895798417093}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5326.743582248688, "sampler_perf": {"mean_inference_ms": 7.648700467671882, "mean_processing_ms": 10.918198180821399, "mean_env_wait_ms": 140.31241811446338}, "episodes_this_iter": 21, "episodes_total": 944, "time_total_s": 5326.743582248688, "episode_reward_max": 541.8431858420372, "off_policy_estimator": {}, "episode_reward_min": 512.3568133786321, "episode_reward_mean": 527.1043728132333, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 125.76986575126648, "timestamp": 1559269639, "episode_len_mean": 325.0, "iterations_since_restore": 41, "training_iteration": 41, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-27-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.0761423048473, "cost1_mean": 186.9773681323006, "system_level_velocity_max": 17.79070096639763, "cost2_min": -145.51510231501265, "outflow_rate_min": 825.7050372901208, "system_level_velocity_min": 12.603490853634195, "cost2_max": -105.34979285871273, "cost1_max": 213.6239358435331, "cost2_mean": -121.11980272623516, "cost1_min": 152.1359152704319, "discrim_loss": 1.176642894744873, "outflow_rate_mean": 962.8252018205973, "system_level_velocity_mean": 15.549070992330021}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5461.417358636856, "sampler_perf": {"mean_inference_ms": 7.652304664514743, "mean_processing_ms": 10.900763230741427, "mean_env_wait_ms": 140.52135995101327}, "episodes_this_iter": 21, "episodes_total": 965, "time_total_s": 5461.417358636856, "episode_reward_max": 575.4661562591791, "off_policy_estimator": {}, "episode_reward_min": 509.1051055714488, "episode_reward_mean": 539.6526096424177, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.67377638816833, "timestamp": 1559269773, "episode_len_mean": 323.6666666666667, "iterations_since_restore": 42, "training_iteration": 42, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303751e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79306d3f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-29-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1069.171756152762, "cost1_mean": 189.13460097860892, "system_level_velocity_max": 18.121678665221143, "cost2_min": -148.24816808224622, "outflow_rate_min": 789.7972557427072, "system_level_velocity_min": 11.98365484651542, "cost2_max": -101.51675400517477, "cost1_max": 216.4113604778701, "cost2_mean": -118.51678139456128, "cost1_min": 141.52635609670688, "discrim_loss": 1.1798901557922363, "outflow_rate_mean": 974.1496480194546, "system_level_velocity_mean": 15.826832814841266}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5592.985693693161, "sampler_perf": {"mean_inference_ms": 7.657265255181342, "mean_processing_ms": 10.922244784834716, "mean_env_wait_ms": 140.5635341788916}, "episodes_this_iter": 28, "episodes_total": 993, "time_total_s": 5592.985693693161, "episode_reward_max": 619.9735893756151, "off_policy_estimator": {}, "episode_reward_min": 513.8949655070901, "episode_reward_mean": 557.6688548198769, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 131.56833505630493, "timestamp": 1559269912, "episode_len_mean": 325.0, "iterations_since_restore": 43, "training_iteration": 43, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303599d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303598c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359840>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-31-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.3947190258123, "cost1_mean": 180.92635621663644, "system_level_velocity_max": 17.979671780648296, "cost2_min": -147.89111731219973, "outflow_rate_min": 806.1950674489004, "system_level_velocity_min": 12.159013281245723, "cost2_max": -109.24020447886033, "cost1_max": 216.5540576146746, "cost2_mean": -121.06867113976958, "cost1_min": 144.86071004715666, "discrim_loss": 1.1691811084747314, "outflow_rate_mean": 942.1231769312424, "system_level_velocity_mean": 15.058170069585133}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5726.391093492508, "sampler_perf": {"mean_inference_ms": 7.652285493213301, "mean_processing_ms": 10.939686717475507, "mean_env_wait_ms": 140.43723990803016}, "episodes_this_iter": 21, "episodes_total": 1014, "time_total_s": 5726.391093492508, "episode_reward_max": 601.1085084974766, "off_policy_estimator": {}, "episode_reward_min": 519.256731107831, "episode_reward_mean": 555.1324391829826, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.40539979934692, "timestamp": 1559270049, "episode_len_mean": 325.0, "iterations_since_restore": 44, "training_iteration": 44, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e7b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eb70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-34-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.9137560540928, "cost1_mean": 181.45249350498898, "system_level_velocity_max": 17.699484235469576, "cost2_min": -142.95796445776432, "outflow_rate_min": 846.1235081148972, "system_level_velocity_min": 12.998229316545098, "cost2_max": -112.4350478495738, "cost1_max": 213.01801392768914, "cost2_mean": -122.08827426697991, "cost1_min": 154.97136494485397, "discrim_loss": 1.11026930809021, "outflow_rate_mean": 944.8153369874848, "system_level_velocity_mean": 15.101088439757927}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5876.225464582443, "sampler_perf": {"mean_inference_ms": 7.651312722920029, "mean_processing_ms": 10.91103726867983, "mean_env_wait_ms": 140.7875118366272}, "episodes_this_iter": 21, "episodes_total": 1035, "time_total_s": 5876.225464582443, "episode_reward_max": 616.2706324011087, "off_policy_estimator": {}, "episode_reward_min": 403.51246865838766, "episode_reward_mean": 544.9872252579246, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 149.8343710899353, "timestamp": 1559270199, "episode_len_mean": 319.85714285714283, "iterations_since_restore": 45, "training_iteration": 45, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303641e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303642f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-36-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.427179781363, "cost1_mean": 174.58405016023667, "system_level_velocity_max": 17.960937668703515, "cost2_min": -147.8477978062025, "outflow_rate_min": 752.7617115892824, "system_level_velocity_min": 11.283540308751515, "cost2_max": -85.40385138887459, "cost1_max": 215.3416956164216, "cost2_mean": -123.3757553186367, "cost1_min": 134.53177991859724, "discrim_loss": 1.0181972980499268, "outflow_rate_mean": 922.3275594345812, "system_level_velocity_mean": 14.823124656120475}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6004.963122367859, "sampler_perf": {"mean_inference_ms": 7.645382662822899, "mean_processing_ms": 10.939045549399088, "mean_env_wait_ms": 140.67820924510104}, "episodes_this_iter": 28, "episodes_total": 1063, "time_total_s": 6004.963122367859, "episode_reward_max": 640.9090707302094, "off_policy_estimator": {}, "episode_reward_min": 504.89659006148577, "episode_reward_mean": 555.2872116195837, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 128.73765778541565, "timestamp": 1559270328, "episode_len_mean": 325.0, "iterations_since_restore": 46, "training_iteration": 46, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303248c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-38-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.4162217829185, "cost1_mean": 174.25479552637094, "system_level_velocity_max": 18.01087573456245, "cost2_min": -135.75490978330717, "outflow_rate_min": 758.6256178396927, "system_level_velocity_min": 11.51508704966528, "cost2_max": -109.88379013939701, "cost1_max": 216.42034445763667, "cost2_mean": -120.21598889699439, "cost1_min": 136.43242806895103, "discrim_loss": 0.981677234172821, "outflow_rate_mean": 919.8165972140971, "system_level_velocity_mean": 14.565282267913224}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6146.185623168945, "sampler_perf": {"mean_inference_ms": 7.6462552035528875, "mean_processing_ms": 10.916718391421053, "mean_env_wait_ms": 140.65365718681286}, "episodes_this_iter": 20, "episodes_total": 1083, "time_total_s": 6146.185623168945, "episode_reward_max": 647.3827514052391, "off_policy_estimator": {}, "episode_reward_min": 502.7559821046889, "episode_reward_mean": 575.7605811040848, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 141.22250080108643, "timestamp": 1559270469, "episode_len_mean": 325.0, "iterations_since_restore": 47, "training_iteration": 47, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-41-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.1407377942664, "cost1_mean": 183.47859432268055, "system_level_velocity_max": 18.019824915605312, "cost2_min": -136.07206638780286, "outflow_rate_min": 752.9160946018035, "system_level_velocity_min": 11.478820370971198, "cost2_max": -106.68861704038676, "cost1_max": 215.2655135494288, "cost2_mean": -116.98140356570403, "cost1_min": 136.5075134098986, "discrim_loss": 1.0546170473098755, "outflow_rate_mean": 954.3274783130948, "system_level_velocity_mean": 15.355619744584434}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6276.502358198166, "sampler_perf": {"mean_inference_ms": 7.639120836302559, "mean_processing_ms": 10.915941208580152, "mean_env_wait_ms": 140.44247946384746}, "episodes_this_iter": 22, "episodes_total": 1105, "time_total_s": 6276.502358198166, "episode_reward_max": 618.7345281243324, "off_policy_estimator": {}, "episode_reward_min": 487.38914942368865, "episode_reward_mean": 560.7274262254888, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 130.31673502922058, "timestamp": 1559270600, "episode_len_mean": 325.0, "iterations_since_restore": 48, "training_iteration": 48, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364bf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364d08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-43-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1069.9093337816591, "cost1_mean": 192.17075535930738, "system_level_velocity_max": 17.958255181932152, "cost2_min": -131.54873185113038, "outflow_rate_min": 837.1643880179166, "system_level_velocity_min": 12.557832603418275, "cost2_max": -107.72587847473612, "cost1_max": 214.9835480281252, "cost2_mean": -117.21799268701467, "cost1_min": 150.2914085944042, "discrim_loss": 1.0490329265594482, "outflow_rate_mean": 983.2235796469544, "system_level_velocity_mean": 15.973430518869632}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6417.978663921356, "sampler_perf": {"mean_inference_ms": 7.638627374383184, "mean_processing_ms": 10.929453053955253, "mean_env_wait_ms": 140.6248565656632}, "episodes_this_iter": 27, "episodes_total": 1132, "time_total_s": 6417.978663921356, "episode_reward_max": 582.3742166757584, "off_policy_estimator": {}, "episode_reward_min": 209.65959492325783, "episode_reward_mean": 475.3603733056397, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 141.4763057231903, "timestamp": 1559270741, "episode_len_mean": 317.5925925925926, "iterations_since_restore": 49, "training_iteration": 49, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-45-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1069.9465613410446, "cost1_mean": 176.95713660881714, "system_level_velocity_max": 18.481967916745177, "cost2_min": -147.08822812788145, "outflow_rate_min": 745.4531921968767, "system_level_velocity_min": 12.520156808230485, "cost2_max": -57.058155484663274, "cost1_max": 216.0297911121754, "cost2_mean": -118.50989721251038, "cost1_min": 83.48675770973763, "discrim_loss": 0.9709935784339905, "outflow_rate_mean": 935.3146544807661, "system_level_velocity_mean": 15.187294384931329}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6552.666574478149, "sampler_perf": {"mean_inference_ms": 7.641373100257463, "mean_processing_ms": 10.9308020645495, "mean_env_wait_ms": 140.69107623538665}, "episodes_this_iter": 21, "episodes_total": 1153, "time_total_s": 6552.666574478149, "episode_reward_max": 512.958646401763, "off_policy_estimator": {}, "episode_reward_min": 400.0242893099785, "episode_reward_mean": 453.3538594330173, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.6879105567932, "timestamp": 1559270876, "episode_len_mean": 325.0, "iterations_since_restore": 50, "training_iteration": 50, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-47-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1063.9498946847807, "cost1_mean": 182.9226311421841, "system_level_velocity_max": 17.833422252573783, "cost2_min": -141.56867756567266, "outflow_rate_min": 726.3338114083442, "system_level_velocity_min": 10.893924227839124, "cost2_max": -108.0762214463249, "cost1_max": 213.75627522932777, "cost2_mean": -122.11814741574433, "cost1_min": 129.68910951445372, "discrim_loss": 0.9365459680557251, "outflow_rate_mean": 946.1934754287626, "system_level_velocity_mean": 15.209077543210716}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6695.621577501297, "sampler_perf": {"mean_inference_ms": 7.634901988963944, "mean_processing_ms": 10.955231186852473, "mean_env_wait_ms": 140.66777635885126}, "episodes_this_iter": 23, "episodes_total": 1176, "time_total_s": 6695.621577501297, "episode_reward_max": 496.0436544120312, "off_policy_estimator": {}, "episode_reward_min": 408.47211106307805, "episode_reward_mean": 446.1295610798685, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 142.95500302314758, "timestamp": 1559271019, "episode_len_mean": 325.0, "iterations_since_restore": 51, "training_iteration": 51, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-50-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1063.5337728178774, "cost1_mean": 178.80441964256934, "system_level_velocity_max": 17.791708286624516, "cost2_min": -138.68058511436664, "outflow_rate_min": 770.5886736975932, "system_level_velocity_min": 11.676767502698791, "cost2_max": -107.9658575495814, "cost1_max": 213.79647835353066, "cost2_mean": -120.67355705698276, "cost1_min": 138.3727625653232, "discrim_loss": 0.8595530986785889, "outflow_rate_mean": 936.213347537762, "system_level_velocity_mean": 14.912945190284438}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6844.014438390732, "sampler_perf": {"mean_inference_ms": 7.643607592215584, "mean_processing_ms": 10.95165747295955, "mean_env_wait_ms": 140.97529894107277}, "episodes_this_iter": 26, "episodes_total": 1202, "time_total_s": 6844.014438390732, "episode_reward_max": 524.2706679403782, "off_policy_estimator": {}, "episode_reward_min": 406.51817410439253, "episode_reward_mean": 460.062104392546, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 148.39286088943481, "timestamp": 1559271168, "episode_len_mean": 325.0, "iterations_since_restore": 52, "training_iteration": 52, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303649d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303648c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-52-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.7064845249652, "cost1_mean": 178.25795566014708, "system_level_velocity_max": 17.95162527108069, "cost2_min": -151.58587718505015, "outflow_rate_min": 795.4016239606905, "system_level_velocity_min": 11.892952030999597, "cost2_max": -106.55442039182455, "cost1_max": 215.21666578297558, "cost2_mean": -120.86099347163015, "cost1_min": 143.48639447940778, "discrim_loss": 0.8952710628509521, "outflow_rate_mean": 930.2815985889886, "system_level_velocity_mean": 14.825624477831353}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6983.585901975632, "sampler_perf": {"mean_inference_ms": 7.642936576647742, "mean_processing_ms": 10.962806234910158, "mean_env_wait_ms": 140.92711246390462}, "episodes_this_iter": 21, "episodes_total": 1223, "time_total_s": 6983.585901975632, "episode_reward_max": 499.3919347971678, "off_policy_estimator": {}, "episode_reward_min": 395.45387315470725, "episode_reward_mean": 444.6003415854648, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 139.5714635848999, "timestamp": 1559271307, "episode_len_mean": 325.0, "iterations_since_restore": 53, "training_iteration": 53, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-55-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.9422248874946, "cost1_mean": 185.33855525806862, "system_level_velocity_max": 17.916930555089554, "cost2_min": -145.02707256022694, "outflow_rate_min": 841.7544948180542, "system_level_velocity_min": 12.897050338168912, "cost2_max": -108.53402966817781, "cost1_max": 215.61259954228547, "cost2_mean": -120.05104015679288, "cost1_min": 154.31265317693268, "discrim_loss": 0.9105227589607239, "outflow_rate_mean": 959.583760656055, "system_level_velocity_mean": 15.442755420798445}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7124.282380580902, "sampler_perf": {"mean_inference_ms": 7.6367711481802845, "mean_processing_ms": 10.990414133094145, "mean_env_wait_ms": 140.66369732922468}, "episodes_this_iter": 23, "episodes_total": 1246, "time_total_s": 7124.282380580902, "episode_reward_max": 463.7122127972543, "off_policy_estimator": {}, "episode_reward_min": 27.735023722052574, "episode_reward_mean": 361.16571607629, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 140.69647860527039, "timestamp": 1559271451, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 54, "training_iteration": 54, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ed08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-57-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.9771325145311, "cost1_mean": 169.32856522435873, "system_level_velocity_max": 17.990314877738157, "cost2_min": -140.94308053370784, "outflow_rate_min": 431.75782487237836, "system_level_velocity_min": 12.296461896334305, "cost2_max": -21.739805092572354, "cost1_max": 215.14116405037595, "cost2_mean": -118.49278520419874, "cost1_min": 17.9316047730401, "discrim_loss": 0.8370234966278076, "outflow_rate_mean": 906.401307279172, "system_level_velocity_mean": 14.833721405297645}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7263.497486829758, "sampler_perf": {"mean_inference_ms": 7.63542725464065, "mean_processing_ms": 10.950331849117942, "mean_env_wait_ms": 141.19522958373054}, "episodes_this_iter": 22, "episodes_total": 1268, "time_total_s": 7263.497486829758, "episode_reward_max": 388.4353584945202, "off_policy_estimator": {}, "episode_reward_min": 295.7559293573722, "episode_reward_mean": 336.2010499703571, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 139.2151062488556, "timestamp": 1559271591, "episode_len_mean": 325.0, "iterations_since_restore": 55, "training_iteration": 55, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303646a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-59-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.4233410847362, "cost1_mean": 174.99862281500512, "system_level_velocity_max": 18.040138802677518, "cost2_min": -147.87386375766363, "outflow_rate_min": 843.7023346503285, "system_level_velocity_min": 12.920489721969453, "cost2_max": -108.40231222936733, "cost1_max": 215.69747667037586, "cost2_mean": -124.24797858677884, "cost1_min": 154.57724045053314, "discrim_loss": 0.7792574167251587, "outflow_rate_mean": 925.0016770787229, "system_level_velocity_mean": 14.639112249378199}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7398.174941778183, "sampler_perf": {"mean_inference_ms": 7.644547557117668, "mean_processing_ms": 10.969174591749457, "mean_env_wait_ms": 141.1462622632818}, "episodes_this_iter": 26, "episodes_total": 1294, "time_total_s": 7398.174941778183, "episode_reward_max": 419.44426729530096, "off_policy_estimator": {}, "episode_reward_min": 145.646515712142, "episode_reward_mean": 354.7819357434503, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.6774549484253, "timestamp": 1559271725, "episode_len_mean": 317.0, "iterations_since_restore": 56, "training_iteration": 56, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035eae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ebf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-02-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.2262869692292, "cost1_mean": 182.7897731954416, "system_level_velocity_max": 18.539099804151352, "cost2_min": -147.63570766712036, "outflow_rate_min": 716.8303827259027, "system_level_velocity_min": 12.711564080640732, "cost2_max": -56.78479669231631, "cost1_max": 215.7927692699605, "cost2_mean": -120.00152848232307, "cost1_min": 78.93312432019842, "discrim_loss": 0.7885161638259888, "outflow_rate_mean": 955.4998837157905, "system_level_velocity_mean": 15.675768090026763}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7540.507080316544, "sampler_perf": {"mean_inference_ms": 7.636330372598284, "mean_processing_ms": 10.96819514437729, "mean_env_wait_ms": 141.25138549522634}, "episodes_this_iter": 22, "episodes_total": 1316, "time_total_s": 7540.507080316544, "episode_reward_max": 435.0191370844841, "off_policy_estimator": {}, "episode_reward_min": 314.917056247592, "episode_reward_mean": 362.4752603909212, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 142.3321385383606, "timestamp": 1559271868, "episode_len_mean": 325.0, "iterations_since_restore": 57, "training_iteration": 57, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bba60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb950>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-04-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.1368920711102, "cost1_mean": 177.14888233818726, "system_level_velocity_max": 18.092969561176293, "cost2_min": -144.33470277051993, "outflow_rate_min": 776.0856799778363, "system_level_velocity_min": 11.876643282577495, "cost2_max": -110.29282588327419, "cost1_max": 216.93902473490488, "cost2_mean": -121.64800143454458, "cost1_min": 140.98405989660228, "discrim_loss": 0.7498996257781982, "outflow_rate_mean": 930.1172698315412, "system_level_velocity_mean": 14.830052778038798}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7677.79815030098, "sampler_perf": {"mean_inference_ms": 7.639295188596302, "mean_processing_ms": 10.984475315180424, "mean_env_wait_ms": 141.1698718039448}, "episodes_this_iter": 23, "episodes_total": 1339, "time_total_s": 7677.79815030098, "episode_reward_max": 422.3244972229004, "off_policy_estimator": {}, "episode_reward_min": 33.59371869266033, "episode_reward_mean": 353.9813461117244, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 137.29106998443604, "timestamp": 1559272005, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 58, "training_iteration": 58, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ebf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-06-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.6488502334396, "cost1_mean": 175.90344987606858, "system_level_velocity_max": 17.8965863927932, "cost2_min": -145.11257831200118, "outflow_rate_min": 454.9250223567449, "system_level_velocity_min": 12.36369895419701, "cost2_max": -20.479560661502266, "cost1_max": 215.05141498945798, "cost2_mean": -116.819664595017, "cost1_min": 18.030406847866132, "discrim_loss": 0.7667006254196167, "outflow_rate_mean": 931.9091803473218, "system_level_velocity_mean": 15.376554832937781}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7820.969773054123, "sampler_perf": {"mean_inference_ms": 7.642432282502193, "mean_processing_ms": 10.987503253776364, "mean_env_wait_ms": 141.45641112545866}, "episodes_this_iter": 26, "episodes_total": 1365, "time_total_s": 7820.969773054123, "episode_reward_max": 415.5467205941677, "off_policy_estimator": {}, "episode_reward_min": 259.1183160706423, "episode_reward_mean": 325.2692750657622, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 143.1716227531433, "timestamp": 1559272148, "episode_len_mean": 325.0, "iterations_since_restore": 59, "training_iteration": 59, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b3268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b31e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b30d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b3158>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-09-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.5273073147312, "cost1_mean": 178.87683474358025, "system_level_velocity_max": 17.965163812409, "cost2_min": -150.3398187823451, "outflow_rate_min": 812.5325452846625, "system_level_velocity_min": 12.073231911361683, "cost2_max": -110.90303732329104, "cost1_max": 216.1513143615121, "cost2_mean": -125.13552569376823, "cost1_min": 146.6587871641473, "discrim_loss": 0.7015237808227539, "outflow_rate_mean": 937.8261819945534, "system_level_velocity_mean": 14.922262652316679}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7955.028086423874, "sampler_perf": {"mean_inference_ms": 7.639109895157945, "mean_processing_ms": 10.981779626723563, "mean_env_wait_ms": 141.46263216387973}, "episodes_this_iter": 21, "episodes_total": 1386, "time_total_s": 7955.028086423874, "episode_reward_max": 353.26161842793226, "off_policy_estimator": {}, "episode_reward_min": 237.24411979410797, "episode_reward_mean": 284.166577663705, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.05831336975098, "timestamp": 1559272283, "episode_len_mean": 325.0, "iterations_since_restore": 60, "training_iteration": 60, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303751e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-11-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1071.9560356526388, "cost1_mean": 177.8150737388733, "system_level_velocity_max": 18.06076888961309, "cost2_min": -148.5592872750467, "outflow_rate_min": 772.1453359803398, "system_level_velocity_min": 11.74728714569868, "cost2_max": -108.63764852013176, "cost1_max": 216.41878578046078, "cost2_mean": -125.29881646165536, "cost1_min": 140.19300542631578, "discrim_loss": 0.6735754013061523, "outflow_rate_mean": 932.0788131599072, "system_level_velocity_mean": 14.86089007892091}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8097.042095661163, "sampler_perf": {"mean_inference_ms": 7.6359104378127824, "mean_processing_ms": 11.001958987096335, "mean_env_wait_ms": 141.53459152744222}, "episodes_this_iter": 23, "episodes_total": 1409, "time_total_s": 8097.042095661163, "episode_reward_max": 339.4780974537134, "off_policy_estimator": {}, "episode_reward_min": 223.40466124005616, "episode_reward_mean": 265.5107625780688, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 142.01400923728943, "timestamp": 1559272426, "episode_len_mean": 325.0, "iterations_since_restore": 61, "training_iteration": 61, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-13-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1072.4437046621222, "cost1_mean": 170.18775229262909, "system_level_velocity_max": 18.123496083888753, "cost2_min": -151.86008071790363, "outflow_rate_min": 791.7105773813531, "system_level_velocity_min": 12.068305405232579, "cost2_max": -108.34221767991126, "cost1_max": 217.4225746848893, "cost2_mean": -125.11223630956638, "cost1_min": 143.88660829265504, "discrim_loss": 0.6171119213104248, "outflow_rate_mean": 907.3670736563007, "system_level_velocity_mean": 14.2632172332967}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8243.523627281189, "sampler_perf": {"mean_inference_ms": 7.6401608778977605, "mean_processing_ms": 10.998407782555876, "mean_env_wait_ms": 141.77066194793488}, "episodes_this_iter": 25, "episodes_total": 1434, "time_total_s": 8243.523627281189, "episode_reward_max": 379.1765163000673, "off_policy_estimator": {}, "episode_reward_min": 232.1335400575772, "episode_reward_mean": 285.15925703436136, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 146.48153162002563, "timestamp": 1559272572, "episode_len_mean": 325.0, "iterations_since_restore": 62, "training_iteration": 62, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb1e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bba60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb7b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-16-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.7996911746447, "cost1_mean": 172.43468412086995, "system_level_velocity_max": 18.242584598121876, "cost2_min": -153.68696474412639, "outflow_rate_min": 785.849270759027, "system_level_velocity_min": 11.942582309773435, "cost2_max": -107.36004310307794, "cost1_max": 218.324410409034, "cost2_mean": -126.00709489751553, "cost1_min": 141.20930788282146, "discrim_loss": 0.6539238691329956, "outflow_rate_mean": 918.669093162079, "system_level_velocity_mean": 14.50548082854416}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8384.584827899933, "sampler_perf": {"mean_inference_ms": 7.640849377305301, "mean_processing_ms": 10.990817564401425, "mean_env_wait_ms": 141.9763935669475}, "episodes_this_iter": 21, "episodes_total": 1455, "time_total_s": 8384.584827899933, "episode_reward_max": 411.14444863796234, "off_policy_estimator": {}, "episode_reward_min": 264.0568722630851, "episode_reward_mean": 302.0714581503555, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 141.0612006187439, "timestamp": 1559272713, "episode_len_mean": 325.0, "iterations_since_restore": 63, "training_iteration": 63, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e8c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ec80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-18-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1073.730362404723, "cost1_mean": 171.18342141836652, "system_level_velocity_max": 18.2763323525051, "cost2_min": -143.8728638811757, "outflow_rate_min": 846.4049306686172, "system_level_velocity_min": 12.697817930646153, "cost2_max": -110.64582143103765, "cost1_max": 218.91326590463927, "cost2_mean": -124.34888653038931, "cost1_min": 152.71288208359152, "discrim_loss": 0.6668065786361694, "outflow_rate_mean": 915.327506236052, "system_level_velocity_mean": 14.373936894519023}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8521.980375528336, "sampler_perf": {"mean_inference_ms": 7.6445251642541345, "mean_processing_ms": 11.011883868035898, "mean_env_wait_ms": 141.86182808780174}, "episodes_this_iter": 25, "episodes_total": 1480, "time_total_s": 8521.980375528336, "episode_reward_max": 404.7597767598927, "off_policy_estimator": {}, "episode_reward_min": 33.645097337663174, "episode_reward_mean": 305.6839010466216, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 137.3955476284027, "timestamp": 1559272851, "episode_len_mean": 313.08, "iterations_since_restore": 64, "training_iteration": 64, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303642f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-20-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.0759285337087, "cost1_mean": 177.1964949961339, "system_level_velocity_max": 18.25912632558154, "cost2_min": -141.53704965819975, "outflow_rate_min": 470.30216034021953, "system_level_velocity_min": 11.906213324952194, "cost2_max": -19.952337744492738, "cost1_max": 219.59228225948715, "cost2_mean": -116.71638420428863, "cost1_min": 18.16375940778358, "discrim_loss": 0.6458560228347778, "outflow_rate_mean": 937.9906357337683, "system_level_velocity_mean": 15.502169451821105}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8668.113254785538, "sampler_perf": {"mean_inference_ms": 7.634141846624111, "mean_processing_ms": 11.007073022106832, "mean_env_wait_ms": 141.9845968104843}, "episodes_this_iter": 24, "episodes_total": 1504, "time_total_s": 8668.113254785538, "episode_reward_max": 371.1750503331423, "off_policy_estimator": {}, "episode_reward_min": 223.31127089099027, "episode_reward_mean": 278.8949684011847, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 146.13287925720215, "timestamp": 1559272997, "episode_len_mean": 325.0, "iterations_since_restore": 65, "training_iteration": 65, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e950>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-23-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.0500250737564, "cost1_mean": 180.91893577771324, "system_level_velocity_max": 18.399418332407755, "cost2_min": -148.91213727425867, "outflow_rate_min": 788.9768341881504, "system_level_velocity_min": 11.865200466948243, "cost2_max": -108.78129166468271, "cost1_max": 219.48083120148294, "cost2_mean": -124.47092553630709, "cost1_min": 139.83363071060353, "discrim_loss": 0.622393786907196, "outflow_rate_mean": 945.1184680839773, "system_level_velocity_mean": 15.169259081950102}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8808.021404266357, "sampler_perf": {"mean_inference_ms": 7.648192503875486, "mean_processing_ms": 11.008566055744888, "mean_env_wait_ms": 142.14207043087282}, "episodes_this_iter": 22, "episodes_total": 1526, "time_total_s": 8808.021404266357, "episode_reward_max": 302.7043287551496, "off_policy_estimator": {}, "episode_reward_min": 202.71066980599426, "episode_reward_mean": 247.99351170929995, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 139.9081494808197, "timestamp": 1559273137, "episode_len_mean": 325.0, "iterations_since_restore": 66, "training_iteration": 66, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bba60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb1e0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-25-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.9475934794202, "cost1_mean": 178.18833149914423, "system_level_velocity_max": 18.039890167726053, "cost2_min": -146.3652033770095, "outflow_rate_min": 766.6196400135866, "system_level_velocity_min": 11.501702343969136, "cost2_max": -110.06587996898119, "cost1_max": 217.3395193183749, "cost2_mean": -126.35953481653172, "cost1_min": 136.0497061833486, "discrim_loss": 0.5889150500297546, "outflow_rate_mean": 936.6177486599277, "system_level_velocity_mean": 14.90525556219514}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8949.095323562622, "sampler_perf": {"mean_inference_ms": 7.636674048141429, "mean_processing_ms": 11.029814437108575, "mean_env_wait_ms": 141.96123148874523}, "episodes_this_iter": 23, "episodes_total": 1549, "time_total_s": 8949.095323562622, "episode_reward_max": 327.8991859033704, "off_policy_estimator": {}, "episode_reward_min": 205.6269802490715, "episode_reward_mean": 258.3336678913278, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 141.07391929626465, "timestamp": 1559273278, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 67, "training_iteration": 67, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303622f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-27-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.9903899677995, "cost1_mean": 180.62246726178412, "system_level_velocity_max": 18.323836365889743, "cost2_min": -144.93629685200773, "outflow_rate_min": 759.7217180552245, "system_level_velocity_min": 11.516856741411395, "cost2_max": -85.1262422289123, "cost1_max": 218.81470299515928, "cost2_mean": -122.12574156486446, "cost1_min": 136.70454306920092, "discrim_loss": 0.6481031775474548, "outflow_rate_mean": 948.97494498206, "system_level_velocity_mean": 15.41663057949637}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9092.376101016998, "sampler_perf": {"mean_inference_ms": 7.636909780556021, "mean_processing_ms": 11.009948648110985, "mean_env_wait_ms": 142.18917143675705}, "episodes_this_iter": 22, "episodes_total": 1571, "time_total_s": 9092.376101016998, "episode_reward_max": 353.1776627674699, "off_policy_estimator": {}, "episode_reward_min": 221.77299187215976, "episode_reward_mean": 281.28437048498415, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 143.28077745437622, "timestamp": 1559273422, "episode_len_mean": 325.0, "iterations_since_restore": 68, "training_iteration": 68, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-30-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1080.5966698631466, "cost1_mean": 178.42905660810217, "system_level_velocity_max": 18.26515452957539, "cost2_min": -148.52551220142732, "outflow_rate_min": 786.2878350985699, "system_level_velocity_min": 11.935357812055903, "cost2_max": -112.13732570706303, "cost1_max": 217.99591811553924, "cost2_mean": -125.9549438548757, "cost1_min": 141.35547311581112, "discrim_loss": 0.6545494198799133, "outflow_rate_mean": 937.5212651308483, "system_level_velocity_mean": 14.93163821146414}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9231.387159824371, "sampler_perf": {"mean_inference_ms": 7.644387254926705, "mean_processing_ms": 11.038055990492314, "mean_env_wait_ms": 142.01938170901548}, "episodes_this_iter": 26, "episodes_total": 1597, "time_total_s": 9231.387159824371, "episode_reward_max": 378.0051293820143, "off_policy_estimator": {}, "episode_reward_min": 241.76513321697712, "episode_reward_mean": 311.51259391358604, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 139.01105880737305, "timestamp": 1559273563, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 69, "training_iteration": 69, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-32-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.8357738004074, "cost1_mean": 186.2059755038438, "system_level_velocity_max": 18.440118685489328, "cost2_min": -143.07936349686486, "outflow_rate_min": 873.8150436359406, "system_level_velocity_min": 13.200868780956707, "cost2_max": -84.16438281592923, "cost1_max": 220.06646295637321, "cost2_mean": -119.8471088854448, "cost1_min": 140.09241041931244, "discrim_loss": 0.6803534030914307, "outflow_rate_mean": 969.468625578887, "system_level_velocity_mean": 15.837773609038996}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9366.607053279877, "sampler_perf": {"mean_inference_ms": 7.632707473271711, "mean_processing_ms": 11.02533434143594, "mean_env_wait_ms": 142.0520979177353}, "episodes_this_iter": 22, "episodes_total": 1619, "time_total_s": 9366.607053279877, "episode_reward_max": 352.94419402081985, "off_policy_estimator": {}, "episode_reward_min": 224.4313941593282, "episode_reward_mean": 287.5657791332527, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 135.21989345550537, "timestamp": 1559273698, "episode_len_mean": 325.0, "iterations_since_restore": 70, "training_iteration": 70, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-34-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1074.3856780311162, "cost1_mean": 177.1559902904858, "system_level_velocity_max": 18.23872892452102, "cost2_min": -142.64393537905724, "outflow_rate_min": 808.5803488621748, "system_level_velocity_min": 12.188105539082295, "cost2_max": -107.0205038878483, "cost1_max": 216.87219992877573, "cost2_mean": -125.76208826505045, "cost1_min": 143.4894254997527, "discrim_loss": 0.6569047570228577, "outflow_rate_mean": 934.0488228291149, "system_level_velocity_mean": 14.830645910589347}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9501.894659280777, "sampler_perf": {"mean_inference_ms": 7.634888407628305, "mean_processing_ms": 11.020024365904568, "mean_env_wait_ms": 141.91750405267055}, "episodes_this_iter": 22, "episodes_total": 1641, "time_total_s": 9501.894659280777, "episode_reward_max": 328.0683671813458, "off_policy_estimator": {}, "episode_reward_min": 261.2616159921163, "episode_reward_mean": 292.6218977749734, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 135.28760600090027, "timestamp": 1559273833, "episode_len_mean": 325.0, "iterations_since_restore": 71, "training_iteration": 71, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b46a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4510>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-37-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.2294178721452, "cost1_mean": 186.34137746323316, "system_level_velocity_max": 18.361593294332902, "cost2_min": -144.64503820611037, "outflow_rate_min": 793.8718512207362, "system_level_velocity_min": 12.06988140869793, "cost2_max": -107.14502725394296, "cost1_max": 218.36080647315782, "cost2_mean": -120.48300217285954, "cost1_min": 143.95658316654345, "discrim_loss": 0.6585848331451416, "outflow_rate_mean": 966.805851082786, "system_level_velocity_mean": 15.630033348724483}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9638.632252693176, "sampler_perf": {"mean_inference_ms": 7.637075380679337, "mean_processing_ms": 11.027307930867922, "mean_env_wait_ms": 142.0193099458139}, "episodes_this_iter": 25, "episodes_total": 1666, "time_total_s": 9638.632252693176, "episode_reward_max": 338.2701212707325, "off_policy_estimator": {}, "episode_reward_min": 219.68975875986507, "episode_reward_mean": 268.4395269940747, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 136.7375934123993, "timestamp": 1559273970, "episode_len_mean": 325.0, "iterations_since_restore": 72, "training_iteration": 72, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb0d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbbf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-39-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.819634016276, "cost1_mean": 183.95538240993432, "system_level_velocity_max": 18.302411972744125, "cost2_min": -140.78342464020554, "outflow_rate_min": 786.8503967776419, "system_level_velocity_min": 11.898662132590978, "cost2_max": -107.15279481373081, "cost1_max": 217.8272979820095, "cost2_mean": -123.23153744035153, "cost1_min": 142.1970777074917, "discrim_loss": 0.6778452396392822, "outflow_rate_mean": 955.7925343368178, "system_level_velocity_mean": 15.35826569613449}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9772.601085662842, "sampler_perf": {"mean_inference_ms": 7.6321978410828235, "mean_processing_ms": 11.077600265791332, "mean_env_wait_ms": 141.6972714066734}, "episodes_this_iter": 24, "episodes_total": 1690, "time_total_s": 9772.601085662842, "episode_reward_max": 373.69604806322604, "off_policy_estimator": {}, "episode_reward_min": 19.866836979985237, "episode_reward_mean": 271.62937471569603, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 133.96883296966553, "timestamp": 1559274107, "episode_len_mean": 303.9166666666667, "iterations_since_restore": 73, "training_iteration": 73, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-41-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.2226776730236, "cost1_mean": 168.25065893435203, "system_level_velocity_max": 18.130213830129367, "cost2_min": -139.31933079202105, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 12.539340142141548, "cost2_max": -21.126900583073546, "cost1_max": 216.29764939595623, "cost2_mean": -119.67104018122966, "cost1_min": 17.95414920911911, "discrim_loss": 0.7052865028381348, "outflow_rate_mean": 907.7676461040874, "system_level_velocity_mean": 15.136281537172428}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9908.025800943375, "sampler_perf": {"mean_inference_ms": 7.637549269646811, "mean_processing_ms": 11.046347706629152, "mean_env_wait_ms": 142.0209441610236}, "episodes_this_iter": 23, "episodes_total": 1713, "time_total_s": 9908.025800943375, "episode_reward_max": 424.34201569482684, "off_policy_estimator": {}, "episode_reward_min": 156.42468164116144, "episode_reward_mean": 318.82825000219566, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 135.42471528053284, "timestamp": 1559274243, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 74, "training_iteration": 74, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b82f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-44-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1072.7149382958594, "cost1_mean": 180.42359714116284, "system_level_velocity_max": 18.224891797433592, "cost2_min": -135.89826610750788, "outflow_rate_min": 718.965505302634, "system_level_velocity_min": 13.136519741952409, "cost2_max": -52.622514575439205, "cost1_max": 216.46000334250047, "cost2_mean": -119.65144176284225, "cost1_min": 78.53174661917885, "discrim_loss": 0.6996645331382751, "outflow_rate_mean": 947.6780354436702, "system_level_velocity_mean": 15.514233571479503}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10043.352536916733, "sampler_perf": {"mean_inference_ms": 7.627438668654332, "mean_processing_ms": 11.048979949290818, "mean_env_wait_ms": 142.02580383238424}, "episodes_this_iter": 24, "episodes_total": 1737, "time_total_s": 10043.352536916733, "episode_reward_max": 394.0881519122049, "off_policy_estimator": {}, "episode_reward_min": 229.15139398048632, "episode_reward_mean": 286.10651889108095, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 135.32673597335815, "timestamp": 1559274378, "episode_len_mean": 325.0, "iterations_since_restore": 75, "training_iteration": 75, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-46-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.659370559269, "cost1_mean": 179.29586272254014, "system_level_velocity_max": 18.157007741758722, "cost2_min": -137.48112942386888, "outflow_rate_min": 853.0550705140711, "system_level_velocity_min": 13.11806264319139, "cost2_max": -105.46172627249962, "cost1_max": 214.8226978952036, "cost2_mean": -125.23281567275086, "cost1_min": 158.64242577540233, "discrim_loss": 0.6464381217956543, "outflow_rate_mean": 933.8236741517261, "system_level_velocity_mean": 14.835425681154684}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10172.202791690826, "sampler_perf": {"mean_inference_ms": 7.640722497554381, "mean_processing_ms": 11.05767466111629, "mean_env_wait_ms": 141.6937315424341}, "episodes_this_iter": 22, "episodes_total": 1759, "time_total_s": 10172.202791690826, "episode_reward_max": 395.44665616494603, "off_policy_estimator": {}, "episode_reward_min": 251.29577910603257, "episode_reward_mean": 309.97859488604246, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 128.85025477409363, "timestamp": 1559274507, "episode_len_mean": 325.0, "iterations_since_restore": 76, "training_iteration": 76, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b36a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b3598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b3510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b3620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-48-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.6713604442514, "cost1_mean": 183.53727397030295, "system_level_velocity_max": 17.859941170969524, "cost2_min": -136.09999679830213, "outflow_rate_min": 839.298023964651, "system_level_velocity_min": 12.686931980646783, "cost2_max": -103.0639946507733, "cost1_max": 213.08630431915546, "cost2_mean": -119.07928205131056, "cost1_min": 154.0667870321937, "discrim_loss": 0.6968952417373657, "outflow_rate_mean": 950.5369097158684, "system_level_velocity_mean": 15.217633877722818}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10306.356389045715, "sampler_perf": {"mean_inference_ms": 7.634775371322195, "mean_processing_ms": 11.053368523608126, "mean_env_wait_ms": 141.95891409808084}, "episodes_this_iter": 24, "episodes_total": 1783, "time_total_s": 10306.356389045715, "episode_reward_max": 356.8868896178901, "off_policy_estimator": {}, "episode_reward_min": 202.83772074099397, "episode_reward_mean": 270.78110938415676, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 134.15359735488892, "timestamp": 1559274641, "episode_len_mean": 325.0, "iterations_since_restore": 77, "training_iteration": 77, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-50-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.2990395667312, "cost1_mean": 183.8079462362128, "system_level_velocity_max": 17.850905930275108, "cost2_min": -131.68861470879463, "outflow_rate_min": 818.5688382208584, "system_level_velocity_min": 12.249611282350362, "cost2_max": -102.90162651305175, "cost1_max": 211.12440806675238, "cost2_mean": -117.53128507225978, "cost1_min": 150.6403645836944, "discrim_loss": 0.7270774841308594, "outflow_rate_mean": 949.461172424138, "system_level_velocity_mean": 15.195938269276084}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10424.454443454742, "sampler_perf": {"mean_inference_ms": 7.6247112412118865, "mean_processing_ms": 11.06164802802769, "mean_env_wait_ms": 141.68868555046325}, "episodes_this_iter": 24, "episodes_total": 1807, "time_total_s": 10424.454443454742, "episode_reward_max": 354.33335452340543, "off_policy_estimator": {}, "episode_reward_min": 220.14414657029556, "episode_reward_mean": 282.27631983984, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 118.0980544090271, "timestamp": 1559274759, "episode_len_mean": 325.0, "iterations_since_restore": 78, "training_iteration": 78, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303646a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-52-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.7010677725407, "cost1_mean": 190.61858504154597, "system_level_velocity_max": 17.697446455294127, "cost2_min": -128.7058070534421, "outflow_rate_min": 824.810309587128, "system_level_velocity_min": 12.630181422734562, "cost2_max": -101.27426692941356, "cost1_max": 210.63519932644607, "cost2_mean": -112.48861818563306, "cost1_min": 156.02997675063517, "discrim_loss": 0.7755386233329773, "outflow_rate_mean": 974.757811762548, "system_level_velocity_mean": 15.783702546731439}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10546.412764549255, "sampler_perf": {"mean_inference_ms": 7.641723756882447, "mean_processing_ms": 11.074104683755946, "mean_env_wait_ms": 141.31983764043997}, "episodes_this_iter": 22, "episodes_total": 1829, "time_total_s": 10546.412764549255, "episode_reward_max": 437.187762147747, "off_policy_estimator": {}, "episode_reward_min": 259.6622823137441, "episode_reward_mean": 340.0746727383455, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 121.95832109451294, "timestamp": 1559274881, "episode_len_mean": 325.0, "iterations_since_restore": 79, "training_iteration": 79, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-54-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.515361224451, "cost1_mean": 187.26457446347638, "system_level_velocity_max": 17.60678967044096, "cost2_min": -117.69012808976498, "outflow_rate_min": 896.8682098885139, "system_level_velocity_min": 13.582025780973204, "cost2_max": -101.82316796663689, "cost1_max": 208.6138290386314, "cost2_mean": -108.79164910870837, "cost1_min": 165.49975400854473, "discrim_loss": 0.8003073930740356, "outflow_rate_mean": 967.3407345399173, "system_level_velocity_mean": 15.546181541253087}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10670.941895484924, "sampler_perf": {"mean_inference_ms": 7.635756256539494, "mean_processing_ms": 11.062155053126787, "mean_env_wait_ms": 141.40412277736243}, "episodes_this_iter": 22, "episodes_total": 1851, "time_total_s": 10670.941895484924, "episode_reward_max": 664.093333510682, "off_policy_estimator": {}, "episode_reward_min": 280.3315734216012, "episode_reward_mean": 374.4025345501075, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 124.52913093566895, "timestamp": 1559275007, "episode_len_mean": 325.0, "iterations_since_restore": 80, "training_iteration": 80, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-56-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.1799198937624, "cost1_mean": 183.5968027050765, "system_level_velocity_max": 17.606901117575358, "cost2_min": -113.08773340496901, "outflow_rate_min": 774.8418575150467, "system_level_velocity_min": 11.248041671424723, "cost2_max": -91.69928768890544, "cost1_max": 209.90038485953386, "cost2_mean": -104.64421395775253, "cost1_min": 134.20994962010357, "discrim_loss": 0.8720871210098267, "outflow_rate_mean": 954.1803403815942, "system_level_velocity_mean": 15.241992011660527}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10793.80340385437, "sampler_perf": {"mean_inference_ms": 7.629329210213252, "mean_processing_ms": 11.065959293993423, "mean_env_wait_ms": 141.23039617800507}, "episodes_this_iter": 24, "episodes_total": 1875, "time_total_s": 10793.80340385437, "episode_reward_max": 591.2902099329513, "off_policy_estimator": {}, "episode_reward_min": 280.1972024911083, "episode_reward_mean": 375.72907128951437, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 122.8615083694458, "timestamp": 1559275130, "episode_len_mean": 324.1666666666667, "iterations_since_restore": 81, "training_iteration": 81, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ad6a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ad620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ad598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ad510>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-58-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1045.6705073052253, "cost1_mean": 183.70842884612833, "system_level_velocity_max": 17.510394440162408, "cost2_min": -109.78008144602686, "outflow_rate_min": 866.9732662531426, "system_level_velocity_min": 12.894065045791095, "cost2_max": -89.09568797253321, "cost1_max": 206.95587337015934, "cost2_mean": -101.62617019308276, "cost1_min": 155.42756578791284, "discrim_loss": 0.8635684251785278, "outflow_rate_mean": 955.2410892176014, "system_level_velocity_mean": 15.311089653570116}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10919.777525663376, "sampler_perf": {"mean_inference_ms": 7.63919548830097, "mean_processing_ms": 11.058383876901374, "mean_env_wait_ms": 140.91860575356537}, "episodes_this_iter": 23, "episodes_total": 1898, "time_total_s": 10919.777525663376, "episode_reward_max": 405.4428629647009, "off_policy_estimator": {}, "episode_reward_min": 262.30191598134115, "episode_reward_mean": 316.1707423133459, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 125.97412180900574, "timestamp": 1559275259, "episode_len_mean": 325.0, "iterations_since_restore": 82, "training_iteration": 82, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbe18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-00-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.7969249299238, "cost1_mean": 186.241045521953, "system_level_velocity_max": 17.39178896250286, "cost2_min": -107.4059271459131, "outflow_rate_min": 870.4497473732529, "system_level_velocity_min": 13.058596484453153, "cost2_max": -96.95517872829703, "cost1_max": 205.38959979927162, "cost2_mean": -101.75949219621324, "cost1_min": 160.10508176081748, "discrim_loss": 0.9241054058074951, "outflow_rate_mean": 966.8684384816617, "system_level_velocity_mean": 15.481330567784651}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11038.309448957443, "sampler_perf": {"mean_inference_ms": 7.632469285549251, "mean_processing_ms": 11.081367711923766, "mean_env_wait_ms": 140.68310153016066}, "episodes_this_iter": 23, "episodes_total": 1921, "time_total_s": 11038.309448957443, "episode_reward_max": 599.2014423660003, "off_policy_estimator": {}, "episode_reward_min": 273.26717040967196, "episode_reward_mean": 373.8227911721434, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 118.53192329406738, "timestamp": 1559275377, "episode_len_mean": 325.0, "iterations_since_restore": 83, "training_iteration": 83, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-02-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.1767642843784, "cost1_mean": 186.83486114003355, "system_level_velocity_max": 17.605976899853182, "cost2_min": -104.74049599505258, "outflow_rate_min": 860.3202161827086, "system_level_velocity_min": 12.793193565092588, "cost2_max": -93.22381867284349, "cost1_max": 207.3039342703332, "cost2_mean": -98.89184790513616, "cost1_min": 153.84786454945748, "discrim_loss": 0.9935473203659058, "outflow_rate_mean": 971.9423866297271, "system_level_velocity_mean": 15.594114314481141}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11155.815382242203, "sampler_perf": {"mean_inference_ms": 7.627598839581997, "mean_processing_ms": 11.07388456651143, "mean_env_wait_ms": 140.63104708237003}, "episodes_this_iter": 24, "episodes_total": 1945, "time_total_s": 11155.815382242203, "episode_reward_max": 659.1537558650598, "off_policy_estimator": {}, "episode_reward_min": 20.683871407061815, "episode_reward_mean": 437.8128810922911, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 117.50593328475952, "timestamp": 1559275495, "episode_len_mean": 311.4166666666667, "iterations_since_restore": 84, "training_iteration": 84, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b40d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b41e0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-04-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.8005442259002, "cost1_mean": 174.8578495668264, "system_level_velocity_max": 17.835614936252806, "cost2_min": -102.58487687995654, "outflow_rate_min": 460.62677674270975, "system_level_velocity_min": 11.958078985441079, "cost2_max": -19.952258196511693, "cost1_max": 206.26965704883568, "cost2_mean": -93.8516865020391, "cost1_min": 18.097108537410463, "discrim_loss": 1.0139933824539185, "outflow_rate_mean": 934.5941397308844, "system_level_velocity_mean": 15.353364148024}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11272.614867448807, "sampler_perf": {"mean_inference_ms": 7.629311051930213, "mean_processing_ms": 11.071501248053119, "mean_env_wait_ms": 140.28494964979663}, "episodes_this_iter": 24, "episodes_total": 1969, "time_total_s": 11272.614867448807, "episode_reward_max": 733.819379835797, "off_policy_estimator": {}, "episode_reward_min": 350.210890552029, "episode_reward_mean": 484.8647510450367, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 116.799485206604, "timestamp": 1559275612, "episode_len_mean": 325.0, "iterations_since_restore": 85, "training_iteration": 85, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b46a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-06-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1043.3993356924243, "cost1_mean": 181.84676007393898, "system_level_velocity_max": 17.516362864947894, "cost2_min": -98.26716663421078, "outflow_rate_min": 772.9212493563923, "system_level_velocity_min": 11.264636678325887, "cost2_max": -81.65739258960258, "cost1_max": 207.24476986950168, "cost2_mean": -94.04960844417553, "cost1_min": 132.93066315309287, "discrim_loss": 1.080215334892273, "outflow_rate_mean": 955.6971197552904, "system_level_velocity_mean": 15.272554370421366}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11383.139291286469, "sampler_perf": {"mean_inference_ms": 7.626103184222843, "mean_processing_ms": 11.083951788742814, "mean_env_wait_ms": 139.87320936830824}, "episodes_this_iter": 22, "episodes_total": 1991, "time_total_s": 11383.139291286469, "episode_reward_max": 771.3732953770086, "off_policy_estimator": {}, "episode_reward_min": 289.93400147370994, "episode_reward_mean": 466.71231199317316, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.52442383766174, "timestamp": 1559275722, "episode_len_mean": 325.0, "iterations_since_restore": 86, "training_iteration": 86, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303620d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79304250d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-08-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1042.283889578309, "cost1_mean": 185.61189217943772, "system_level_velocity_max": 17.53058845090562, "cost2_min": -95.49014037160461, "outflow_rate_min": 841.8289528906105, "system_level_velocity_min": 13.158811912339859, "cost2_max": -77.94173684375363, "cost1_max": 205.76112232073018, "cost2_mean": -89.76100059450717, "cost1_min": 156.71760247021956, "discrim_loss": 1.0871860980987549, "outflow_rate_mean": 970.5613219493094, "system_level_velocity_mean": 15.687009283638814}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11498.490025281906, "sampler_perf": {"mean_inference_ms": 7.623504976029909, "mean_processing_ms": 11.0765558605113, "mean_env_wait_ms": 139.78498379736564}, "episodes_this_iter": 24, "episodes_total": 2015, "time_total_s": 11498.490025281906, "episode_reward_max": 768.8182962182909, "off_policy_estimator": {}, "episode_reward_min": 21.659011186100543, "episode_reward_mean": 464.2054196389702, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 115.35073399543762, "timestamp": 1559275838, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 87, "training_iteration": 87, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303627b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303628c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-10-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1028.3975794610863, "cost1_mean": 170.13931541279442, "system_level_velocity_max": 18.596986165301868, "cost2_min": -94.90340793017198, "outflow_rate_min": 468.8485586228365, "system_level_velocity_min": 11.600493150883903, "cost2_max": -24.40926399876808, "cost1_max": 202.05252802878036, "cost2_mean": -83.46877913596016, "cost1_min": 23.050829237762603, "discrim_loss": 1.2466394901275635, "outflow_rate_mean": 917.9147331898766, "system_level_velocity_mean": 15.078837450561258}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11603.091438531876, "sampler_perf": {"mean_inference_ms": 7.614142155047516, "mean_processing_ms": 11.074031615655045, "mean_env_wait_ms": 139.41891883428463}, "episodes_this_iter": 23, "episodes_total": 2038, "time_total_s": 11603.091438531876, "episode_reward_max": 779.313170385547, "off_policy_estimator": {}, "episode_reward_min": 265.47803036123514, "episode_reward_mean": 449.9520819232617, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.60141324996948, "timestamp": 1559275942, "episode_len_mean": 324.1304347826087, "iterations_since_restore": 88, "training_iteration": 88, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b47b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b48c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-12-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.2401239781452, "cost1_mean": 177.21831090876086, "system_level_velocity_max": 17.214628240548365, "cost2_min": -92.71934213254065, "outflow_rate_min": 794.5960053175813, "system_level_velocity_min": 11.660281517119868, "cost2_max": -68.93133824323829, "cost1_max": 201.27500333513316, "cost2_mean": -84.57227066669716, "cost1_min": 136.16691231884872, "discrim_loss": 1.1667869091033936, "outflow_rate_mean": 939.8726103927119, "system_level_velocity_mean": 15.071734298933764}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11714.214102506638, "sampler_perf": {"mean_inference_ms": 7.624060278671577, "mean_processing_ms": 11.09133623996731, "mean_env_wait_ms": 138.9689607564234}, "episodes_this_iter": 24, "episodes_total": 2062, "time_total_s": 11714.214102506638, "episode_reward_max": 765.0149447955191, "off_policy_estimator": {}, "episode_reward_min": 235.16513948887587, "episode_reward_mean": 467.95366894927184, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 111.12266397476196, "timestamp": 1559276054, "episode_len_mean": 320.4166666666667, "iterations_since_restore": 89, "training_iteration": 89, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-14-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.6433727347206, "cost1_mean": 177.9440269136713, "system_level_velocity_max": 17.581079572519933, "cost2_min": -90.74840533180401, "outflow_rate_min": 811.9767771165772, "system_level_velocity_min": 12.027921768240011, "cost2_max": -67.91467720157603, "cost1_max": 199.00667101462173, "cost2_mean": -83.4099016102223, "cost1_min": 135.1799171611109, "discrim_loss": 1.1422628164291382, "outflow_rate_mean": 950.2585155375064, "system_level_velocity_mean": 15.390957690431904}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11824.00507736206, "sampler_perf": {"mean_inference_ms": 7.622219691488922, "mean_processing_ms": 11.090973457886244, "mean_env_wait_ms": 138.9465746682111}, "episodes_this_iter": 24, "episodes_total": 2086, "time_total_s": 11824.00507736206, "episode_reward_max": 791.4233128912747, "off_policy_estimator": {}, "episode_reward_min": 322.91307805478573, "episode_reward_mean": 518.6834702553364, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.79097485542297, "timestamp": 1559276163, "episode_len_mean": 325.0, "iterations_since_restore": 90, "training_iteration": 90, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303486a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-16-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.1187184117352, "cost1_mean": 172.38520669754928, "system_level_velocity_max": 17.324830805320254, "cost2_min": -88.36968179060867, "outflow_rate_min": 735.8699242948237, "system_level_velocity_min": 10.995253133613165, "cost2_max": -65.47863581883603, "cost1_max": 201.66568008313214, "cost2_mean": -80.33902529180163, "cost1_min": 128.86263650766506, "discrim_loss": 1.1908576488494873, "outflow_rate_mean": 922.0688094050632, "system_level_velocity_mean": 14.732570044639951}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11931.100505113602, "sampler_perf": {"mean_inference_ms": 7.613015836474233, "mean_processing_ms": 11.106696773309402, "mean_env_wait_ms": 138.54646747926552}, "episodes_this_iter": 23, "episodes_total": 2109, "time_total_s": 11931.100505113602, "episode_reward_max": 599.5844170898199, "off_policy_estimator": {}, "episode_reward_min": 188.02536670863628, "episode_reward_mean": 444.84927083122665, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.09542775154114, "timestamp": 1559276271, "episode_len_mean": 320.2173913043478, "iterations_since_restore": 91, "training_iteration": 91, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303480d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303489d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-17-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.1937307242638, "cost1_mean": 171.56675265752727, "system_level_velocity_max": 17.402150824703963, "cost2_min": -88.51699763054442, "outflow_rate_min": 798.4470443596974, "system_level_velocity_min": 12.262272043257807, "cost2_max": -69.48623665533378, "cost1_max": 202.35225815272705, "cost2_mean": -79.79012081131872, "cost1_min": 134.82665560998544, "discrim_loss": 1.1578190326690674, "outflow_rate_mean": 918.9025705946393, "system_level_velocity_mean": 14.888933811633427}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12039.400159835815, "sampler_perf": {"mean_inference_ms": 7.6208410004341856, "mean_processing_ms": 11.088738520800781, "mean_env_wait_ms": 138.29984727580276}, "episodes_this_iter": 22, "episodes_total": 2131, "time_total_s": 12039.400159835815, "episode_reward_max": 613.8157109320164, "off_policy_estimator": {}, "episode_reward_min": 262.9219536036253, "episode_reward_mean": 384.89589564942503, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.29965472221375, "timestamp": 1559276379, "episode_len_mean": 325.0, "iterations_since_restore": 92, "training_iteration": 92, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b48c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b47b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-19-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.8904572099418, "cost1_mean": 179.8787225495622, "system_level_velocity_max": 17.381532504919765, "cost2_min": -89.92114294842193, "outflow_rate_min": 815.6328409121486, "system_level_velocity_min": 12.502314480283454, "cost2_max": -69.53800518250948, "cost1_max": 202.53918457393416, "cost2_mean": -81.71010461777054, "cost1_min": 147.17728472077818, "discrim_loss": 1.1362043619155884, "outflow_rate_mean": 949.3374155998754, "system_level_velocity_mean": 15.371940354307691}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12147.166826486588, "sampler_perf": {"mean_inference_ms": 7.615391419295543, "mean_processing_ms": 11.083030071032756, "mean_env_wait_ms": 138.16378515702084}, "episodes_this_iter": 23, "episodes_total": 2154, "time_total_s": 12147.166826486588, "episode_reward_max": 542.065238147974, "off_policy_estimator": {}, "episode_reward_min": 267.38810040801764, "episode_reward_mean": 388.7696344740689, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.7666666507721, "timestamp": 1559276487, "episode_len_mean": 325.0, "iterations_since_restore": 93, "training_iteration": 93, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-21-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.272429844861, "cost1_mean": 172.14844039146, "system_level_velocity_max": 17.370799203604907, "cost2_min": -91.2931637331355, "outflow_rate_min": 763.8254288202479, "system_level_velocity_min": 11.569359441361602, "cost2_max": -70.25232886687738, "cost1_max": 202.39896678556948, "cost2_mean": -82.37654657514172, "cost1_min": 133.83322142531648, "discrim_loss": 1.1577049493789673, "outflow_rate_mean": 921.7086013177061, "system_level_velocity_mean": 14.69869677600033}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12259.674030542374, "sampler_perf": {"mean_inference_ms": 7.6146393261049585, "mean_processing_ms": 11.086107609615874, "mean_env_wait_ms": 137.87696186370167}, "episodes_this_iter": 23, "episodes_total": 2177, "time_total_s": 12259.674030542374, "episode_reward_max": 549.1878138072789, "off_policy_estimator": {}, "episode_reward_min": 281.95917420834303, "episode_reward_mean": 405.42102258101755, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 112.50720405578613, "timestamp": 1559276599, "episode_len_mean": 325.0, "iterations_since_restore": 94, "training_iteration": 94, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303481e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303482f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348840>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-23-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1032.6588505424497, "cost1_mean": 177.65062111363096, "system_level_velocity_max": 17.34609973067219, "cost2_min": -92.93774867760236, "outflow_rate_min": 826.9388840273268, "system_level_velocity_min": 12.175629793173606, "cost2_max": -75.45578632559443, "cost1_max": 202.74746247875441, "cost2_mean": -85.6641113829376, "cost1_min": 142.74683442040413, "discrim_loss": 1.1065855026245117, "outflow_rate_mean": 940.624954460441, "system_level_velocity_mean": 15.05801287088549}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12367.159746170044, "sampler_perf": {"mean_inference_ms": 7.615987115809044, "mean_processing_ms": 11.110050239803376, "mean_env_wait_ms": 137.53600283409642}, "episodes_this_iter": 25, "episodes_total": 2202, "time_total_s": 12367.159746170044, "episode_reward_max": 624.4703221321106, "off_policy_estimator": {}, "episode_reward_min": 28.12044958025217, "episode_reward_mean": 391.99208313167094, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.48571562767029, "timestamp": 1559276707, "episode_len_mean": 313.08, "iterations_since_restore": 95, "training_iteration": 95, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425048>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-25-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.507478650848, "cost1_mean": 169.43118905767588, "system_level_velocity_max": 17.662663420276644, "cost2_min": -92.4587039704677, "outflow_rate_min": 444.6769763958757, "system_level_velocity_min": 12.217265753779838, "cost2_max": -21.097299273166882, "cost1_max": 202.6774807056935, "cost2_mean": -81.19712862298884, "cost1_min": 18.069208468158752, "discrim_loss": 1.1023082733154297, "outflow_rate_mean": 913.4319241510863, "system_level_velocity_mean": 15.053807581817166}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12475.021580696106, "sampler_perf": {"mean_inference_ms": 7.61531822757988, "mean_processing_ms": 11.091538199386997, "mean_env_wait_ms": 137.42804748132914}, "episodes_this_iter": 22, "episodes_total": 2224, "time_total_s": 12475.021580696106, "episode_reward_max": 467.771067045629, "off_policy_estimator": {}, "episode_reward_min": 292.74939151108265, "episode_reward_mean": 382.5907130804633, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.86183452606201, "timestamp": 1559276817, "episode_len_mean": 325.0, "iterations_since_restore": 96, "training_iteration": 96, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd1e0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-26-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.6581026700214, "cost1_mean": 174.3261699336979, "system_level_velocity_max": 17.356141906414067, "cost2_min": -90.5326286708962, "outflow_rate_min": 868.943145373913, "system_level_velocity_min": 13.363449051608915, "cost2_max": -72.00827846834633, "cost1_max": 202.4841986908208, "cost2_mean": -81.90810588946027, "cost1_min": 156.56889405764622, "discrim_loss": 1.0755735635757446, "outflow_rate_mean": 929.6047711510092, "system_level_velocity_mean": 14.893757277885708}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12585.835716724396, "sampler_perf": {"mean_inference_ms": 7.617825843253005, "mean_processing_ms": 11.095939541746054, "mean_env_wait_ms": 137.1547040419182}, "episodes_this_iter": 23, "episodes_total": 2247, "time_total_s": 12585.835716724396, "episode_reward_max": 478.70077769085765, "off_policy_estimator": {}, "episode_reward_min": 282.9794833511114, "episode_reward_mean": 367.93647528958064, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.8141360282898, "timestamp": 1559276928, "episode_len_mean": 325.0, "iterations_since_restore": 97, "training_iteration": 97, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b88c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b87b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-28-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.3892242593558, "cost1_mean": 174.28553090086845, "system_level_velocity_max": 17.346854248177845, "cost2_min": -88.73932222225855, "outflow_rate_min": 782.2955080762367, "system_level_velocity_min": 11.93912100664566, "cost2_max": -70.614850163315, "cost1_max": 202.33364448873112, "cost2_mean": -82.20413643841017, "cost1_min": 139.2016159336907, "discrim_loss": 1.0859074592590332, "outflow_rate_mean": 930.3089542781001, "system_level_velocity_mean": 14.921674668131642}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12695.503225803375, "sampler_perf": {"mean_inference_ms": 7.610749733909726, "mean_processing_ms": 11.132373417625594, "mean_env_wait_ms": 136.7688624976302}, "episodes_this_iter": 26, "episodes_total": 2273, "time_total_s": 12695.503225803375, "episode_reward_max": 573.1533021405339, "off_policy_estimator": {}, "episode_reward_min": 28.214338079094887, "episode_reward_mean": 372.54726033915694, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.66750907897949, "timestamp": 1559277038, "episode_len_mean": 313.84615384615387, "iterations_since_restore": 98, "training_iteration": 98, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-30-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1032.7306142625152, "cost1_mean": 168.8341999720464, "system_level_velocity_max": 18.574827144798913, "cost2_min": -88.15107855580533, "outflow_rate_min": 463.7321904813336, "system_level_velocity_min": 11.555112664571686, "cost2_max": -25.270730300058272, "cost1_max": 202.54163002474132, "cost2_mean": -79.13699307725781, "cost1_min": 23.060659574009264, "discrim_loss": 1.0987744331359863, "outflow_rate_mean": 917.1375732192698, "system_level_velocity_mean": 15.094925935804458}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12805.199934959412, "sampler_perf": {"mean_inference_ms": 7.612437955655663, "mean_processing_ms": 11.094508388275377, "mean_env_wait_ms": 136.70763161669964}, "episodes_this_iter": 21, "episodes_total": 2294, "time_total_s": 12805.199934959412, "episode_reward_max": 613.8560030013323, "off_policy_estimator": {}, "episode_reward_min": 345.39301385730505, "episode_reward_mean": 413.43803123939074, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.69670915603638, "timestamp": 1559277147, "episode_len_mean": 325.0, "iterations_since_restore": 99, "training_iteration": 99, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303242f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-32-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1034.9762084516162, "cost1_mean": 172.7044192415346, "system_level_velocity_max": 17.24652765027394, "cost2_min": -92.22024600759505, "outflow_rate_min": 815.4681271118395, "system_level_velocity_min": 12.285714103887118, "cost2_max": -71.23335407148593, "cost1_max": 200.63633102357818, "cost2_mean": -81.91540469419176, "cost1_min": 142.92523771583595, "discrim_loss": 1.048166275024414, "outflow_rate_mean": 924.3238379808671, "system_level_velocity_mean": 14.758866611835629}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12911.604602575302, "sampler_perf": {"mean_inference_ms": 7.613057764704064, "mean_processing_ms": 11.099071465980172, "mean_env_wait_ms": 136.53323347471883}, "episodes_this_iter": 24, "episodes_total": 2318, "time_total_s": 12911.604602575302, "episode_reward_max": 608.9823093637824, "off_policy_estimator": {}, "episode_reward_min": 348.7720982134342, "episode_reward_mean": 425.57811082014814, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.4046676158905, "timestamp": 1559277254, "episode_len_mean": 325.0, "iterations_since_restore": 100, "training_iteration": 100, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdf28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-34-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.1313626057333, "cost1_mean": 176.34288185539575, "system_level_velocity_max": 17.49010591206684, "cost2_min": -87.84090454034184, "outflow_rate_min": 814.4810560301456, "system_level_velocity_min": 12.09276225113479, "cost2_max": -68.97873328922029, "cost1_max": 202.51618029755753, "cost2_mean": -80.37153571201496, "cost1_min": 141.48124075722973, "discrim_loss": 1.057434320449829, "outflow_rate_mean": 937.3437435790623, "system_level_velocity_mean": 15.094514457627824}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13019.946274757385, "sampler_perf": {"mean_inference_ms": 7.610213025112724, "mean_processing_ms": 11.118112776178874, "mean_env_wait_ms": 136.23097865810516}, "episodes_this_iter": 23, "episodes_total": 2341, "time_total_s": 13019.946274757385, "episode_reward_max": 499.42393869534135, "off_policy_estimator": {}, "episode_reward_min": 370.3931270390749, "episode_reward_mean": 425.225266052491, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.34167218208313, "timestamp": 1559277362, "episode_len_mean": 325.0, "iterations_since_restore": 101, "training_iteration": 101, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-36-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1021.9421442374689, "cost1_mean": 178.29439079198545, "system_level_velocity_max": 17.04429634766534, "cost2_min": -87.43658434815791, "outflow_rate_min": 864.8856036722879, "system_level_velocity_min": 13.554589251899541, "cost2_max": -68.88734555750432, "cost1_max": 198.44840535715267, "cost2_mean": -79.90486262603017, "cost1_min": 156.67804910090177, "discrim_loss": 1.0277001857757568, "outflow_rate_mean": 947.9501216170255, "system_level_velocity_mean": 15.297156253657691}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13126.884097576141, "sampler_perf": {"mean_inference_ms": 7.618817234470365, "mean_processing_ms": 11.097712262970777, "mean_env_wait_ms": 136.01573341484286}, "episodes_this_iter": 23, "episodes_total": 2364, "time_total_s": 13126.884097576141, "episode_reward_max": 476.0806202031672, "off_policy_estimator": {}, "episode_reward_min": 351.34306658804417, "episode_reward_mean": 402.63949289027113, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.9378228187561, "timestamp": 1559277469, "episode_len_mean": 325.0, "iterations_since_restore": 102, "training_iteration": 102, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-37-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.5305369844842, "cost1_mean": 175.1081442177749, "system_level_velocity_max": 17.028222989153992, "cost2_min": -86.06378361537963, "outflow_rate_min": 779.6913056472877, "system_level_velocity_min": 11.820742685159113, "cost2_max": -70.84145538418976, "cost1_max": 198.44308253106806, "cost2_mean": -78.62585655956302, "cost1_min": 135.7958541616718, "discrim_loss": 1.063573956489563, "outflow_rate_mean": 935.0897913566914, "system_level_velocity_mean": 15.045181457371276}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13237.517234563828, "sampler_perf": {"mean_inference_ms": 7.617771365113526, "mean_processing_ms": 11.11402613940452, "mean_env_wait_ms": 135.89724813066843}, "episodes_this_iter": 24, "episodes_total": 2388, "time_total_s": 13237.517234563828, "episode_reward_max": 472.920167542994, "off_policy_estimator": {}, "episode_reward_min": 319.9585319906473, "episode_reward_mean": 377.86815136640024, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.63313698768616, "timestamp": 1559277580, "episode_len_mean": 325.0, "iterations_since_restore": 103, "training_iteration": 103, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b87b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-39-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1029.9934008251807, "cost1_mean": 171.51943751646562, "system_level_velocity_max": 17.30036771102558, "cost2_min": -86.91150932646985, "outflow_rate_min": 778.9392100204204, "system_level_velocity_min": 11.501476001406434, "cost2_max": -65.95699242824244, "cost1_max": 200.84880506989367, "cost2_mean": -77.99454173919843, "cost1_min": 133.25889398753642, "discrim_loss": 1.037674903869629, "outflow_rate_mean": 920.8508150552801, "system_level_velocity_mean": 14.724565599187036}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13345.679913759232, "sampler_perf": {"mean_inference_ms": 7.608180607186083, "mean_processing_ms": 11.108984633190785, "mean_env_wait_ms": 135.68007951905327}, "episodes_this_iter": 22, "episodes_total": 2410, "time_total_s": 13345.679913759232, "episode_reward_max": 469.6030270084739, "off_policy_estimator": {}, "episode_reward_min": 324.97509164363146, "episode_reward_mean": 361.8513749401, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.16267919540405, "timestamp": 1559277688, "episode_len_mean": 325.0, "iterations_since_restore": 104, "training_iteration": 104, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdd90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bde18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-41-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1025.2583350729788, "cost1_mean": 169.7444987937705, "system_level_velocity_max": 17.130594342040155, "cost2_min": -88.3348359395736, "outflow_rate_min": 755.9488863971362, "system_level_velocity_min": 11.546377723722472, "cost2_max": -64.34606141424851, "cost1_max": 199.42813873748912, "cost2_mean": -78.6660281495611, "cost1_min": 134.3103884230039, "discrim_loss": 1.0086958408355713, "outflow_rate_mean": 916.3742459555393, "system_level_velocity_mean": 14.563680684153564}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13457.506041526794, "sampler_perf": {"mean_inference_ms": 7.615805022295791, "mean_processing_ms": 11.117600709126615, "mean_env_wait_ms": 135.30288322612924}, "episodes_this_iter": 24, "episodes_total": 2434, "time_total_s": 13457.506041526794, "episode_reward_max": 393.68185944482684, "off_policy_estimator": {}, "episode_reward_min": 30.32117934525013, "episode_reward_mean": 345.14387281875435, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 111.82612776756287, "timestamp": 1559277800, "episode_len_mean": 312.5833333333333, "iterations_since_restore": 105, "training_iteration": 105, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd9d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdd08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bdea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdc80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-43-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1026.7398418592397, "cost1_mean": 169.36949811102798, "system_level_velocity_max": 17.11201871397341, "cost2_min": -87.56992279740632, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 12.19397942139889, "cost2_max": -21.21937824841606, "cost1_max": 199.70587853191813, "cost2_mean": -78.89519900704683, "cost1_min": 17.78346641689332, "discrim_loss": 0.9953559041023254, "outflow_rate_mean": 918.1644528360401, "system_level_velocity_mean": 15.145936326882557}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13563.896347999573, "sampler_perf": {"mean_inference_ms": 7.611816584588246, "mean_processing_ms": 11.109665981853045, "mean_env_wait_ms": 135.2763800780073}, "episodes_this_iter": 23, "episodes_total": 2457, "time_total_s": 13563.896347999573, "episode_reward_max": 482.59000580757856, "off_policy_estimator": {}, "episode_reward_min": 216.55082716047764, "episode_reward_mean": 364.55958064046246, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.39030647277832, "timestamp": 1559277907, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 106, "training_iteration": 106, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-45-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1020.227008943799, "cost1_mean": 170.69056245688444, "system_level_velocity_max": 17.766788027644147, "cost2_min": -87.22067850040874, "outflow_rate_min": 769.7559317787375, "system_level_velocity_min": 11.614391180961125, "cost2_max": -67.8289986177933, "cost1_max": 199.94365832747232, "cost2_mean": -79.33464332082578, "cost1_min": 131.90173641147075, "discrim_loss": 0.9789356589317322, "outflow_rate_mean": 920.4208131285304, "system_level_velocity_mean": 14.906963960229232}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13669.782907962799, "sampler_perf": {"mean_inference_ms": 7.607184414148527, "mean_processing_ms": 11.120505417776188, "mean_env_wait_ms": 134.9248343587864}, "episodes_this_iter": 24, "episodes_total": 2481, "time_total_s": 13669.782907962799, "episode_reward_max": 407.0420897901058, "off_policy_estimator": {}, "episode_reward_min": 348.54888758063316, "episode_reward_mean": 380.50128342894214, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.88655996322632, "timestamp": 1559278012, "episode_len_mean": 325.0, "iterations_since_restore": 107, "training_iteration": 107, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324c80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-46-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1020.5941106993354, "cost1_mean": 170.80655815378688, "system_level_velocity_max": 16.821340936492422, "cost2_min": -89.56551347197802, "outflow_rate_min": 758.5767390749584, "system_level_velocity_min": 11.758716446720747, "cost2_max": -70.47709040816805, "cost1_max": 196.44095914105725, "cost2_mean": -79.3579442488926, "cost1_min": 134.7998872722663, "discrim_loss": 0.9917989373207092, "outflow_rate_mean": 917.1180950612825, "system_level_velocity_mean": 14.637802035345516}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13780.048761606216, "sampler_perf": {"mean_inference_ms": 7.60874733305648, "mean_processing_ms": 11.10431382097341, "mean_env_wait_ms": 134.822300643552}, "episodes_this_iter": 23, "episodes_total": 2504, "time_total_s": 13780.048761606216, "episode_reward_max": 399.10063038021326, "off_policy_estimator": {}, "episode_reward_min": 241.89405637979507, "episode_reward_mean": 359.58977620902914, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.26585364341736, "timestamp": 1559278123, "episode_len_mean": 319.2173913043478, "iterations_since_restore": 108, "training_iteration": 108, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdc80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-48-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1022.8741378963531, "cost1_mean": 173.50952336747537, "system_level_velocity_max": 17.781121370749243, "cost2_min": -86.47992602014034, "outflow_rate_min": 867.5626819512327, "system_level_velocity_min": 13.50821461991984, "cost2_max": -70.01590526450673, "cost1_max": 197.5280445505234, "cost2_mean": -78.80041675539664, "cost1_min": 139.36999269742984, "discrim_loss": 0.9869335889816284, "outflow_rate_mean": 936.9281684262177, "system_level_velocity_mean": 15.2014131426695}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13887.911811590195, "sampler_perf": {"mean_inference_ms": 7.608497497693269, "mean_processing_ms": 11.109744239111942, "mean_env_wait_ms": 134.67973782305157}, "episodes_this_iter": 24, "episodes_total": 2528, "time_total_s": 13887.911811590195, "episode_reward_max": 387.2728057205677, "off_policy_estimator": {}, "episode_reward_min": 38.440903678536415, "episode_reward_mean": 343.51757337292656, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.86304998397827, "timestamp": 1559278233, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 109, "training_iteration": 109, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-50-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.8070243563159, "cost1_mean": 160.14800939427846, "system_level_velocity_max": 18.810099505485596, "cost2_min": -82.83754775591996, "outflow_rate_min": 516.5375004973323, "system_level_velocity_min": 12.450938289830436, "cost2_max": -23.01160257339377, "cost1_max": 197.5445426856837, "cost2_mean": -71.61855380551434, "cost1_min": 22.987903117575257, "discrim_loss": 0.9615752696990967, "outflow_rate_mean": 880.8931377444045, "system_level_velocity_mean": 14.476645971475527}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13994.042677402496, "sampler_perf": {"mean_inference_ms": 7.608006749486033, "mean_processing_ms": 11.124334491602612, "mean_env_wait_ms": 134.3441312010788}, "episodes_this_iter": 24, "episodes_total": 2552, "time_total_s": 13994.042677402496, "episode_reward_max": 386.642909809947, "off_policy_estimator": {}, "episode_reward_min": 38.75292356312275, "episode_reward_mean": 337.5939118821795, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.13086581230164, "timestamp": 1559278343, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 110, "training_iteration": 110, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ab70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034aae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aa60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-52-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.3812848555078, "cost1_mean": 165.37016296635875, "system_level_velocity_max": 18.760959629680467, "cost2_min": -83.69262638482812, "outflow_rate_min": 516.5375004973323, "system_level_velocity_min": 12.464524197302918, "cost2_max": -22.994482004064, "cost1_max": 195.4398457846736, "cost2_mean": -72.89375811311923, "cost1_min": 22.945750082293234, "discrim_loss": 0.9505836367607117, "outflow_rate_mean": 906.9475594059195, "system_level_velocity_mean": 14.951569923476734}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14100.147194862366, "sampler_perf": {"mean_inference_ms": 7.603658447451661, "mean_processing_ms": 11.127409577302389, "mean_env_wait_ms": 134.2434901434876}, "episodes_this_iter": 25, "episodes_total": 2577, "time_total_s": 14100.147194862366, "episode_reward_max": 370.0270890444517, "off_policy_estimator": {}, "episode_reward_min": 38.35395635664463, "episode_reward_mean": 327.4431945309043, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.10451745986938, "timestamp": 1559278449, "episode_len_mean": 313.48, "iterations_since_restore": 111, "training_iteration": 111, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-54-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.935766552657, "cost1_mean": 166.66498240818444, "system_level_velocity_max": 18.68416354113169, "cost2_min": -82.45518235357267, "outflow_rate_min": 477.4323090172687, "system_level_velocity_min": 11.61431921997467, "cost2_max": -25.010396113043956, "cost1_max": 195.7185438980739, "cost2_mean": -71.37182374895926, "cost1_min": 24.36654224554942, "discrim_loss": 0.9366155862808228, "outflow_rate_mean": 910.5796095759321, "system_level_velocity_mean": 15.046748381735334}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14208.128465175629, "sampler_perf": {"mean_inference_ms": 7.603717047027811, "mean_processing_ms": 11.122119921595388, "mean_env_wait_ms": 134.01737569155426}, "episodes_this_iter": 21, "episodes_total": 2598, "time_total_s": 14208.128465175629, "episode_reward_max": 380.11098958551884, "off_policy_estimator": {}, "episode_reward_min": 327.04802273213863, "episode_reward_mean": 361.9282102073942, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.98127031326294, "timestamp": 1559278557, "episode_len_mean": 325.0, "iterations_since_restore": 112, "training_iteration": 112, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdbf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bde18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-55-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1014.3048533776322, "cost1_mean": 168.83862856425134, "system_level_velocity_max": 16.905580519438942, "cost2_min": -80.49691670329088, "outflow_rate_min": 805.6123458371509, "system_level_velocity_min": 12.411991152013229, "cost2_max": -64.11160691262768, "cost1_max": 195.3041634115795, "cost2_mean": -72.87837338335716, "cost1_min": 142.80082537909306, "discrim_loss": 0.9286011457443237, "outflow_rate_mean": 916.1314011270858, "system_level_velocity_mean": 14.603724155473591}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14314.501675367355, "sampler_perf": {"mean_inference_ms": 7.606864339154658, "mean_processing_ms": 11.13847520228728, "mean_env_wait_ms": 133.79005510807517}, "episodes_this_iter": 25, "episodes_total": 2623, "time_total_s": 14314.501675367355, "episode_reward_max": 380.51198349893093, "off_policy_estimator": {}, "episode_reward_min": 223.41348692774773, "episode_reward_mean": 354.5624378603697, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.37321019172668, "timestamp": 1559278663, "episode_len_mean": 320.68, "iterations_since_restore": 113, "training_iteration": 113, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-57-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.8901472237054, "cost1_mean": 164.33093649636214, "system_level_velocity_max": 17.516452608306633, "cost2_min": -81.16605061395177, "outflow_rate_min": 798.2991509479166, "system_level_velocity_min": 12.33603161264959, "cost2_max": -63.691181558284285, "cost1_max": 194.05835759386542, "cost2_mean": -70.1170647149884, "cost1_min": 134.89805348328184, "discrim_loss": 0.9357367753982544, "outflow_rate_mean": 897.5399233854572, "system_level_velocity_mean": 14.439648527082221}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14421.611124038696, "sampler_perf": {"mean_inference_ms": 7.596402532685763, "mean_processing_ms": 11.130743087042351, "mean_env_wait_ms": 133.67882419191164}, "episodes_this_iter": 23, "episodes_total": 2646, "time_total_s": 14421.611124038696, "episode_reward_max": 367.80073929578066, "off_policy_estimator": {}, "episode_reward_min": 306.59286800026894, "episode_reward_mean": 330.6425231468418, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.10944867134094, "timestamp": 1559278770, "episode_len_mean": 323.7826086956522, "iterations_since_restore": 114, "training_iteration": 114, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a8c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-59-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.8327278058081, "cost1_mean": 172.50600212600207, "system_level_velocity_max": 16.821357929728954, "cost2_min": -81.80096208499421, "outflow_rate_min": 810.889974390903, "system_level_velocity_min": 12.41479298449447, "cost2_max": -64.8462329174181, "cost1_max": 194.82132671271737, "cost2_mean": -74.3624833979563, "cost1_min": 142.86757766142935, "discrim_loss": 0.899921715259552, "outflow_rate_mean": 929.5449743743615, "system_level_velocity_mean": 14.951175775152695}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14527.770495653152, "sampler_perf": {"mean_inference_ms": 7.607852249975708, "mean_processing_ms": 11.124338313010114, "mean_env_wait_ms": 133.4372061353033}, "episodes_this_iter": 22, "episodes_total": 2668, "time_total_s": 14527.770495653152, "episode_reward_max": 338.42643789201975, "off_policy_estimator": {}, "episode_reward_min": 268.2583348751068, "episode_reward_mean": 299.8738787136972, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.15937161445618, "timestamp": 1559278877, "episode_len_mean": 325.0, "iterations_since_restore": 115, "training_iteration": 115, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-01-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.6714528077976, "cost1_mean": 177.02907435715753, "system_level_velocity_max": 16.8693337021875, "cost2_min": -80.6467671216076, "outflow_rate_min": 778.8491402325616, "system_level_velocity_min": 12.128440007631673, "cost2_max": -64.38956482363524, "cost1_max": 194.53184860264253, "cost2_mean": -75.10486543057539, "cost1_min": 140.10110237625312, "discrim_loss": 0.8996567726135254, "outflow_rate_mean": 946.5636221755029, "system_level_velocity_mean": 15.284775807735889}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14634.346714258194, "sampler_perf": {"mean_inference_ms": 7.603491600956763, "mean_processing_ms": 11.137125484587221, "mean_env_wait_ms": 133.19840322779842}, "episodes_this_iter": 24, "episodes_total": 2692, "time_total_s": 14634.346714258194, "episode_reward_max": 317.13404258340597, "off_policy_estimator": {}, "episode_reward_min": 265.6536157876253, "episode_reward_mean": 288.3423679843545, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.5762186050415, "timestamp": 1559278983, "episode_len_mean": 325.0, "iterations_since_restore": 116, "training_iteration": 116, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bff28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfe18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-03-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.9003721129156, "cost1_mean": 168.22735897475584, "system_level_velocity_max": 16.823216058260783, "cost2_min": -80.78686786290072, "outflow_rate_min": 755.6718737890459, "system_level_velocity_min": 11.686144240986211, "cost2_max": -61.41079840479128, "cost1_max": 195.13604363218008, "cost2_mean": -72.70316141130122, "cost1_min": 133.71824133068398, "discrim_loss": 0.9106401205062866, "outflow_rate_mean": 910.9411973267615, "system_level_velocity_mean": 14.552409874383551}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14741.258985042572, "sampler_perf": {"mean_inference_ms": 7.595613495747744, "mean_processing_ms": 11.129501692213656, "mean_env_wait_ms": 133.08685531094204}, "episodes_this_iter": 24, "episodes_total": 2716, "time_total_s": 14741.258985042572, "episode_reward_max": 357.68867349624634, "off_policy_estimator": {}, "episode_reward_min": 278.74161028862, "episode_reward_mean": 314.43970000681776, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.91227078437805, "timestamp": 1559279090, "episode_len_mean": 325.0, "iterations_since_restore": 117, "training_iteration": 117, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79304250d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-04-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.900645577069, "cost1_mean": 169.9133629585325, "system_level_velocity_max": 16.80222122986309, "cost2_min": -81.8277566028327, "outflow_rate_min": 802.6832095136375, "system_level_velocity_min": 12.102183111756023, "cost2_max": -64.8797962794312, "cost1_max": 194.32989848700876, "cost2_mean": -73.6042822044995, "cost1_min": 140.37895287629937, "discrim_loss": 0.8863888382911682, "outflow_rate_mean": 919.7520963248659, "system_level_velocity_mean": 14.664334186163762}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14844.440643072128, "sampler_perf": {"mean_inference_ms": 7.602408829498774, "mean_processing_ms": 11.116010756784334, "mean_env_wait_ms": 132.79880377453748}, "episodes_this_iter": 21, "episodes_total": 2737, "time_total_s": 14844.440643072128, "episode_reward_max": 363.0566336661577, "off_policy_estimator": {}, "episode_reward_min": 321.74879460036755, "episode_reward_mean": 341.46679930069615, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.18165802955627, "timestamp": 1559279194, "episode_len_mean": 323.6666666666667, "iterations_since_restore": 118, "training_iteration": 118, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b42f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-06-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.9401595010804, "cost1_mean": 167.5762532085508, "system_level_velocity_max": 16.625634813029443, "cost2_min": -81.41004041429119, "outflow_rate_min": 825.2150315880187, "system_level_velocity_min": 12.76025292093218, "cost2_max": -64.40462880609093, "cost1_max": 193.92795235941554, "cost2_mean": -71.73101501121587, "cost1_min": 145.40917773300194, "discrim_loss": 0.8786174058914185, "outflow_rate_mean": 910.8842371465306, "system_level_velocity_mean": 14.542288481598964}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14953.009982347488, "sampler_perf": {"mean_inference_ms": 7.5946642263230935, "mean_processing_ms": 11.118751727534802, "mean_env_wait_ms": 132.65563138650717}, "episodes_this_iter": 23, "episodes_total": 2760, "time_total_s": 14953.009982347488, "episode_reward_max": 378.12321335077286, "off_policy_estimator": {}, "episode_reward_min": 339.9215871989727, "episode_reward_mean": 356.8922437869984, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.56933927536011, "timestamp": 1559279302, "episode_len_mean": 325.0, "iterations_since_restore": 119, "training_iteration": 119, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-08-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.8957457269158, "cost1_mean": 167.48458809842376, "system_level_velocity_max": 16.920336965199954, "cost2_min": -81.20757904591831, "outflow_rate_min": 767.3816460086294, "system_level_velocity_min": 12.027268639220202, "cost2_max": -64.65332989336899, "cost1_max": 195.61352242185836, "cost2_mean": -72.45207910065722, "cost1_min": 138.3498101023348, "discrim_loss": 0.8596063256263733, "outflow_rate_mean": 907.0009214470515, "system_level_velocity_mean": 14.488218205027183}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15061.2467212677, "sampler_perf": {"mean_inference_ms": 7.593630516595707, "mean_processing_ms": 11.138389448718447, "mean_env_wait_ms": 132.42842412485274}, "episodes_this_iter": 25, "episodes_total": 2785, "time_total_s": 15061.2467212677, "episode_reward_max": 382.5239968970418, "off_policy_estimator": {}, "episode_reward_min": 323.64976742863655, "episode_reward_mean": 343.93501936793325, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.23673892021179, "timestamp": 1559279410, "episode_len_mean": 325.0, "iterations_since_restore": 120, "training_iteration": 120, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf510>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-10-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.2961880658289, "cost1_mean": 167.6514008490467, "system_level_velocity_max": 16.72606071307272, "cost2_min": -84.3270853164368, "outflow_rate_min": 813.2126780649044, "system_level_velocity_min": 12.451993229441994, "cost2_max": -63.7474611709563, "cost1_max": 193.8580320529416, "cost2_mean": -73.06403650834996, "cost1_min": 145.20018068326834, "discrim_loss": 0.8612185716629028, "outflow_rate_mean": 908.4069721169602, "system_level_velocity_mean": 14.459221841753354}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15167.215896368027, "sampler_perf": {"mean_inference_ms": 7.594073827029283, "mean_processing_ms": 11.11848740765703, "mean_env_wait_ms": 132.3318223000749}, "episodes_this_iter": 22, "episodes_total": 2807, "time_total_s": 15167.215896368027, "episode_reward_max": 348.56664388626814, "off_policy_estimator": {}, "episode_reward_min": 189.69707477092743, "episode_reward_mean": 306.4582960893485, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.96917510032654, "timestamp": 1559279517, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 121, "training_iteration": 121, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324840>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-11-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.6194078100445, "cost1_mean": 166.65730626696595, "system_level_velocity_max": 17.517732085777183, "cost2_min": -81.62682147773873, "outflow_rate_min": 695.0603797718235, "system_level_velocity_min": 10.454696386010303, "cost2_max": -63.92189606589352, "cost1_max": 194.3501435666512, "cost2_mean": -72.09832581457839, "cost1_min": 121.53221690933582, "discrim_loss": 0.8700348138809204, "outflow_rate_mean": 910.965992620531, "system_level_velocity_mean": 14.691341364427348}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15276.566366672516, "sampler_perf": {"mean_inference_ms": 7.591669281393118, "mean_processing_ms": 11.120132102137203, "mean_env_wait_ms": 132.2241053407053}, "episodes_this_iter": 22, "episodes_total": 2829, "time_total_s": 15276.566366672516, "episode_reward_max": 308.3797610551119, "off_policy_estimator": {}, "episode_reward_min": 271.1934296488762, "episode_reward_mean": 288.3101537349549, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.35047030448914, "timestamp": 1559279626, "episode_len_mean": 325.0, "iterations_since_restore": 122, "training_iteration": 122, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ad90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ae18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034af28>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-13-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4969717453399, "cost1_mean": 169.76294157739045, "system_level_velocity_max": 16.829665218946992, "cost2_min": -82.14385585299924, "outflow_rate_min": 806.6952395431368, "system_level_velocity_min": 12.293650129342092, "cost2_max": -64.64599393909738, "cost1_max": 195.00715739772443, "cost2_mean": -73.86234288515212, "cost1_min": 141.69375745731372, "discrim_loss": 0.8361477851867676, "outflow_rate_mean": 915.9012872996802, "system_level_velocity_mean": 14.664391085014653}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15383.050662517548, "sampler_perf": {"mean_inference_ms": 7.596377504507566, "mean_processing_ms": 11.13652605944128, "mean_env_wait_ms": 131.92394928121536}, "episodes_this_iter": 26, "episodes_total": 2855, "time_total_s": 15383.050662517548, "episode_reward_max": 330.40971825644374, "off_policy_estimator": {}, "episode_reward_min": 270.513823479414, "episode_reward_mean": 289.473621917602, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.48429584503174, "timestamp": 1559279732, "episode_len_mean": 325.0, "iterations_since_restore": 123, "training_iteration": 123, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-15-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.2596890517084, "cost1_mean": 164.28367023053866, "system_level_velocity_max": 16.905365261524526, "cost2_min": -80.56729819991588, "outflow_rate_min": 719.1249069367938, "system_level_velocity_min": 11.192963103717153, "cost2_max": -62.24803655690197, "cost1_max": 195.2913813761236, "cost2_mean": -70.72755636211781, "cost1_min": 130.3947578269755, "discrim_loss": 0.844562292098999, "outflow_rate_mean": 896.0957740105233, "system_level_velocity_mean": 14.217943629137942}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15493.42013502121, "sampler_perf": {"mean_inference_ms": 7.585469582232441, "mean_processing_ms": 11.123667254834187, "mean_env_wait_ms": 131.92845306836435}, "episodes_this_iter": 22, "episodes_total": 2877, "time_total_s": 15493.42013502121, "episode_reward_max": 324.4739969521761, "off_policy_estimator": {}, "episode_reward_min": 274.71314361691475, "episode_reward_mean": 304.259296186607, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.36947250366211, "timestamp": 1559279843, "episode_len_mean": 324.3181818181818, "iterations_since_restore": 124, "training_iteration": 124, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfd08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf2f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf7b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-17-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1010.2148988858286, "cost1_mean": 168.571868644875, "system_level_velocity_max": 17.146645968901296, "cost2_min": -80.92162906858378, "outflow_rate_min": 765.8399274598784, "system_level_velocity_min": 11.659448406951197, "cost2_max": -65.83446577504515, "cost1_max": 194.15131405058003, "cost2_mean": -73.36705874470857, "cost1_min": 133.16704168974368, "discrim_loss": 0.8246839642524719, "outflow_rate_mean": 918.591708604527, "system_level_velocity_mean": 14.623065099015532}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15600.429818868637, "sampler_perf": {"mean_inference_ms": 7.588393532087993, "mean_processing_ms": 11.118811797585531, "mean_env_wait_ms": 131.69507834357952}, "episodes_this_iter": 21, "episodes_total": 2898, "time_total_s": 15600.429818868637, "episode_reward_max": 327.45193003863096, "off_policy_estimator": {}, "episode_reward_min": 290.81284188479185, "episode_reward_mean": 306.29132978706843, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.00968384742737, "timestamp": 1559279950, "episode_len_mean": 325.0, "iterations_since_restore": 125, "training_iteration": 125, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a400>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-19-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.9708081104507, "cost1_mean": 168.73870243932237, "system_level_velocity_max": 16.93392293252774, "cost2_min": -81.48912043235964, "outflow_rate_min": 751.3660926507106, "system_level_velocity_min": 11.801652848985071, "cost2_max": -65.08498998865836, "cost1_max": 195.9952558505724, "cost2_mean": -73.19945355027951, "cost1_min": 133.66380784926508, "discrim_loss": 0.811883807182312, "outflow_rate_mean": 914.7320097110328, "system_level_velocity_mean": 14.60962782745849}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15704.155821323395, "sampler_perf": {"mean_inference_ms": 7.590930985321221, "mean_processing_ms": 11.139992729926423, "mean_env_wait_ms": 131.50275059528818}, "episodes_this_iter": 28, "episodes_total": 2926, "time_total_s": 15704.155821323395, "episode_reward_max": 330.66711960732937, "off_policy_estimator": {}, "episode_reward_min": 39.79956004023552, "episode_reward_mean": 298.5351205573284, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.72600245475769, "timestamp": 1559280054, "episode_len_mean": 313.64285714285717, "iterations_since_restore": 126, "training_iteration": 126, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a1e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a6a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-20-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1020.793598467581, "cost1_mean": 157.60532653868918, "system_level_velocity_max": 18.631310331617186, "cost2_min": -81.49344814026439, "outflow_rate_min": 484.6173885219949, "system_level_velocity_min": 12.422321567555695, "cost2_max": -24.360879878627937, "cost1_max": 196.92848057806836, "cost2_mean": -69.80298007661597, "cost1_min": 23.098557307685972, "discrim_loss": 0.8353602886199951, "outflow_rate_mean": 876.6710056088231, "system_level_velocity_mean": 14.283145578775846}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15808.427826166153, "sampler_perf": {"mean_inference_ms": 7.577773811684142, "mean_processing_ms": 11.12523717969112, "mean_env_wait_ms": 131.39855967474816}, "episodes_this_iter": 22, "episodes_total": 2948, "time_total_s": 15808.427826166153, "episode_reward_max": 329.30690462887287, "off_policy_estimator": {}, "episode_reward_min": 283.46910666674376, "episode_reward_mean": 301.3394649265842, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.27200484275818, "timestamp": 1559280158, "episode_len_mean": 325.0, "iterations_since_restore": 127, "training_iteration": 127, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf2f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-22-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.9464381464875, "cost1_mean": 164.5971409935685, "system_level_velocity_max": 17.102102507437355, "cost2_min": -81.60429918471743, "outflow_rate_min": 739.7144582238201, "system_level_velocity_min": 11.422882231397523, "cost2_max": -64.2697596714354, "cost1_max": 197.55320095690504, "cost2_mean": -72.43416170834887, "cost1_min": 130.5960985121682, "discrim_loss": 0.8106369972229004, "outflow_rate_mean": 895.5534929485773, "system_level_velocity_mean": 14.238613772420807}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15916.837805747986, "sampler_perf": {"mean_inference_ms": 7.583970849199739, "mean_processing_ms": 11.12555129512528, "mean_env_wait_ms": 131.2543399698277}, "episodes_this_iter": 22, "episodes_total": 2970, "time_total_s": 15916.837805747986, "episode_reward_max": 320.45683231949806, "off_policy_estimator": {}, "episode_reward_min": 27.029911264777184, "episode_reward_mean": 287.8625194073062, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.40997958183289, "timestamp": 1559280267, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 128, "training_iteration": 128, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302beae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bea60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be950>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-24-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1020.2433819223486, "cost1_mean": 164.12722835279527, "system_level_velocity_max": 17.207430780089048, "cost2_min": -82.37993099819697, "outflow_rate_min": 477.24354782665716, "system_level_velocity_min": 12.137948042571027, "cost2_max": -17.403764337714513, "cost1_max": 196.2507784909988, "cost2_mean": -71.52963158562426, "cost1_min": 17.76821112473265, "discrim_loss": 0.8216211795806885, "outflow_rate_mean": 906.237088384793, "system_level_velocity_mean": 14.855970570956504}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16020.680787563324, "sampler_perf": {"mean_inference_ms": 7.5807739095711915, "mean_processing_ms": 11.139105355742162, "mean_env_wait_ms": 130.9842260187421}, "episodes_this_iter": 26, "episodes_total": 2996, "time_total_s": 16020.680787563324, "episode_reward_max": 315.63945573195815, "off_policy_estimator": {}, "episode_reward_min": 267.4688956812024, "episode_reward_mean": 291.8265678753647, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.84298181533813, "timestamp": 1559280371, "episode_len_mean": 325.0, "iterations_since_restore": 129, "training_iteration": 129, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be2f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-26-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.1137981760885, "cost1_mean": 170.57675693646053, "system_level_velocity_max": 16.85836958603991, "cost2_min": -82.60540387061798, "outflow_rate_min": 782.1548451639001, "system_level_velocity_min": 12.067304037025169, "cost2_max": -63.970749422914196, "cost1_max": 195.61900978627975, "cost2_mean": -73.40815393989847, "cost1_min": 140.118280587433, "discrim_loss": 0.7977675199508667, "outflow_rate_mean": 920.5539783717735, "system_level_velocity_mean": 14.725782001561443}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16125.701686382294, "sampler_perf": {"mean_inference_ms": 7.577518842520164, "mean_processing_ms": 11.127821163329443, "mean_env_wait_ms": 130.8493433517217}, "episodes_this_iter": 23, "episodes_total": 3019, "time_total_s": 16125.701686382294, "episode_reward_max": 314.47698171436787, "off_policy_estimator": {}, "episode_reward_min": 42.31261736154556, "episode_reward_mean": 284.66029206371826, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.02089881896973, "timestamp": 1559280476, "episode_len_mean": 312.4782608695652, "iterations_since_restore": 130, "training_iteration": 130, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-27-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1014.3537604586999, "cost1_mean": 155.57323402420806, "system_level_velocity_max": 18.883124378337413, "cost2_min": -81.53142413593221, "outflow_rate_min": 492.1711703675176, "system_level_velocity_min": 11.76839339117629, "cost2_max": -24.902358558559424, "cost1_max": 195.65497932887223, "cost2_mean": -69.22440977345379, "cost1_min": 24.589410213871734, "discrim_loss": 0.8039994239807129, "outflow_rate_mean": 865.6890932614051, "system_level_velocity_mean": 14.195761183980053}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16232.64752984047, "sampler_perf": {"mean_inference_ms": 7.57852069998647, "mean_processing_ms": 11.126194405923316, "mean_env_wait_ms": 130.78116154456973}, "episodes_this_iter": 22, "episodes_total": 3041, "time_total_s": 16232.64752984047, "episode_reward_max": 353.4739484079182, "off_policy_estimator": {}, "episode_reward_min": 274.57028000056744, "episode_reward_mean": 307.06256343695253, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.94584345817566, "timestamp": 1559280583, "episode_len_mean": 325.0, "iterations_since_restore": 131, "training_iteration": 131, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-29-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1010.3690753924463, "cost1_mean": 175.8252049196262, "system_level_velocity_max": 16.79555485525163, "cost2_min": -81.6157164636831, "outflow_rate_min": 863.1398525907605, "system_level_velocity_min": 13.523352260915422, "cost2_max": -63.36549557859777, "cost1_max": 194.3744390788496, "cost2_mean": -73.69701671805409, "cost1_min": 155.74988284892862, "discrim_loss": 0.8244115114212036, "outflow_rate_mean": 943.0257208412226, "system_level_velocity_mean": 15.168910451279345}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16345.871886730194, "sampler_perf": {"mean_inference_ms": 7.581948464136921, "mean_processing_ms": 11.127016148844861, "mean_env_wait_ms": 130.68411941990863}, "episodes_this_iter": 22, "episodes_total": 3063, "time_total_s": 16345.871886730194, "episode_reward_max": 331.82529758661985, "off_policy_estimator": {}, "episode_reward_min": 213.62264853715897, "episode_reward_mean": 306.34807663173837, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 113.22435688972473, "timestamp": 1559280696, "episode_len_mean": 320.0, "iterations_since_restore": 132, "training_iteration": 132, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-31-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.9222817351948, "cost1_mean": 166.63401298844735, "system_level_velocity_max": 16.992332539623217, "cost2_min": -81.49882516372392, "outflow_rate_min": 805.0509931095057, "system_level_velocity_min": 12.12738971054091, "cost2_max": -63.426841581961625, "cost1_max": 194.3767693697488, "cost2_mean": -72.3990608180235, "cost1_min": 131.07888317591735, "discrim_loss": 0.8176486492156982, "outflow_rate_mean": 912.6619061249838, "system_level_velocity_mean": 14.661740240534334}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16455.92834544182, "sampler_perf": {"mean_inference_ms": 7.585407462898104, "mean_processing_ms": 11.145895181227926, "mean_env_wait_ms": 130.44582825330866}, "episodes_this_iter": 26, "episodes_total": 3089, "time_total_s": 16455.92834544182, "episode_reward_max": 343.1681075617671, "off_policy_estimator": {}, "episode_reward_min": 263.9170881062746, "episode_reward_mean": 303.07534154404243, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.05645871162415, "timestamp": 1559280806, "episode_len_mean": 325.0, "iterations_since_restore": 133, "training_iteration": 133, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303247b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-33-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.7730710844438, "cost1_mean": 175.2099390328519, "system_level_velocity_max": 16.955505668555325, "cost2_min": -82.81687275891427, "outflow_rate_min": 850.7552535007873, "system_level_velocity_min": 13.20562900697223, "cost2_max": -64.71261659538906, "cost1_max": 196.2408008246368, "cost2_mean": -74.96880593129536, "cost1_min": 151.2144000628397, "discrim_loss": 0.8353078365325928, "outflow_rate_mean": 942.4493149995258, "system_level_velocity_mean": 15.136530682941505}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16564.590745449066, "sampler_perf": {"mean_inference_ms": 7.578277177892389, "mean_processing_ms": 11.13783900001062, "mean_env_wait_ms": 130.4492723487928}, "episodes_this_iter": 22, "episodes_total": 3111, "time_total_s": 16564.590745449066, "episode_reward_max": 310.45576572045684, "off_policy_estimator": {}, "episode_reward_min": 258.53113975189626, "episode_reward_mean": 286.0476407529786, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.66240000724792, "timestamp": 1559280915, "episode_len_mean": 323.72727272727275, "iterations_since_restore": 134, "training_iteration": 134, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be0d0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-35-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.183397709238, "cost1_mean": 168.0416378845588, "system_level_velocity_max": 16.966187158911755, "cost2_min": -81.02663184799198, "outflow_rate_min": 754.5482310322781, "system_level_velocity_min": 12.06245293708288, "cost2_max": -62.68499352890013, "cost1_max": 196.43739558757406, "cost2_mean": -73.29480294619981, "cost1_min": 136.91178945311194, "discrim_loss": 0.8521316647529602, "outflow_rate_mean": 909.8129912824802, "system_level_velocity_mean": 14.584144859003514}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16672.75982952118, "sampler_perf": {"mean_inference_ms": 7.581698829863446, "mean_processing_ms": 11.139235176486531, "mean_env_wait_ms": 130.26502889392472}, "episodes_this_iter": 21, "episodes_total": 3132, "time_total_s": 16672.75982952118, "episode_reward_max": 316.8379668071866, "off_policy_estimator": {}, "episode_reward_min": 197.73476807773113, "episode_reward_mean": 285.98199854046106, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.16908407211304, "timestamp": 1559281023, "episode_len_mean": 319.76190476190476, "iterations_since_restore": 135, "training_iteration": 135, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfe18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-37-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.4290009653986, "cost1_mean": 167.67772529255373, "system_level_velocity_max": 17.416604235355305, "cost2_min": -81.8378901552127, "outflow_rate_min": 763.5726703317497, "system_level_velocity_min": 12.075161834670629, "cost2_max": -62.19569760200748, "cost1_max": 194.8556519167625, "cost2_mean": -72.91451917668803, "cost1_min": 133.73532193787577, "discrim_loss": 0.8466427326202393, "outflow_rate_mean": 914.0994967642085, "system_level_velocity_mean": 14.79315051171682}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16780.14173913002, "sampler_perf": {"mean_inference_ms": 7.592786120902436, "mean_processing_ms": 11.147963063246006, "mean_env_wait_ms": 130.13860817840146}, "episodes_this_iter": 26, "episodes_total": 3158, "time_total_s": 16780.14173913002, "episode_reward_max": 358.414183139801, "off_policy_estimator": {}, "episode_reward_min": 273.2413747385144, "episode_reward_mean": 321.52529770873775, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.38190960884094, "timestamp": 1559281131, "episode_len_mean": 325.0, "iterations_since_restore": 136, "training_iteration": 136, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba8c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-38-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.0298817312624, "cost1_mean": 167.89926241108134, "system_level_velocity_max": 16.922451021963205, "cost2_min": -81.63426667895865, "outflow_rate_min": 759.2157959245787, "system_level_velocity_min": 12.134514911569845, "cost2_max": -63.639757109050976, "cost1_max": 196.0358329981454, "cost2_mean": -72.89411383994576, "cost1_min": 138.9083186006829, "discrim_loss": 0.8628123998641968, "outflow_rate_mean": 909.8799450749905, "system_level_velocity_mean": 14.497291433845998}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16888.115561246872, "sampler_perf": {"mean_inference_ms": 7.581226688328036, "mean_processing_ms": 11.14387970260832, "mean_env_wait_ms": 130.0981706174779}, "episodes_this_iter": 23, "episodes_total": 3181, "time_total_s": 16888.115561246872, "episode_reward_max": 431.99890231341124, "off_policy_estimator": {}, "episode_reward_min": 311.9207655079663, "episode_reward_mean": 367.7387650471343, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.9738221168518, "timestamp": 1559281241, "episode_len_mean": 325.0, "iterations_since_restore": 137, "training_iteration": 137, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-40-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.3561434748063, "cost1_mean": 172.12361645365598, "system_level_velocity_max": 16.72077998786446, "cost2_min": -82.75630993019213, "outflow_rate_min": 814.0836692123345, "system_level_velocity_min": 12.513883462261905, "cost2_max": -63.52098937744055, "cost1_max": 194.13786205799016, "cost2_mean": -73.76260419681968, "cost1_min": 145.98583418192538, "discrim_loss": 0.8609088063240051, "outflow_rate_mean": 925.792810692542, "system_level_velocity_mean": 14.84128437250484}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16992.641615867615, "sampler_perf": {"mean_inference_ms": 7.582061982475049, "mean_processing_ms": 11.138581909356535, "mean_env_wait_ms": 129.89562282236045}, "episodes_this_iter": 21, "episodes_total": 3202, "time_total_s": 16992.641615867615, "episode_reward_max": 391.36571447364986, "off_policy_estimator": {}, "episode_reward_min": 247.1346413642168, "episode_reward_mean": 354.9769015448789, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.5260546207428, "timestamp": 1559281346, "episode_len_mean": 319.85714285714283, "iterations_since_restore": 138, "training_iteration": 138, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-42-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.0378560998982, "cost1_mean": 171.9631695861714, "system_level_velocity_max": 17.420899412023882, "cost2_min": -82.42802294683162, "outflow_rate_min": 806.1896719442168, "system_level_velocity_min": 12.120591515268652, "cost2_max": -63.812725116911004, "cost1_max": 194.8869691418264, "cost2_mean": -74.16925282242975, "cost1_min": 135.02137387132672, "discrim_loss": 0.8745850920677185, "outflow_rate_mean": 933.3195442981249, "system_level_velocity_mean": 15.125013551313998}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17099.17002224922, "sampler_perf": {"mean_inference_ms": 7.591238460192671, "mean_processing_ms": 11.159396258957365, "mean_env_wait_ms": 129.7771817962362}, "episodes_this_iter": 27, "episodes_total": 3229, "time_total_s": 17099.17002224922, "episode_reward_max": 388.3173044025898, "off_policy_estimator": {}, "episode_reward_min": 281.989739343524, "episode_reward_mean": 321.7006629600569, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.52840638160706, "timestamp": 1559281456, "episode_len_mean": 325.0, "iterations_since_restore": 139, "training_iteration": 139, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-44-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.8167636624362, "cost1_mean": 165.5902197935484, "system_level_velocity_max": 16.850737995552727, "cost2_min": -80.60949433349708, "outflow_rate_min": 802.8406079461998, "system_level_velocity_min": 12.056985312771985, "cost2_max": -62.86025162915078, "cost1_max": 195.2836592299406, "cost2_mean": -69.64838532663629, "cost1_min": 140.10705874115496, "discrim_loss": 0.8857936859130859, "outflow_rate_mean": 898.6980306058008, "system_level_velocity_mean": 14.321539125562001}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17203.69025182724, "sampler_perf": {"mean_inference_ms": 7.580018857663316, "mean_processing_ms": 11.143102020591652, "mean_env_wait_ms": 129.65375876982606}, "episodes_this_iter": 22, "episodes_total": 3251, "time_total_s": 17203.69025182724, "episode_reward_max": 332.5494008772075, "off_policy_estimator": {}, "episode_reward_min": 262.5010263286531, "episode_reward_mean": 295.6604664005254, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.52022957801819, "timestamp": 1559281561, "episode_len_mean": 325.0, "iterations_since_restore": 140, "training_iteration": 140, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c12f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-46-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.9285400648666, "cost1_mean": 170.70554532925442, "system_level_velocity_max": 16.954467638366683, "cost2_min": -81.68619578375635, "outflow_rate_min": 796.9764638008013, "system_level_velocity_min": 12.42528074376558, "cost2_max": -63.33801102231473, "cost1_max": 196.10897755003828, "cost2_mean": -72.74847045807574, "cost1_min": 142.72524527600436, "discrim_loss": 0.9313031435012817, "outflow_rate_mean": 919.8935204356396, "system_level_velocity_mean": 14.753474632279369}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17308.847064733505, "sampler_perf": {"mean_inference_ms": 7.583810115243578, "mean_processing_ms": 11.14111910849217, "mean_env_wait_ms": 129.5233261175926}, "episodes_this_iter": 20, "episodes_total": 3271, "time_total_s": 17308.847064733505, "episode_reward_max": 324.8898521512747, "off_policy_estimator": {}, "episode_reward_min": 267.59124417230487, "episode_reward_mean": 303.40227990476416, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.15681290626526, "timestamp": 1559281666, "episode_len_mean": 325.0, "iterations_since_restore": 141, "training_iteration": 141, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303242f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-47-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.9508409444697, "cost1_mean": 169.9897230102232, "system_level_velocity_max": 17.06291601401978, "cost2_min": -81.85922626094421, "outflow_rate_min": 759.3547121659641, "system_level_velocity_min": 12.253524686857121, "cost2_max": -61.59505967801639, "cost1_max": 197.60030102623585, "cost2_mean": -72.43155387790924, "cost1_min": 140.2587159864681, "discrim_loss": 0.9500406384468079, "outflow_rate_mean": 916.7430072473793, "system_level_velocity_mean": 14.695588146676101}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17416.724424362183, "sampler_perf": {"mean_inference_ms": 7.581582022765042, "mean_processing_ms": 11.160533580330036, "mean_env_wait_ms": 129.39634366705823}, "episodes_this_iter": 27, "episodes_total": 3298, "time_total_s": 17416.724424362183, "episode_reward_max": 419.94331212341785, "off_policy_estimator": {}, "episode_reward_min": 290.96662236750126, "episode_reward_mean": 363.653087525663, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.87735962867737, "timestamp": 1559281774, "episode_len_mean": 321.037037037037, "iterations_since_restore": 142, "training_iteration": 142, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-49-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.1077316750435, "cost1_mean": 163.85227363467615, "system_level_velocity_max": 16.927704587293537, "cost2_min": -81.15050723973977, "outflow_rate_min": 778.5840671022762, "system_level_velocity_min": 12.118526969944874, "cost2_max": -63.81152005659503, "cost1_max": 195.14987702025854, "cost2_mean": -72.53337878478298, "cost1_min": 133.20139989764397, "discrim_loss": 0.9260979890823364, "outflow_rate_mean": 898.1889311739096, "system_level_velocity_mean": 14.355262771865263}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17523.45897293091, "sampler_perf": {"mean_inference_ms": 7.583245822906048, "mean_processing_ms": 11.148471716985002, "mean_env_wait_ms": 129.27540644407148}, "episodes_this_iter": 23, "episodes_total": 3321, "time_total_s": 17523.45897293091, "episode_reward_max": 508.42089788615704, "off_policy_estimator": {}, "episode_reward_min": 413.2955201268196, "episode_reward_mean": 460.8270598339808, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.73454856872559, "timestamp": 1559281881, "episode_len_mean": 325.0, "iterations_since_restore": 143, "training_iteration": 143, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303751e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-51-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.2938649136148, "cost1_mean": 173.35996296337015, "system_level_velocity_max": 16.890896422495285, "cost2_min": -80.88868300390126, "outflow_rate_min": 803.6134284035063, "system_level_velocity_min": 12.102121989319203, "cost2_max": -62.91670916472261, "cost1_max": 195.580584684581, "cost2_mean": -74.271019334302, "cost1_min": 140.13807777020804, "discrim_loss": 0.9821068644523621, "outflow_rate_mean": 933.0027048040155, "system_level_velocity_mean": 14.93608907843496}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17626.397650957108, "sampler_perf": {"mean_inference_ms": 7.580275883980457, "mean_processing_ms": 11.143703787456241, "mean_env_wait_ms": 129.1387956551552}, "episodes_this_iter": 20, "episodes_total": 3341, "time_total_s": 17626.397650957108, "episode_reward_max": 486.42966409027576, "off_policy_estimator": {}, "episode_reward_min": 397.94124215841293, "episode_reward_mean": 446.3129883732181, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 102.93867802619934, "timestamp": 1559281984, "episode_len_mean": 325.0, "iterations_since_restore": 144, "training_iteration": 144, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-53-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.0324070315163, "cost1_mean": 176.35497651623584, "system_level_velocity_max": 16.897871724485103, "cost2_min": -81.84596331615404, "outflow_rate_min": 785.0136164553045, "system_level_velocity_min": 11.947344862078404, "cost2_max": -64.56755659690913, "cost1_max": 195.77396812851492, "cost2_mean": -74.54520460952058, "cost1_min": 138.57441890195753, "discrim_loss": 0.9544481039047241, "outflow_rate_mean": 945.5533424905391, "system_level_velocity_mean": 15.211138666004794}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17731.40717625618, "sampler_perf": {"mean_inference_ms": 7.577582384853201, "mean_processing_ms": 11.14855192913563, "mean_env_wait_ms": 129.05292240563682}, "episodes_this_iter": 24, "episodes_total": 3365, "time_total_s": 17731.40717625618, "episode_reward_max": 445.1534968018532, "off_policy_estimator": {}, "episode_reward_min": 344.8616710025817, "episode_reward_mean": 393.37998572248034, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.00952529907227, "timestamp": 1559282089, "episode_len_mean": 325.0, "iterations_since_restore": 145, "training_iteration": 145, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303242f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-54-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.7984165777985, "cost1_mean": 169.45019796895986, "system_level_velocity_max": 16.79854749499152, "cost2_min": -81.3222827152555, "outflow_rate_min": 746.406659523011, "system_level_velocity_min": 11.541867052671337, "cost2_max": -63.48349595170964, "cost1_max": 194.38596052262955, "cost2_mean": -72.77272054308558, "cost1_min": 132.42977759638586, "discrim_loss": 0.9653388261795044, "outflow_rate_mean": 917.1924656066594, "system_level_velocity_mean": 14.640347828554058}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17836.4436712265, "sampler_perf": {"mean_inference_ms": 7.583287102413452, "mean_processing_ms": 11.155280317173343, "mean_env_wait_ms": 128.85220129171796}, "episodes_this_iter": 26, "episodes_total": 3391, "time_total_s": 17836.4436712265, "episode_reward_max": 422.50545283406973, "off_policy_estimator": {}, "episode_reward_min": 313.19327932037413, "episode_reward_mean": 363.1217550274271, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.03649497032166, "timestamp": 1559282196, "episode_len_mean": 325.0, "iterations_since_restore": 146, "training_iteration": 146, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be2f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bed90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302beae8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-56-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1014.9860842823479, "cost1_mean": 177.18787891950575, "system_level_velocity_max": 16.86031829432252, "cost2_min": -82.35509494692485, "outflow_rate_min": 764.0486213886777, "system_level_velocity_min": 12.00369602764493, "cost2_max": -63.042895301316726, "cost1_max": 194.78456791000588, "cost2_mean": -74.7678200861835, "cost1_min": 137.40829247444515, "discrim_loss": 1.0044119358062744, "outflow_rate_mean": 948.4185827349103, "system_level_velocity_mean": 15.301837936160288}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17944.082180023193, "sampler_perf": {"mean_inference_ms": 7.581475055653165, "mean_processing_ms": 11.148275254144707, "mean_env_wait_ms": 128.78426601781413}, "episodes_this_iter": 20, "episodes_total": 3411, "time_total_s": 17944.082180023193, "episode_reward_max": 442.7596201747656, "off_policy_estimator": {}, "episode_reward_min": 329.8132781870663, "episode_reward_mean": 391.94300919286906, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.6385087966919, "timestamp": 1559282303, "episode_len_mean": 325.0, "iterations_since_restore": 147, "training_iteration": 147, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-58-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.5737724200795, "cost1_mean": 176.97765924134396, "system_level_velocity_max": 16.844306616110273, "cost2_min": -80.83034902024394, "outflow_rate_min": 811.1230589768402, "system_level_velocity_min": 12.52899152721626, "cost2_max": -65.82620025793807, "cost1_max": 195.0570658856376, "cost2_mean": -74.97781200265327, "cost1_min": 146.12334286901412, "discrim_loss": 0.9649804830551147, "outflow_rate_mean": 946.6413454868074, "system_level_velocity_mean": 15.244296529152374}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18048.949262857437, "sampler_perf": {"mean_inference_ms": 7.577805283944565, "mean_processing_ms": 11.145137179097425, "mean_env_wait_ms": 128.6758992105256}, "episodes_this_iter": 22, "episodes_total": 3433, "time_total_s": 18048.949262857437, "episode_reward_max": 458.5910362005234, "off_policy_estimator": {}, "episode_reward_min": 362.2695835418999, "episode_reward_mean": 406.9127874191512, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.86708283424377, "timestamp": 1559282408, "episode_len_mean": 325.0, "iterations_since_restore": 148, "training_iteration": 148, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c18c8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-00-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1001.7262250341614, "cost1_mean": 170.60277903833727, "system_level_velocity_max": 16.651446192725096, "cost2_min": -80.35137534134445, "outflow_rate_min": 810.1043391325921, "system_level_velocity_min": 12.579038050155921, "cost2_max": -63.059231910605746, "cost1_max": 193.65419763024448, "cost2_mean": -71.90021361565947, "cost1_min": 146.5985011475071, "discrim_loss": 0.9918224811553955, "outflow_rate_mean": 920.9211350192941, "system_level_velocity_mean": 14.754529239451402}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18155.857141017914, "sampler_perf": {"mean_inference_ms": 7.587699475903428, "mean_processing_ms": 11.154432976177846, "mean_env_wait_ms": 128.511102065114}, "episodes_this_iter": 26, "episodes_total": 3459, "time_total_s": 18155.857141017914, "episode_reward_max": 477.0345428362489, "off_policy_estimator": {}, "episode_reward_min": 371.44520145095885, "episode_reward_mean": 423.5930751282722, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.90787816047668, "timestamp": 1559282515, "episode_len_mean": 325.0, "iterations_since_restore": 149, "training_iteration": 149, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-01-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.4879665459882, "cost1_mean": 169.5564283681767, "system_level_velocity_max": 16.909568285511003, "cost2_min": -81.18562955621256, "outflow_rate_min": 814.0374138371718, "system_level_velocity_min": 12.633617415139689, "cost2_max": -63.09582758588728, "cost1_max": 195.03596961572714, "cost2_mean": -70.60846147352277, "cost1_min": 146.54291458270154, "discrim_loss": 0.978898286819458, "outflow_rate_mean": 917.2433962438105, "system_level_velocity_mean": 14.662008596695857}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18265.40750312805, "sampler_perf": {"mean_inference_ms": 7.5764679191678646, "mean_processing_ms": 11.145519082627668, "mean_env_wait_ms": 128.47401551686391}, "episodes_this_iter": 23, "episodes_total": 3482, "time_total_s": 18265.40750312805, "episode_reward_max": 452.3872818648815, "off_policy_estimator": {}, "episode_reward_min": 61.66319167613983, "episode_reward_mean": 397.56501825307697, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.55036211013794, "timestamp": 1559282625, "episode_len_mean": 312.39130434782606, "iterations_since_restore": 150, "training_iteration": 150, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bea60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bee18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be510>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-03-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.8130322140373, "cost1_mean": 154.232271318948, "system_level_velocity_max": 17.604449811104924, "cost2_min": -80.07303336005316, "outflow_rate_min": 424.4559491199726, "system_level_velocity_min": 11.547882028914671, "cost2_max": -26.672251581369107, "cost1_max": 195.6888897991741, "cost2_mean": -66.91491008817223, "cost1_min": 22.549032061335, "discrim_loss": 0.9992339611053467, "outflow_rate_mean": 856.7994584031225, "system_level_velocity_mean": 14.006334619843644}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18370.779364585876, "sampler_perf": {"mean_inference_ms": 7.576345391390515, "mean_processing_ms": 11.152264285780644, "mean_env_wait_ms": 128.30228161338096}, "episodes_this_iter": 22, "episodes_total": 3504, "time_total_s": 18370.779364585876, "episode_reward_max": 453.4459747709334, "off_policy_estimator": {}, "episode_reward_min": 346.783999055624, "episode_reward_mean": 410.67140750586987, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.3718614578247, "timestamp": 1559282730, "episode_len_mean": 325.0, "iterations_since_restore": 151, "training_iteration": 151, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302beb70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-05-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.3630276509666, "cost1_mean": 166.05841075544384, "system_level_velocity_max": 16.773051929214233, "cost2_min": -81.59264089171884, "outflow_rate_min": 746.0163841377763, "system_level_velocity_min": 11.809404990360807, "cost2_max": -58.38610276447494, "cost1_max": 194.49460338534095, "cost2_mean": -70.63971857129405, "cost1_min": 135.41636079631115, "discrim_loss": 1.021520733833313, "outflow_rate_mean": 900.6029117969164, "system_level_velocity_mean": 14.32663704119094}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18478.929478168488, "sampler_perf": {"mean_inference_ms": 7.585534334990171, "mean_processing_ms": 11.161256241312222, "mean_env_wait_ms": 128.1678838791177}, "episodes_this_iter": 26, "episodes_total": 3530, "time_total_s": 18478.929478168488, "episode_reward_max": 453.62091720849276, "off_policy_estimator": {}, "episode_reward_min": 372.16265842691064, "episode_reward_mean": 416.4519730119321, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.15011358261108, "timestamp": 1559282839, "episode_len_mean": 325.0, "iterations_since_restore": 152, "training_iteration": 152, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c11e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c16a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1a60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-07-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1018.7218074025517, "cost1_mean": 170.53220854606755, "system_level_velocity_max": 16.940824338020263, "cost2_min": -81.21240973258136, "outflow_rate_min": 853.1929947494377, "system_level_velocity_min": 13.18585739700413, "cost2_max": -63.96648607789007, "cost1_max": 197.01398035706518, "cost2_mean": -72.13606198792766, "cost1_min": 151.9920492414502, "discrim_loss": 0.985028862953186, "outflow_rate_mean": 921.5028187192105, "system_level_velocity_mean": 14.684342511959937}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18585.93207859993, "sampler_perf": {"mean_inference_ms": 7.5731851603354565, "mean_processing_ms": 11.152236757037874, "mean_env_wait_ms": 128.0840950797103}, "episodes_this_iter": 22, "episodes_total": 3552, "time_total_s": 18585.93207859993, "episode_reward_max": 463.24796640872955, "off_policy_estimator": {}, "episode_reward_min": 369.05150228738785, "episode_reward_mean": 413.3483319240199, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.00260043144226, "timestamp": 1559282946, "episode_len_mean": 325.0, "iterations_since_restore": 153, "training_iteration": 153, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303757b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-09-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4060889471032, "cost1_mean": 169.61856458963555, "system_level_velocity_max": 16.77614207760493, "cost2_min": -81.28111886179903, "outflow_rate_min": 767.6079985567736, "system_level_velocity_min": 11.799928393193875, "cost2_max": -62.982578681013806, "cost1_max": 194.83572520249214, "cost2_mean": -71.31977514209429, "cost1_min": 135.27423663975856, "discrim_loss": 0.9945475459098816, "outflow_rate_mean": 916.4711203968028, "system_level_velocity_mean": 14.63928365008558}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18686.47980618477, "sampler_perf": {"mean_inference_ms": 7.574054826374173, "mean_processing_ms": 11.145693657695833, "mean_env_wait_ms": 127.95550416735841}, "episodes_this_iter": 21, "episodes_total": 3573, "time_total_s": 18686.47980618477, "episode_reward_max": 431.96487947925925, "off_policy_estimator": {}, "episode_reward_min": 271.5505305826664, "episode_reward_mean": 398.23011678599175, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 100.54772758483887, "timestamp": 1559283046, "episode_len_mean": 319.85714285714283, "iterations_since_restore": 154, "training_iteration": 154, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be730>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bed08>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-10-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1019.5578827046731, "cost1_mean": 166.6341158287219, "system_level_velocity_max": 17.10486851197736, "cost2_min": -79.18290720441027, "outflow_rate_min": 803.734423698158, "system_level_velocity_min": 12.244202856769201, "cost2_max": -62.85724687633388, "cost1_max": 197.97814541120565, "cost2_mean": -70.44044727372744, "cost1_min": 125.41857168905955, "discrim_loss": 0.9929224252700806, "outflow_rate_mean": 907.692184312273, "system_level_velocity_mean": 14.595088608163147}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18788.61064863205, "sampler_perf": {"mean_inference_ms": 7.572318227614882, "mean_processing_ms": 11.16133551594525, "mean_env_wait_ms": 127.77550583523133}, "episodes_this_iter": 26, "episodes_total": 3599, "time_total_s": 18788.61064863205, "episode_reward_max": 438.72347839176655, "off_policy_estimator": {}, "episode_reward_min": 355.2029084917158, "episode_reward_mean": 397.9536499698969, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 102.13084244728088, "timestamp": 1559283149, "episode_len_mean": 325.0, "iterations_since_restore": 155, "training_iteration": 155, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-12-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.7383802332884, "cost1_mean": 175.5561608995755, "system_level_velocity_max": 16.75850487119909, "cost2_min": -81.85723037784146, "outflow_rate_min": 849.5702003405123, "system_level_velocity_min": 13.154600999742266, "cost2_max": -63.272510444013285, "cost1_max": 195.19307886251693, "cost2_mean": -73.34869137020269, "cost1_min": 151.45156271603904, "discrim_loss": 0.9938318729400635, "outflow_rate_mean": 944.5706155666885, "system_level_velocity_mean": 15.115640761664888}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18896.955801010132, "sampler_perf": {"mean_inference_ms": 7.5774213656222855, "mean_processing_ms": 11.146713118340644, "mean_env_wait_ms": 127.73614331844102}, "episodes_this_iter": 23, "episodes_total": 3622, "time_total_s": 18896.955801010132, "episode_reward_max": 431.8142075538635, "off_policy_estimator": {}, "episode_reward_min": 369.1937852110714, "episode_reward_mean": 396.31093245542246, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.34515237808228, "timestamp": 1559283258, "episode_len_mean": 325.0, "iterations_since_restore": 156, "training_iteration": 156, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c11e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c16a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1950>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-14-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.693004171093, "cost1_mean": 169.5625888434748, "system_level_velocity_max": 16.70376954327238, "cost2_min": -81.08389652130764, "outflow_rate_min": 843.3265010698171, "system_level_velocity_min": 13.068002735839825, "cost2_max": -63.3313289868435, "cost1_max": 194.11605063330072, "cost2_mean": -70.65556803348566, "cost1_min": 151.26678793319718, "discrim_loss": 1.0359513759613037, "outflow_rate_mean": 915.8495871852199, "system_level_velocity_mean": 14.601491098732861}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19006.491238832474, "sampler_perf": {"mean_inference_ms": 7.576894850590802, "mean_processing_ms": 11.150765827460114, "mean_env_wait_ms": 127.69960988965474}, "episodes_this_iter": 21, "episodes_total": 3643, "time_total_s": 19006.491238832474, "episode_reward_max": 459.04854115843773, "off_policy_estimator": {}, "episode_reward_min": 373.7911398289725, "episode_reward_mean": 419.6052400460467, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.53543782234192, "timestamp": 1559283368, "episode_len_mean": 325.0, "iterations_since_restore": 157, "training_iteration": 157, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c17b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-16-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1010.1060378546275, "cost1_mean": 172.5726254582835, "system_level_velocity_max": 16.75704611342275, "cost2_min": -80.53465701932896, "outflow_rate_min": 762.7668628526566, "system_level_velocity_min": 11.83272190866332, "cost2_max": -61.99549904755717, "cost1_max": 195.37900187647335, "cost2_mean": -71.91106934620936, "cost1_min": 138.172038723743, "discrim_loss": 0.9828016757965088, "outflow_rate_mean": 925.6837148255329, "system_level_velocity_mean": 14.826139710659659}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19115.418369054794, "sampler_perf": {"mean_inference_ms": 7.577119998101859, "mean_processing_ms": 11.148085452677385, "mean_env_wait_ms": 127.54098783508304}, "episodes_this_iter": 23, "episodes_total": 3666, "time_total_s": 19115.418369054794, "episode_reward_max": 474.69744259119034, "off_policy_estimator": {}, "episode_reward_min": 57.81053310632706, "episode_reward_mean": 408.66164694110984, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.92713022232056, "timestamp": 1559283477, "episode_len_mean": 312.39130434782606, "iterations_since_restore": 158, "training_iteration": 158, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bebf8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bef28>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-17-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.047707755626, "cost1_mean": 165.0786065609539, "system_level_velocity_max": 18.463538906782404, "cost2_min": -80.13969930202015, "outflow_rate_min": 512.5194798574704, "system_level_velocity_min": 12.029896083030609, "cost2_max": -23.07674935381506, "cost1_max": 195.80399970797595, "cost2_mean": -69.85729995215357, "cost1_min": 22.788627119614898, "discrim_loss": 0.9755772352218628, "outflow_rate_mean": 905.2692831226765, "system_level_velocity_mean": 14.891508633712462}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19219.832845926285, "sampler_perf": {"mean_inference_ms": 7.578522860056892, "mean_processing_ms": 11.157424153394038, "mean_env_wait_ms": 127.4489631918819}, "episodes_this_iter": 27, "episodes_total": 3693, "time_total_s": 19219.832845926285, "episode_reward_max": 443.91999673098326, "off_policy_estimator": {}, "episode_reward_min": 337.38408050639555, "episode_reward_mean": 397.3383707861519, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.41447687149048, "timestamp": 1559283581, "episode_len_mean": 323.962962962963, "iterations_since_restore": 159, "training_iteration": 159, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-19-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1007.163082192787, "cost1_mean": 164.63639322436342, "system_level_velocity_max": 16.679730129001054, "cost2_min": -79.61137065184994, "outflow_rate_min": 752.5185851704346, "system_level_velocity_min": 11.558112066701318, "cost2_max": -59.376877474038515, "cost1_max": 194.31935731303042, "cost2_mean": -68.45403875447931, "cost1_min": 123.46875683519696, "discrim_loss": 0.9676258563995361, "outflow_rate_mean": 895.9077476771666, "system_level_velocity_mean": 14.177867748119006}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19323.790386915207, "sampler_perf": {"mean_inference_ms": 7.572561774826335, "mean_processing_ms": 11.147187239448932, "mean_env_wait_ms": 127.34080849684312}, "episodes_this_iter": 21, "episodes_total": 3714, "time_total_s": 19323.790386915207, "episode_reward_max": 421.53422090411186, "off_policy_estimator": {}, "episode_reward_min": 332.2076413077302, "episode_reward_mean": 379.29842416636114, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.95754098892212, "timestamp": 1559283685, "episode_len_mean": 325.0, "iterations_since_restore": 160, "training_iteration": 160, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a950>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a7b8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-21-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.4531037501754, "cost1_mean": 166.8405589991412, "system_level_velocity_max": 16.77955797232985, "cost2_min": -79.37900997101221, "outflow_rate_min": 754.7544489161941, "system_level_velocity_min": 11.716003734282882, "cost2_max": -59.53228168019106, "cost1_max": 195.39156842597623, "cost2_mean": -69.10903544290329, "cost1_min": 135.47390184052048, "discrim_loss": 0.9693171977996826, "outflow_rate_mean": 901.0116011620399, "system_level_velocity_mean": 14.33791235586482}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19428.354695796967, "sampler_perf": {"mean_inference_ms": 7.56890178450481, "mean_processing_ms": 11.146531825463475, "mean_env_wait_ms": 127.18313141163874}, "episodes_this_iter": 21, "episodes_total": 3735, "time_total_s": 19428.354695796967, "episode_reward_max": 457.36168394237757, "off_policy_estimator": {}, "episode_reward_min": 350.6429443433881, "episode_reward_mean": 401.9851381874067, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.56430888175964, "timestamp": 1559283790, "episode_len_mean": 325.0, "iterations_since_restore": 161, "training_iteration": 161, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-23-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.2614469887721, "cost1_mean": 172.48957884402125, "system_level_velocity_max": 16.32408592031584, "cost2_min": -84.67717908551785, "outflow_rate_min": 797.898583011683, "system_level_velocity_min": 12.290549469173675, "cost2_max": -63.12703848773028, "cost1_max": 192.98589174241627, "cost2_mean": -73.21795170268986, "cost1_min": 141.53265401661048, "discrim_loss": 1.0341181755065918, "outflow_rate_mean": 923.1175684026999, "system_level_velocity_mean": 14.735009310288106}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19537.95194554329, "sampler_perf": {"mean_inference_ms": 7.579369861990217, "mean_processing_ms": 11.153966119732234, "mean_env_wait_ms": 127.0934427986855}, "episodes_this_iter": 26, "episodes_total": 3761, "time_total_s": 19537.95194554329, "episode_reward_max": 459.8965418636799, "off_policy_estimator": {}, "episode_reward_min": 352.9116657814011, "episode_reward_mean": 425.18718747024496, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.59724974632263, "timestamp": 1559283900, "episode_len_mean": 325.0, "iterations_since_restore": 162, "training_iteration": 162, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4378>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b46a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-25-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.9184334586647, "cost1_mean": 177.20053552955866, "system_level_velocity_max": 16.874436685514443, "cost2_min": -83.74567218512028, "outflow_rate_min": 812.5503317950696, "system_level_velocity_min": 12.501627497606766, "cost2_max": -62.13678503737176, "cost1_max": 196.69186405471692, "cost2_mean": -74.58343444600939, "cost1_min": 147.1905034462036, "discrim_loss": 0.986046552658081, "outflow_rate_mean": 942.1403887646823, "system_level_velocity_mean": 15.158801351213814}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19644.251353263855, "sampler_perf": {"mean_inference_ms": 7.566845392903344, "mean_processing_ms": 11.141885790474168, "mean_env_wait_ms": 127.05163371612464}, "episodes_this_iter": 23, "episodes_total": 3784, "time_total_s": 19644.251353263855, "episode_reward_max": 458.6480585485697, "off_policy_estimator": {}, "episode_reward_min": 298.8229378759861, "episode_reward_mean": 406.18539412694213, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.2994077205658, "timestamp": 1559284006, "episode_len_mean": 320.2173913043478, "iterations_since_restore": 163, "training_iteration": 163, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303242f0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324f28>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-26-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1019.2631529188428, "cost1_mean": 170.19280694475285, "system_level_velocity_max": 16.951785906056617, "cost2_min": -81.89535050366632, "outflow_rate_min": 759.6853972729165, "system_level_velocity_min": 11.77909244216606, "cost2_max": -62.2932066235026, "cost1_max": 197.10921783192012, "cost2_mean": -71.99563676303572, "cost1_min": 131.695138636178, "discrim_loss": 0.9761359691619873, "outflow_rate_mean": 921.7700315525007, "system_level_velocity_mean": 14.803925164990705}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19752.43784379959, "sampler_perf": {"mean_inference_ms": 7.570051670941785, "mean_processing_ms": 11.145011953618486, "mean_env_wait_ms": 126.93825703634099}, "episodes_this_iter": 22, "episodes_total": 3806, "time_total_s": 19752.43784379959, "episode_reward_max": 435.01615519821644, "off_policy_estimator": {}, "episode_reward_min": 345.5928902081214, "episode_reward_mean": 394.7937173189341, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 108.18649053573608, "timestamp": 1559284114, "episode_len_mean": 325.0, "iterations_since_restore": 164, "training_iteration": 164, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ad08>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aa60>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-28-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.2390067543963, "cost1_mean": 175.48494056097803, "system_level_velocity_max": 16.93213141158534, "cost2_min": -83.69183824731078, "outflow_rate_min": 824.0134031325529, "system_level_velocity_min": 12.723836508615165, "cost2_max": -63.314406761896564, "cost1_max": 197.5659226588453, "cost2_mean": -73.35209027762987, "cost1_min": 149.65900689232137, "discrim_loss": 0.9718430042266846, "outflow_rate_mean": 934.1703081690993, "system_level_velocity_mean": 14.984798444513832}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19866.636247634888, "sampler_perf": {"mean_inference_ms": 7.577518194613074, "mean_processing_ms": 11.156658634343893, "mean_env_wait_ms": 126.87507059552722}, "episodes_this_iter": 25, "episodes_total": 3831, "time_total_s": 19866.636247634888, "episode_reward_max": 430.87667756713927, "off_policy_estimator": {}, "episode_reward_min": 333.492971687112, "episode_reward_mean": 380.60098828310146, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 114.19840383529663, "timestamp": 1559284229, "episode_len_mean": 325.0, "iterations_since_restore": 165, "training_iteration": 165, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425048>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-30-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.2863918844643, "cost1_mean": 174.8654066725225, "system_level_velocity_max": 16.71479501304874, "cost2_min": -81.62145533316591, "outflow_rate_min": 810.2960931055194, "system_level_velocity_min": 12.464961511560666, "cost2_max": -62.47198391611544, "cost1_max": 195.586593338823, "cost2_mean": -72.77259419593503, "cost1_min": 146.68466023901794, "discrim_loss": 0.9746841788291931, "outflow_rate_mean": 932.713702077969, "system_level_velocity_mean": 14.939382095574137}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19977.052822589874, "sampler_perf": {"mean_inference_ms": 7.56604731851349, "mean_processing_ms": 11.146175377585545, "mean_env_wait_ms": 126.85518479386302}, "episodes_this_iter": 23, "episodes_total": 3854, "time_total_s": 19977.052822589874, "episode_reward_max": 431.8982479572296, "off_policy_estimator": {}, "episode_reward_min": 330.17550759902224, "episode_reward_mean": 386.3408664504532, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.41657495498657, "timestamp": 1559284339, "episode_len_mean": 325.0, "iterations_since_restore": 166, "training_iteration": 166, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b40d0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4510>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-32-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.0472336680987, "cost1_mean": 172.45905742879333, "system_level_velocity_max": 16.980110297018438, "cost2_min": -82.73250734900247, "outflow_rate_min": 762.3303902132809, "system_level_velocity_min": 11.660820954389287, "cost2_max": -62.95429637607303, "cost1_max": 197.8534134073367, "cost2_mean": -72.94594605520976, "cost1_min": 135.102525995596, "discrim_loss": 0.9962972402572632, "outflow_rate_mean": 921.6389182438874, "system_level_velocity_mean": 14.72940990875265}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20084.15143108368, "sampler_perf": {"mean_inference_ms": 7.572314285019621, "mean_processing_ms": 11.144642480514543, "mean_env_wait_ms": 126.74868471933864}, "episodes_this_iter": 21, "episodes_total": 3875, "time_total_s": 20084.15143108368, "episode_reward_max": 488.8516964763403, "off_policy_estimator": {}, "episode_reward_min": 339.899299249053, "episode_reward_mean": 429.38158403516616, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.09860849380493, "timestamp": 1559284446, "episode_len_mean": 319.76190476190476, "iterations_since_restore": 167, "training_iteration": 167, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303247b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-34-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1020.8378826691884, "cost1_mean": 172.96950706629246, "system_level_velocity_max": 16.99211133768113, "cost2_min": -82.96317775789845, "outflow_rate_min": 769.0196350231095, "system_level_velocity_min": 11.918156513392427, "cost2_max": -63.85768631762194, "cost1_max": 198.55914245028808, "cost2_mean": -75.28144427690025, "cost1_min": 130.43856202270757, "discrim_loss": 0.9670354127883911, "outflow_rate_mean": 925.8976092252409, "system_level_velocity_mean": 15.030777532423889}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20194.647492170334, "sampler_perf": {"mean_inference_ms": 7.567238946830311, "mean_processing_ms": 11.164004892564241, "mean_env_wait_ms": 126.66089400334137}, "episodes_this_iter": 25, "episodes_total": 3900, "time_total_s": 20194.647492170334, "episode_reward_max": 486.50910894572735, "off_policy_estimator": {}, "episode_reward_min": 366.08098133280873, "episode_reward_mean": 428.84399811783805, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.49606108665466, "timestamp": 1559284560, "episode_len_mean": 325.0, "iterations_since_restore": 168, "training_iteration": 168, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a048>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034aa60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-36-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1016.4669683634984, "cost1_mean": 174.95365804458356, "system_level_velocity_max": 16.900804477901957, "cost2_min": -82.47286259040044, "outflow_rate_min": 803.8518973687769, "system_level_velocity_min": 12.031012653647648, "cost2_max": -61.33055969453407, "cost1_max": 197.30108566763306, "cost2_mean": -73.49691283011624, "cost1_min": 141.7405864815068, "discrim_loss": 0.9407031536102295, "outflow_rate_mean": 934.9596460536513, "system_level_velocity_mean": 14.944620387233655}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20301.173465013504, "sampler_perf": {"mean_inference_ms": 7.569520065179823, "mean_processing_ms": 11.144070781979357, "mean_env_wait_ms": 126.61152969404475}, "episodes_this_iter": 23, "episodes_total": 3923, "time_total_s": 20301.173465013504, "episode_reward_max": 449.99641612172127, "off_policy_estimator": {}, "episode_reward_min": 342.22905970551074, "episode_reward_mean": 393.9909070236001, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.52597284317017, "timestamp": 1559284667, "episode_len_mean": 325.0, "iterations_since_restore": 169, "training_iteration": 169, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-37-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1014.7481194560492, "cost1_mean": 175.1733126315597, "system_level_velocity_max": 16.857957108286563, "cost2_min": -80.9292712122654, "outflow_rate_min": 854.6913034842534, "system_level_velocity_min": 13.342529724037737, "cost2_max": -62.89899551352679, "cost1_max": 196.68359409831106, "cost2_mean": -72.8219845283323, "cost1_min": 155.56589243275778, "discrim_loss": 0.9534280300140381, "outflow_rate_mean": 935.3188143036244, "system_level_velocity_mean": 15.005930256140294}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20410.79744744301, "sampler_perf": {"mean_inference_ms": 7.569471920776724, "mean_processing_ms": 11.14676648015864, "mean_env_wait_ms": 126.5560076457617}, "episodes_this_iter": 22, "episodes_total": 3945, "time_total_s": 20410.79744744301, "episode_reward_max": 405.62490651011467, "off_policy_estimator": {}, "episode_reward_min": 303.9907282318454, "episode_reward_mean": 354.46547074337616, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 109.6239824295044, "timestamp": 1559284777, "episode_len_mean": 325.0, "iterations_since_restore": 170, "training_iteration": 170, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4c80>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-39-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.125270599575, "cost1_mean": 176.15434117895524, "system_level_velocity_max": 16.84602214799984, "cost2_min": -81.23212592437662, "outflow_rate_min": 816.7252242905507, "system_level_velocity_min": 12.444773024175955, "cost2_max": -62.66840823775813, "cost1_max": 195.80431027077458, "cost2_mean": -73.11610183630707, "cost1_min": 145.5621214739127, "discrim_loss": 0.9417230486869812, "outflow_rate_mean": 940.9994171145888, "system_level_velocity_mean": 15.111959991982467}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20516.109408140182, "sampler_perf": {"mean_inference_ms": 7.563997782553436, "mean_processing_ms": 11.156653698353205, "mean_env_wait_ms": 126.36417420959677}, "episodes_this_iter": 23, "episodes_total": 3968, "time_total_s": 20516.109408140182, "episode_reward_max": 386.55824844539165, "off_policy_estimator": {}, "episode_reward_min": 256.56177873909473, "episode_reward_mean": 334.7689205859484, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.31196069717407, "timestamp": 1559284882, "episode_len_mean": 320.2173913043478, "iterations_since_restore": 171, "training_iteration": 171, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4e18>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-41-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.5531086154422, "cost1_mean": 169.464520510017, "system_level_velocity_max": 17.4460544042118, "cost2_min": -81.33239944497508, "outflow_rate_min": 776.2318194244879, "system_level_velocity_min": 11.891785149475744, "cost2_max": -62.18481146150326, "cost1_max": 196.95722851055262, "cost2_mean": -70.53754750408056, "cost1_min": 133.93967051767805, "discrim_loss": 0.9501654505729675, "outflow_rate_mean": 914.8671068336282, "system_level_velocity_mean": 14.810056519247157}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20623.368196487427, "sampler_perf": {"mean_inference_ms": 7.568899513648452, "mean_processing_ms": 11.15026212624908, "mean_env_wait_ms": 126.448206356638}, "episodes_this_iter": 26, "episodes_total": 3994, "time_total_s": 20623.368196487427, "episode_reward_max": 451.52235874533653, "off_policy_estimator": {}, "episode_reward_min": 262.4810952395201, "episode_reward_mean": 375.41003177301565, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.25878834724426, "timestamp": 1559284989, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 172, "training_iteration": 172, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375f28>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-43-09", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.0024559232484, "cost1_mean": 169.43628615972952, "system_level_velocity_max": 16.965458753536947, "cost2_min": -80.21441679941235, "outflow_rate_min": 806.5879361278518, "system_level_velocity_min": 12.287821310296785, "cost2_max": -62.7191951783975, "cost1_max": 195.45654010830947, "cost2_mean": -71.4613386552482, "cost1_min": 126.90172325997355, "discrim_loss": 0.9258111715316772, "outflow_rate_mean": 916.8775134630606, "system_level_velocity_mean": 14.814477936688613}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20729.14559483528, "sampler_perf": {"mean_inference_ms": 7.5694804703255, "mean_processing_ms": 11.149731937692426, "mean_env_wait_ms": 126.27880139387051}, "episodes_this_iter": 21, "episodes_total": 4015, "time_total_s": 20729.14559483528, "episode_reward_max": 468.72152199596167, "off_policy_estimator": {}, "episode_reward_min": 357.20012845192105, "episode_reward_mean": 405.6597341488426, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 105.77739834785461, "timestamp": 1559285095, "episode_len_mean": 325.0, "iterations_since_restore": 173, "training_iteration": 173, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303247b8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-44-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1012.8499436196252, "cost1_mean": 171.99965890373423, "system_level_velocity_max": 16.799714873907398, "cost2_min": -81.55397931818524, "outflow_rate_min": 774.3259349006073, "system_level_velocity_min": 11.877601297541128, "cost2_max": -62.96148806468694, "cost1_max": 195.47078290080154, "cost2_mean": -71.17484047409059, "cost1_min": 138.4931972518251, "discrim_loss": 0.9374610185623169, "outflow_rate_mean": 923.0788284726596, "system_level_velocity_mean": 14.780437451931707}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20832.698684215546, "sampler_perf": {"mean_inference_ms": 7.56159597754357, "mean_processing_ms": 11.158078465615437, "mean_env_wait_ms": 126.11005512333628}, "episodes_this_iter": 22, "episodes_total": 4037, "time_total_s": 20832.698684215546, "episode_reward_max": 448.38742273300886, "off_policy_estimator": {}, "episode_reward_min": 317.53128569899127, "episode_reward_mean": 391.8003518622982, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.55308938026428, "timestamp": 1559285199, "episode_len_mean": 325.0, "iterations_since_restore": 174, "training_iteration": 174, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a158>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034aa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-46-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1017.9410804629289, "cost1_mean": 175.13779391103043, "system_level_velocity_max": 17.061276493109993, "cost2_min": -80.77541423458975, "outflow_rate_min": 751.3457767734184, "system_level_velocity_min": 11.96395232234427, "cost2_max": -57.392174923104484, "cost1_max": 197.28224725788817, "cost2_mean": -73.24012184394233, "cost1_min": 138.0717692372626, "discrim_loss": 0.9406328201293945, "outflow_rate_mean": 934.2615709122879, "system_level_velocity_mean": 15.055476401678282}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20939.063547849655, "sampler_perf": {"mean_inference_ms": 7.570140296300751, "mean_processing_ms": 11.148840167263742, "mean_env_wait_ms": 126.15243202454658}, "episodes_this_iter": 25, "episodes_total": 4062, "time_total_s": 20939.063547849655, "episode_reward_max": 402.04345757048577, "off_policy_estimator": {}, "episode_reward_min": 274.04729706724174, "episode_reward_mean": 329.4569629249256, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.3648636341095, "timestamp": 1559285305, "episode_len_mean": 325.0, "iterations_since_restore": 175, "training_iteration": 175, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4510>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4b70>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-48-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.249253102445, "cost1_mean": 166.61527674998572, "system_level_velocity_max": 16.77821335852227, "cost2_min": -80.99110552027673, "outflow_rate_min": 798.6399485982836, "system_level_velocity_min": 12.108251839745932, "cost2_max": -62.09385453170885, "cost1_max": 194.65919407778622, "cost2_mean": -70.3869567461923, "cost1_min": 140.99974996709676, "discrim_loss": 0.9127272963523865, "outflow_rate_mean": 905.4069832757361, "system_level_velocity_mean": 14.350536214504425}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21040.474758148193, "sampler_perf": {"mean_inference_ms": 7.5592664359288095, "mean_processing_ms": 11.156089143793414, "mean_env_wait_ms": 125.92157415152413}, "episodes_this_iter": 24, "episodes_total": 4086, "time_total_s": 21040.474758148193, "episode_reward_max": 367.39224997907877, "off_policy_estimator": {}, "episode_reward_min": 260.4816343486309, "episode_reward_mean": 308.6620481003095, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 101.41121029853821, "timestamp": 1559285407, "episode_len_mean": 320.5, "iterations_since_restore": 176, "training_iteration": 176, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303659d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-50-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1015.2992103232311, "cost1_mean": 164.4356347640177, "system_level_velocity_max": 17.53111421888022, "cost2_min": -77.90901012197281, "outflow_rate_min": 801.7052685002093, "system_level_velocity_min": 12.13778232525584, "cost2_max": -62.44092785493958, "cost1_max": 196.27214284728635, "cost2_mean": -69.30186446092083, "cost1_min": 135.61141646597224, "discrim_loss": 0.9338717460632324, "outflow_rate_mean": 900.2200782016225, "system_level_velocity_mean": 14.429574595486548}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21141.913068532944, "sampler_perf": {"mean_inference_ms": 7.555528749458451, "mean_processing_ms": 11.153242707399986, "mean_env_wait_ms": 125.83532271826533}, "episodes_this_iter": 21, "episodes_total": 4107, "time_total_s": 21141.913068532944, "episode_reward_max": 416.5835266113281, "off_policy_estimator": {}, "episode_reward_min": 280.3077053865418, "episode_reward_mean": 353.72299328575, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 101.43831038475037, "timestamp": 1559285508, "episode_len_mean": 325.0, "iterations_since_restore": 177, "training_iteration": 177, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303248c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-51-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.0893972789879, "cost1_mean": 171.98979766034248, "system_level_velocity_max": 16.8431034922668, "cost2_min": -78.1504544966727, "outflow_rate_min": 774.4919027064117, "system_level_velocity_min": 11.979601736123245, "cost2_max": -62.40096044416964, "cost1_max": 194.9426727744352, "cost2_mean": -70.54704360592912, "cost1_min": 139.2149534376954, "discrim_loss": 0.8877184391021729, "outflow_rate_mean": 923.9640077335694, "system_level_velocity_mean": 14.835675725178598}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21243.46977710724, "sampler_perf": {"mean_inference_ms": 7.563590302633328, "mean_processing_ms": 11.146160892480829, "mean_env_wait_ms": 125.81517423635376}, "episodes_this_iter": 25, "episodes_total": 4132, "time_total_s": 21243.46977710724, "episode_reward_max": 447.6721651405096, "off_policy_estimator": {}, "episode_reward_min": 342.9572183396667, "episode_reward_mean": 383.0624695749674, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 101.55670857429504, "timestamp": 1559285610, "episode_len_mean": 325.0, "iterations_since_restore": 178, "training_iteration": 178, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c29d8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-53-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.971386625837, "cost1_mean": 167.30327633207267, "system_level_velocity_max": 16.81467357873754, "cost2_min": -77.03432017524864, "outflow_rate_min": 781.7658198993048, "system_level_velocity_min": 12.466964623681605, "cost2_max": -59.26931353178707, "cost1_max": 194.2756922229426, "cost2_mean": -68.2801598689819, "cost1_min": 144.65504097398934, "discrim_loss": 0.9023433923721313, "outflow_rate_mean": 906.0286473252245, "system_level_velocity_mean": 14.461126109323818}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21353.535108089447, "sampler_perf": {"mean_inference_ms": 7.557755398086645, "mean_processing_ms": 11.156549298339689, "mean_env_wait_ms": 125.6575247744452}, "episodes_this_iter": 24, "episodes_total": 4156, "time_total_s": 21353.535108089447, "episode_reward_max": 457.4090964347124, "off_policy_estimator": {}, "episode_reward_min": 332.87034593336284, "episode_reward_mean": 390.1865133253353, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 110.06533098220825, "timestamp": 1559285723, "episode_len_mean": 325.0, "iterations_since_restore": 179, "training_iteration": 179, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c26a8>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-55-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1013.6519539516038, "cost1_mean": 169.86393508044617, "system_level_velocity_max": 16.875310988521043, "cost2_min": -78.27503567949705, "outflow_rate_min": 736.6028000859145, "system_level_velocity_min": 11.6991983516176, "cost2_max": -62.067893429196275, "cost1_max": 195.36106958863945, "cost2_mean": -69.99046505407267, "cost1_min": 134.2974278614116, "discrim_loss": 0.9076284170150757, "outflow_rate_mean": 916.2950811332998, "system_level_velocity_mean": 14.658238810893577}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21455.05284333229, "sampler_perf": {"mean_inference_ms": 7.558409508127225, "mean_processing_ms": 11.14523468388025, "mean_env_wait_ms": 125.59578692186945}, "episodes_this_iter": 20, "episodes_total": 4176, "time_total_s": 21455.05284333229, "episode_reward_max": 419.9279317604378, "off_policy_estimator": {}, "episode_reward_min": 296.8927124608308, "episode_reward_mean": 349.1062001413782, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 101.51773524284363, "timestamp": 1559285824, "episode_len_mean": 325.0, "iterations_since_restore": 180, "training_iteration": 180, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324620>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-57-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4948009185093, "cost1_mean": 168.87571923743727, "system_level_velocity_max": 16.641091591847715, "cost2_min": -79.13914314635095, "outflow_rate_min": 788.0084791884985, "system_level_velocity_min": 12.505955011774743, "cost2_max": -61.26931508537646, "cost1_max": 192.40184652888908, "cost2_mean": -69.37001889179469, "cost1_min": 144.18353961354967, "discrim_loss": 0.8743607997894287, "outflow_rate_mean": 914.5927633438845, "system_level_velocity_mean": 14.582128460278943}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21558.24104475975, "sampler_perf": {"mean_inference_ms": 7.554570132858447, "mean_processing_ms": 11.152985098032648, "mean_env_wait_ms": 125.53774741860182}, "episodes_this_iter": 25, "episodes_total": 4201, "time_total_s": 21558.24104475975, "episode_reward_max": 376.851452447474, "off_policy_estimator": {}, "episode_reward_min": 233.4716104194522, "episode_reward_mean": 320.4416262123268, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.18820142745972, "timestamp": 1559285927, "episode_len_mean": 320.28, "iterations_since_restore": 181, "training_iteration": 181, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-58-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.8070538871847, "cost1_mean": 169.69407139279437, "system_level_velocity_max": 16.842136042270884, "cost2_min": -79.0116398978748, "outflow_rate_min": 843.2086294399463, "system_level_velocity_min": 13.153129038443895, "cost2_max": -61.14921276298419, "cost1_max": 193.2630444020253, "cost2_mean": -69.37774981302691, "cost1_min": 125.45058891619652, "discrim_loss": 0.8941659927368164, "outflow_rate_mean": 921.5031259403662, "system_level_velocity_mean": 14.909420909016484}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21658.99719142914, "sampler_perf": {"mean_inference_ms": 7.555901911014849, "mean_processing_ms": 11.153304464404494, "mean_env_wait_ms": 125.32404469480105}, "episodes_this_iter": 24, "episodes_total": 4225, "time_total_s": 21658.99719142914, "episode_reward_max": 369.12313210964203, "off_policy_estimator": {}, "episode_reward_min": 280.65221969317645, "episode_reward_mean": 325.0979862735646, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 100.75614666938782, "timestamp": 1559286028, "episode_len_mean": 325.0, "iterations_since_restore": 182, "training_iteration": 182, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1400>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c10d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-00-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1007.1086834622207, "cost1_mean": 167.15685353491196, "system_level_velocity_max": 16.626719666569947, "cost2_min": -76.7907197480396, "outflow_rate_min": 802.2811174705632, "system_level_velocity_min": 12.329484226604478, "cost2_max": -61.50449445839877, "cost1_max": 192.0141013632607, "cost2_mean": -68.10496307685636, "cost1_min": 142.7258190239593, "discrim_loss": 0.8713550567626953, "outflow_rate_mean": 906.7005941245761, "system_level_velocity_mean": 14.464752795360445}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21765.260191440582, "sampler_perf": {"mean_inference_ms": 7.553913184519673, "mean_processing_ms": 11.151957962094757, "mean_env_wait_ms": 125.29414275925245}, "episodes_this_iter": 22, "episodes_total": 4247, "time_total_s": 21765.260191440582, "episode_reward_max": 396.8946725875139, "off_policy_estimator": {}, "episode_reward_min": 299.4619172574021, "episode_reward_mean": 349.59665466433347, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.26300001144409, "timestamp": 1559286135, "episode_len_mean": 325.0, "iterations_since_restore": 183, "training_iteration": 183, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c3268>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c31e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c3158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c30d0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-02-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.6796411643693, "cost1_mean": 173.15347570769597, "system_level_velocity_max": 16.805141402201805, "cost2_min": -77.19632587732737, "outflow_rate_min": 802.0477413267699, "system_level_velocity_min": 12.15464564381099, "cost2_max": -61.61685094579923, "cost1_max": 194.5760459773171, "cost2_mean": -70.83899653462647, "cost1_min": 141.03279687467102, "discrim_loss": 0.8905888795852661, "outflow_rate_mean": 930.8966973983632, "system_level_velocity_mean": 14.930190637935366}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21868.915108919144, "sampler_perf": {"mean_inference_ms": 7.55519635973538, "mean_processing_ms": 11.143411969628035, "mean_env_wait_ms": 125.1986216057682}, "episodes_this_iter": 21, "episodes_total": 4268, "time_total_s": 21868.915108919144, "episode_reward_max": 388.9383483454585, "off_policy_estimator": {}, "episode_reward_min": 312.1515538105741, "episode_reward_mean": 340.80212108419454, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 103.6549174785614, "timestamp": 1559286238, "episode_len_mean": 325.0, "iterations_since_restore": 184, "training_iteration": 184, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d90>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365840>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-03-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.1351580546742, "cost1_mean": 159.25574163701236, "system_level_velocity_max": 16.636997841541195, "cost2_min": -77.72083095097025, "outflow_rate_min": 766.6899838198708, "system_level_velocity_min": 12.008011244731243, "cost2_max": -58.80056021509514, "cost1_max": 192.48332041319628, "cost2_mean": -67.79026252309487, "cost1_min": 137.02396818346404, "discrim_loss": 0.8787226676940918, "outflow_rate_mean": 873.8010931734118, "system_level_velocity_mean": 13.81052034546991}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21971.872729063034, "sampler_perf": {"mean_inference_ms": 7.554882589755854, "mean_processing_ms": 11.14699324564644, "mean_env_wait_ms": 125.19569983568678}, "episodes_this_iter": 26, "episodes_total": 4294, "time_total_s": 21971.872729063034, "episode_reward_max": 392.73434110730886, "off_policy_estimator": {}, "episode_reward_min": 299.20845998846926, "episode_reward_mean": 345.8269440826351, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 102.95762014389038, "timestamp": 1559286341, "episode_len_mean": 325.0, "iterations_since_restore": 185, "training_iteration": 185, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be2f0>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-05-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.0067746322945, "cost1_mean": 165.4784317422442, "system_level_velocity_max": 16.835322324437602, "cost2_min": -77.7201467806236, "outflow_rate_min": 725.1675229168844, "system_level_velocity_min": 11.103152071657505, "cost2_max": -61.44698943782202, "cost1_max": 194.52157532498063, "cost2_mean": -68.9141561270554, "cost1_min": 126.13246532236057, "discrim_loss": 0.871234118938446, "outflow_rate_mean": 896.8448427856723, "system_level_velocity_mean": 14.324480939898981}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22078.89252614975, "sampler_perf": {"mean_inference_ms": 7.548849297785321, "mean_processing_ms": 11.170303188229388, "mean_env_wait_ms": 124.95901981244951}, "episodes_this_iter": 25, "episodes_total": 4319, "time_total_s": 22078.89252614975, "episode_reward_max": 398.74573021382093, "off_policy_estimator": {}, "episode_reward_min": 44.211420327425, "episode_reward_mean": 325.1558744593151, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 107.0197970867157, "timestamp": 1559286448, "episode_len_mean": 297.16, "iterations_since_restore": 186, "training_iteration": 186, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2b70>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c21e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c20d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2158>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-07-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.4039771225027, "cost1_mean": 156.32872803299637, "system_level_velocity_max": 17.7799625977275, "cost2_min": -79.19131900654439, "outflow_rate_min": 432.89918915288416, "system_level_velocity_min": 12.273993167350959, "cost2_max": -21.204045988967703, "cost1_max": 193.95764736141234, "cost2_mean": -66.40541876202415, "cost1_min": 17.88112767985278, "discrim_loss": 0.8939414024353027, "outflow_rate_mean": 869.8001944909664, "system_level_velocity_mean": 14.985797528408316}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22185.694484233856, "sampler_perf": {"mean_inference_ms": 7.557124195239647, "mean_processing_ms": 11.147768679827923, "mean_env_wait_ms": 124.95571845860124}, "episodes_this_iter": 21, "episodes_total": 4340, "time_total_s": 22185.694484233856, "episode_reward_max": 405.3273115977645, "off_policy_estimator": {}, "episode_reward_min": 300.1823866625782, "episode_reward_mean": 353.0807541299035, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 106.80195808410645, "timestamp": 1559286555, "episode_len_mean": 325.0, "iterations_since_restore": 187, "training_iteration": 187, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b9488>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b9400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b92f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b9378>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-09-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.6199694800946, "cost1_mean": 165.65882757965545, "system_level_velocity_max": 16.74206116021089, "cost2_min": -79.48118845816515, "outflow_rate_min": 774.9238411943577, "system_level_velocity_min": 12.258499506101407, "cost2_max": -59.5011409906314, "cost1_max": 193.95693764559402, "cost2_mean": -68.93829771576932, "cost1_min": 140.99428661582328, "discrim_loss": 0.8558794856071472, "outflow_rate_mean": 896.9320449693987, "system_level_velocity_mean": 14.344607919396882}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22289.812692403793, "sampler_perf": {"mean_inference_ms": 7.551895610357346, "mean_processing_ms": 11.15038244110979, "mean_env_wait_ms": 124.92985269105036}, "episodes_this_iter": 24, "episodes_total": 4364, "time_total_s": 22289.812692403793, "episode_reward_max": 382.43011570721865, "off_policy_estimator": {}, "episode_reward_min": 310.4401014535688, "episode_reward_mean": 343.5482825183911, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.11820816993713, "timestamp": 1559286659, "episode_len_mean": 325.0, "iterations_since_restore": 188, "training_iteration": 188, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324598>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-10-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.1216105362911, "cost1_mean": 166.37887679558636, "system_level_velocity_max": 16.802075714007213, "cost2_min": -76.68991729114231, "outflow_rate_min": 816.0347516799272, "system_level_velocity_min": 12.734328526035656, "cost2_max": -62.43204472635343, "cost1_max": 194.08792585073996, "cost2_mean": -68.81624657295247, "cost1_min": 147.786033771178, "discrim_loss": 0.864513635635376, "outflow_rate_mean": 903.23703419828, "system_level_velocity_mean": 14.403010242249927}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22382.510632038116, "sampler_perf": {"mean_inference_ms": 7.539616663419245, "mean_processing_ms": 11.157334299286196, "mean_env_wait_ms": 124.64164878662541}, "episodes_this_iter": 25, "episodes_total": 4389, "time_total_s": 22382.510632038116, "episode_reward_max": 381.6058468322735, "off_policy_estimator": {}, "episode_reward_min": 45.59616297483444, "episode_reward_mean": 328.89111108947543, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 92.69793963432312, "timestamp": 1559286752, "episode_len_mean": 313.4, "iterations_since_restore": 189, "training_iteration": 189, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-12-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4127747236167, "cost1_mean": 164.62533514808248, "system_level_velocity_max": 18.656085796555125, "cost2_min": -77.71818776465291, "outflow_rate_min": 494.02018216404343, "system_level_velocity_min": 11.848087263608534, "cost2_max": -21.982591584291118, "cost1_max": 193.61462462373254, "cost2_mean": -67.70987774499699, "cost1_min": 23.111629311947826, "discrim_loss": 0.8667383193969727, "outflow_rate_mean": 902.5883552945837, "system_level_velocity_mean": 14.933714989764017}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22486.827672719955, "sampler_perf": {"mean_inference_ms": 7.546428539092161, "mean_processing_ms": 11.15087447185738, "mean_env_wait_ms": 124.59005378830062}, "episodes_this_iter": 22, "episodes_total": 4411, "time_total_s": 22486.827672719955, "episode_reward_max": 362.877285733819, "off_policy_estimator": {}, "episode_reward_min": 287.2997131505981, "episode_reward_mean": 328.97183969046455, "timesteps_total": null, "experiment_id": "e743644fe059417f89798ecfd1762c5a", "done": false, "time_this_iter_s": 104.31704068183899, "timestamp": 1559286857, "episode_len_mean": 325.0, "iterations_since_restore": 190, "training_iteration": 190, "node_ip": "10.138.0.2", "pid": 7170, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "grad_clip": null, "horizon": 750, "num_cpus_for_driver": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c19d8>)", "policies_to_train": ["default_policy"]}, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "straggler_mitigation": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "discrim_lr": 0.005, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_train_result": null}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-14-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1010.024938250885, "cost1_mean": 170.2203004169211, "system_level_velocity_max": 16.750022752164686, "cost2_min": -76.91382297675113, "outflow_rate_min": 754.7529151834028, "system_level_velocity_min": 12.058351566921374, "cost2_max": -55.845616402311656, "cost1_max": 193.45089883540925, "cost2_mean": -70.24090939716835, "cost1_min": 137.80668935752868, "discrim_loss": 0.8671213388442993, "outflow_rate_mean": 918.4609364393752, "system_level_velocity_mean": 14.736276056179982}}

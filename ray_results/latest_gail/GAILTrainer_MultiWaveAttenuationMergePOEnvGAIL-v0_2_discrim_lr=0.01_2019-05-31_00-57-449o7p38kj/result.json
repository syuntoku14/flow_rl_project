{"sampler_perf": {"mean_inference_ms": 7.955745977663327, "mean_processing_ms": 9.895121400429312, "mean_env_wait_ms": 129.0164698614738}, "policy_reward_mean": {}, "time_since_restore": 144.81464076042175, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 20, "time_total_s": 144.81464076042175, "episode_reward_max": 751.8351365327835, "episode_reward_mean": 612.9604719132185, "episode_reward_min": 349.5925667285919, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 144.81464076042175, "timestamp": 1559264427, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 1, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303752f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375268>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-00-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 822.9421665521071, "outflow_rate_min": 576.4951741803521, "system_level_velocity_max": 11.64612882812667, "cost2_min": -63.190309689650185, "system_level_velocity_min": 8.927417548040378, "cost1_min": 107.88532916605374, "cost1_max": 141.62013967810682, "cost2_mean": -44.85054846556928, "discrim_loss": 1.38569974899292, "cost1_mean": 123.32807512306734, "outflow_rate_mean": 717.3573692935572, "system_level_velocity_mean": 10.274334905780005, "cost2_max": -30.221744961304697}}
{"sampler_perf": {"mean_inference_ms": 7.845382893744665, "mean_processing_ms": 10.111797785139498, "mean_env_wait_ms": 129.4789002149761}, "policy_reward_mean": {}, "time_since_restore": 260.1330862045288, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 40, "time_total_s": 260.1330862045288, "episode_reward_max": 753.4811433553696, "episode_reward_mean": 630.4916195631027, "episode_reward_min": 520.6865083575249, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.31844544410706, "timestamp": 1559264548, "episode_len_mean": 325.0, "iterations_since_restore": 2, "training_iteration": 2, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c39d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425268>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-02-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 818.4219596820321, "outflow_rate_min": 556.5312827800004, "system_level_velocity_max": 11.761745213997282, "cost2_min": -63.70893590673218, "system_level_velocity_min": 8.053074337780242, "cost1_min": 99.94124877205402, "cost1_max": 140.94761030619466, "cost2_mean": -41.83975275922855, "discrim_loss": 1.3259221315383911, "cost1_mean": 119.62565587089769, "outflow_rate_mean": 712.1489772919828, "system_level_velocity_mean": 9.940902873439528, "cost2_max": -23.19085125561499}}
{"sampler_perf": {"mean_inference_ms": 7.784221205166952, "mean_processing_ms": 10.022123915944722, "mean_env_wait_ms": 126.5848105137002}, "policy_reward_mean": {}, "time_since_restore": 370.9648792743683, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 60, "time_total_s": 370.9648792743683, "episode_reward_max": 671.4854775965214, "episode_reward_mean": 526.614337324351, "episode_reward_min": 363.8771835267544, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 110.83179306983948, "timestamp": 1559264662, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 3, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79306d3f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b378>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-04-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 763.8831991791155, "outflow_rate_min": 651.7975758811277, "system_level_velocity_max": 11.737241026983913, "cost2_min": -60.80511364083091, "system_level_velocity_min": 8.443828633960788, "cost1_min": 98.973115897895, "cost1_max": 142.83359548744204, "cost2_mean": -39.02587181448098, "discrim_loss": 1.2043594121932983, "cost1_mean": 119.67657822328545, "outflow_rate_mean": 709.3589363335537, "system_level_velocity_mean": 10.011547943690688, "cost2_max": -25.81177647135833}}
{"sampler_perf": {"mean_inference_ms": 7.729833819634994, "mean_processing_ms": 10.966443260506063, "mean_env_wait_ms": 124.72205327040525}, "policy_reward_mean": {}, "time_since_restore": 484.2892892360687, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 31, "episodes_total": 91, "time_total_s": 484.2892892360687, "episode_reward_max": 593.5812164098024, "episode_reward_mean": 439.2638009700083, "episode_reward_min": 58.09410680830479, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.32440996170044, "timestamp": 1559264781, "episode_len_mean": 315.64516129032256, "iterations_since_restore": 4, "training_iteration": 4, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033a158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033a2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033a268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033a1e0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-06-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 769.5859420538224, "outflow_rate_min": 504.5827016154056, "system_level_velocity_max": 18.216463264945837, "cost2_min": -53.22034429053763, "system_level_velocity_min": 8.257020859304932, "cost1_min": 22.58595558542369, "cost1_max": 139.2765059287554, "cost2_mean": -38.159394056583615, "discrim_loss": 1.1135469675064087, "cost1_mean": 117.21762162795525, "outflow_rate_mean": 707.7774497303113, "system_level_velocity_mean": 10.339452582236882, "cost2_max": -20.27630065487213}}
{"sampler_perf": {"mean_inference_ms": 7.733039791124466, "mean_processing_ms": 10.658176782384805, "mean_env_wait_ms": 125.65037614343899}, "policy_reward_mean": {}, "time_since_restore": 600.8885991573334, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 111, "time_total_s": 600.8885991573334, "episode_reward_max": 701.5780744403601, "episode_reward_mean": 533.1659081127494, "episode_reward_min": 334.96480199694633, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.59930992126465, "timestamp": 1559264899, "episode_len_mean": 325.0, "iterations_since_restore": 5, "training_iteration": 5, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033e268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033e158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033e0d0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-08-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 867.2824452199586, "outflow_rate_min": 716.3534575993413, "system_level_velocity_max": 12.928084141823913, "cost2_min": -73.61488620977869, "system_level_velocity_min": 10.355947287844755, "cost1_min": 125.22148253853638, "cost1_max": 157.53661101572825, "cost2_mean": -50.970622812740956, "discrim_loss": 1.083615779876709, "cost1_mean": 134.40004731130986, "outflow_rate_mean": 767.5124990367865, "system_level_velocity_mean": 11.187981528372228, "cost2_max": -31.26700802409113}}
{"sampler_perf": {"mean_inference_ms": 7.73511845597795, "mean_processing_ms": 10.496794226645786, "mean_env_wait_ms": 127.53071909982664}, "policy_reward_mean": {}, "time_since_restore": 733.4452564716339, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 131, "time_total_s": 733.4452564716339, "episode_reward_max": 1001.7707042209804, "episode_reward_mean": 662.7683358741924, "episode_reward_min": 415.59699200466275, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.55665731430054, "timestamp": 1559265032, "episode_len_mean": 325.0, "iterations_since_restore": 6, "training_iteration": 6, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c32f0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-10-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.9963426691036, "outflow_rate_min": 710.2119013279811, "system_level_velocity_max": 15.460437095878467, "cost2_min": -106.68460536501834, "system_level_velocity_min": 10.678588522884503, "cost1_min": 127.17013647315842, "cost1_max": 187.42505680448062, "cost2_mean": -72.01861789474637, "discrim_loss": 1.3099915981292725, "cost1_mean": 153.7785386290441, "outflow_rate_mean": 824.5091775599991, "system_level_velocity_mean": 12.713537262983012, "cost2_max": -40.978018880931714}}
{"sampler_perf": {"mean_inference_ms": 7.729372053220006, "mean_processing_ms": 10.963857697168933, "mean_env_wait_ms": 128.21676843434284}, "policy_reward_mean": {}, "time_since_restore": 859.0813293457031, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 31, "episodes_total": 162, "time_total_s": 859.0813293457031, "episode_reward_max": 1140.651335310191, "episode_reward_mean": 893.3068180369634, "episode_reward_min": 102.65861117094755, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.63607287406921, "timestamp": 1559265157, "episode_len_mean": 315.38709677419354, "iterations_since_restore": 7, "training_iteration": 7, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039b598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b620>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-12-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1024.8561554968278, "outflow_rate_min": 444.6769763958757, "system_level_velocity_max": 17.67161520676849, "cost2_min": -123.69409307266022, "system_level_velocity_min": 11.803581693133347, "cost1_min": 18.0715488687714, "cost1_max": 208.77749769012064, "cost2_mean": -96.24850482058875, "discrim_loss": 1.6997408866882324, "cost1_mean": 177.733799493078, "outflow_rate_mean": 924.7154184598243, "system_level_velocity_mean": 15.199208969154897, "cost2_max": -20.836611430171555}}
{"sampler_perf": {"mean_inference_ms": 7.656176061237718, "mean_processing_ms": 10.895421321819951, "mean_env_wait_ms": 127.99601815895446}, "policy_reward_mean": {}, "time_since_restore": 988.8225665092468, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 182, "time_total_s": 988.8225665092468, "episode_reward_max": 936.582384057343, "episode_reward_mean": 840.3166238449514, "episode_reward_min": 787.7349348217249, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.7412371635437, "timestamp": 1559265287, "episode_len_mean": 325.0, "iterations_since_restore": 8, "training_iteration": 8, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303a4510>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303a4488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303a4400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303a4378>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-14-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1074.3369278870912, "outflow_rate_min": 825.5005117852405, "system_level_velocity_max": 18.274730049606692, "cost2_min": -135.76661895590075, "system_level_velocity_min": 12.759592428182295, "cost1_min": 150.0085481846084, "cost1_max": 217.9449746956262, "cost2_mean": -115.25482916777301, "discrim_loss": 1.7513034343719482, "cost1_mean": 185.163642986767, "outflow_rate_mean": 958.0000785663262, "system_level_velocity_mean": 15.484105505786596, "cost2_max": -103.16309785010517}}
{"sampler_perf": {"mean_inference_ms": 7.640626503144796, "mean_processing_ms": 10.824755445584033, "mean_env_wait_ms": 128.42360136559745}, "policy_reward_mean": {}, "time_since_restore": 1115.2362086772919, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 203, "time_total_s": 1115.2362086772919, "episode_reward_max": 821.3870545327663, "episode_reward_mean": 751.1251601912081, "episode_reward_min": 305.42269621789455, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.41364216804504, "timestamp": 1559265414, "episode_len_mean": 315.4761904761905, "iterations_since_restore": 9, "training_iteration": 9, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303756a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-16-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.2962014490465, "outflow_rate_min": 750.7017592647998, "system_level_velocity_max": 19.031221183548205, "cost2_min": -145.73540869030137, "system_level_velocity_min": 12.430219342488355, "cost1_min": 85.43642873445837, "cost1_max": 220.3394370154255, "cost2_mean": -121.29154687254463, "discrim_loss": 1.7085870504379272, "cost1_mean": 187.6590477988813, "outflow_rate_mean": 972.4254807563304, "system_level_velocity_mean": 16.262014618014387, "cost2_max": -62.78804292587563}}
{"sampler_perf": {"mean_inference_ms": 7.629245807320891, "mean_processing_ms": 10.88954181516032, "mean_env_wait_ms": 130.30761423560048}, "policy_reward_mean": {}, "time_since_restore": 1255.2251658439636, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 230, "time_total_s": 1255.2251658439636, "episode_reward_max": 761.3224711418152, "episode_reward_mean": 701.3335225005393, "episode_reward_min": 636.172484472394, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 139.98895716667175, "timestamp": 1559265554, "episode_len_mean": 325.0, "iterations_since_restore": 10, "training_iteration": 10, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303408c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303407b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340840>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-19-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1078.5738932668382, "outflow_rate_min": 772.1362142589433, "system_level_velocity_max": 18.574378365287878, "cost2_min": -157.28847844168092, "system_level_velocity_min": 11.675054303301152, "cost1_min": 137.1680524921388, "cost1_max": 222.348426891011, "cost2_mean": -132.76042006716128, "discrim_loss": 1.3948242664337158, "cost1_mean": 173.07902874995068, "outflow_rate_mean": 924.5036449983359, "system_level_velocity_mean": 14.60718796033644, "cost2_max": -110.3181609051766}}
{"sampler_perf": {"mean_inference_ms": 7.596598343497586, "mean_processing_ms": 10.945298107087494, "mean_env_wait_ms": 129.96195259450437}, "policy_reward_mean": {}, "time_since_restore": 1381.2184879779816, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 253, "time_total_s": 1381.2184879779816, "episode_reward_max": 716.6768092215061, "episode_reward_mean": 686.9051320546347, "episode_reward_min": 657.8518843054771, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.99332213401794, "timestamp": 1559265680, "episode_len_mean": 325.0, "iterations_since_restore": 11, "training_iteration": 11, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340d90>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-21-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1089.2763425980734, "outflow_rate_min": 856.566599397606, "system_level_velocity_max": 18.776552209495087, "cost2_min": -147.41295257354517, "system_level_velocity_min": 12.994739632894099, "cost1_min": 154.70813830404637, "cost1_max": 223.73279027837137, "cost2_mean": -131.37966832185725, "discrim_loss": 1.37471342086792, "cost1_mean": 188.6240432358527, "outflow_rate_mean": 975.0474181539855, "system_level_velocity_mean": 15.854065269802778, "cost2_max": -115.53255853985698}}
{"sampler_perf": {"mean_inference_ms": 7.584037193787417, "mean_processing_ms": 10.84496924088089, "mean_env_wait_ms": 130.85474592621443}, "policy_reward_mean": {}, "time_since_restore": 1517.8010878562927, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 273, "time_total_s": 1517.8010878562927, "episode_reward_max": 671.6914063170552, "episode_reward_mean": 640.2308509234339, "episode_reward_min": 614.2290794849396, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.58259987831116, "timestamp": 1559265816, "episode_len_mean": 324.15, "iterations_since_restore": 12, "training_iteration": 12, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930344400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930344378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303442f0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-23-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1088.288026420454, "outflow_rate_min": 836.4083163491027, "system_level_velocity_max": 18.823947841493446, "cost2_min": -150.26663672034326, "system_level_velocity_min": 12.591372903176316, "cost1_min": 149.21728165772066, "cost1_max": 224.34715860732388, "cost2_mean": -132.24990863276165, "discrim_loss": 1.2929099798202515, "cost1_mean": 178.3361870527986, "outflow_rate_mean": 941.7231549379512, "system_level_velocity_mean": 15.077160149546714, "cost2_max": -112.51656241857427}}
{"sampler_perf": {"mean_inference_ms": 7.589016451264555, "mean_processing_ms": 10.929866616928962, "mean_env_wait_ms": 132.01705142827626}, "policy_reward_mean": {}, "time_since_restore": 1660.6921439170837, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 300, "time_total_s": 1660.6921439170837, "episode_reward_max": 684.4937620460987, "episode_reward_mean": 640.9285228401423, "episode_reward_min": 566.2325040996075, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.89105606079102, "timestamp": 1559265959, "episode_len_mean": 325.0, "iterations_since_restore": 13, "training_iteration": 13, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303756a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-25-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.0723953170148, "outflow_rate_min": 815.9245891989445, "system_level_velocity_max": 18.87803123428492, "cost2_min": -157.25028471579844, "system_level_velocity_min": 12.251526833673996, "cost1_min": 144.74131750236168, "cost1_max": 225.0536658514353, "cost2_mean": -130.43832153879254, "discrim_loss": 1.2854363918304443, "cost1_mean": 178.8124038889051, "outflow_rate_mean": 939.9621766211962, "system_level_velocity_mean": 15.048894786723892, "cost2_max": -113.1164951474568}}
{"sampler_perf": {"mean_inference_ms": 7.5827634442706096, "mean_processing_ms": 10.951970632952564, "mean_env_wait_ms": 132.28683354939744}, "policy_reward_mean": {}, "time_since_restore": 1789.1283655166626, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 323, "time_total_s": 1789.1283655166626, "episode_reward_max": 794.5870668813586, "episode_reward_mean": 658.4402192212317, "episode_reward_min": 65.77108898758888, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.43622159957886, "timestamp": 1559266088, "episode_len_mean": 311.60869565217394, "iterations_since_restore": 14, "training_iteration": 14, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340bf8>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-28-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.120885293916, "outflow_rate_min": 513.1510694623687, "system_level_velocity_max": 18.84406297962731, "cost2_min": -147.39912176783, "system_level_velocity_min": 11.776282968994217, "cost1_min": 23.029892014381705, "cost1_max": 222.18978966595557, "cost2_mean": -122.68355915355441, "discrim_loss": 1.3382223844528198, "cost1_mean": 178.58083761734267, "outflow_rate_mean": 945.4755808216249, "system_level_velocity_mean": 15.793612133446787, "cost2_max": -23.103279572001593}}
{"sampler_perf": {"mean_inference_ms": 7.596312872917102, "mean_processing_ms": 10.882353386182555, "mean_env_wait_ms": 132.42033428626758}, "policy_reward_mean": {}, "time_since_restore": 1922.4019892215729, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 344, "time_total_s": 1922.4019892215729, "episode_reward_max": 876.3299031108618, "episode_reward_mean": 730.615281638645, "episode_reward_min": 411.5987214297056, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.27362370491028, "timestamp": 1559266221, "episode_len_mean": 320.0, "iterations_since_restore": 15, "training_iteration": 15, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303756a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375510>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-30-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.5724858334556, "outflow_rate_min": 876.9717471845748, "system_level_velocity_max": 18.82779809118877, "cost2_min": -145.76781525831092, "system_level_velocity_min": 13.499747321505096, "cost1_min": 150.88724531559518, "cost1_max": 219.1512167835873, "cost2_mean": -120.42845111125945, "discrim_loss": 1.3769699335098267, "cost1_mean": 184.0422900617856, "outflow_rate_mean": 962.8032351040276, "system_level_velocity_mean": 15.741617490042879, "cost2_max": -89.95428644528303}}
{"sampler_perf": {"mean_inference_ms": 7.589581096723534, "mean_processing_ms": 10.86246674567731, "mean_env_wait_ms": 133.5324880066182}, "policy_reward_mean": {}, "time_since_restore": 2059.8998415470123, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 365, "time_total_s": 2059.8998415470123, "episode_reward_max": 970.9410707503557, "episode_reward_mean": 808.4189807375272, "episode_reward_min": 612.345866844058, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.49785232543945, "timestamp": 1559266359, "episode_len_mean": 325.0, "iterations_since_restore": 16, "training_iteration": 16, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362488>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-32-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.8605811498646, "outflow_rate_min": 761.8593364779282, "system_level_velocity_max": 18.175246587213454, "cost2_min": -148.2808506790522, "system_level_velocity_min": 11.404696917071776, "cost1_min": 135.77620003796278, "cost1_max": 217.45932875729653, "cost2_mean": -124.20809731057034, "discrim_loss": 1.3881793022155762, "cost1_mean": 173.14873642872593, "outflow_rate_mean": 917.665836576175, "system_level_velocity_mean": 14.501033584081531, "cost2_max": -106.36497346861222}}
{"sampler_perf": {"mean_inference_ms": 7.603976707956456, "mean_processing_ms": 10.975887977495265, "mean_env_wait_ms": 133.85259321717842}, "policy_reward_mean": {}, "time_since_restore": 2190.064407348633, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 29, "episodes_total": 394, "time_total_s": 2190.064407348633, "episode_reward_max": 887.3186939507723, "episode_reward_mean": 722.7578988851144, "episode_reward_min": 214.78002020716667, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.16456580162048, "timestamp": 1559266489, "episode_len_mean": 318.1034482758621, "iterations_since_restore": 17, "training_iteration": 17, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340ea0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930340f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3c80>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-34-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1073.7313838799985, "outflow_rate_min": 710.8524294835497, "system_level_velocity_max": 18.15022429746277, "cost2_min": -137.48955985587742, "system_level_velocity_min": 12.693616710727474, "cost1_min": 83.1229703999402, "cost1_max": 217.5927315994466, "cost2_mean": -116.03904845992565, "discrim_loss": 1.3874151706695557, "cost1_mean": 181.10603899426687, "outflow_rate_mean": 942.2737522417866, "system_level_velocity_mean": 15.390659290753305, "cost2_max": -61.83849380683368}}
{"sampler_perf": {"mean_inference_ms": 7.615666267262784, "mean_processing_ms": 10.946728114631119, "mean_env_wait_ms": 134.25953280315625}, "policy_reward_mean": {}, "time_since_restore": 2320.3776597976685, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 414, "time_total_s": 2320.3776597976685, "episode_reward_max": 933.5394634604454, "episode_reward_mean": 716.5690663725138, "episode_reward_min": 579.3652608394623, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.31325244903564, "timestamp": 1559266620, "episode_len_mean": 325.0, "iterations_since_restore": 18, "training_iteration": 18, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e9d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e8c8>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-37-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1033.5122461242704, "outflow_rate_min": 741.2754439386407, "system_level_velocity_max": 17.125270855969866, "cost2_min": -128.55688595009883, "system_level_velocity_min": 11.298193874938322, "cost1_min": 135.5474213879731, "cost1_max": 206.57931708752233, "cost2_mean": -111.96906323301963, "discrim_loss": 1.367391586303711, "cost1_mean": 175.0283903683769, "outflow_rate_mean": 907.8879729971379, "system_level_velocity_mean": 14.405499825822522, "cost2_max": -100.06807196311644}}
{"sampler_perf": {"mean_inference_ms": 7.604882855398038, "mean_processing_ms": 10.959294003212207, "mean_env_wait_ms": 134.01284258047198}, "policy_reward_mean": {}, "time_since_restore": 2444.8857362270355, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 436, "time_total_s": 2444.8857362270355, "episode_reward_max": 805.4129929542542, "episode_reward_mean": 627.4848013208671, "episode_reward_min": 577.29587495327, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.50807642936707, "timestamp": 1559266745, "episode_len_mean": 325.0, "iterations_since_restore": 19, "training_iteration": 19, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e730>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-39-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.6723075016122, "outflow_rate_min": 811.1198967446882, "system_level_velocity_max": 16.12116431212994, "cost2_min": -118.34245979092475, "system_level_velocity_min": 12.539224511452812, "cost1_min": 152.5062946716137, "cost1_max": 197.8446915264307, "cost2_mean": -106.32454693566606, "discrim_loss": 1.315072774887085, "cost1_mean": 178.6402847151353, "outflow_rate_mean": 921.9658249612388, "system_level_velocity_mean": 14.599660148111308, "cost2_max": -92.32101200845109}}
{"sampler_perf": {"mean_inference_ms": 7.594280396655597, "mean_processing_ms": 10.988048687399154, "mean_env_wait_ms": 134.4960850465355}, "policy_reward_mean": {}, "time_since_restore": 2578.859686613083, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 28, "episodes_total": 464, "time_total_s": 2578.859686613083, "episode_reward_max": 763.881953150034, "episode_reward_mean": 611.1982825462308, "episode_reward_min": 574.0435487926006, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.97395038604736, "timestamp": 1559266879, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 20, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e9d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e2f0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-41-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 961.7490830793671, "outflow_rate_min": 782.6434746552205, "system_level_velocity_max": 15.300425775514674, "cost2_min": -125.49732919253542, "system_level_velocity_min": 12.055657249708641, "cost1_min": 146.24937629132586, "cost1_max": 187.61233657660836, "cost2_mean": -104.79460752810282, "discrim_loss": 1.2806432247161865, "cost1_mean": 174.6629104709163, "outflow_rate_mean": 905.4010098184256, "system_level_velocity_mean": 14.251631797053182, "cost2_max": -85.43064867866747}}
{"sampler_perf": {"mean_inference_ms": 7.5968976581174585, "mean_processing_ms": 10.986861576542658, "mean_env_wait_ms": 134.32678225895512}, "policy_reward_mean": {}, "time_since_restore": 2707.045817375183, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 484, "time_total_s": 2707.045817375183, "episode_reward_max": 787.9514121711254, "episode_reward_mean": 655.9860891610384, "episode_reward_min": 598.4936165511608, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.18613076210022, "timestamp": 1559267007, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 21, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359488>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-43-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.9644529200203, "outflow_rate_min": 765.181719302207, "system_level_velocity_max": 16.088283392564723, "cost2_min": -126.11479525865616, "system_level_velocity_min": 12.009835789595082, "cost1_min": 144.53319449378267, "cost1_max": 197.52687155234898, "cost2_mean": -107.49906983503885, "discrim_loss": 1.2705142498016357, "cost1_mean": 180.57506936068881, "outflow_rate_mean": 926.7004902711924, "system_level_velocity_mean": 14.788036882440181, "cost2_max": -91.55811819245395}}
{"sampler_perf": {"mean_inference_ms": 7.595110222908009, "mean_processing_ms": 11.011215664020009, "mean_env_wait_ms": 133.999961336247}, "policy_reward_mean": {}, "time_since_restore": 2833.0616040229797, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 505, "time_total_s": 2833.0616040229797, "episode_reward_max": 860.6370331346989, "episode_reward_mean": 690.8692276037875, "episode_reward_min": 648.3555781245232, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.01578664779663, "timestamp": 1559267133, "episode_len_mean": 325.0, "iterations_since_restore": 22, "training_iteration": 22, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359730>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303597b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359620>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-45-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1011.4370407514441, "outflow_rate_min": 732.4662238132296, "system_level_velocity_max": 16.65952952769764, "cost2_min": -123.76322639451817, "system_level_velocity_min": 11.314660473000279, "cost1_min": 135.56545216946998, "cost1_max": 202.0746614916745, "cost2_mean": -108.58722344811788, "discrim_loss": 1.305656909942627, "cost1_mean": 183.63985927001116, "outflow_rate_mean": 938.1664921543392, "system_level_velocity_mean": 15.05776150887205, "cost2_max": -92.44868231455183}}
{"sampler_perf": {"mean_inference_ms": 7.564603541571235, "mean_processing_ms": 11.028366865562505, "mean_env_wait_ms": 134.03555132715664}, "policy_reward_mean": {}, "time_since_restore": 2966.4608767032623, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 532, "time_total_s": 2966.4608767032623, "episode_reward_max": 825.9438848048449, "episode_reward_mean": 679.6810115266729, "episode_reward_min": 586.1012190282345, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.3992726802826, "timestamp": 1559267267, "episode_len_mean": 325.0, "iterations_since_restore": 23, "training_iteration": 23, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ea60>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e730>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-47-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.4165871732682, "outflow_rate_min": 744.3792085746378, "system_level_velocity_max": 17.40951372899278, "cost2_min": -134.11183776908018, "system_level_velocity_min": 11.271357101705064, "cost1_min": 134.59704469807116, "cost1_max": 211.2928911182571, "cost2_mean": -114.63732844786166, "discrim_loss": 1.3324930667877197, "cost1_mean": 179.01277208063507, "outflow_rate_mean": 924.1143394863145, "system_level_velocity_mean": 14.809492815114094, "cost2_max": -99.83650940776909}}
{"sampler_perf": {"mean_inference_ms": 7.515667552370914, "mean_processing_ms": 10.983159978786928, "mean_env_wait_ms": 133.16046029333668}, "policy_reward_mean": {}, "time_since_restore": 3079.7316539287567, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 554, "time_total_s": 3079.7316539287567, "episode_reward_max": 676.6032290607691, "episode_reward_mean": 578.5764095031402, "episode_reward_min": 524.8660307079554, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 113.27077722549438, "timestamp": 1559267380, "episode_len_mean": 325.0, "iterations_since_restore": 24, "training_iteration": 24, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375510>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-49-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.7855204679825, "outflow_rate_min": 852.6143798835782, "system_level_velocity_max": 17.67367022486127, "cost2_min": -134.7210699081897, "system_level_velocity_min": 13.21321637937827, "cost1_min": 156.76305923199425, "cost1_max": 213.61480853412291, "cost2_mean": -117.93246538401313, "discrim_loss": 1.3573675155639648, "cost1_mean": 191.40329064707038, "outflow_rate_mean": 977.5439823303426, "system_level_velocity_mean": 15.909251619873988, "cost2_max": -109.27050479961035}}
{"sampler_perf": {"mean_inference_ms": 7.498394412413565, "mean_processing_ms": 10.902176837362699, "mean_env_wait_ms": 132.9645321061596}, "policy_reward_mean": {}, "time_since_restore": 3222.120316505432, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 574, "time_total_s": 3222.120316505432, "episode_reward_max": 613.4618248194456, "episode_reward_mean": 563.0699570424855, "episode_reward_min": 505.3819720894098, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.38866257667542, "timestamp": 1559267522, "episode_len_mean": 325.0, "iterations_since_restore": 25, "training_iteration": 25, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303330d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359d90>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-52-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1065.4080084533987, "outflow_rate_min": 805.7468736548453, "system_level_velocity_max": 17.935098916104028, "cost2_min": -140.9295272961388, "system_level_velocity_min": 12.1721734441393, "cost1_min": 144.07087688328903, "cost1_max": 216.5929965660751, "cost2_mean": -123.75939470018336, "discrim_loss": 1.3182251453399658, "cost1_mean": 175.96786953234184, "outflow_rate_mean": 929.0578640117837, "system_level_velocity_mean": 14.73445250472363, "cost2_max": -111.1782848399054}}
{"sampler_perf": {"mean_inference_ms": 7.478301203939817, "mean_processing_ms": 10.970710198161944, "mean_env_wait_ms": 132.6637808244552}, "policy_reward_mean": {}, "time_since_restore": 3353.0593440532684, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 28, "episodes_total": 602, "time_total_s": 3353.0593440532684, "episode_reward_max": 639.0423791706562, "episode_reward_mean": 580.7610467028405, "episode_reward_min": 498.1811588704586, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.9390275478363, "timestamp": 1559267653, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 26, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c32f0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c38c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3ae8>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-54-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.3467489807263, "outflow_rate_min": 800.8159640367203, "system_level_velocity_max": 18.795426950861835, "cost2_min": -143.4776356638181, "system_level_velocity_min": 12.14074520480877, "cost1_min": 142.60938127736128, "cost1_max": 223.45419242753775, "cost2_mean": -125.89427463722122, "discrim_loss": 1.2322754859924316, "cost1_mean": 183.1148629363551, "outflow_rate_mean": 956.1380365395892, "system_level_velocity_mean": 15.37221039923614, "cost2_max": -108.17873552791286}}
{"sampler_perf": {"mean_inference_ms": 7.480562775974605, "mean_processing_ms": 10.964810476578334, "mean_env_wait_ms": 133.18236599210988}, "policy_reward_mean": {}, "time_since_restore": 3481.543607711792, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 624, "time_total_s": 3481.543607711792, "episode_reward_max": 693.580558821559, "episode_reward_mean": 669.9266773557121, "episode_reward_min": 597.4965300858021, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.48426365852356, "timestamp": 1559267782, "episode_len_mean": 325.0, "iterations_since_restore": 27, "training_iteration": 27, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930360598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930360488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360400>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-56-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.8578543274386, "outflow_rate_min": 791.1279489626943, "system_level_velocity_max": 18.267147397388563, "cost2_min": -155.6002892096733, "system_level_velocity_min": 12.132570945644105, "cost1_min": 144.77702077008158, "cost1_max": 217.57229113651786, "cost2_mean": -131.21586064940468, "discrim_loss": 1.2218493223190308, "cost1_mean": 177.04436809847004, "outflow_rate_mean": 937.9312272401639, "system_level_velocity_mean": 14.934670986382777, "cost2_max": -119.40610103391116}}
{"sampler_perf": {"mean_inference_ms": 7.478579430567942, "mean_processing_ms": 10.97665977433855, "mean_env_wait_ms": 133.01200780439152}, "policy_reward_mean": {}, "time_since_restore": 3618.552495241165, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 646, "time_total_s": 3618.552495241165, "episode_reward_max": 713.4246354997158, "episode_reward_mean": 624.7687948860905, "episode_reward_min": 82.91339254379272, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.00888752937317, "timestamp": 1559267919, "episode_len_mean": 302.72727272727275, "iterations_since_restore": 28, "training_iteration": 28, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c36a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3b70>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_01-58-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1096.670280667785, "outflow_rate_min": 486.5197872620737, "system_level_velocity_max": 19.034330691555056, "cost2_min": -151.14688171499733, "system_level_velocity_min": 12.825747833835294, "cost1_min": 23.083804362660793, "cost1_max": 226.22723616277662, "cost2_mean": -123.60059081442729, "discrim_loss": 1.1954128742218018, "cost1_mean": 175.31730703636478, "outflow_rate_mean": 940.4327189947264, "system_level_velocity_mean": 16.05768927317935, "cost2_max": -22.85223785827078}}
{"sampler_perf": {"mean_inference_ms": 7.490575548163116, "mean_processing_ms": 10.982701700410516, "mean_env_wait_ms": 133.03092623526248}, "policy_reward_mean": {}, "time_since_restore": 3756.2103629112244, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 669, "time_total_s": 3756.2103629112244, "episode_reward_max": 672.3422618508339, "episode_reward_mean": 591.5228485549274, "episode_reward_min": 259.6096433699131, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.6578676700592, "timestamp": 1559268057, "episode_len_mean": 316.6521739130435, "iterations_since_restore": 29, "training_iteration": 29, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303609d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303608c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360840>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-00-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1098.8475698393058, "outflow_rate_min": 754.1446595777286, "system_level_velocity_max": 19.060234588244906, "cost2_min": -153.77248330733258, "system_level_velocity_min": 12.032209384140845, "cost1_min": 91.21598693606396, "cost1_max": 226.37772589241825, "cost2_mean": -130.11535090179484, "discrim_loss": 1.0930286645889282, "cost1_mean": 182.93274514309874, "outflow_rate_mean": 961.7226706735395, "system_level_velocity_mean": 15.926675974378897, "cost2_max": -70.43139584613368}}
{"sampler_perf": {"mean_inference_ms": 7.5123624636861175, "mean_processing_ms": 10.990250661735821, "mean_env_wait_ms": 133.6072523800694}, "policy_reward_mean": {}, "time_since_restore": 3886.964499473572, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 695, "time_total_s": 3886.964499473572, "episode_reward_max": 579.6216522753239, "episode_reward_mean": 534.7317047894287, "episode_reward_min": 494.83521489053965, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.7541365623474, "timestamp": 1559268187, "episode_len_mean": 325.0, "iterations_since_restore": 30, "training_iteration": 30, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79306d3f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-03-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1088.5778244996052, "outflow_rate_min": 817.0010431621819, "system_level_velocity_max": 18.768601623689243, "cost2_min": -154.31105703397103, "system_level_velocity_min": 12.392923804017606, "cost1_min": 146.764416451678, "cost1_max": 225.00434847030706, "cost2_mean": -135.80416019034047, "discrim_loss": 1.0284926891326904, "cost1_mean": 181.9666697815175, "outflow_rate_mean": 955.9670355264548, "system_level_velocity_mean": 15.337812236958172, "cost2_max": -119.00853423670462}}
{"sampler_perf": {"mean_inference_ms": 7.497018301813378, "mean_processing_ms": 11.001938646277383, "mean_env_wait_ms": 133.66931712823964}, "policy_reward_mean": {}, "time_since_restore": 4020.189209461212, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 717, "time_total_s": 4020.189209461212, "episode_reward_max": 576.927435874939, "episode_reward_mean": 508.6758039168675, "episode_reward_min": 473.4149400368333, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.22470998764038, "timestamp": 1559268321, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 31, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333488>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-05-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1093.0171495922746, "outflow_rate_min": 824.2465144846984, "system_level_velocity_max": 19.000103703274025, "cost2_min": -158.69015117616803, "system_level_velocity_min": 12.322075247245747, "cost1_min": 146.72092161430976, "cost1_max": 226.64699781206514, "cost2_mean": -138.14239159473811, "discrim_loss": 0.9314703941345215, "cost1_mean": 180.08196259165996, "outflow_rate_mean": 950.0186212035161, "system_level_velocity_mean": 15.213264556576787, "cost2_max": -119.26661954109554}}
{"sampler_perf": {"mean_inference_ms": 7.50271396911064, "mean_processing_ms": 11.057802208077758, "mean_env_wait_ms": 133.53569265739353}, "policy_reward_mean": {}, "time_since_restore": 4148.6490478515625, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 740, "time_total_s": 4148.6490478515625, "episode_reward_max": 565.2807965949178, "episode_reward_mean": 484.6626585704153, "episode_reward_min": 50.56685945019126, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.45983839035034, "timestamp": 1559268449, "episode_len_mean": 303.5652173913044, "iterations_since_restore": 32, "training_iteration": 32, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ea60>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e730>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-07-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1094.0963754519255, "outflow_rate_min": 448.5093812448499, "system_level_velocity_max": 19.137252675658868, "cost2_min": -159.44668587065902, "system_level_velocity_min": 12.806241168048492, "cost1_min": 17.968747264695534, "cost1_max": 227.0069503820683, "cost2_mean": -128.11380282324544, "discrim_loss": 0.9771265983581543, "cost1_mean": 177.38026471451977, "outflow_rate_mean": 948.016874273335, "system_level_velocity_mean": 16.159212924478396, "cost2_max": -20.496997350836995}}
{"sampler_perf": {"mean_inference_ms": 7.514792630698558, "mean_processing_ms": 11.007656531884722, "mean_env_wait_ms": 134.1150347146452}, "policy_reward_mean": {}, "time_since_restore": 4284.114097356796, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 765, "time_total_s": 4284.114097356796, "episode_reward_max": 571.4334879517555, "episode_reward_mean": 511.447126878947, "episode_reward_min": 477.5043977238238, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.46504950523376, "timestamp": 1559268585, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 33, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361400>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-09-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1089.373566385118, "outflow_rate_min": 829.5525096776854, "system_level_velocity_max": 18.738032099921615, "cost2_min": -166.41961664380105, "system_level_velocity_min": 12.547609930377593, "cost1_min": 148.78852133715515, "cost1_max": 224.46637047226073, "cost2_mean": -141.14028090352966, "discrim_loss": 0.9002052545547485, "cost1_mean": 177.03693310422585, "outflow_rate_mean": 944.0307772662611, "system_level_velocity_mean": 14.965540887784323, "cost2_max": -119.61676363420105}}
{"sampler_perf": {"mean_inference_ms": 7.497742868517854, "mean_processing_ms": 11.060247489063249, "mean_env_wait_ms": 133.96942953060662}, "policy_reward_mean": {}, "time_since_restore": 4412.668326854706, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 789, "time_total_s": 4412.668326854706, "episode_reward_max": 601.2564638145268, "episode_reward_mean": 523.3086008786535, "episode_reward_min": 232.37949922680855, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.55422949790955, "timestamp": 1559268713, "episode_len_mean": 316.6666666666667, "iterations_since_restore": 34, "training_iteration": 34, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303337b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333730>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-11-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1092.16724325603, "outflow_rate_min": 744.706072450358, "system_level_velocity_max": 19.32060533277091, "cost2_min": -166.21657285337915, "system_level_velocity_min": 12.349770350122485, "cost1_min": 87.17776565673425, "cost1_max": 226.32355776462603, "cost2_mean": -134.84899119805084, "discrim_loss": 0.9585729241371155, "cost1_mean": 180.2162999522203, "outflow_rate_mean": 953.818252630164, "system_level_velocity_mean": 15.684855192861077, "cost2_max": -67.35899513455884}}
{"sampler_perf": {"mean_inference_ms": 7.497398521328646, "mean_processing_ms": 11.018069325934484, "mean_env_wait_ms": 133.63831888331796}, "policy_reward_mean": {}, "time_since_restore": 4542.732923030853, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 811, "time_total_s": 4542.732923030853, "episode_reward_max": 574.9870768673718, "episode_reward_mean": 517.5203313312747, "episode_reward_min": 484.91760768555105, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.06459617614746, "timestamp": 1559268843, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 35, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e598>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-14-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1080.97796017371, "outflow_rate_min": 862.1012904790493, "system_level_velocity_max": 18.67711782162544, "cost2_min": -153.79808785915736, "system_level_velocity_min": 12.85772785014019, "cost1_min": 152.4230378791242, "cost1_max": 223.5052345076931, "cost2_mean": -136.83872331789672, "discrim_loss": 0.9543064832687378, "cost1_mean": 178.96685072239913, "outflow_rate_mean": 947.741425888526, "system_level_velocity_mean": 15.103103718137204, "cost2_max": -118.76548357769204}}
{"sampler_perf": {"mean_inference_ms": 7.506454144578117, "mean_processing_ms": 11.022693654389277, "mean_env_wait_ms": 133.76558934423852}, "policy_reward_mean": {}, "time_since_restore": 4680.3141968250275, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 835, "time_total_s": 4680.3141968250275, "episode_reward_max": 501.41031334456056, "episode_reward_mean": 461.8425664989433, "episode_reward_min": 416.284198012203, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.5812737941742, "timestamp": 1559268981, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 36, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930361158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303610d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930361048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3598>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-16-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1097.7943006337612, "outflow_rate_min": 807.6980014996464, "system_level_velocity_max": 19.107449106126325, "cost2_min": -169.1251546945344, "system_level_velocity_min": 12.231652023146683, "cost1_min": 144.36347767064237, "cost1_max": 227.29028039737875, "cost2_mean": -133.7629261275146, "discrim_loss": 0.9212068319320679, "cost1_mean": 191.29391893090306, "outflow_rate_mean": 985.3297229444343, "system_level_velocity_mean": 16.081692712356787, "cost2_max": -118.57500118046136}}
{"sampler_perf": {"mean_inference_ms": 7.492622659695897, "mean_processing_ms": 11.039149161881632, "mean_env_wait_ms": 134.0397642748968}, "policy_reward_mean": {}, "time_since_restore": 4811.7412712574005, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 859, "time_total_s": 4811.7412712574005, "episode_reward_max": 460.1173808965832, "episode_reward_mean": 393.91450232857215, "episode_reward_min": 351.2485230714083, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.42707443237305, "timestamp": 1559269113, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 37, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e730>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e048>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-18-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1093.873906079572, "outflow_rate_min": 816.6852978061415, "system_level_velocity_max": 18.872762568554425, "cost2_min": -151.56761437579797, "system_level_velocity_min": 12.348183476955821, "cost1_min": 146.31021733025545, "cost1_max": 225.06192191519187, "cost2_mean": -134.68258345271855, "discrim_loss": 1.0386309623718262, "cost1_mean": 184.03859292366283, "outflow_rate_mean": 962.3659043283261, "system_level_velocity_mean": 15.495880528679066, "cost2_max": -117.2064696276421}}
{"sampler_perf": {"mean_inference_ms": 7.508096271488323, "mean_processing_ms": 11.009440842815287, "mean_env_wait_ms": 134.0624092896022}, "policy_reward_mean": {}, "time_since_restore": 4939.98467707634, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 880, "time_total_s": 4939.98467707634, "episode_reward_max": 433.51382673624903, "episode_reward_mean": 376.1378204693486, "episode_reward_min": 26.707736467942595, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.2434058189392, "timestamp": 1559269241, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 38, "training_iteration": 38, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364400>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-20-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.7713053755228, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 18.520980994693485, "cost2_min": -151.87508438250924, "system_level_velocity_min": 12.811907327757732, "cost1_min": 17.827390448589437, "cost1_max": 223.42912040870073, "cost2_mean": -127.33600749338034, "discrim_loss": 1.0353235006332397, "cost1_mean": 172.18374324352206, "outflow_rate_mean": 923.7990786073502, "system_level_velocity_mean": 15.244761898496497, "cost2_max": -21.759989104933464}}
{"sampler_perf": {"mean_inference_ms": 7.512000697090509, "mean_processing_ms": 11.023338352495623, "mean_env_wait_ms": 133.65959103936956}, "policy_reward_mean": {}, "time_since_restore": 5071.606985330582, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 905, "time_total_s": 5071.606985330582, "episode_reward_max": 487.1383810262196, "episode_reward_mean": 420.24076852027326, "episode_reward_min": 371.45592263899744, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.62230825424194, "timestamp": 1559269372, "episode_len_mean": 325.0, "iterations_since_restore": 39, "training_iteration": 39, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e1e0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e378>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-22-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1095.7211076139884, "outflow_rate_min": 804.9188032308776, "system_level_velocity_max": 18.88336265217822, "cost2_min": -162.89728919682915, "system_level_velocity_min": 12.27865199795477, "cost1_min": 146.97280333955024, "cost1_max": 224.43729933705515, "cost2_mean": -127.96778016520202, "discrim_loss": 1.0600684881210327, "cost1_mean": 199.4181418097332, "outflow_rate_mean": 1009.9946938936218, "system_level_velocity_mean": 16.73846093298597, "cost2_max": -114.41449089660836}}
{"sampler_perf": {"mean_inference_ms": 7.510081206915274, "mean_processing_ms": 11.041232968071279, "mean_env_wait_ms": 134.2052552453897}, "policy_reward_mean": {}, "time_since_restore": 5201.863518714905, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 929, "time_total_s": 5201.863518714905, "episode_reward_max": 578.5028262571432, "episode_reward_mean": 482.8193499276531, "episode_reward_min": 176.06073758006096, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 130.25653338432312, "timestamp": 1559269503, "episode_len_mean": 316.3333333333333, "iterations_since_restore": 40, "training_iteration": 40, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-25-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1091.2833675021764, "outflow_rate_min": 709.4155895569636, "system_level_velocity_max": 18.991658538898463, "cost2_min": -159.70754074721356, "system_level_velocity_min": 12.17433449552026, "cost1_min": 78.78481775167802, "cost1_max": 224.97314472934124, "cost2_mean": -125.72193598308233, "discrim_loss": 1.0479305982589722, "cost1_mean": 180.13542511311664, "outflow_rate_mean": 952.3126096965647, "system_level_velocity_mean": 15.650893501211398, "cost2_max": -61.83888054926999}}
{"sampler_perf": {"mean_inference_ms": 7.511494535637552, "mean_processing_ms": 11.048409927529667, "mean_env_wait_ms": 134.38143567319455}, "policy_reward_mean": {}, "time_since_restore": 5336.599818944931, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 952, "time_total_s": 5336.599818944931, "episode_reward_max": 603.4087588586845, "episode_reward_mean": 486.92605590984306, "episode_reward_min": 175.55290370248258, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.73630023002625, "timestamp": 1559269641, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 41, "training_iteration": 41, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303592f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303591e0>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-27-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.778729430644, "outflow_rate_min": 721.871075554337, "system_level_velocity_max": 18.572109914614128, "cost2_min": -148.1968554977933, "system_level_velocity_min": 11.676691217944779, "cost1_min": 79.60344080710003, "cost1_max": 221.73213229596297, "cost2_mean": -126.02480861862003, "discrim_loss": 0.9400559663772583, "cost1_mean": 178.0565600197999, "outflow_rate_mean": 945.5903169674922, "system_level_velocity_mean": 15.484463936563362, "cost2_max": -61.94443480216437}}
{"sampler_perf": {"mean_inference_ms": 7.520289258935729, "mean_processing_ms": 11.047638132453828, "mean_env_wait_ms": 134.42281328182236}, "policy_reward_mean": {}, "time_since_restore": 5469.2154223918915, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 975, "time_total_s": 5469.2154223918915, "episode_reward_max": 582.7243115473539, "episode_reward_mean": 456.89817286655307, "episode_reward_min": 209.8041644077748, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.61560344696045, "timestamp": 1559269775, "episode_len_mean": 311.17391304347825, "iterations_since_restore": 42, "training_iteration": 42, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e0d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ed08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ea60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e048>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-29-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.3555377806672, "outflow_rate_min": 750.1872659802765, "system_level_velocity_max": 18.849519389973903, "cost2_min": -161.02356559041536, "system_level_velocity_min": 11.807126956191246, "cost1_min": 84.97318999488051, "cost1_max": 209.37903366548505, "cost2_mean": -127.11435577268927, "discrim_loss": 1.0202584266662598, "cost1_mean": 172.9802385364581, "outflow_rate_mean": 930.9471930850135, "system_level_velocity_mean": 15.330508904852882, "cost2_max": -61.75432901475088}}
{"sampler_perf": {"mean_inference_ms": 7.529604662042915, "mean_processing_ms": 11.06391488176949, "mean_env_wait_ms": 134.43099284947542}, "policy_reward_mean": {}, "time_since_restore": 5604.325339794159, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 999, "time_total_s": 5604.325339794159, "episode_reward_max": 540.4083550800569, "episode_reward_mean": 479.77785919765785, "episode_reward_min": 380.93956992030144, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.10991740226746, "timestamp": 1559269911, "episode_len_mean": 320.4166666666667, "iterations_since_restore": 43, "training_iteration": 43, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359488>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-31-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1074.774312813318, "outflow_rate_min": 853.8369847623262, "system_level_velocity_max": 18.497236670990635, "cost2_min": -146.9429647219303, "system_level_velocity_min": 12.86483141935485, "cost1_min": 145.11773640909598, "cost1_max": 218.57132434200253, "cost2_mean": -124.5899633127173, "discrim_loss": 0.9925369024276733, "cost1_mean": 181.96866337391668, "outflow_rate_mean": 958.1664488979818, "system_level_velocity_mean": 15.54086659826091, "cost2_max": -87.78343307570864}}
{"sampler_perf": {"mean_inference_ms": 7.5255066578750816, "mean_processing_ms": 11.094832492500752, "mean_env_wait_ms": 134.79941407192436}, "policy_reward_mean": {}, "time_since_restore": 5745.966217756271, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 1022, "time_total_s": 5745.966217756271, "episode_reward_max": 567.5393333137035, "episode_reward_mean": 481.0655273798772, "episode_reward_min": 383.45175134018064, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 141.64087796211243, "timestamp": 1559270053, "episode_len_mean": 325.0, "iterations_since_restore": 44, "training_iteration": 44, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364ae8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364b70>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-34-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1078.6528555586394, "outflow_rate_min": 786.2140707502666, "system_level_velocity_max": 18.50778992010459, "cost2_min": -150.89215313780477, "system_level_velocity_min": 11.84892536177298, "cost1_min": 139.69905263929007, "cost1_max": 219.8880215323477, "cost2_mean": -129.0591584051434, "discrim_loss": 0.9364479780197144, "cost1_mean": 180.08030226918575, "outflow_rate_mean": 942.985498288804, "system_level_velocity_mean": 15.072446802906326, "cost2_max": -110.42355504982484}}
{"sampler_perf": {"mean_inference_ms": 7.537013738053855, "mean_processing_ms": 11.084658686532379, "mean_env_wait_ms": 135.13077918110852}, "policy_reward_mean": {}, "time_since_restore": 5877.694950580597, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 1046, "time_total_s": 5877.694950580597, "episode_reward_max": 570.3481610268354, "episode_reward_mean": 480.52899379337515, "episode_reward_min": 382.38494682870805, "off_policy_estimator": {}, "pid": 7177, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 131.72873282432556, "timestamp": 1559270186, "episode_len_mean": 325.0, "iterations_since_restore": 45, "training_iteration": 45, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "remote_worker_envs": false, "num_cpus_for_driver": 1, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "entropy_coeff": 0.0, "num_sgd_iter": 10, "vf_share_layers": false, "compress_observations": false, "lr": 0.0005, "custom_resources_per_worker": {}, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "output_max_file_size": 67108864, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303659d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_postprocess_traj": null, "on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365840>)", "on_train_result": null}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-36-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1080.9949884630337, "outflow_rate_min": 853.7169366432976, "system_level_velocity_max": 18.30474178009377, "cost2_min": -143.370414300694, "system_level_velocity_min": 12.894817250929577, "cost1_min": 153.66406263671195, "cost1_max": 218.46040040704813, "cost2_mean": -124.42099636795183, "discrim_loss": 0.9602536559104919, "cost1_mean": 186.69633701602493, "outflow_rate_mean": 969.3298741817031, "system_level_velocity_mean": 15.652881631863087, "cost2_max": -108.72369832558127}}
{"sampler_perf": {"mean_inference_ms": 7.9182225759432585, "mean_processing_ms": 8.948552878337916, "mean_env_wait_ms": 139.14928753747444}, "policy_reward_mean": {}, "time_since_restore": 177.09181213378906, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 949, "time_total_s": 5378.955330848694, "episode_reward_max": 815.9816142916679, "off_policy_estimator": {}, "episode_reward_min": 530.5551881194115, "episode_reward_mean": 677.9354287147522, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 177.09181213378906, "timestamp": 1559270495, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 41, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e0d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ed08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ec80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e510>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-41-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1087.0524190787746, "outflow_rate_min": 807.5870658289456, "system_level_velocity_max": 18.655541339837843, "cost2_min": -149.11645104146137, "cost1_mean": 182.58496613624473, "system_level_velocity_min": 12.23697303882171, "cost2_max": -111.69620180713923, "cost1_min": 144.90954221151796, "cost2_mean": -128.0882386680676, "discrim_loss": 0.9583994746208191, "outflow_rate_mean": 957.5310897081308, "system_level_velocity_mean": 15.336034663522483, "cost1_max": 222.07880173687377}}
{"sampler_perf": {"mean_inference_ms": 7.805197868457297, "mean_processing_ms": 9.630044626594367, "mean_env_wait_ms": 140.0531508558682}, "policy_reward_mean": {}, "time_since_restore": 310.72437167167664, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 970, "time_total_s": 5512.587890386581, "episode_reward_max": 360.25236997008324, "off_policy_estimator": {}, "episode_reward_min": 169.3150196056813, "episode_reward_mean": 272.48243107500355, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.63255953788757, "timestamp": 1559270629, "episode_len_mean": 315.0952380952381, "iterations_since_restore": 2, "training_iteration": 42, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b3268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b31e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b30d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b3158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-43-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.246474323409, "outflow_rate_min": 707.1039703002817, "system_level_velocity_max": 18.73175871257706, "cost2_min": -148.85074502318002, "cost1_mean": 179.74439689378124, "system_level_velocity_min": 12.71761683252612, "cost2_max": -60.91493759549647, "cost1_min": 79.36071366385562, "cost2_mean": -123.58008413142969, "discrim_loss": 1.1443688869476318, "outflow_rate_mean": 951.6978610928738, "system_level_velocity_mean": 15.634647423595327, "cost1_max": 221.89066457551033}}
{"sampler_perf": {"mean_inference_ms": 7.656105535923243, "mean_processing_ms": 9.529019387125283, "mean_env_wait_ms": 141.474625991218}, "policy_reward_mean": {}, "time_since_restore": 446.144376039505, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 990, "time_total_s": 5648.00789475441, "episode_reward_max": 562.1356361731887, "off_policy_estimator": {}, "episode_reward_min": 273.9242648323998, "episode_reward_mean": 411.5885187330656, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.42000436782837, "timestamp": 1559270765, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 43, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-46-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1086.575522063893, "outflow_rate_min": 841.2410140188119, "system_level_velocity_max": 18.743415009102037, "cost2_min": -148.166952026101, "cost1_mean": 181.61454482281255, "system_level_velocity_min": 12.72005592552258, "cost2_max": -112.80138719818602, "cost1_min": 151.12079745930868, "cost2_mean": -128.44015165997456, "discrim_loss": 0.8822041749954224, "outflow_rate_mean": 955.7688462101254, "system_level_velocity_mean": 15.283447195729243, "cost1_max": 223.16376385008965}}
{"sampler_perf": {"mean_inference_ms": 7.607218913174838, "mean_processing_ms": 10.441736638642562, "mean_env_wait_ms": 140.67536076013582}, "policy_reward_mean": {}, "time_since_restore": 585.3549649715424, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 29, "episodes_total": 1019, "time_total_s": 5787.218483686447, "episode_reward_max": 812.4177306741476, "off_policy_estimator": {}, "episode_reward_min": 425.00843410752714, "episode_reward_mean": 650.0863732153485, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 139.21058893203735, "timestamp": 1559270904, "episode_len_mean": 321.2068965517241, "iterations_since_restore": 4, "training_iteration": 44, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb6a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb510>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-48-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1073.046214887272, "outflow_rate_min": 841.2272390106295, "system_level_velocity_max": 18.250481627927968, "cost2_min": -147.65536923355273, "cost1_mean": 179.7893289044269, "system_level_velocity_min": 12.640802632048297, "cost2_max": -90.97077339095715, "cost1_min": 144.7897866108937, "cost2_mean": -125.42008095741892, "discrim_loss": 1.0840160846710205, "outflow_rate_mean": 950.8232011836202, "system_level_velocity_mean": 15.318309796692485, "cost1_max": 218.13196661209963}}
{"sampler_perf": {"mean_inference_ms": 7.551200141276693, "mean_processing_ms": 10.428163938116395, "mean_env_wait_ms": 139.6288625691957}, "policy_reward_mean": {}, "time_since_restore": 719.3211133480072, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1040, "time_total_s": 5921.184632062912, "episode_reward_max": 774.1451755836606, "off_policy_estimator": {}, "episode_reward_min": 475.04579135403037, "episode_reward_mean": 607.6715074868074, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.96614837646484, "timestamp": 1559271038, "episode_len_mean": 325.0, "iterations_since_restore": 5, "training_iteration": 45, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035eae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ec80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-50-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1076.2960952605097, "outflow_rate_min": 809.996888155254, "system_level_velocity_max": 18.318166354203978, "cost2_min": -146.02513275692615, "cost1_mean": 184.66070922289947, "system_level_velocity_min": 12.137889371447264, "cost2_max": -112.93053736821197, "cost1_min": 142.16877156419088, "cost2_mean": -124.96899585080011, "discrim_loss": 1.0283260345458984, "outflow_rate_mean": 963.3030970012161, "system_level_velocity_mean": 15.477470169175247, "cost1_max": 219.1168271751784}}
{"sampler_perf": {"mean_inference_ms": 7.598233335712145, "mean_processing_ms": 10.435069757917333, "mean_env_wait_ms": 140.2312670565127}, "policy_reward_mean": {}, "time_since_restore": 851.4989237785339, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1061, "time_total_s": 6053.362442493439, "episode_reward_max": 586.4033830426633, "off_policy_estimator": {}, "episode_reward_min": 329.5881056152284, "episode_reward_mean": 446.69688169764623, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.17781043052673, "timestamp": 1559271170, "episode_len_mean": 325.0, "iterations_since_restore": 6, "training_iteration": 46, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e6a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e1e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-52-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.7274337484394, "outflow_rate_min": 799.2687545868224, "system_level_velocity_max": 17.353495606229142, "cost2_min": -159.1516536877568, "cost1_mean": 185.10666779196464, "system_level_velocity_min": 12.206583654065653, "cost2_max": -114.93231637048314, "cost1_min": 146.09795626518167, "cost2_mean": -128.75946321763325, "discrim_loss": 0.8104133009910583, "outflow_rate_mean": 965.0481123986302, "system_level_velocity_mean": 15.506095373725502, "cost1_max": 206.7966004831692}}
{"sampler_perf": {"mean_inference_ms": 7.5979474128763425, "mean_processing_ms": 10.68544630244523, "mean_env_wait_ms": 140.7653352726945}, "policy_reward_mean": {}, "time_since_restore": 987.2721328735352, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 28, "episodes_total": 1089, "time_total_s": 6189.13565158844, "episode_reward_max": 491.71460445970297, "off_policy_estimator": {}, "episode_reward_min": 308.9581500738859, "episode_reward_mean": 388.5297920137112, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.77320909500122, "timestamp": 1559271307, "episode_len_mean": 325.0, "iterations_since_restore": 7, "training_iteration": 47, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-55-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.5906856564998, "outflow_rate_min": 796.3426113305735, "system_level_velocity_max": 18.369350410809965, "cost2_min": -144.1698382633661, "cost1_mean": 175.88502352292653, "system_level_velocity_min": 11.953310657605256, "cost2_max": -110.84806471410336, "cost1_min": 142.49219506808845, "cost2_mean": -126.69837604114491, "discrim_loss": 0.8875014781951904, "outflow_rate_mean": 930.8756736949603, "system_level_velocity_mean": 14.749630754454946, "cost1_max": 219.66721445126768}}
{"sampler_perf": {"mean_inference_ms": 7.592128118711666, "mean_processing_ms": 10.649853110026795, "mean_env_wait_ms": 140.63641223227447}, "policy_reward_mean": {}, "time_since_restore": 1123.4990229606628, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1110, "time_total_s": 6325.362541675568, "episode_reward_max": 503.6983939893544, "off_policy_estimator": {}, "episode_reward_min": 306.5254856031388, "episode_reward_mean": 392.8467754951368, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.22689008712769, "timestamp": 1559271443, "episode_len_mean": 320.0, "iterations_since_restore": 8, "training_iteration": 48, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-57-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1078.5772825465785, "outflow_rate_min": 813.4584068497098, "system_level_velocity_max": 18.423306056456468, "cost2_min": -142.828787743695, "cost1_mean": 181.03699233632292, "system_level_velocity_min": 12.226875868091666, "cost2_max": -88.61734004259525, "cost1_min": 143.91802874264835, "cost2_mean": -121.48361720420863, "discrim_loss": 0.9515284299850464, "outflow_rate_mean": 954.7584728528773, "system_level_velocity_mean": 15.489433295937152, "cost1_max": 218.31526656691787}}
{"sampler_perf": {"mean_inference_ms": 7.576580972951851, "mean_processing_ms": 10.686402610710182, "mean_env_wait_ms": 140.28544870850126}, "policy_reward_mean": {}, "time_since_restore": 1266.4149286746979, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1132, "time_total_s": 6468.278447389603, "episode_reward_max": 508.83230051770806, "off_policy_estimator": {}, "episode_reward_min": 283.5787043813616, "episode_reward_mean": 375.2902568327263, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 142.91590571403503, "timestamp": 1559271586, "episode_len_mean": 325.0, "iterations_since_restore": 9, "training_iteration": 49, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364950>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_02-59-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.1878845247422, "outflow_rate_min": 810.2796689159178, "system_level_velocity_max": 18.260145437657844, "cost2_min": -145.65051735245825, "cost1_mean": 184.92396505144515, "system_level_velocity_min": 12.250375243530502, "cost2_max": -110.25135162178155, "cost1_min": 145.73456438139075, "cost2_mean": -125.27044857774544, "discrim_loss": 0.8901916742324829, "outflow_rate_mean": 960.1211700743756, "system_level_velocity_mean": 15.472393099647553, "cost1_max": 217.8872240465151}}
{"sampler_perf": {"mean_inference_ms": 7.584093034088195, "mean_processing_ms": 10.79686068130957, "mean_env_wait_ms": 141.41287495077324}, "policy_reward_mean": {}, "time_since_restore": 1407.0581073760986, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 1159, "time_total_s": 6608.921626091003, "episode_reward_max": 461.3933706507087, "off_policy_estimator": {}, "episode_reward_min": 265.6587274186313, "episode_reward_mean": 341.4384385931685, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 140.64317870140076, "timestamp": 1559271727, "episode_len_mean": 325.0, "iterations_since_restore": 10, "training_iteration": 50, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e7b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-02-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1070.4340222082128, "outflow_rate_min": 799.2497755236537, "system_level_velocity_max": 18.212076037489638, "cost2_min": -159.84570899761874, "cost1_mean": 179.14104538659518, "system_level_velocity_min": 12.072758624212653, "cost2_max": -112.19725497133373, "cost1_min": 144.1012927422722, "cost2_mean": -127.97255703247285, "discrim_loss": 0.8496878147125244, "outflow_rate_mean": 939.08440527583, "system_level_velocity_mean": 14.940188400098474, "cost1_max": 219.01414859644888}}
{"sampler_perf": {"mean_inference_ms": 7.582787208489539, "mean_processing_ms": 10.769400382047296, "mean_env_wait_ms": 141.27764211386588}, "policy_reward_mean": {}, "time_since_restore": 1539.6425170898438, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1180, "time_total_s": 6741.5060358047485, "episode_reward_max": 537.4585952460766, "off_policy_estimator": {}, "episode_reward_min": 286.5287806801498, "episode_reward_mean": 390.5915664780353, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.58440971374512, "timestamp": 1559271862, "episode_len_mean": 325.0, "iterations_since_restore": 11, "training_iteration": 51, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-04-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.6508502659233, "outflow_rate_min": 864.4960214346604, "system_level_velocity_max": 18.286110379332822, "cost2_min": -144.55234977867255, "cost1_mean": 185.26126362118515, "system_level_velocity_min": 13.18874229349323, "cost2_max": -109.15849637098296, "cost1_min": 155.79824859351442, "cost2_mean": -125.9183621931425, "discrim_loss": 0.7947498559951782, "outflow_rate_mean": 961.7913531524814, "system_level_velocity_mean": 15.505988338530234, "cost1_max": 218.2285934311931}}
{"sampler_perf": {"mean_inference_ms": 7.610793451358382, "mean_processing_ms": 10.794808892743037, "mean_env_wait_ms": 141.09379599792254}, "policy_reward_mean": {}, "time_since_restore": 1676.76970911026, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1202, "time_total_s": 6878.633227825165, "episode_reward_max": 624.3993166983128, "off_policy_estimator": {}, "episode_reward_min": 335.3443374745548, "episode_reward_mean": 434.17571426377714, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 137.12719202041626, "timestamp": 1559272000, "episode_len_mean": 325.0, "iterations_since_restore": 12, "training_iteration": 52, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-06-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1072.7598388640406, "outflow_rate_min": 851.5071759829223, "system_level_velocity_max": 18.221971053978347, "cost2_min": -146.3067511181655, "cost1_mean": 180.32159158737457, "system_level_velocity_min": 12.696422083544753, "cost2_max": -108.07512853547334, "cost1_min": 152.02949719192515, "cost2_mean": -129.86856655562363, "discrim_loss": 0.8319715261459351, "outflow_rate_mean": 944.3533844073019, "system_level_velocity_mean": 15.022150128273665, "cost1_max": 216.59532392232757}}
{"sampler_perf": {"mean_inference_ms": 7.59798981816424, "mean_processing_ms": 10.89653324599012, "mean_env_wait_ms": 141.4951119174983}, "policy_reward_mean": {}, "time_since_restore": 1813.5126731395721, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 1229, "time_total_s": 7015.376191854477, "episode_reward_max": 779.3124045580626, "off_policy_estimator": {}, "episode_reward_min": 363.2261110395193, "episode_reward_mean": 540.0806619891965, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.74296402931213, "timestamp": 1559272136, "episode_len_mean": 325.0, "iterations_since_restore": 13, "training_iteration": 53, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbd90>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbd08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbbf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbc80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-08-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1072.6007464948086, "outflow_rate_min": 845.971794512072, "system_level_velocity_max": 18.217805628174432, "cost2_min": -143.8750326760688, "cost1_mean": 184.69032847740917, "system_level_velocity_min": 12.478957883888288, "cost2_max": -107.83923339022223, "cost1_min": 148.91649556583343, "cost2_mean": -122.90068454834488, "discrim_loss": 0.8804755210876465, "outflow_rate_mean": 959.7237685727279, "system_level_velocity_mean": 15.436500833740475, "cost1_max": 216.90983645898214}}
{"sampler_perf": {"mean_inference_ms": 7.5842251108778225, "mean_processing_ms": 10.852600762803448, "mean_env_wait_ms": 141.30819601032263}, "policy_reward_mean": {}, "time_since_restore": 1949.4975929260254, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 20, "episodes_total": 1249, "time_total_s": 7151.36111164093, "episode_reward_max": 716.6739136576653, "off_policy_estimator": {}, "episode_reward_min": 381.88457996957004, "episode_reward_mean": 488.7012371097691, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 135.98491978645325, "timestamp": 1559272272, "episode_len_mean": 325.0, "iterations_since_restore": 14, "training_iteration": 54, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e1e0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ee18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e510>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-11-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.8787699467382, "outflow_rate_min": 845.8954760133594, "system_level_velocity_max": 18.38189855976751, "cost2_min": -140.25221383034807, "cost1_mean": 176.02557170442878, "system_level_velocity_min": 12.458382505324657, "cost2_max": -106.38356037365342, "cost1_min": 148.69190734340071, "cost2_mean": -125.73122626735854, "discrim_loss": 0.8146036863327026, "outflow_rate_mean": 929.3394904786908, "system_level_velocity_mean": 14.728205428080553, "cost1_max": 217.55534649488516}}
{"sampler_perf": {"mean_inference_ms": 7.574994157463976, "mean_processing_ms": 10.833093664330919, "mean_env_wait_ms": 141.5850625369391}, "policy_reward_mean": {}, "time_since_restore": 2083.8546710014343, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1270, "time_total_s": 7285.718189716339, "episode_reward_max": 608.0726535655558, "off_policy_estimator": {}, "episode_reward_min": 306.54099679738283, "episode_reward_mean": 398.4867335057684, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.35707807540894, "timestamp": 1559272407, "episode_len_mean": 325.0, "iterations_since_restore": 15, "training_iteration": 55, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b9268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b91e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b90d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b9158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-13-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1073.7351728112794, "outflow_rate_min": 807.0721909867445, "system_level_velocity_max": 18.25274469746718, "cost2_min": -146.1917817801576, "cost1_mean": 174.7229017781496, "system_level_velocity_min": 12.120145724154149, "cost2_max": -106.32671021988835, "cost1_min": 142.9080676832756, "cost2_mean": -127.7760828436108, "discrim_loss": 0.7677313089370728, "outflow_rate_mean": 922.3735929668414, "system_level_velocity_mean": 14.604159892944784, "cost1_max": 216.0660313529196}}
{"sampler_perf": {"mean_inference_ms": 7.58778604089353, "mean_processing_ms": 10.860330012202756, "mean_env_wait_ms": 141.6396685186471}, "policy_reward_mean": {}, "time_since_restore": 2220.5424630641937, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1292, "time_total_s": 7422.4059817790985, "episode_reward_max": 538.8709751181304, "off_policy_estimator": {}, "episode_reward_min": 279.8270275965333, "episode_reward_mean": 356.75866479337725, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 136.6877920627594, "timestamp": 1559272544, "episode_len_mean": 325.0, "iterations_since_restore": 16, "training_iteration": 56, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ef28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ed90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ea60>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-15-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.1944201881247, "outflow_rate_min": 812.155373133677, "system_level_velocity_max": 18.004347864106983, "cost2_min": -137.56740113449683, "cost1_mean": 175.1374274612189, "system_level_velocity_min": 12.382568792511197, "cost2_max": -104.64819491693103, "cost1_min": 149.4571640296009, "cost2_mean": -126.23471721102986, "discrim_loss": 0.6762292385101318, "outflow_rate_mean": 925.6365885654815, "system_level_velocity_mean": 14.64378917245355, "cost1_max": 214.2348352297547}}
{"sampler_perf": {"mean_inference_ms": 7.568820441408773, "mean_processing_ms": 10.911924639844207, "mean_env_wait_ms": 141.2872161910442}, "policy_reward_mean": {}, "time_since_restore": 2354.5608372688293, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 1319, "time_total_s": 7556.424355983734, "episode_reward_max": 552.8712044134736, "off_policy_estimator": {}, "episode_reward_min": 261.85927089862525, "episode_reward_mean": 388.8819185817545, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.01837420463562, "timestamp": 1559272678, "episode_len_mean": 325.0, "iterations_since_restore": 17, "training_iteration": 57, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb400>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-17-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.0015381081969, "outflow_rate_min": 848.1451503986282, "system_level_velocity_max": 17.898510523971453, "cost2_min": -144.15381495615878, "cost1_mean": 188.74465828637065, "system_level_velocity_min": 13.087753547450973, "cost2_max": -107.89851455031501, "cost1_min": 157.975659974235, "cost2_mean": -122.1074394957915, "discrim_loss": 0.9020829200744629, "outflow_rate_mean": 972.3711819730416, "system_level_velocity_mean": 15.727601785445087, "cost1_max": 213.96383887111406}}
{"sampler_perf": {"mean_inference_ms": 7.5792774952474975, "mean_processing_ms": 10.922671422403932, "mean_env_wait_ms": 141.002340618793}, "policy_reward_mean": {}, "time_since_restore": 2484.003932952881, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 1342, "time_total_s": 7685.867451667786, "episode_reward_max": 481.1338107585907, "off_policy_estimator": {}, "episode_reward_min": 36.1022671982646, "episode_reward_mean": 285.974151997746, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.4430956840515, "timestamp": 1559272807, "episode_len_mean": 299.4347826086956, "iterations_since_restore": 18, "training_iteration": 58, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303247b8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303242f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-20-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.017834490649, "outflow_rate_min": 459.9158090748286, "system_level_velocity_max": 18.425088510537623, "cost2_min": -135.1196961429535, "cost1_mean": 168.4376240147901, "system_level_velocity_min": 12.912307432908129, "cost2_max": -19.257120569272764, "cost1_min": 17.774693793060653, "cost2_mean": -114.99797779365589, "discrim_loss": 0.8061102032661438, "outflow_rate_mean": 905.4278417001485, "system_level_velocity_mean": 15.412121158500819, "cost1_max": 212.81529813481126}}
{"sampler_perf": {"mean_inference_ms": 7.574560358756992, "mean_processing_ms": 10.936851998970045, "mean_env_wait_ms": 140.8083402271061}, "policy_reward_mean": {}, "time_since_restore": 2622.828536748886, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 1365, "time_total_s": 7824.692055463791, "episode_reward_max": 441.6062052473426, "off_policy_estimator": {}, "episode_reward_min": 191.81191793084145, "episode_reward_mean": 303.86043424910423, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 138.82460379600525, "timestamp": 1559272946, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 19, "training_iteration": 59, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035ec80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eb70>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-22-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1065.0686769743527, "outflow_rate_min": 729.8337696707905, "system_level_velocity_max": 18.44576044172676, "cost2_min": -147.3892301995705, "cost1_mean": 177.46339227804978, "system_level_velocity_min": 10.495843168995478, "cost2_max": -54.084866100969876, "cost1_min": 77.8380070604158, "cost2_mean": -119.16646293063715, "discrim_loss": 0.7841324210166931, "outflow_rate_mean": 937.1083784067947, "system_level_velocity_mean": 15.28279105127464, "cost1_max": 214.6083498647006}}
{"sampler_perf": {"mean_inference_ms": 7.561613353500911, "mean_processing_ms": 10.944840532878064, "mean_env_wait_ms": 141.03580342507013}, "policy_reward_mean": {}, "time_since_restore": 2755.2497272491455, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1391, "time_total_s": 7957.11324596405, "episode_reward_max": 522.7254718542099, "off_policy_estimator": {}, "episode_reward_min": 230.05295893363655, "episode_reward_mean": 325.8077109895217, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.4211905002594, "timestamp": 1559273079, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 60, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbf28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-24-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1068.5653720629048, "outflow_rate_min": 796.7839732481282, "system_level_velocity_max": 18.039745952079663, "cost2_min": -140.55853298720962, "cost1_mean": 178.48151603457535, "system_level_velocity_min": 12.1458548780846, "cost2_max": -104.85174611977689, "cost1_min": 145.15037100179183, "cost2_mean": -125.58607018362588, "discrim_loss": 0.7532104849815369, "outflow_rate_mean": 930.5684398426321, "system_level_velocity_mean": 14.825084942416456, "cost1_max": 213.04749646335986}}
{"sampler_perf": {"mean_inference_ms": 7.560305617525092, "mean_processing_ms": 10.961724194145507, "mean_env_wait_ms": 140.67805274642348}, "policy_reward_mean": {}, "time_since_restore": 2889.6497144699097, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1413, "time_total_s": 8091.513233184814, "episode_reward_max": 656.1191246062517, "off_policy_estimator": {}, "episode_reward_min": 276.8963599540293, "episode_reward_mean": 428.03428890801626, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.39998722076416, "timestamp": 1559273213, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 61, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-26-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.1471156893388, "outflow_rate_min": 787.0325082861542, "system_level_velocity_max": 17.73711165634844, "cost2_min": -145.05444098767572, "cost1_mean": 179.37569101157166, "system_level_velocity_min": 11.936278469499234, "cost2_max": -107.2492559135175, "cost1_min": 141.5430681947263, "cost2_mean": -124.04816068612772, "discrim_loss": 0.7489131689071655, "outflow_rate_mean": 934.0053637925267, "system_level_velocity_mean": 14.881277544623146, "cost1_max": 210.75530007315}}
{"sampler_perf": {"mean_inference_ms": 7.559184841923924, "mean_processing_ms": 10.96228773490095, "mean_env_wait_ms": 140.40807518530121}, "policy_reward_mean": {}, "time_since_restore": 3022.0733036994934, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1435, "time_total_s": 8223.936822414398, "episode_reward_max": 675.4521303027868, "off_policy_estimator": {}, "episode_reward_min": 331.57708218693733, "episode_reward_mean": 460.4735494566743, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.42358922958374, "timestamp": 1559273346, "episode_len_mean": 325.0, "iterations_since_restore": 22, "training_iteration": 62, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362ea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-29-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1064.5109956476676, "outflow_rate_min": 799.1866346296246, "system_level_velocity_max": 17.962422765087727, "cost2_min": -137.19821801268998, "cost1_mean": 185.4725123341466, "system_level_velocity_min": 12.11120495972355, "cost2_max": -105.80940298095247, "cost1_min": 144.50358849060365, "cost2_mean": -120.0877838127551, "discrim_loss": 0.7898637652397156, "outflow_rate_mean": 959.83576878649, "system_level_velocity_mean": 15.457777199537794, "cost1_max": 212.7216232102541}}
{"sampler_perf": {"mean_inference_ms": 7.552351631940065, "mean_processing_ms": 10.969792591545444, "mean_env_wait_ms": 140.75756035097803}, "policy_reward_mean": {}, "time_since_restore": 3156.031843662262, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1461, "time_total_s": 8357.895362377167, "episode_reward_max": 545.6353211253881, "off_policy_estimator": {}, "episode_reward_min": 43.619485944509506, "episode_reward_mean": 340.55363436888615, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.95853996276855, "timestamp": 1559273480, "episode_len_mean": 313.84615384615387, "iterations_since_restore": 23, "training_iteration": 63, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb0d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb950>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-31-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.8060958639376, "outflow_rate_min": 469.7268206731651, "system_level_velocity_max": 18.58832917697145, "cost2_min": -133.62771215452727, "cost1_mean": 175.4162478062816, "system_level_velocity_min": 13.608461241017707, "cost2_max": -25.218014432828735, "cost1_min": 23.180193754120303, "cost2_mean": -118.30897335682246, "discrim_loss": 0.7255579233169556, "outflow_rate_mean": 926.7258933871162, "system_level_velocity_mean": 15.231106221904865, "cost1_max": 212.3610412797145}}
{"sampler_perf": {"mean_inference_ms": 7.563897195335733, "mean_processing_ms": 10.964499485752123, "mean_env_wait_ms": 140.29575134065254}, "policy_reward_mean": {}, "time_since_restore": 3280.392773628235, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1483, "time_total_s": 8482.25629234314, "episode_reward_max": 492.21810307726264, "off_policy_estimator": {}, "episode_reward_min": 214.77808144129813, "episode_reward_mean": 304.6998479410752, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.3609299659729, "timestamp": 1559273604, "episode_len_mean": 325.0, "iterations_since_restore": 24, "training_iteration": 64, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-33-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.4822045087074, "outflow_rate_min": 853.1657476449142, "system_level_velocity_max": 17.897436455627254, "cost2_min": -140.28649795014448, "cost1_mean": 183.66232352756307, "system_level_velocity_min": 13.098180285541742, "cost2_max": -103.79898099167885, "cost1_min": 158.272366539552, "cost2_mean": -122.47447843342306, "discrim_loss": 0.7731949090957642, "outflow_rate_mean": 949.058714299385, "system_level_velocity_mean": 15.23117405158166, "cost1_max": 212.55305549913328}}
{"sampler_perf": {"mean_inference_ms": 7.569202256187324, "mean_processing_ms": 10.989153465671292, "mean_env_wait_ms": 140.3625870138668}, "policy_reward_mean": {}, "time_since_restore": 3415.272152900696, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1505, "time_total_s": 8617.1356716156, "episode_reward_max": 459.5123203303665, "off_policy_estimator": {}, "episode_reward_min": 186.24755144119263, "episode_reward_mean": 298.6724880636585, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.87937927246094, "timestamp": 1559273740, "episode_len_mean": 325.0, "iterations_since_restore": 25, "training_iteration": 65, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303627b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-35-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.5781969119926, "outflow_rate_min": 811.8557353455702, "system_level_velocity_max": 17.82045595601826, "cost2_min": -141.46101234139195, "cost1_mean": 182.83868895337454, "system_level_velocity_min": 12.12994292808104, "cost2_max": -104.85312496028288, "cost1_min": 143.97748935069097, "cost2_mean": -119.6918822121563, "discrim_loss": 0.7772774696350098, "outflow_rate_mean": 949.0434769060954, "system_level_velocity_mean": 15.18531963827046, "cost1_max": 211.5626683235293}}
{"sampler_perf": {"mean_inference_ms": 7.560442890315709, "mean_processing_ms": 11.002188097297239, "mean_env_wait_ms": 140.18013252856687}, "policy_reward_mean": {}, "time_since_restore": 3549.1398692131042, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1531, "time_total_s": 8751.003387928009, "episode_reward_max": 455.9198938878253, "off_policy_estimator": {}, "episode_reward_min": 191.41132445260882, "episode_reward_mean": 278.65800678060174, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 133.86771631240845, "timestamp": 1559273874, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 66, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303751e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-37-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.1076179981212, "outflow_rate_min": 846.6738663096303, "system_level_velocity_max": 17.65242719904286, "cost2_min": -134.5937905204143, "cost1_mean": 183.50474119811494, "system_level_velocity_min": 12.914569517557226, "cost2_max": -105.71284827100254, "cost1_min": 155.87989832423102, "cost2_mean": -121.60807054059258, "discrim_loss": 0.6437676548957825, "outflow_rate_mean": 948.6174913211308, "system_level_velocity_mean": 15.208481939137503, "cost1_max": 210.55574622783485}}
{"sampler_perf": {"mean_inference_ms": 7.573273215379133, "mean_processing_ms": 10.99153469698105, "mean_env_wait_ms": 139.94986717338418}, "policy_reward_mean": {}, "time_since_restore": 3676.757136106491, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1552, "time_total_s": 8878.620654821396, "episode_reward_max": 505.09574008733034, "off_policy_estimator": {}, "episode_reward_min": 217.79268413316458, "episode_reward_mean": 316.76859394418784, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.61726689338684, "timestamp": 1559274002, "episode_len_mean": 325.0, "iterations_since_restore": 27, "training_iteration": 67, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b2488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b2400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b22f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b2378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-40-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.737667786857, "outflow_rate_min": 844.9892603944917, "system_level_velocity_max": 17.78822265164777, "cost2_min": -141.3940108262772, "cost1_mean": 184.2350359106565, "system_level_velocity_min": 12.912314711579972, "cost2_max": -104.90324868469503, "cost1_min": 157.90301687769698, "cost2_mean": -122.18027579849957, "discrim_loss": 0.7450276613235474, "outflow_rate_mean": 950.1615943909796, "system_level_velocity_mean": 15.249395544223992, "cost1_max": 212.20108206989033}}
{"sampler_perf": {"mean_inference_ms": 7.56493716001708, "mean_processing_ms": 10.98459620073903, "mean_env_wait_ms": 139.56704652274692}, "policy_reward_mean": {}, "time_since_restore": 3808.855735063553, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1574, "time_total_s": 9010.719253778458, "episode_reward_max": 508.55877426080406, "off_policy_estimator": {}, "episode_reward_min": 241.11024841852486, "episode_reward_mean": 350.2119726386683, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.09859895706177, "timestamp": 1559274134, "episode_len_mean": 325.0, "iterations_since_restore": 28, "training_iteration": 68, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303242f0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303247b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-42-14", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.619325143148, "outflow_rate_min": 905.4374274864197, "system_level_velocity_max": 17.821077654182094, "cost2_min": -129.54828298089964, "cost1_mean": 188.7462243766633, "system_level_velocity_min": 14.244212260780355, "cost2_max": -104.94338116915489, "cost1_min": 172.3764675279412, "cost2_mean": -119.02769800265763, "discrim_loss": 0.7617272138595581, "outflow_rate_mean": 968.0361531319269, "system_level_velocity_mean": 15.630011640475255, "cost1_max": 211.40083558806717}}
{"sampler_perf": {"mean_inference_ms": 7.55882951750632, "mean_processing_ms": 10.984835060548162, "mean_env_wait_ms": 139.18535741148855}, "policy_reward_mean": {}, "time_since_restore": 3937.883801460266, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1596, "time_total_s": 9139.74732017517, "episode_reward_max": 427.35760054178536, "off_policy_estimator": {}, "episode_reward_min": 244.0635896665044, "episode_reward_mean": 332.28019809921864, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.02806639671326, "timestamp": 1559274263, "episode_len_mean": 325.0, "iterations_since_restore": 29, "training_iteration": 69, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-44-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.6598803979584, "outflow_rate_min": 842.2644481814253, "system_level_velocity_max": 17.719860090531093, "cost2_min": -139.78548712935446, "cost1_mean": 188.85350859256616, "system_level_velocity_min": 13.028943522526555, "cost2_max": -105.50027511321262, "cost1_min": 157.63323445547502, "cost2_mean": -118.36514976596791, "discrim_loss": 0.7674436569213867, "outflow_rate_mean": 967.695794843894, "system_level_velocity_mean": 15.636053807220863, "cost1_max": 209.4957469769012}}
{"sampler_perf": {"mean_inference_ms": 7.56533808686885, "mean_processing_ms": 11.001643627042585, "mean_env_wait_ms": 139.38124191340725}, "policy_reward_mean": {}, "time_since_restore": 4072.6332852840424, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1622, "time_total_s": 9274.496803998947, "episode_reward_max": 464.5227301940322, "off_policy_estimator": {}, "episode_reward_min": 205.78895605308935, "episode_reward_mean": 298.3452889721196, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 134.74948382377625, "timestamp": 1559274398, "episode_len_mean": 325.0, "iterations_since_restore": 30, "training_iteration": 70, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb0d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-46-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.3753938542475, "outflow_rate_min": 786.0463478762538, "system_level_velocity_max": 17.845448226696423, "cost2_min": -139.89089390643724, "cost1_mean": 186.05770675084466, "system_level_velocity_min": 12.090674561000753, "cost2_max": -103.37596309286405, "cost1_min": 148.0392258155531, "cost2_mean": -118.86623042320949, "discrim_loss": 0.7682645320892334, "outflow_rate_mean": 957.1972002958444, "system_level_velocity_mean": 15.419726475825216, "cost1_max": 211.08446771643338}}
{"sampler_perf": {"mean_inference_ms": 7.5516309489300975, "mean_processing_ms": 11.025054312429647, "mean_env_wait_ms": 138.9409780216136}, "policy_reward_mean": {}, "time_since_restore": 4197.98216509819, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1644, "time_total_s": 9399.845683813095, "episode_reward_max": 471.90815630648285, "off_policy_estimator": {}, "episode_reward_min": 227.82270644744858, "episode_reward_mean": 326.8992173976836, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.34887981414795, "timestamp": 1559274524, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 71, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbf28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-48-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.2298985803816, "outflow_rate_min": 793.2367311588936, "system_level_velocity_max": 17.898821010054917, "cost2_min": -132.61210843383424, "cost1_mean": 188.76777819465605, "system_level_velocity_min": 11.88903916729065, "cost2_max": -102.89246760819125, "cost1_min": 141.83614497489577, "cost2_mean": -116.99788715547798, "discrim_loss": 0.679661214351654, "outflow_rate_mean": 966.7547710343725, "system_level_velocity_mean": 15.663225375244268, "cost1_max": 211.21981927854185}}
{"sampler_perf": {"mean_inference_ms": 7.545320576744515, "mean_processing_ms": 11.01886115066265, "mean_env_wait_ms": 138.78604978348156}, "policy_reward_mean": {}, "time_since_restore": 4325.202838420868, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1666, "time_total_s": 9527.066357135773, "episode_reward_max": 463.7786071076989, "off_policy_estimator": {}, "episode_reward_min": 226.6391914561391, "episode_reward_mean": 316.9384678085229, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.22067332267761, "timestamp": 1559274651, "episode_len_mean": 325.0, "iterations_since_restore": 32, "training_iteration": 72, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364ea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-50-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.5333372482532, "outflow_rate_min": 798.7338413476201, "system_level_velocity_max": 17.781735879548386, "cost2_min": -138.84064908372454, "cost1_mean": 182.8432759844651, "system_level_velocity_min": 12.20359612854649, "cost2_max": -103.03859581338259, "cost1_min": 147.10840609811194, "cost2_mean": -120.14813488409968, "discrim_loss": 0.7428654432296753, "outflow_rate_mean": 943.3569536823842, "system_level_velocity_mean": 15.12378520599937, "cost1_max": 211.2692226045918}}
{"sampler_perf": {"mean_inference_ms": 7.554647847773645, "mean_processing_ms": 11.043301727173475, "mean_env_wait_ms": 138.69244642733662}, "policy_reward_mean": {}, "time_since_restore": 4448.830155134201, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1692, "time_total_s": 9650.693673849106, "episode_reward_max": 403.03707670560107, "off_policy_estimator": {}, "episode_reward_min": 216.14876926667057, "episode_reward_mean": 298.2893224977978, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.62731671333313, "timestamp": 1559274778, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 73, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303249d8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324bf8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-52-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.9934064113431, "outflow_rate_min": 841.6641870301203, "system_level_velocity_max": 17.898520637262063, "cost2_min": -133.70575784628204, "cost1_mean": 191.63215909064877, "system_level_velocity_min": 12.925909500526927, "cost2_max": -102.84900371862933, "cost1_min": 156.25919634624228, "cost2_mean": -115.68096383552276, "discrim_loss": 0.7603532075881958, "outflow_rate_mean": 978.6031923126895, "system_level_velocity_mean": 15.900031573267102, "cost1_max": 211.8683982674329}}
{"sampler_perf": {"mean_inference_ms": 7.543625566054857, "mean_processing_ms": 11.013592836019276, "mean_env_wait_ms": 138.07763440176666}, "policy_reward_mean": {}, "time_since_restore": 4569.585636615753, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 1713, "time_total_s": 9771.449155330658, "episode_reward_max": 320.3393910676241, "off_policy_estimator": {}, "episode_reward_min": 187.73955006431788, "episode_reward_mean": 229.17885210495885, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.75548148155212, "timestamp": 1559274899, "episode_len_mean": 325.0, "iterations_since_restore": 34, "training_iteration": 74, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbe18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb9d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-54-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.1826648679362, "outflow_rate_min": 846.3716773119666, "system_level_velocity_max": 17.35904981064524, "cost2_min": -129.83181869817852, "cost1_mean": 182.77909343202947, "system_level_velocity_min": 12.737383722706788, "cost2_max": -107.26450713054476, "cost1_min": 155.3986483019534, "cost2_mean": -120.09640090405662, "discrim_loss": 0.6857095956802368, "outflow_rate_mean": 943.3784743798701, "system_level_velocity_mean": 15.060917003749426, "cost1_max": 206.2964788512771}}
{"sampler_perf": {"mean_inference_ms": 7.5490631559568575, "mean_processing_ms": 11.043714358646831, "mean_env_wait_ms": 138.03932315701576}, "policy_reward_mean": {}, "time_since_restore": 4702.0811858177185, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 1736, "time_total_s": 9903.944704532623, "episode_reward_max": 383.4110941393301, "off_policy_estimator": {}, "episode_reward_min": 170.32407883927226, "episode_reward_mean": 278.43322308729506, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.49554920196533, "timestamp": 1559275035, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 75, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362510>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-57-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.8921032321991, "outflow_rate_min": 843.255073768648, "system_level_velocity_max": 17.941028166624058, "cost2_min": -130.82815102432176, "cost1_mean": 186.6675320030258, "system_level_velocity_min": 12.871063454562494, "cost2_max": -103.62823776700117, "cost1_min": 155.5456056787026, "cost2_mean": -116.27276355847141, "discrim_loss": 0.7137022018432617, "outflow_rate_mean": 964.2841571433496, "system_level_velocity_mean": 15.51562629795169, "cost1_max": 212.36294850671717}}
{"sampler_perf": {"mean_inference_ms": 7.5507262607737085, "mean_processing_ms": 11.031959611819163, "mean_env_wait_ms": 137.9962245620033}, "policy_reward_mean": {}, "time_since_restore": 4828.933809757233, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 1761, "time_total_s": 10030.797328472137, "episode_reward_max": 441.3536330140196, "off_policy_estimator": {}, "episode_reward_min": 225.5972349359654, "episode_reward_mean": 344.44174039976207, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.85262393951416, "timestamp": 1559275162, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 76, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303629d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362b70>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_03-59-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.68983972109, "outflow_rate_min": 851.5769071197943, "system_level_velocity_max": 17.59972338923613, "cost2_min": -130.98259327424154, "cost1_mean": 187.15425571332383, "system_level_velocity_min": 12.882251191615243, "cost2_max": -104.26246696715901, "cost1_min": 158.10442361814813, "cost2_mean": -116.61508165981769, "discrim_loss": 0.6732709407806396, "outflow_rate_mean": 960.8370044246786, "system_level_velocity_mean": 15.46330173196257, "cost1_max": 209.1923061663943}}
{"sampler_perf": {"mean_inference_ms": 7.553130553350505, "mean_processing_ms": 11.034758087903448, "mean_env_wait_ms": 137.57844246542754}, "policy_reward_mean": {}, "time_since_restore": 4958.345880270004, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1783, "time_total_s": 10160.209398984909, "episode_reward_max": 478.81870627310127, "off_policy_estimator": {}, "episode_reward_min": 238.55361428880133, "episode_reward_mean": 323.1387014764742, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 129.4120705127716, "timestamp": 1559275291, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 77, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbd08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bba60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbbf8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-01-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.961382496618, "outflow_rate_min": 877.487271239821, "system_level_velocity_max": 17.846726410168195, "cost2_min": -123.89817515268257, "cost1_mean": 189.84060268884267, "system_level_velocity_min": 13.29708788268904, "cost2_max": -103.33012708749916, "cost1_min": 163.39663588633246, "cost2_mean": -114.0621567627512, "discrim_loss": 0.7393600940704346, "outflow_rate_mean": 970.0503755777139, "system_level_velocity_mean": 15.683775278124527, "cost1_max": 211.35956911488137}}
{"sampler_perf": {"mean_inference_ms": 7.545297840183786, "mean_processing_ms": 11.042692342256789, "mean_env_wait_ms": 137.52827874248595}, "policy_reward_mean": {}, "time_since_restore": 5085.791392564774, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1805, "time_total_s": 10287.654911279678, "episode_reward_max": 421.4732329370454, "off_policy_estimator": {}, "episode_reward_min": 234.47274874080904, "episode_reward_mean": 283.59046822794795, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.44551229476929, "timestamp": 1559275419, "episode_len_mean": 325.0, "iterations_since_restore": 38, "training_iteration": 78, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-03-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.467351157541, "outflow_rate_min": 863.828335649028, "system_level_velocity_max": 17.731607152126223, "cost2_min": -121.03415813470998, "cost1_mean": 188.37049118354233, "system_level_velocity_min": 13.148007521985441, "cost2_max": -101.73396542838233, "cost1_min": 160.9649069024594, "cost2_mean": -111.43487826882269, "discrim_loss": 0.7885504364967346, "outflow_rate_mean": 965.0006684617813, "system_level_velocity_mean": 15.566123622424819, "cost1_max": 209.96676471779875}}
{"sampler_perf": {"mean_inference_ms": 7.555309031469881, "mean_processing_ms": 11.05036503623735, "mean_env_wait_ms": 137.31990397828307}, "policy_reward_mean": {}, "time_since_restore": 5218.586159944534, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 27, "episodes_total": 1832, "time_total_s": 10420.449678659439, "episode_reward_max": 460.1799481061753, "off_policy_estimator": {}, "episode_reward_min": 26.440703757107258, "episode_reward_mean": 258.2811710085651, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 132.79476737976074, "timestamp": 1559275551, "episode_len_mean": 314.44444444444446, "iterations_since_restore": 39, "training_iteration": 79, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4d90>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4c80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-05-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.2983920092756, "outflow_rate_min": 500.92659464537064, "system_level_velocity_max": 18.53655630774345, "cost2_min": -121.4539803305626, "cost1_mean": 183.67500127240044, "system_level_velocity_min": 12.297932635211913, "cost2_max": -24.25551079021853, "cost1_min": 26.197455949659435, "cost2_mean": -106.40622615920087, "discrim_loss": 0.7518614530563354, "outflow_rate_mean": 955.6731250703594, "system_level_velocity_mean": 15.865413804490105, "cost1_max": 209.66630223127487}}
{"sampler_perf": {"mean_inference_ms": 7.564927577852486, "mean_processing_ms": 11.06067543847086, "mean_env_wait_ms": 137.09807406121698}, "policy_reward_mean": {}, "time_since_restore": 5339.0934364795685, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1854, "time_total_s": 10540.956955194473, "episode_reward_max": 964.7207037148764, "off_policy_estimator": {}, "episode_reward_min": 24.747967839241028, "episode_reward_mean": 327.458273214505, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.50727653503418, "timestamp": 1559275672, "episode_len_mean": 311.90909090909093, "iterations_since_restore": 40, "training_iteration": 80, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303658c8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-07-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.346444398459, "outflow_rate_min": 475.4385119415045, "system_level_velocity_max": 18.675893039286812, "cost2_min": -117.95632653497633, "cost1_mean": 183.90515525139892, "system_level_velocity_min": 11.954824899245562, "cost2_max": -25.975727550037835, "cost1_min": 24.420688011527638, "cost2_mean": -103.6342852840919, "discrim_loss": 0.850441575050354, "outflow_rate_mean": 957.3858928274789, "system_level_velocity_mean": 16.048681536710856, "cost1_max": 209.83842181630666}}
{"sampler_perf": {"mean_inference_ms": 7.552394896588769, "mean_processing_ms": 11.067710123147249, "mean_env_wait_ms": 136.70790651952214}, "policy_reward_mean": {}, "time_since_restore": 5461.569891691208, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1876, "time_total_s": 10663.433410406113, "episode_reward_max": 517.0869914088398, "off_policy_estimator": {}, "episode_reward_min": 239.79030627256725, "episode_reward_mean": 307.8125803347582, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.4764552116394, "timestamp": 1559275795, "episode_len_mean": 325.0, "iterations_since_restore": 41, "training_iteration": 81, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362b70>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303629d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362a60>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-09-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1049.775536963997, "outflow_rate_min": 858.7105659860458, "system_level_velocity_max": 17.66968524180075, "cost2_min": -116.71360752850356, "cost1_mean": 191.77194291062054, "system_level_velocity_min": 13.024762351600984, "cost2_max": -101.89569580764534, "cost1_min": 160.04226121750636, "cost2_mean": -107.91484840623225, "discrim_loss": 0.7068636417388916, "outflow_rate_mean": 980.6507617695846, "system_level_velocity_mean": 15.920875005053482, "cost1_max": 209.33581582702737}}
{"sampler_perf": {"mean_inference_ms": 7.556309343558505, "mean_processing_ms": 11.059215273644192, "mean_env_wait_ms": 136.5560608378364}, "policy_reward_mean": {}, "time_since_restore": 5581.303355932236, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1898, "time_total_s": 10783.16687464714, "episode_reward_max": 749.3608292732388, "off_policy_estimator": {}, "episode_reward_min": 230.89474695012905, "episode_reward_mean": 338.7387892873217, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.73346424102783, "timestamp": 1559275914, "episode_len_mean": 325.0, "iterations_since_restore": 42, "training_iteration": 82, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b46a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-11-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1041.1416074449032, "outflow_rate_min": 801.8682347364187, "system_level_velocity_max": 17.293108919056206, "cost2_min": -114.93532931980467, "cost1_mean": 182.695430277399, "system_level_velocity_min": 12.05584385459441, "cost2_max": -100.74459596619224, "cost1_min": 146.04174638670122, "cost2_mean": -108.80522562177602, "discrim_loss": 0.8193917274475098, "outflow_rate_mean": 945.2972615232264, "system_level_velocity_mean": 15.084522123161065, "cost1_max": 206.5356414851779}}
{"sampler_perf": {"mean_inference_ms": 7.576159159461488, "mean_processing_ms": 11.057543724381729, "mean_env_wait_ms": 136.68921795116728}, "policy_reward_mean": {}, "time_since_restore": 5706.432878732681, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 1924, "time_total_s": 10908.296397447586, "episode_reward_max": 766.6326688975096, "off_policy_estimator": {}, "episode_reward_min": 224.38343633851036, "episode_reward_mean": 317.37575955790146, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.12952280044556, "timestamp": 1559276044, "episode_len_mean": 324.34615384615387, "iterations_since_restore": 43, "training_iteration": 83, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4268>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-14-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.0834515241763, "outflow_rate_min": 853.1541757173134, "system_level_velocity_max": 17.691583688314203, "cost2_min": -115.08712592611163, "cost1_mean": 186.31395603361125, "system_level_velocity_min": 12.640680068402967, "cost2_max": -96.37164616225795, "cost1_min": 154.78064876337697, "cost2_mean": -106.4515275540995, "discrim_loss": 0.7966722249984741, "outflow_rate_mean": 961.4849824535904, "system_level_velocity_mean": 15.444803131742066, "cost1_max": 208.65887691356133}}
{"sampler_perf": {"mean_inference_ms": 7.578026702879172, "mean_processing_ms": 11.108140997212871, "mean_env_wait_ms": 136.3182583961001}, "policy_reward_mean": {}, "time_since_restore": 5833.220527648926, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 1947, "time_total_s": 11035.08404636383, "episode_reward_max": 892.579613052425, "off_policy_estimator": {}, "episode_reward_min": 30.058474391698837, "episode_reward_mean": 358.15031839945635, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.7876489162445, "timestamp": 1559276170, "episode_len_mean": 312.4782608695652, "iterations_since_restore": 44, "training_iteration": 84, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930348950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303488c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303487b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-16-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1052.7759912542795, "outflow_rate_min": 507.35127965118886, "system_level_velocity_max": 18.949994223552178, "cost2_min": -113.91499519737025, "cost1_mean": 176.5913198151588, "system_level_velocity_min": 12.740605036208699, "cost2_max": -23.213568239979864, "cost1_min": 24.63489095263097, "cost2_mean": -103.25993520834622, "discrim_loss": 0.7754725217819214, "outflow_rate_mean": 930.981724655123, "system_level_velocity_mean": 15.334727954499911, "cost1_max": 208.9032414515636}}
{"sampler_perf": {"mean_inference_ms": 7.574928811843072, "mean_processing_ms": 11.08616475372001, "mean_env_wait_ms": 136.11545969209286}, "policy_reward_mean": {}, "time_since_restore": 5958.883090019226, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 1969, "time_total_s": 11160.74660873413, "episode_reward_max": 803.2148889607051, "off_policy_estimator": {}, "episode_reward_min": 242.03593288979027, "episode_reward_mean": 324.45543528866784, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.6625623703003, "timestamp": 1559276296, "episode_len_mean": 325.0, "iterations_since_restore": 45, "training_iteration": 85, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-18-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.9984677183409, "outflow_rate_min": 809.530186575547, "system_level_velocity_max": 17.39247569227213, "cost2_min": -113.88071467806057, "cost1_mean": 188.26850002003212, "system_level_velocity_min": 12.062184936242298, "cost2_max": -98.94926860906887, "cost1_min": 147.25751596134717, "cost2_mean": -106.36296484454925, "discrim_loss": 0.7839696407318115, "outflow_rate_mean": 969.1240367967956, "system_level_velocity_mean": 15.632419040057009, "cost1_max": 206.42265387948606}}
{"sampler_perf": {"mean_inference_ms": 7.582339310603903, "mean_processing_ms": 11.071294438911174, "mean_env_wait_ms": 136.2030458487634}, "policy_reward_mean": {}, "time_since_restore": 6086.029288768768, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 1994, "time_total_s": 11287.892807483673, "episode_reward_max": 668.3185543237487, "off_policy_estimator": {}, "episode_reward_min": 197.8427345736418, "episode_reward_mean": 296.0679282712727, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.14619874954224, "timestamp": 1559276423, "episode_len_mean": 325.0, "iterations_since_restore": 46, "training_iteration": 86, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b46a8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-20-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.114205797776, "outflow_rate_min": 795.3447257803036, "system_level_velocity_max": 17.326440270634624, "cost2_min": -112.45089468415298, "cost1_mean": 186.32286555641068, "system_level_velocity_min": 11.82728799621562, "cost2_max": -94.97177537382848, "cost1_min": 143.11645555683626, "cost2_mean": -104.86860885314755, "discrim_loss": 0.7175880074501038, "outflow_rate_mean": 962.4415314487103, "system_level_velocity_mean": 15.449565366506114, "cost1_max": 205.7976199891997}}
{"sampler_perf": {"mean_inference_ms": 7.58994912787987, "mean_processing_ms": 11.09658840032103, "mean_env_wait_ms": 135.84999881622159}, "policy_reward_mean": {}, "time_since_restore": 6205.202209472656, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2016, "time_total_s": 11407.065728187561, "episode_reward_max": 627.4901854614727, "off_policy_estimator": {}, "episode_reward_min": 203.98373474692926, "episode_reward_mean": 296.6219864299082, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.17292070388794, "timestamp": 1559276543, "episode_len_mean": 325.0, "iterations_since_restore": 47, "training_iteration": 87, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-22-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.471108355395, "outflow_rate_min": 865.2693441511813, "system_level_velocity_max": 17.725920566133322, "cost2_min": -111.81736502936347, "cost1_mean": 186.2680926926767, "system_level_velocity_min": 12.870445390924603, "cost2_max": -98.82199226316094, "cost1_min": 156.93971481584433, "cost2_mean": -103.73237874748392, "discrim_loss": 0.8112804293632507, "outflow_rate_mean": 963.8696271391108, "system_level_velocity_mean": 15.458180379494221, "cost1_max": 209.37618951244414}}
{"sampler_perf": {"mean_inference_ms": 7.582899723740366, "mean_processing_ms": 11.117998122860275, "mean_env_wait_ms": 135.6436178678225}, "policy_reward_mean": {}, "time_since_restore": 6325.786212205887, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2039, "time_total_s": 11527.649730920792, "episode_reward_max": 571.8620463089319, "off_policy_estimator": {}, "episode_reward_min": 225.2001561744837, "episode_reward_mean": 314.2378621779853, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.58400273323059, "timestamp": 1559276663, "episode_len_mean": 325.0, "iterations_since_restore": 48, "training_iteration": 88, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-24-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.9734844541797, "outflow_rate_min": 881.0049943606227, "system_level_velocity_max": 17.54013086366759, "cost2_min": -107.07351258494558, "cost1_mean": 188.63236524267478, "system_level_velocity_min": 13.232806672104315, "cost2_max": -98.62291466173986, "cost1_min": 160.4897883451663, "cost2_mean": -101.81638701854898, "discrim_loss": 0.807979941368103, "outflow_rate_mean": 974.402896672601, "system_level_velocity_mean": 15.694446986505639, "cost1_max": 207.20208136184567}}
{"sampler_perf": {"mean_inference_ms": 7.590861598069992, "mean_processing_ms": 11.094394645363261, "mean_env_wait_ms": 135.53580401577423}, "policy_reward_mean": {}, "time_since_restore": 6449.5450575351715, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2063, "time_total_s": 11651.408576250076, "episode_reward_max": 672.2278130450286, "off_policy_estimator": {}, "episode_reward_min": 237.39520833373535, "episode_reward_mean": 353.51460740468127, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.75884532928467, "timestamp": 1559276787, "episode_len_mean": 325.0, "iterations_since_restore": 49, "training_iteration": 89, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324488>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-26-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.155492239041, "outflow_rate_min": 805.5370422012952, "system_level_velocity_max": 17.57948417652365, "cost2_min": -104.82423563309533, "cost1_mean": 187.61544218805588, "system_level_velocity_min": 12.248310441046556, "cost2_max": -89.54066789492991, "cost1_min": 146.27468615669642, "cost2_mean": -100.19695000818994, "discrim_loss": 0.8054844737052917, "outflow_rate_mean": 973.0871003229189, "system_level_velocity_mean": 15.67717873138075, "cost1_max": 207.74565325414105}}
{"sampler_perf": {"mean_inference_ms": 7.599254025894432, "mean_processing_ms": 11.11471879690455, "mean_env_wait_ms": 135.1088356451546}, "policy_reward_mean": {}, "time_since_restore": 6564.930554628372, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2086, "time_total_s": 11766.794073343277, "episode_reward_max": 582.04475645395, "off_policy_estimator": {}, "episode_reward_min": 218.95114104263484, "episode_reward_mean": 344.5514756356994, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.38549709320068, "timestamp": 1559276902, "episode_len_mean": 325.0, "iterations_since_restore": 50, "training_iteration": 90, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b81e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b80d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b8158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-28-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.2636239003757, "outflow_rate_min": 840.5237384246799, "system_level_velocity_max": 17.71204626085557, "cost2_min": -102.77175495490036, "cost1_mean": 186.40196933444975, "system_level_velocity_min": 12.921931454861975, "cost2_max": -88.91255745660196, "cost1_min": 154.86387332391985, "cost2_mean": -98.45559330886857, "discrim_loss": 0.8380588889122009, "outflow_rate_mean": 967.4181337950507, "system_level_velocity_mean": 15.57578366762428, "cost1_max": 208.62144517373318}}
{"sampler_perf": {"mean_inference_ms": 7.5901462775638455, "mean_processing_ms": 11.135623483537847, "mean_env_wait_ms": 134.9602048583591}, "policy_reward_mean": {}, "time_since_restore": 6681.476495981216, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2109, "time_total_s": 11883.340014696121, "episode_reward_max": 641.2297028363682, "off_policy_estimator": {}, "episode_reward_min": 16.408752761781216, "episode_reward_mean": 336.12465816572734, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.54594135284424, "timestamp": 1559277019, "episode_len_mean": 311.5217391304348, "iterations_since_restore": 51, "training_iteration": 91, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-30-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.8143041943233, "outflow_rate_min": 469.7268206731651, "system_level_velocity_max": 18.604193256848557, "cost2_min": -101.55982314360044, "cost1_mean": 177.48799767081434, "system_level_velocity_min": 11.974878656555003, "cost2_max": -25.241737270487338, "cost1_min": 23.20006112492036, "cost2_mean": -92.96720005701671, "discrim_loss": 0.7924760580062866, "outflow_rate_mean": 941.3701846477849, "system_level_velocity_mean": 15.628499112222363, "cost1_max": 206.31223893746142}}
{"sampler_perf": {"mean_inference_ms": 7.582144843245503, "mean_processing_ms": 11.112928506652592, "mean_env_wait_ms": 134.68392642160975}, "policy_reward_mean": {}, "time_since_restore": 6796.913990974426, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 2134, "time_total_s": 11998.777509689331, "episode_reward_max": 648.9777125484543, "off_policy_estimator": {}, "episode_reward_min": 208.4528651572764, "episode_reward_mean": 281.35979686351493, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.43749499320984, "timestamp": 1559277135, "episode_len_mean": 325.0, "iterations_since_restore": 52, "training_iteration": 92, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348ea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-32-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.8577901365613, "outflow_rate_min": 794.8143507238716, "system_level_velocity_max": 17.671372239332346, "cost2_min": -103.29895155430816, "cost1_mean": 191.22654152778188, "system_level_velocity_min": 11.789926653095367, "cost2_max": -80.96299294672671, "cost1_min": 139.85666982082836, "cost2_mean": -98.10427039330202, "discrim_loss": 0.7722064256668091, "outflow_rate_mean": 985.4140888390144, "system_level_velocity_mean": 16.03447132591258, "cost1_max": 207.8824100709059}}
{"sampler_perf": {"mean_inference_ms": 7.589638754311917, "mean_processing_ms": 11.111349267156173, "mean_env_wait_ms": 134.31610796424147}, "policy_reward_mean": {}, "time_since_restore": 6908.758177518845, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2156, "time_total_s": 12110.62169623375, "episode_reward_max": 504.1326226107776, "off_policy_estimator": {}, "episode_reward_min": 220.83525535045192, "episode_reward_mean": 287.45785416335144, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.84418654441833, "timestamp": 1559277247, "episode_len_mean": 324.09090909090907, "iterations_since_restore": 53, "training_iteration": 93, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-34-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.9803281036384, "outflow_rate_min": 837.8113175947584, "system_level_velocity_max": 17.611490065227038, "cost2_min": -103.98356188136297, "cost1_mean": 187.36233450767347, "system_level_velocity_min": 12.648976782995776, "cost2_max": -88.74337681689772, "cost1_min": 151.1212485618405, "cost2_mean": -97.64680779102946, "discrim_loss": 0.7646166682243347, "outflow_rate_mean": 974.334910807486, "system_level_velocity_mean": 15.751661531345485, "cost1_max": 207.3274172621778}}
{"sampler_perf": {"mean_inference_ms": 7.593445017476987, "mean_processing_ms": 11.143638540794141, "mean_env_wait_ms": 134.30394773989684}, "policy_reward_mean": {}, "time_since_restore": 7026.569334030151, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2178, "time_total_s": 12228.432852745056, "episode_reward_max": 535.9393450031057, "off_policy_estimator": {}, "episode_reward_min": 217.68747496418655, "episode_reward_mean": 317.7791791775142, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.81115651130676, "timestamp": 1559277364, "episode_len_mean": 325.0, "iterations_since_restore": 54, "training_iteration": 94, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-36-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.1953491964457, "outflow_rate_min": 859.5152893577819, "system_level_velocity_max": 17.542177678008866, "cost2_min": -103.37833320201145, "cost1_mean": 184.8645443269572, "system_level_velocity_min": 12.725985913957887, "cost2_max": -89.13425551619096, "cost1_min": 154.7618131250723, "cost2_mean": -97.60639117960979, "discrim_loss": 0.7768409252166748, "outflow_rate_mean": 966.0322619639464, "system_level_velocity_mean": 15.436715117840826, "cost1_max": 207.59606160543558}}
{"sampler_perf": {"mean_inference_ms": 7.58903907103672, "mean_processing_ms": 11.134100583680816, "mean_env_wait_ms": 133.95474619247506}, "policy_reward_mean": {}, "time_since_restore": 7142.929784536362, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2201, "time_total_s": 12344.793303251266, "episode_reward_max": 393.37949957093224, "off_policy_estimator": {}, "episode_reward_min": 190.51081503741443, "episode_reward_mean": 264.277312548783, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.36045050621033, "timestamp": 1559277485, "episode_len_mean": 325.0, "iterations_since_restore": 55, "training_iteration": 95, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8b70>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b89d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-38-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.5829787068706, "outflow_rate_min": 857.297206635415, "system_level_velocity_max": 17.71870935632987, "cost2_min": -103.4323692925345, "cost1_mean": 184.29257494137246, "system_level_velocity_min": 12.89606642717593, "cost2_max": -89.88475918839754, "cost1_min": 155.57386200006715, "cost2_mean": -98.50159068721007, "discrim_loss": 0.7559906244277954, "outflow_rate_mean": 963.4815734789826, "system_level_velocity_mean": 15.411974290139407, "cost1_max": 208.42906368932438}}
{"sampler_perf": {"mean_inference_ms": 7.593751723549314, "mean_processing_ms": 11.118566459713799, "mean_env_wait_ms": 133.92914552792215}, "policy_reward_mean": {}, "time_since_restore": 7260.644037723541, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2225, "time_total_s": 12462.507556438446, "episode_reward_max": 384.44059341889806, "off_policy_estimator": {}, "episode_reward_min": 176.18470031255856, "episode_reward_mean": 258.45683987867477, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.71425318717957, "timestamp": 1559277602, "episode_len_mean": 325.0, "iterations_since_restore": 56, "training_iteration": 96, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-40-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.7772065769611, "outflow_rate_min": 823.1055609750092, "system_level_velocity_max": 17.531014193312586, "cost2_min": -104.2919609121611, "cost1_mean": 185.4400656488157, "system_level_velocity_min": 12.20928657384033, "cost2_max": -87.47524774193006, "cost1_min": 147.17596592581418, "cost2_mean": -98.12658885973049, "discrim_loss": 0.6864952445030212, "outflow_rate_mean": 966.1518145805121, "system_level_velocity_mean": 15.548754650762774, "cost1_max": 206.5681863030417}}
{"sampler_perf": {"mean_inference_ms": 7.598526019369704, "mean_processing_ms": 11.14794727909407, "mean_env_wait_ms": 133.7180407205246}, "policy_reward_mean": {}, "time_since_restore": 7378.873091220856, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2248, "time_total_s": 12580.73660993576, "episode_reward_max": 413.5705943987705, "off_policy_estimator": {}, "episode_reward_min": 230.15749561414123, "episode_reward_mean": 279.91448533934357, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.22905349731445, "timestamp": 1559277721, "episode_len_mean": 325.0, "iterations_since_restore": 57, "training_iteration": 97, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd1e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-42-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.526435419792, "outflow_rate_min": 861.4719420159157, "system_level_velocity_max": 17.783641833636516, "cost2_min": -105.97341953179907, "cost1_mean": 184.8918616517264, "system_level_velocity_min": 13.145762044759598, "cost2_max": -94.19391693356219, "cost1_min": 157.39525603168175, "cost2_mean": -100.7915677134512, "discrim_loss": 0.7271042466163635, "outflow_rate_mean": 961.3066582955088, "system_level_velocity_mean": 15.390848845821013, "cost1_max": 209.4123840856097}}
{"sampler_perf": {"mean_inference_ms": 7.591883569753347, "mean_processing_ms": 11.13413072094812, "mean_env_wait_ms": 133.44345853233997}, "policy_reward_mean": {}, "time_since_restore": 7494.391400814056, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2270, "time_total_s": 12696.254919528961, "episode_reward_max": 385.7346716616303, "off_policy_estimator": {}, "episode_reward_min": 213.2698151343502, "episode_reward_mean": 268.7069260256407, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.51830959320068, "timestamp": 1559277836, "episode_len_mean": 325.0, "iterations_since_restore": 58, "training_iteration": 98, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324f28>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-43-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.0845494939683, "outflow_rate_min": 852.3372704854846, "system_level_velocity_max": 17.81105880479412, "cost2_min": -105.91398817512345, "cost1_mean": 190.48905694977992, "system_level_velocity_min": 12.936962821852806, "cost2_max": -87.36814612667456, "cost1_min": 154.31344655919406, "cost2_mean": -99.06317898630408, "discrim_loss": 0.709100604057312, "outflow_rate_mean": 981.682650293294, "system_level_velocity_mean": 15.949112504973725, "cost1_max": 209.2870674193202}}
{"sampler_perf": {"mean_inference_ms": 7.598087489840669, "mean_processing_ms": 11.128664098188208, "mean_env_wait_ms": 133.45097689436685}, "policy_reward_mean": {}, "time_since_restore": 7614.22856760025, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 2295, "time_total_s": 12816.092086315155, "episode_reward_max": 411.0325609185966, "off_policy_estimator": {}, "episode_reward_min": 215.0140927694738, "episode_reward_mean": 258.5758178367815, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.83716678619385, "timestamp": 1559277956, "episode_len_mean": 325.0, "iterations_since_restore": 59, "training_iteration": 99, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b86a8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-45-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.2072355841756, "outflow_rate_min": 810.4117906648509, "system_level_velocity_max": 17.745614871796935, "cost2_min": -105.46122352968749, "cost1_mean": 188.62759443016483, "system_level_velocity_min": 12.094417330821694, "cost2_max": -86.12213182582653, "cost1_min": 144.40122561879173, "cost2_mean": -99.56185456955272, "discrim_loss": 0.6816507577896118, "outflow_rate_mean": 975.8218987359038, "system_level_velocity_mean": 15.774688384988428, "cost1_max": 209.03922950064765}}
{"sampler_perf": {"mean_inference_ms": 7.604983634782042, "mean_processing_ms": 11.151417577729624, "mean_env_wait_ms": 133.15132199111767}, "policy_reward_mean": {}, "time_since_restore": 7730.008951663971, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2317, "time_total_s": 12931.872470378876, "episode_reward_max": 428.4228979703039, "off_policy_estimator": {}, "episode_reward_min": 213.3666280657053, "episode_reward_mean": 278.1917220329633, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.7803840637207, "timestamp": 1559278072, "episode_len_mean": 325.0, "iterations_since_restore": 60, "training_iteration": 100, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303750d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-47-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.4764849967091, "outflow_rate_min": 791.0543526369802, "system_level_velocity_max": 17.202900340578278, "cost2_min": -105.67721397384096, "cost1_mean": 180.82424466818463, "system_level_velocity_min": 11.514429128447267, "cost2_max": -86.044482081775, "cost1_min": 135.03652093956583, "cost2_mean": -98.67839075943544, "discrim_loss": 0.6966849565505981, "outflow_rate_mean": 946.6872040506968, "system_level_velocity_mean": 15.085712132890892, "cost1_max": 203.99648667143543}}
{"sampler_perf": {"mean_inference_ms": 7.59885570762775, "mean_processing_ms": 11.163763051870184, "mean_env_wait_ms": 133.00217516927603}, "policy_reward_mean": {}, "time_since_restore": 7845.427544116974, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2341, "time_total_s": 13047.291062831879, "episode_reward_max": 410.99834232311696, "off_policy_estimator": {}, "episode_reward_min": 134.34708780795336, "episode_reward_mean": 248.7499516776928, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.41859245300293, "timestamp": 1559278188, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 61, "training_iteration": 101, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-49-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1047.5124477029342, "outflow_rate_min": 779.9928680401495, "system_level_velocity_max": 17.943261357285696, "cost2_min": -105.60578726215353, "cost1_mean": 186.0794919527024, "system_level_velocity_min": 11.542146093201861, "cost2_max": -74.75735858501412, "cost1_min": 134.1024019385179, "cost2_mean": -97.51027367810498, "discrim_loss": 0.6349319219589233, "outflow_rate_mean": 971.7761198867302, "system_level_velocity_mean": 15.8731363109845, "cost1_max": 207.99986026319414}}
{"sampler_perf": {"mean_inference_ms": 7.593116639944839, "mean_processing_ms": 11.145193048303957, "mean_env_wait_ms": 132.86860079742007}, "policy_reward_mean": {}, "time_since_restore": 7958.102259874344, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2365, "time_total_s": 13159.965778589249, "episode_reward_max": 383.21375127276406, "off_policy_estimator": {}, "episode_reward_min": 168.94265644997358, "episode_reward_mean": 235.89136161091542, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 112.67471575737, "timestamp": 1559278300, "episode_len_mean": 325.0, "iterations_since_restore": 62, "training_iteration": 102, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a2f0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303241e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324268>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-51-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.7841930192337, "outflow_rate_min": 780.0606624652511, "system_level_velocity_max": 17.811169335416952, "cost2_min": -104.01480041117536, "cost1_mean": 186.0354772260541, "system_level_velocity_min": 11.34168745195067, "cost2_max": -83.88574979574152, "cost1_min": 134.4250776520664, "cost2_mean": -98.28390662462641, "discrim_loss": 0.7011680603027344, "outflow_rate_mean": 969.0770112072072, "system_level_velocity_mean": 15.59734772099288, "cost1_max": 209.64811555426957}}
{"sampler_perf": {"mean_inference_ms": 7.596003050679056, "mean_processing_ms": 11.144061151470986, "mean_env_wait_ms": 132.53582340580255}, "policy_reward_mean": {}, "time_since_restore": 8070.0631601810455, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 2386, "time_total_s": 13271.92667889595, "episode_reward_max": 265.12626522697974, "off_policy_estimator": {}, "episode_reward_min": 160.78334586741403, "episode_reward_mean": 199.7531276457483, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 111.96090030670166, "timestamp": 1559278412, "episode_len_mean": 325.0, "iterations_since_restore": 63, "training_iteration": 103, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba6a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-53-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.935139567773, "outflow_rate_min": 895.051889464012, "system_level_velocity_max": 17.767363924654322, "cost2_min": -104.72325811620686, "cost1_mean": 190.93473290748088, "system_level_velocity_min": 13.570573913370502, "cost2_max": -94.8390936177955, "cost1_min": 164.43632383610844, "cost2_mean": -99.49683657206201, "discrim_loss": 0.6621379256248474, "outflow_rate_mean": 984.503067221233, "system_level_velocity_mean": 15.948782806535094, "cost1_max": 209.3387997693565}}
{"sampler_perf": {"mean_inference_ms": 7.5989343602722075, "mean_processing_ms": 11.169483151820083, "mean_env_wait_ms": 132.50383206508394}, "policy_reward_mean": {}, "time_since_restore": 8189.029492616653, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2409, "time_total_s": 13390.893011331558, "episode_reward_max": 347.74532344401814, "off_policy_estimator": {}, "episode_reward_min": 186.04369966313243, "episode_reward_mean": 234.41004127684636, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.96633243560791, "timestamp": 1559278531, "episode_len_mean": 325.0, "iterations_since_restore": 64, "training_iteration": 104, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bda60>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd8c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd950>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-55-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.6647269099692, "outflow_rate_min": 859.1282376154749, "system_level_velocity_max": 17.773112606417396, "cost2_min": -105.32459078446713, "cost1_mean": 191.05016529424242, "system_level_velocity_min": 12.68609805589568, "cost2_max": -97.41586068714076, "cost1_min": 154.51693573209184, "cost2_mean": -101.05512607483858, "discrim_loss": 0.6202919483184814, "outflow_rate_mean": 983.7843761473912, "system_level_velocity_mean": 15.949657948365157, "cost1_max": 209.45537924011063}}
{"sampler_perf": {"mean_inference_ms": 7.594892830157646, "mean_processing_ms": 11.147601837668818, "mean_env_wait_ms": 132.3553353290215}, "policy_reward_mean": {}, "time_since_restore": 8303.478982448578, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 2435, "time_total_s": 13505.342501163483, "episode_reward_max": 436.4431151699973, "off_policy_estimator": {}, "episode_reward_min": 209.7454449357465, "episode_reward_mean": 268.60252948883976, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 114.44948983192444, "timestamp": 1559278646, "episode_len_mean": 325.0, "iterations_since_restore": 65, "training_iteration": 105, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303751e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-57-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.9143654906372, "outflow_rate_min": 887.8682797187549, "system_level_velocity_max": 17.7056241661119, "cost2_min": -105.65613334229016, "cost1_mean": 191.2105373121907, "system_level_velocity_min": 13.513743736711655, "cost2_max": -91.5132948635515, "cost1_min": 162.75466254619934, "cost2_mean": -100.9748710401606, "discrim_loss": 0.6278785467147827, "outflow_rate_mean": 986.5234851806524, "system_level_velocity_mean": 15.965937705542823, "cost1_max": 209.37786187742932}}
{"sampler_perf": {"mean_inference_ms": 7.596723816760423, "mean_processing_ms": 11.160875991253604, "mean_env_wait_ms": 132.18322177804103}, "policy_reward_mean": {}, "time_since_restore": 8431.820564746857, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 2456, "time_total_s": 13633.684083461761, "episode_reward_max": 328.9441234007245, "off_policy_estimator": {}, "episode_reward_min": 157.87923360290006, "episode_reward_mean": 208.91229924834002, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.3415822982788, "timestamp": 1559278774, "episode_len_mean": 325.0, "iterations_since_restore": 66, "training_iteration": 106, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a2f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034af28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ae18>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_04-59-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.5482395101121, "outflow_rate_min": 843.3510221280054, "system_level_velocity_max": 17.620211156445208, "cost2_min": -109.9711689043822, "cost1_mean": 187.28392114784924, "system_level_velocity_min": 13.046710443085509, "cost2_max": -93.3711043400675, "cost1_min": 155.3472026008715, "cost2_mean": -104.0468390767877, "discrim_loss": 0.5368985533714294, "outflow_rate_mean": 967.9115749378465, "system_level_velocity_mean": 15.577047555466525, "cost1_max": 208.95209496386087}}
{"sampler_perf": {"mean_inference_ms": 7.601377164394225, "mean_processing_ms": 11.178755739661892, "mean_env_wait_ms": 132.20142155092006}, "policy_reward_mean": {}, "time_since_restore": 8553.026431560516, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2478, "time_total_s": 13754.889950275421, "episode_reward_max": 322.462085140869, "off_policy_estimator": {}, "episode_reward_min": 147.63093341793865, "episode_reward_mean": 206.2660076054559, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.20586681365967, "timestamp": 1559278896, "episode_len_mean": 325.0, "iterations_since_restore": 67, "training_iteration": 107, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-01-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.6891675252841, "outflow_rate_min": 864.4595388157841, "system_level_velocity_max": 17.803032939625243, "cost2_min": -109.32442617962666, "cost1_mean": 186.84658244415434, "system_level_velocity_min": 12.808887291561337, "cost2_max": -95.89632348438495, "cost1_min": 155.9292405640624, "cost2_mean": -103.52849663360699, "discrim_loss": 0.621847927570343, "outflow_rate_mean": 968.3421545368313, "system_level_velocity_mean": 15.522065099860894, "cost1_max": 210.15927729135007}}
{"sampler_perf": {"mean_inference_ms": 7.598980326394261, "mean_processing_ms": 11.169703323632305, "mean_env_wait_ms": 132.06688821622353}, "policy_reward_mean": {}, "time_since_restore": 8673.253851652145, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2502, "time_total_s": 13875.11737036705, "episode_reward_max": 413.8700232972624, "off_policy_estimator": {}, "episode_reward_min": 150.45617386931553, "episode_reward_mean": 243.30470365639243, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.22742009162903, "timestamp": 1559279016, "episode_len_mean": 325.0, "iterations_since_restore": 68, "training_iteration": 108, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-03-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.8438725908059, "outflow_rate_min": 793.3620122456656, "system_level_velocity_max": 17.81376589789584, "cost2_min": -108.1218792851513, "cost1_mean": 184.60218437815934, "system_level_velocity_min": 11.651481399093859, "cost2_max": -94.19480321381823, "cost1_min": 139.930327596459, "cost2_mean": -102.03787165218453, "discrim_loss": 0.6193009614944458, "outflow_rate_mean": 960.8979603903412, "system_level_velocity_mean": 15.362940233341595, "cost1_max": 210.32143023898215}}
{"sampler_perf": {"mean_inference_ms": 7.596629159956279, "mean_processing_ms": 11.14759996267726, "mean_env_wait_ms": 132.10712749442231}, "policy_reward_mean": {}, "time_since_restore": 8791.477269649506, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2525, "time_total_s": 13993.34078836441, "episode_reward_max": 405.8691490481142, "off_policy_estimator": {}, "episode_reward_min": 202.35921343415976, "episode_reward_mean": 259.7349055842876, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.22341799736023, "timestamp": 1559279134, "episode_len_mean": 325.0, "iterations_since_restore": 69, "training_iteration": 109, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a6a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ae18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034af28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a2f0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-05-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.0395172611352, "outflow_rate_min": 805.669970083249, "system_level_velocity_max": 17.83063448819473, "cost2_min": -110.18529327973891, "cost1_mean": 183.99269570947746, "system_level_velocity_min": 11.863320234983235, "cost2_max": -91.95853386259236, "cost1_min": 141.26272281221216, "cost2_mean": -103.01709334855953, "discrim_loss": 0.5787918567657471, "outflow_rate_mean": 957.6112433878989, "system_level_velocity_mean": 15.286691787342034, "cost1_max": 210.74508753308027}}
{"sampler_perf": {"mean_inference_ms": 7.602238072175416, "mean_processing_ms": 11.19197950620208, "mean_env_wait_ms": 131.9368568259321}, "policy_reward_mean": {}, "time_since_restore": 8912.46942281723, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2548, "time_total_s": 14114.332941532135, "episode_reward_max": 467.43308638595045, "off_policy_estimator": {}, "episode_reward_min": 189.35638425149955, "episode_reward_mean": 267.72519980508673, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.99215316772461, "timestamp": 1559279258, "episode_len_mean": 325.0, "iterations_since_restore": 70, "training_iteration": 110, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303242f0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-07-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.3044818048504, "outflow_rate_min": 792.9827806298243, "system_level_velocity_max": 17.743175307432768, "cost2_min": -106.26056445952997, "cost1_mean": 177.74652413564007, "system_level_velocity_min": 11.652337234841879, "cost2_max": -87.13470931109224, "cost1_min": 137.37312386663996, "cost2_mean": -100.31358189600314, "discrim_loss": 0.619354784488678, "outflow_rate_mean": 935.4486805446853, "system_level_velocity_mean": 14.793058130109843, "cost1_max": 209.83049164245662}}
{"sampler_perf": {"mean_inference_ms": 7.601443216432314, "mean_processing_ms": 11.17082905937362, "mean_env_wait_ms": 131.9075581604184}, "policy_reward_mean": {}, "time_since_restore": 9035.720133304596, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2571, "time_total_s": 14237.5836520195, "episode_reward_max": 354.7327386807883, "off_policy_estimator": {}, "episode_reward_min": 144.87979918066412, "episode_reward_mean": 205.79359151984048, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.25071048736572, "timestamp": 1559279382, "episode_len_mean": 325.0, "iterations_since_restore": 71, "training_iteration": 111, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfd08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf7b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-09-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1039.6322749382712, "outflow_rate_min": 815.0007633851405, "system_level_velocity_max": 17.269411374656325, "cost2_min": -109.67686498849021, "cost1_mean": 179.5754578222787, "system_level_velocity_min": 12.030288727565098, "cost2_max": -89.23383224270655, "cost1_min": 143.31143066090678, "cost2_mean": -102.92779557550152, "discrim_loss": 0.5452361702919006, "outflow_rate_mean": 940.9136402286733, "system_level_velocity_mean": 14.879170012476198, "cost1_max": 205.73763186756304}}
{"sampler_perf": {"mean_inference_ms": 7.598774388308237, "mean_processing_ms": 11.16983206531305, "mean_env_wait_ms": 131.9258764287666}, "policy_reward_mean": {}, "time_since_restore": 9151.235360622406, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2595, "time_total_s": 14353.09887933731, "episode_reward_max": 306.4567330017453, "off_policy_estimator": {}, "episode_reward_min": 142.0814780772198, "episode_reward_mean": 204.37049696707982, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 115.51522731781006, "timestamp": 1559279497, "episode_len_mean": 325.0, "iterations_since_restore": 72, "training_iteration": 112, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-11-37", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.9424350999439, "outflow_rate_min": 820.68160269281, "system_level_velocity_max": 17.675389742033577, "cost2_min": -107.7840177310785, "cost1_mean": 184.84201230739475, "system_level_velocity_min": 11.864139839645077, "cost2_max": -93.35874384735646, "cost1_min": 141.3742320037156, "cost2_mean": -101.42018676908843, "discrim_loss": 0.6191877126693726, "outflow_rate_mean": 960.973287592766, "system_level_velocity_mean": 15.393641611045306, "cost1_max": 208.88278317541207}}
{"sampler_perf": {"mean_inference_ms": 7.606038928503209, "mean_processing_ms": 11.194626450555857, "mean_env_wait_ms": 131.66058067841882}, "policy_reward_mean": {}, "time_since_restore": 9269.922461032867, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2617, "time_total_s": 14471.785979747772, "episode_reward_max": 301.8907886282541, "off_policy_estimator": {}, "episode_reward_min": 150.55932016216684, "episode_reward_mean": 222.26107535949401, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.68710041046143, "timestamp": 1559279616, "episode_len_mean": 325.0, "iterations_since_restore": 73, "training_iteration": 113, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-13-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.5244018670974, "outflow_rate_min": 860.4668619558007, "system_level_velocity_max": 17.805195179380334, "cost2_min": -106.18771184816075, "cost1_mean": 189.31138774623568, "system_level_velocity_min": 12.763288798639019, "cost2_max": -96.83805981897169, "cost1_min": 155.40747293473066, "cost2_mean": -101.98555628734859, "discrim_loss": 0.577386736869812, "outflow_rate_mean": 980.3412325057324, "system_level_velocity_mean": 15.795483059788062, "cost1_max": 209.86868243819185}}
{"sampler_perf": {"mean_inference_ms": 7.601689577974699, "mean_processing_ms": 11.197844183140049, "mean_env_wait_ms": 131.63468400043777}, "policy_reward_mean": {}, "time_since_restore": 9388.936292886734, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2641, "time_total_s": 14590.799811601639, "episode_reward_max": 341.9449805231998, "off_policy_estimator": {}, "episode_reward_min": 192.30794074840378, "episode_reward_mean": 249.5213453886196, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.01383185386658, "timestamp": 1559279735, "episode_len_mean": 325.0, "iterations_since_restore": 74, "training_iteration": 114, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-15-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.6282061148734, "outflow_rate_min": 767.800310249089, "system_level_velocity_max": 17.751581126697356, "cost2_min": -108.15947818166364, "cost1_mean": 184.39394624060083, "system_level_velocity_min": 11.189055985828125, "cost2_max": -83.4453933897926, "cost1_min": 131.40458249643507, "cost2_mean": -101.43843660469395, "discrim_loss": 0.5707604885101318, "outflow_rate_mean": 958.1913975696713, "system_level_velocity_mean": 15.31808897047199, "cost1_max": 210.25646367861725}}
{"sampler_perf": {"mean_inference_ms": 7.596429091102081, "mean_processing_ms": 11.182302594461083, "mean_env_wait_ms": 131.6117934071723}, "policy_reward_mean": {}, "time_since_restore": 9510.859119653702, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2665, "time_total_s": 14712.722638368607, "episode_reward_max": 292.8944797710865, "off_policy_estimator": {}, "episode_reward_min": 161.2698742528446, "episode_reward_mean": 220.21467438103477, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.92282676696777, "timestamp": 1559279858, "episode_len_mean": 325.0, "iterations_since_restore": 75, "training_iteration": 115, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-17-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.5440120815044, "outflow_rate_min": 825.4767660130946, "system_level_velocity_max": 17.834383227607855, "cost2_min": -106.66925829377162, "cost1_mean": 190.09303243904822, "system_level_velocity_min": 12.407696123733954, "cost2_max": -96.1675102895747, "cost1_min": 149.90913585987224, "cost2_mean": -101.56972909283216, "discrim_loss": 0.5731550455093384, "outflow_rate_mean": 979.9281119298148, "system_level_velocity_mean": 15.847403162585687, "cost1_max": 210.95843566364437}}
{"sampler_perf": {"mean_inference_ms": 7.600443678093887, "mean_processing_ms": 11.18774932045163, "mean_env_wait_ms": 131.40687352635396}, "policy_reward_mean": {}, "time_since_restore": 9633.741919755936, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 2686, "time_total_s": 14835.60543847084, "episode_reward_max": 275.0002829078585, "off_policy_estimator": {}, "episode_reward_min": 143.70730215217918, "episode_reward_mean": 188.99751583484024, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.88280010223389, "timestamp": 1559279981, "episode_len_mean": 325.0, "iterations_since_restore": 76, "training_iteration": 116, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034ad90>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ad08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034abf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ac80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-19-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.0908177173992, "outflow_rate_min": 857.5628303204994, "system_level_velocity_max": 17.728256150856573, "cost2_min": -106.51067072806734, "cost1_mean": 182.8328149520446, "system_level_velocity_min": 12.724402921997738, "cost2_max": -92.3794818322803, "cost1_min": 155.3558153783896, "cost2_mean": -102.05691805239547, "discrim_loss": 0.5124495625495911, "outflow_rate_mean": 952.9203154178964, "system_level_velocity_mean": 15.167194224809881, "cost1_max": 209.29861412522487}}
{"sampler_perf": {"mean_inference_ms": 7.606205893394755, "mean_processing_ms": 11.212816676177663, "mean_env_wait_ms": 131.4128059990087}, "policy_reward_mean": {}, "time_since_restore": 9752.353264570236, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2709, "time_total_s": 14954.216783285141, "episode_reward_max": 248.97659320873208, "off_policy_estimator": {}, "episode_reward_min": 153.3756739771925, "episode_reward_mean": 195.32447377451362, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.61134481430054, "timestamp": 1559280100, "episode_len_mean": 325.0, "iterations_since_restore": 77, "training_iteration": 117, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303750d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79304250d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425268>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-21-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1052.8200461998276, "outflow_rate_min": 817.1082874925743, "system_level_velocity_max": 17.66992590092263, "cost2_min": -106.98580633919411, "cost1_mean": 182.5357583288104, "system_level_velocity_min": 12.250939819621546, "cost2_max": -92.58694980253044, "cost1_min": 147.60119366490852, "cost2_mean": -100.70526956288812, "discrim_loss": 0.5695450901985168, "outflow_rate_mean": 954.120515211961, "system_level_velocity_mean": 15.212796569486544, "cost1_max": 209.65543496231663}}
{"sampler_perf": {"mean_inference_ms": 7.601746347856089, "mean_processing_ms": 11.200539919014279, "mean_env_wait_ms": 131.39923670259822}, "policy_reward_mean": {}, "time_since_restore": 9875.12519645691, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 2735, "time_total_s": 15076.988715171814, "episode_reward_max": 282.8175568014849, "off_policy_estimator": {}, "episode_reward_min": 161.94786581071094, "episode_reward_mean": 226.3890809932446, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.77193188667297, "timestamp": 1559280226, "episode_len_mean": 325.0, "iterations_since_restore": 78, "training_iteration": 118, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfc80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-23-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.4935609837771, "outflow_rate_min": 830.9438328434499, "system_level_velocity_max": 17.812918215244206, "cost2_min": -107.0936501569015, "cost1_mean": 191.34628365408844, "system_level_velocity_min": 12.917921929085551, "cost2_max": -85.54124423671358, "cost1_min": 152.90212023789215, "cost2_mean": -101.72877850353944, "discrim_loss": 0.561775803565979, "outflow_rate_mean": 984.0696557627593, "system_level_velocity_mean": 15.959655471161433, "cost1_max": 209.86742009494233}}
{"sampler_perf": {"mean_inference_ms": 7.599346106599324, "mean_processing_ms": 11.199959206785625, "mean_env_wait_ms": 131.23162835411867}, "policy_reward_mean": {}, "time_since_restore": 9996.236877441406, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 2756, "time_total_s": 15198.100396156311, "episode_reward_max": 274.5510739902966, "off_policy_estimator": {}, "episode_reward_min": 181.93707311758772, "episode_reward_mean": 226.14986649599103, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.11168098449707, "timestamp": 1559280347, "episode_len_mean": 325.0, "iterations_since_restore": 79, "training_iteration": 119, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-25-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1037.1623358935597, "outflow_rate_min": 861.1780293215793, "system_level_velocity_max": 17.32333221245451, "cost2_min": -106.44044268798905, "cost1_mean": 186.3142266451835, "system_level_velocity_min": 13.25138521122928, "cost2_max": -93.91797781929404, "cost1_min": 159.40877368698528, "cost2_mean": -100.89785645490043, "discrim_loss": 0.5279086828231812, "outflow_rate_mean": 969.8373736038361, "system_level_velocity_mean": 15.52660516059961, "cost1_max": 206.61459065892433}}
{"sampler_perf": {"mean_inference_ms": 7.603925060176036, "mean_processing_ms": 11.212429258785177, "mean_env_wait_ms": 131.2425639611949}, "policy_reward_mean": {}, "time_since_restore": 10115.35298037529, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2778, "time_total_s": 15317.216499090195, "episode_reward_max": 265.80636567564216, "off_policy_estimator": {}, "episode_reward_min": 162.68222844682168, "episode_reward_mean": 200.56004931173678, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.11610293388367, "timestamp": 1559280466, "episode_len_mean": 325.0, "iterations_since_restore": 80, "training_iteration": 120, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bef28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bee18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-27-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.4976607869373, "outflow_rate_min": 874.9098964176193, "system_level_velocity_max": 17.92692925435224, "cost2_min": -106.66604072373008, "cost1_mean": 185.50689329619425, "system_level_velocity_min": 13.230092656259023, "cost2_max": -96.25010659634775, "cost1_min": 159.653607089355, "cost2_mean": -101.7794415308772, "discrim_loss": 0.5314662456512451, "outflow_rate_mean": 965.9160791948518, "system_level_velocity_mean": 15.437454979988662, "cost1_max": 211.47066828204652}}
{"sampler_perf": {"mean_inference_ms": 7.600282175312922, "mean_processing_ms": 11.195812994162013, "mean_env_wait_ms": 131.15697081540745}, "policy_reward_mean": {}, "time_since_restore": 10234.459167718887, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2802, "time_total_s": 15436.322686433792, "episode_reward_max": 339.08815761387814, "off_policy_estimator": {}, "episode_reward_min": 153.06336738850223, "episode_reward_mean": 206.6231345259063, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.10618734359741, "timestamp": 1559280586, "episode_len_mean": 325.0, "iterations_since_restore": 81, "training_iteration": 121, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfb70>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-29-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.7210510933285, "outflow_rate_min": 777.3412663151332, "system_level_velocity_max": 17.859828380984734, "cost2_min": -107.0248800000541, "cost1_mean": 182.40565660895246, "system_level_velocity_min": 11.316371628384598, "cost2_max": -85.9329813217196, "cost1_min": 132.4912352880362, "cost2_mean": -99.9244640025489, "discrim_loss": 0.4761561453342438, "outflow_rate_mean": 956.8037099749886, "system_level_velocity_mean": 15.22374566389958, "cost1_max": 210.59725281019712}}
{"sampler_perf": {"mean_inference_ms": 7.601476211057733, "mean_processing_ms": 11.185069258391405, "mean_env_wait_ms": 131.23202290540573}, "policy_reward_mean": {}, "time_since_restore": 10355.072148799896, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2825, "time_total_s": 15556.935667514801, "episode_reward_max": 265.134897275595, "off_policy_estimator": {}, "episode_reward_min": 148.3076322900597, "episode_reward_mean": 200.28742908318426, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.61298108100891, "timestamp": 1559280710, "episode_len_mean": 325.0, "iterations_since_restore": 82, "training_iteration": 122, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303757b8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-31-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.757699397925, "outflow_rate_min": 827.0319850693777, "system_level_velocity_max": 17.684684996688638, "cost2_min": -106.72703429176458, "cost1_mean": 186.5508169703224, "system_level_velocity_min": 12.99470920799514, "cost2_max": -86.7218510886594, "cost1_min": 155.15737028996148, "cost2_mean": -100.85170076419472, "discrim_loss": 0.5532300472259521, "outflow_rate_mean": 967.183987734433, "system_level_velocity_mean": 15.534490141515516, "cost1_max": 208.67658810835724}}
{"sampler_perf": {"mean_inference_ms": 7.612298993461404, "mean_processing_ms": 11.229419518619183, "mean_env_wait_ms": 131.10486382805993}, "policy_reward_mean": {}, "time_since_restore": 10480.724929571152, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2848, "time_total_s": 15682.588448286057, "episode_reward_max": 354.5325645888224, "off_policy_estimator": {}, "episode_reward_min": 154.78783721732907, "episode_reward_mean": 208.55694329723684, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.6527807712555, "timestamp": 1559280836, "episode_len_mean": 325.0, "iterations_since_restore": 83, "training_iteration": 123, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bea60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be9d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-33-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.7220468908959, "outflow_rate_min": 793.0594828750125, "system_level_velocity_max": 17.853548077271867, "cost2_min": -105.19234235099425, "cost1_mean": 183.2464817487751, "system_level_velocity_min": 11.761657791869123, "cost2_max": -90.14825514007401, "cost1_min": 140.34799831870944, "cost2_mean": -99.33033242161298, "discrim_loss": 0.5391615629196167, "outflow_rate_mean": 960.0513775802268, "system_level_velocity_mean": 15.319941912031462, "cost1_max": 210.48915260260358}}
{"sampler_perf": {"mean_inference_ms": 7.613868095994828, "mean_processing_ms": 11.207820584454105, "mean_env_wait_ms": 131.08831098275098}, "policy_reward_mean": {}, "time_since_restore": 10603.384755849838, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 2871, "time_total_s": 15805.248274564743, "episode_reward_max": 256.63738964125514, "off_policy_estimator": {}, "episode_reward_min": 162.01713043556083, "episode_reward_mean": 209.4012658681098, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.65982627868652, "timestamp": 1559280959, "episode_len_mean": 325.0, "iterations_since_restore": 84, "training_iteration": 124, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-35-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.0727552485014, "outflow_rate_min": 894.1238579640835, "system_level_velocity_max": 17.861374254429922, "cost2_min": -105.36152665267235, "cost1_mean": 186.52992991927155, "system_level_velocity_min": 13.632649814637563, "cost2_max": -93.71676065557911, "cost1_min": 164.49779086621652, "cost2_mean": -99.73690997205475, "discrim_loss": 0.5093491077423096, "outflow_rate_mean": 973.1329192280483, "system_level_velocity_mean": 15.56634591013001, "cost1_max": 210.93975852062357}}
{"sampler_perf": {"mean_inference_ms": 7.606754177232607, "mean_processing_ms": 11.199712748621096, "mean_env_wait_ms": 131.10511620245427}, "policy_reward_mean": {}, "time_since_restore": 10719.869404554367, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2895, "time_total_s": 15921.732923269272, "episode_reward_max": 310.398362493841, "off_policy_estimator": {}, "episode_reward_min": 160.14925277000293, "episode_reward_mean": 209.88302131954092, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.48464870452881, "timestamp": 1559281075, "episode_len_mean": 325.0, "iterations_since_restore": 85, "training_iteration": 125, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bff28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf8c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-37-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1044.4636035931098, "outflow_rate_min": 777.2653863755271, "system_level_velocity_max": 17.515324129881705, "cost2_min": -106.3156911270006, "cost1_mean": 179.27033039940656, "system_level_velocity_min": 11.18034036225564, "cost2_max": -81.35618557419309, "cost1_min": 129.5085406020214, "cost2_mean": -99.12229662730128, "discrim_loss": 0.5123273134231567, "outflow_rate_mean": 942.3309304490293, "system_level_velocity_mean": 14.926989811715094, "cost1_max": 207.99085471681613}}
{"sampler_perf": {"mean_inference_ms": 7.61526156767475, "mean_processing_ms": 11.215422802253727, "mean_env_wait_ms": 130.8613707370442}, "policy_reward_mean": {}, "time_since_restore": 10836.08181142807, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 2917, "time_total_s": 16037.945330142975, "episode_reward_max": 276.12919504148886, "off_policy_estimator": {}, "episode_reward_min": 167.26936806965386, "episode_reward_mean": 208.41719812524389, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.212406873703, "timestamp": 1559281191, "episode_len_mean": 325.0, "iterations_since_restore": 86, "training_iteration": 126, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-39-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.1336146363767, "outflow_rate_min": 790.9505687171568, "system_level_velocity_max": 17.32890611675887, "cost2_min": -106.17976696280085, "cost1_mean": 183.1871302869865, "system_level_velocity_min": 11.603611761457666, "cost2_max": -86.23810690776119, "cost1_min": 135.75733822798372, "cost2_mean": -100.1786028366736, "discrim_loss": 0.45530521869659424, "outflow_rate_mean": 957.845758750876, "system_level_velocity_mean": 15.254832882679278, "cost1_max": 206.404701462866}}
{"sampler_perf": {"mean_inference_ms": 7.610720546124522, "mean_processing_ms": 11.223078821794667, "mean_env_wait_ms": 130.80547185739917}, "policy_reward_mean": {}, "time_since_restore": 10956.73488998413, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2941, "time_total_s": 16158.598408699036, "episode_reward_max": 265.33660468365997, "off_policy_estimator": {}, "episode_reward_min": 150.61426343186758, "episode_reward_mean": 189.4840410985877, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.65307855606079, "timestamp": 1559281312, "episode_len_mean": 325.0, "iterations_since_restore": 87, "training_iteration": 127, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-41-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.1230692187708, "outflow_rate_min": 856.9381902486043, "system_level_velocity_max": 17.779466001711945, "cost2_min": -106.8865338849977, "cost1_mean": 181.9114177465518, "system_level_velocity_min": 13.156648059949175, "cost2_max": -89.86086287687424, "cost1_min": 158.94812528583415, "cost2_mean": -100.2268898180165, "discrim_loss": 0.525181233882904, "outflow_rate_mean": 954.1099149994434, "system_level_velocity_mean": 15.151541902393802, "cost1_max": 209.32878588516184}}
{"sampler_perf": {"mean_inference_ms": 7.608145674518256, "mean_processing_ms": 11.206628469481798, "mean_env_wait_ms": 130.81481045815883}, "policy_reward_mean": {}, "time_since_restore": 11078.236971378326, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 2965, "time_total_s": 16280.100490093231, "episode_reward_max": 275.4526641003322, "off_policy_estimator": {}, "episode_reward_min": 148.52498284587637, "episode_reward_mean": 183.04574182292467, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.50208139419556, "timestamp": 1559281434, "episode_len_mean": 325.0, "iterations_since_restore": 88, "training_iteration": 128, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324730>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303242f0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-43-54", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.4273008091018, "outflow_rate_min": 790.92845447505, "system_level_velocity_max": 17.757129895929598, "cost2_min": -108.68461411792288, "cost1_mean": 179.891857644448, "system_level_velocity_min": 11.64936428735431, "cost2_max": -82.45925144641095, "cost1_min": 136.60744093419387, "cost2_mean": -100.99930145640174, "discrim_loss": 0.5029454827308655, "outflow_rate_mean": 946.9660915554381, "system_level_velocity_mean": 14.946338682439892, "cost1_max": 210.2783853660626}}
{"sampler_perf": {"mean_inference_ms": 7.608895774070204, "mean_processing_ms": 11.208398486443595, "mean_env_wait_ms": 130.5949893191117}, "policy_reward_mean": {}, "time_since_restore": 11195.673732042313, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 2986, "time_total_s": 16397.537250757217, "episode_reward_max": 325.29659580392763, "off_policy_estimator": {}, "episode_reward_min": 174.56432082504034, "episode_reward_mean": 215.17639550475482, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.4367606639862, "timestamp": 1559281551, "episode_len_mean": 324.04761904761904, "iterations_since_restore": 89, "training_iteration": 129, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302baf28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bae18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302baea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-45-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.0727807779926, "outflow_rate_min": 809.6783272818086, "system_level_velocity_max": 17.864578111417163, "cost2_min": -109.50331228364215, "cost1_mean": 183.38247659254512, "system_level_velocity_min": 11.903267822747365, "cost2_max": -91.43705712459183, "cost1_min": 140.55203158555682, "cost2_mean": -101.65011845024667, "discrim_loss": 0.47865450382232666, "outflow_rate_mean": 955.758497712957, "system_level_velocity_mean": 15.318008036528134, "cost1_max": 210.86650835294978}}
{"sampler_perf": {"mean_inference_ms": 7.611969397261541, "mean_processing_ms": 11.22530662287609, "mean_env_wait_ms": 130.59879434680067}, "policy_reward_mean": {}, "time_since_restore": 11315.635525465012, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3009, "time_total_s": 16517.499044179916, "episode_reward_max": 285.1780278030783, "off_policy_estimator": {}, "episode_reward_min": 185.08681130147306, "episode_reward_mean": 218.8204738559257, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 119.96179342269897, "timestamp": 1559281671, "episode_len_mean": 325.0, "iterations_since_restore": 90, "training_iteration": 130, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d90>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-47-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.5983623652335, "outflow_rate_min": 867.5002946336238, "system_level_velocity_max": 17.737149955025888, "cost2_min": -108.96043020273144, "cost1_mean": 184.65882288422708, "system_level_velocity_min": 13.110044481252649, "cost2_max": -96.09739818405248, "cost1_min": 158.66751637707154, "cost2_mean": -100.99671783643643, "discrim_loss": 0.48331427574157715, "outflow_rate_mean": 966.6362843901927, "system_level_velocity_mean": 15.4008863250915, "cost1_max": 209.8640001469504}}
{"sampler_perf": {"mean_inference_ms": 7.610449727801798, "mean_processing_ms": 11.204939095872179, "mean_env_wait_ms": 130.61082271229017}, "policy_reward_mean": {}, "time_since_restore": 11436.986425638199, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 3035, "time_total_s": 16638.849944353104, "episode_reward_max": 243.92805007647257, "off_policy_estimator": {}, "episode_reward_min": 153.7143239416182, "episode_reward_mean": 187.14613922395802, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.35090017318726, "timestamp": 1559281793, "episode_len_mean": 325.0, "iterations_since_restore": 91, "training_iteration": 131, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bef28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beea0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-49-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.7586711515485, "outflow_rate_min": 828.4013483075067, "system_level_velocity_max": 17.90734002537609, "cost2_min": -109.08802925240587, "cost1_mean": 184.7939441873458, "system_level_velocity_min": 12.448088966679034, "cost2_max": -87.97574723624717, "cost1_min": 148.94763679116159, "cost2_mean": -100.9942896309249, "discrim_loss": 0.40937039256095886, "outflow_rate_mean": 965.4708084379304, "system_level_velocity_mean": 15.399989906806603, "cost1_max": 211.24796981258734}}
{"sampler_perf": {"mean_inference_ms": 7.609910792879134, "mean_processing_ms": 11.209736221511102, "mean_env_wait_ms": 130.48768176118995}, "policy_reward_mean": {}, "time_since_restore": 11560.2700715065, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 3056, "time_total_s": 16762.133590221405, "episode_reward_max": 222.44684170302935, "off_policy_estimator": {}, "episode_reward_min": 133.8490157466149, "episode_reward_mean": 165.43261164976727, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.28364586830139, "timestamp": 1559281917, "episode_len_mean": 325.0, "iterations_since_restore": 92, "training_iteration": 132, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1730>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c10d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1268>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-51-57", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.9176712631752, "outflow_rate_min": 768.2201364368495, "system_level_velocity_max": 17.804299102257094, "cost2_min": -108.1886927051804, "cost1_mean": 187.19516186030728, "system_level_velocity_min": 11.23518931042895, "cost2_max": -83.96398265178286, "cost1_min": 130.9439779183952, "cost2_mean": -101.61265708878302, "discrim_loss": 0.48130184412002563, "outflow_rate_mean": 971.7010403867356, "system_level_velocity_mean": 15.623793530744779, "cost1_max": 211.08529366798894}}
{"sampler_perf": {"mean_inference_ms": 7.616145884810414, "mean_processing_ms": 11.224807833003055, "mean_env_wait_ms": 130.5185094928863}, "policy_reward_mean": {}, "time_since_restore": 11684.422914028168, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3078, "time_total_s": 16886.286432743073, "episode_reward_max": 285.7124305940233, "off_policy_estimator": {}, "episode_reward_min": 140.21490297245327, "episode_reward_mean": 190.2574820891843, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.15284252166748, "timestamp": 1559282041, "episode_len_mean": 325.0, "iterations_since_restore": 93, "training_iteration": 133, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303751e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-54-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1061.860043756404, "outflow_rate_min": 774.5785872208622, "system_level_velocity_max": 17.816082856519426, "cost2_min": -109.81420972427509, "cost1_mean": 175.57674660170022, "system_level_velocity_min": 11.421390469201777, "cost2_max": -85.97680723012067, "cost1_min": 137.74900555254578, "cost2_mean": -100.8326557759792, "discrim_loss": 0.4746032953262329, "outflow_rate_mean": 928.9068643306549, "system_level_velocity_mean": 14.58689814956463, "cost1_max": 210.3298941620862}}
{"sampler_perf": {"mean_inference_ms": 7.61385289762489, "mean_processing_ms": 11.220963787142109, "mean_env_wait_ms": 130.43449589138217}, "policy_reward_mean": {}, "time_since_restore": 11809.65959239006, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3103, "time_total_s": 17011.523111104965, "episode_reward_max": 310.86832994723227, "off_policy_estimator": {}, "episode_reward_min": 17.907547782175243, "episode_reward_mean": 191.12869867921108, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.2366783618927, "timestamp": 1559282167, "episode_len_mean": 313.4, "iterations_since_restore": 94, "training_iteration": 134, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bed08>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-56-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1063.460497363882, "outflow_rate_min": 477.1206855028346, "system_level_velocity_max": 18.712395063881036, "cost2_min": -110.29637467973875, "cost1_mean": 176.96367184452654, "system_level_velocity_min": 10.515582164348517, "cost2_max": -25.047141541648557, "cost1_min": 23.24512287489642, "cost2_mean": -98.5531454556665, "discrim_loss": 0.428162157535553, "outflow_rate_mean": 943.575965774096, "system_level_velocity_mean": 15.449378875015382, "cost1_max": 211.4738539247345}}
{"sampler_perf": {"mean_inference_ms": 7.6060444296540455, "mean_processing_ms": 11.207708080984098, "mean_env_wait_ms": 130.46073722594704}, "policy_reward_mean": {}, "time_since_restore": 11935.402567625046, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3126, "time_total_s": 17137.26608633995, "episode_reward_max": 286.2386134696426, "off_policy_estimator": {}, "episode_reward_min": 153.90382746531395, "episode_reward_mean": 196.37773859161572, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.74297523498535, "timestamp": 1559282292, "episode_len_mean": 325.0, "iterations_since_restore": 95, "training_iteration": 135, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_05-58-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.6617118299591, "outflow_rate_min": 790.1455423138203, "system_level_velocity_max": 17.359395458820007, "cost2_min": -110.66478859417616, "cost1_mean": 172.88655677093692, "system_level_velocity_min": 11.631709988682045, "cost2_max": -89.63265116536022, "cost1_min": 138.881711816462, "cost2_mean": -101.02363232981573, "discrim_loss": 0.45488595962524414, "outflow_rate_mean": 918.5794741804161, "system_level_velocity_mean": 14.335871201040705, "cost1_max": 207.69548790301653}}
{"sampler_perf": {"mean_inference_ms": 7.6109126323850465, "mean_processing_ms": 11.23691894304873, "mean_env_wait_ms": 130.333446799235}, "policy_reward_mean": {}, "time_since_restore": 12053.943174123764, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3149, "time_total_s": 17255.80669283867, "episode_reward_max": 240.04587337769408, "off_policy_estimator": {}, "episode_reward_min": 130.70934147178195, "episode_reward_mean": 177.15070998264332, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.54060649871826, "timestamp": 1559282411, "episode_len_mean": 325.0, "iterations_since_restore": 96, "training_iteration": 136, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-00-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.6167518228142, "outflow_rate_min": 813.257550118623, "system_level_velocity_max": 17.8249096853988, "cost2_min": -108.55810311856018, "cost1_mean": 180.03051425417837, "system_level_velocity_min": 12.053430465448905, "cost2_max": -86.690284092891, "cost1_min": 143.16556741118433, "cost2_mean": -101.3753140214517, "discrim_loss": 0.38387149572372437, "outflow_rate_mean": 945.7110589108107, "system_level_velocity_mean": 14.959139085902152, "cost1_max": 211.42618615651594}}
{"sampler_perf": {"mean_inference_ms": 7.613905623231617, "mean_processing_ms": 11.21335237235636, "mean_env_wait_ms": 130.31717649264365}, "policy_reward_mean": {}, "time_since_restore": 12170.41474699974, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3171, "time_total_s": 17372.278265714645, "episode_reward_max": 209.7356751805055, "off_policy_estimator": {}, "episode_reward_min": 123.91800448362483, "episode_reward_mean": 157.30216005289748, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.47157287597656, "timestamp": 1559282528, "episode_len_mean": 325.0, "iterations_since_restore": 97, "training_iteration": 137, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-02-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.8104006313054, "outflow_rate_min": 789.3787141175466, "system_level_velocity_max": 17.83435749972624, "cost2_min": -109.32905423800608, "cost1_mean": 177.278442693513, "system_level_velocity_min": 11.763160924518306, "cost2_max": -85.32024645843391, "cost1_min": 138.55303187212667, "cost2_mean": -101.70060007225635, "discrim_loss": 0.46009936928749084, "outflow_rate_mean": 934.8018792028529, "system_level_velocity_mean": 14.728156065572067, "cost1_max": 211.17000054691647}}
{"sampler_perf": {"mean_inference_ms": 7.606168110317665, "mean_processing_ms": 11.220838634697373, "mean_env_wait_ms": 130.2907960146726}, "policy_reward_mean": {}, "time_since_restore": 12290.451846599579, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3196, "time_total_s": 17492.315365314484, "episode_reward_max": 284.1963551566587, "off_policy_estimator": {}, "episode_reward_min": 136.18010933272308, "episode_reward_mean": 179.17864344553206, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.03709959983826, "timestamp": 1559282648, "episode_len_mean": 325.0, "iterations_since_restore": 98, "training_iteration": 138, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79304250d0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-04-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.598919646424, "outflow_rate_min": 856.2254482892197, "system_level_velocity_max": 17.776993280466005, "cost2_min": -108.95313796613162, "cost1_mean": 184.80875664385488, "system_level_velocity_min": 12.838540145442922, "cost2_max": -94.79686412786717, "cost1_min": 156.94122704914525, "cost2_mean": -104.17086974117339, "discrim_loss": 0.44079095125198364, "outflow_rate_mean": 961.4498307523828, "system_level_velocity_mean": 15.342154836766221, "cost1_max": 210.50345273024496}}
{"sampler_perf": {"mean_inference_ms": 7.615540604488729, "mean_processing_ms": 11.229483116202015, "mean_env_wait_ms": 130.20504938088428}, "policy_reward_mean": {}, "time_since_restore": 12413.88608622551, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3218, "time_total_s": 17615.749604940414, "episode_reward_max": 283.46362291742116, "off_policy_estimator": {}, "episode_reward_min": 151.18354304306558, "episode_reward_mean": 190.17891292599828, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.43423962593079, "timestamp": 1559282772, "episode_len_mean": 325.0, "iterations_since_restore": 99, "training_iteration": 139, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-06-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.6471623341008, "outflow_rate_min": 807.2644833211422, "system_level_velocity_max": 17.68334201367216, "cost2_min": -109.71290723715089, "cost1_mean": 176.14624502396063, "system_level_velocity_min": 12.030488611119319, "cost2_max": -88.47023296794049, "cost1_min": 142.011773727553, "cost2_mean": -102.39559560027546, "discrim_loss": 0.41569891571998596, "outflow_rate_mean": 931.3419733057337, "system_level_velocity_mean": 14.633723660554665, "cost1_max": 210.33761639726086}}
{"sampler_perf": {"mean_inference_ms": 7.613207342391332, "mean_processing_ms": 11.237129745817937, "mean_env_wait_ms": 130.29536532670792}, "policy_reward_mean": {}, "time_since_restore": 12539.23800611496, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3241, "time_total_s": 17741.101524829865, "episode_reward_max": 247.3539507437672, "off_policy_estimator": {}, "episode_reward_min": 130.61914038076065, "episode_reward_mean": 172.15760889555816, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.35191988945007, "timestamp": 1559282897, "episode_len_mean": 325.0, "iterations_since_restore": 100, "training_iteration": 140, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a2f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-08-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1063.907668096413, "outflow_rate_min": 785.5300850015149, "system_level_velocity_max": 17.948724623299647, "cost2_min": -111.44223869221955, "cost1_mean": 181.22882075248538, "system_level_velocity_min": 11.677353299458378, "cost2_max": -87.76911876980209, "cost1_min": 138.47146800834258, "cost2_mean": -103.51077977210879, "discrim_loss": 0.4125187397003174, "outflow_rate_mean": 949.2800280178187, "system_level_velocity_mean": 15.044456007063564, "cost1_max": 212.0615710090549}}
{"sampler_perf": {"mean_inference_ms": 7.607178412274266, "mean_processing_ms": 11.232856542961418, "mean_env_wait_ms": 130.27283018932795}, "policy_reward_mean": {}, "time_since_restore": 12665.373001813889, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3266, "time_total_s": 17867.236520528793, "episode_reward_max": 244.7297149062215, "off_policy_estimator": {}, "episode_reward_min": 129.73496835189871, "episode_reward_mean": 177.9772855865502, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.13499569892883, "timestamp": 1559283023, "episode_len_mean": 325.0, "iterations_since_restore": 101, "training_iteration": 141, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302beae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-10-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.1533990673383, "outflow_rate_min": 780.929028629985, "system_level_velocity_max": 17.80432287010528, "cost2_min": -111.29958226024527, "cost1_mean": 181.65037894126985, "system_level_velocity_min": 11.390710236035957, "cost2_max": -87.8395210280201, "cost1_min": 134.11097543052256, "cost2_mean": -103.61363408398924, "discrim_loss": 0.36224567890167236, "outflow_rate_mean": 949.6696523293115, "system_level_velocity_mean": 15.101263378083477, "cost1_max": 211.28762531135894}}
{"sampler_perf": {"mean_inference_ms": 7.61272008073868, "mean_processing_ms": 11.231379308590387, "mean_env_wait_ms": 130.22026924498982}, "policy_reward_mean": {}, "time_since_restore": 12783.811775684357, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 3287, "time_total_s": 17985.67529439926, "episode_reward_max": 216.07214983047743, "off_policy_estimator": {}, "episode_reward_min": 133.2686179502998, "episode_reward_mean": 173.6712210200851, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.43877387046814, "timestamp": 1559283145, "episode_len_mean": 325.0, "iterations_since_restore": 102, "training_iteration": 142, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-12-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.658862344487, "outflow_rate_min": 873.2234812328317, "system_level_velocity_max": 17.935233673500324, "cost2_min": -111.30352960005466, "cost1_mean": 185.25210148562275, "system_level_velocity_min": 13.112055683741987, "cost2_max": -97.79872423956039, "cost1_min": 159.23100783024472, "cost2_mean": -104.50539132640948, "discrim_loss": 0.4372447729110718, "outflow_rate_mean": 965.042021438993, "system_level_velocity_mean": 15.390824888828192, "cost1_max": 212.33799649775875}}
{"sampler_perf": {"mean_inference_ms": 7.618577952519063, "mean_processing_ms": 11.246511254766947, "mean_env_wait_ms": 130.22993369383178}, "policy_reward_mean": {}, "time_since_restore": 12901.156295061111, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3310, "time_total_s": 18103.019813776016, "episode_reward_max": 232.87553055782337, "off_policy_estimator": {}, "episode_reward_min": 125.36947495411732, "episode_reward_mean": 169.87242120415993, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 117.34451937675476, "timestamp": 1559283263, "episode_len_mean": 325.0, "iterations_since_restore": 103, "training_iteration": 143, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a1e0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c19d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1730>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-14-23", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.0706572565953, "outflow_rate_min": 826.2524747665001, "system_level_velocity_max": 17.8749100572529, "cost2_min": -109.69985852290519, "cost1_mean": 182.29109277139284, "system_level_velocity_min": 12.417705994469415, "cost2_max": -89.46731154183769, "cost1_min": 150.1002124496631, "cost2_mean": -103.01710602377732, "discrim_loss": 0.4152923822402954, "outflow_rate_mean": 952.4272175395712, "system_level_velocity_mean": 15.144519520948538, "cost1_max": 211.23108547586642}}
{"sampler_perf": {"mean_inference_ms": 7.615985958443402, "mean_processing_ms": 11.237780078944095, "mean_env_wait_ms": 130.2166607775173}, "policy_reward_mean": {}, "time_since_restore": 13020.127702951431, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 26, "episodes_total": 3336, "time_total_s": 18221.991221666336, "episode_reward_max": 272.4177773478441, "off_policy_estimator": {}, "episode_reward_min": 131.36070959936478, "episode_reward_mean": 181.33507011507749, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.97140789031982, "timestamp": 1559283384, "episode_len_mean": 325.0, "iterations_since_restore": 104, "training_iteration": 144, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-16-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.0872605161348, "outflow_rate_min": 853.205384343592, "system_level_velocity_max": 17.873794987363166, "cost2_min": -111.20570913187673, "cost1_mean": 181.19695350725303, "system_level_velocity_min": 13.296205388800143, "cost2_max": -89.59421755131531, "cost1_min": 160.55132944197925, "cost2_mean": -102.31391715405337, "discrim_loss": 0.3909796476364136, "outflow_rate_mean": 947.352624749021, "system_level_velocity_mean": 15.055877745240982, "cost1_max": 212.09130408581598}}
{"sampler_perf": {"mean_inference_ms": 7.614207529092068, "mean_processing_ms": 11.235957797696, "mean_env_wait_ms": 130.14844355278487}, "policy_reward_mean": {}, "time_since_restore": 13143.227420806885, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 21, "episodes_total": 3357, "time_total_s": 18345.09093952179, "episode_reward_max": 333.12559273967054, "off_policy_estimator": {}, "episode_reward_min": 134.49435379033093, "episode_reward_mean": 198.5067426027575, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.09971785545349, "timestamp": 1559283508, "episode_len_mean": 325.0, "iterations_since_restore": 105, "training_iteration": 145, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be158>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be048>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-18-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.085446936725, "outflow_rate_min": 789.7219954409069, "system_level_velocity_max": 17.893589119361547, "cost2_min": -111.3407132281217, "cost1_mean": 170.9556782046193, "system_level_velocity_min": 11.641408131435172, "cost2_max": -86.1378535553454, "cost1_min": 137.05992702198301, "cost2_mean": -103.38342260360997, "discrim_loss": 0.39717811346054077, "outflow_rate_mean": 910.1258689138137, "system_level_velocity_mean": 14.147873720121563, "cost1_max": 211.31856345381277}}
{"sampler_perf": {"mean_inference_ms": 7.6183700593257635, "mean_processing_ms": 11.248553763151717, "mean_env_wait_ms": 130.13434895827766}, "policy_reward_mean": {}, "time_since_restore": 13260.142896652222, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3379, "time_total_s": 18462.006415367126, "episode_reward_max": 292.6905310093425, "off_policy_estimator": {}, "episode_reward_min": 81.51801294274628, "episode_reward_mean": 188.51280240952872, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.91547584533691, "timestamp": 1559283625, "episode_len_mean": 315.54545454545456, "iterations_since_restore": 106, "training_iteration": 146, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a0d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-20-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.192116044813, "outflow_rate_min": 733.8714403298324, "system_level_velocity_max": 18.425113886193717, "cost2_min": -110.57529203612697, "cost1_mean": 171.649181354976, "system_level_velocity_min": 11.510805886561165, "cost2_max": -53.29346318290752, "cost1_min": 78.24044518293039, "cost2_mean": -99.45500387536077, "discrim_loss": 0.351753830909729, "outflow_rate_mean": 924.4401093003423, "system_level_velocity_mean": 14.828448292452428, "cost1_max": 211.06347271816088}}
{"sampler_perf": {"mean_inference_ms": 7.614299783771908, "mean_processing_ms": 11.252190206930589, "mean_env_wait_ms": 130.04649438919947}, "policy_reward_mean": {}, "time_since_restore": 13376.770468950272, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3404, "time_total_s": 18578.633987665176, "episode_reward_max": 298.5963343853946, "off_policy_estimator": {}, "episode_reward_min": 88.67564021832368, "episode_reward_mean": 148.24759639380227, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.62757229804993, "timestamp": 1559283741, "episode_len_mean": 325.0, "iterations_since_restore": 107, "training_iteration": 147, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b48c8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b47b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-22-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1060.7646877509121, "outflow_rate_min": 793.4719168745786, "system_level_velocity_max": 17.864702218942547, "cost2_min": -114.98179171957618, "cost1_mean": 179.57533115939458, "system_level_velocity_min": 11.594708498894974, "cost2_max": -87.18041430304257, "cost1_min": 136.7432092921395, "cost2_mean": -104.25136034847985, "discrim_loss": 0.41505560278892517, "outflow_rate_mean": 940.8535511859335, "system_level_velocity_mean": 14.890432675166158, "cost1_max": 212.08836431512532}}
{"sampler_perf": {"mean_inference_ms": 7.6109449804321345, "mean_processing_ms": 11.229612974288166, "mean_env_wait_ms": 130.07566516061502}, "policy_reward_mean": {}, "time_since_restore": 13499.77445602417, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3427, "time_total_s": 18701.637974739075, "episode_reward_max": 235.50971935236885, "off_policy_estimator": {}, "episode_reward_min": 85.09734686522279, "episode_reward_mean": 144.0443632752459, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.00398707389832, "timestamp": 1559283864, "episode_len_mean": 325.0, "iterations_since_restore": 108, "training_iteration": 148, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b40d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324e18>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-24-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.8200258587676, "outflow_rate_min": 792.6817155585659, "system_level_velocity_max": 17.68037117463017, "cost2_min": -114.12725382669157, "cost1_mean": 181.81242843960064, "system_level_velocity_min": 11.522233729774193, "cost2_max": -91.70758012534245, "cost1_min": 137.03721563290577, "cost2_mean": -105.88998956370004, "discrim_loss": 0.38791391253471375, "outflow_rate_mean": 947.8298729309366, "system_level_velocity_mean": 15.04806781919848, "cost1_max": 211.55073249953614}}
{"sampler_perf": {"mean_inference_ms": 7.6195470433284065, "mean_processing_ms": 11.237514653183531, "mean_env_wait_ms": 130.0191145809906}, "policy_reward_mean": {}, "time_since_restore": 13626.370471715927, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3449, "time_total_s": 18828.233990430832, "episode_reward_max": 305.12169539625756, "off_policy_estimator": {}, "episode_reward_min": 123.88451219824492, "episode_reward_mean": 178.38430771248758, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 126.5960156917572, "timestamp": 1559283991, "episode_len_mean": 325.0, "iterations_since_restore": 109, "training_iteration": 149, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324620>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-26-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.5096718614438, "outflow_rate_min": 807.4677804844858, "system_level_velocity_max": 17.693648714533776, "cost2_min": -114.30566567466303, "cost1_mean": 176.94464490773308, "system_level_velocity_min": 12.0035374413417, "cost2_max": -88.39015596215216, "cost1_min": 144.61552882812992, "cost2_mean": -104.92142777463305, "discrim_loss": 0.35499969124794006, "outflow_rate_mean": 933.4789663743524, "system_level_velocity_mean": 14.67723019354461, "cost1_max": 210.3151568887671}}
{"sampler_perf": {"mean_inference_ms": 7.617054664402549, "mean_processing_ms": 11.241937290619036, "mean_env_wait_ms": 130.11445928257834}, "policy_reward_mean": {}, "time_since_restore": 13750.95727300644, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3472, "time_total_s": 18952.820791721344, "episode_reward_max": 265.8666114771622, "off_policy_estimator": {}, "episode_reward_min": 146.132675482193, "episode_reward_mean": 199.45467929954634, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.58680129051208, "timestamp": 1559284116, "episode_len_mean": 325.0, "iterations_since_restore": 110, "training_iteration": 150, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2048>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a0d0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-28-36", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.7093204317257, "outflow_rate_min": 898.4167334067204, "system_level_velocity_max": 17.720226915771686, "cost2_min": -111.06372139276084, "cost1_mean": 184.4847285128815, "system_level_velocity_min": 13.740220486995002, "cost2_max": -98.60727100077408, "cost1_min": 166.01342712325908, "cost2_mean": -104.37924141839069, "discrim_loss": 0.37682363390922546, "outflow_rate_mean": 965.5857100034208, "system_level_velocity_mean": 15.374663903969031, "cost1_max": 211.23586368222612}}
{"sampler_perf": {"mean_inference_ms": 7.613306148860023, "mean_processing_ms": 11.242736538566744, "mean_env_wait_ms": 130.11646470729042}, "policy_reward_mean": {}, "time_since_restore": 13876.790177345276, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3497, "time_total_s": 19078.65369606018, "episode_reward_max": 218.22771146619925, "off_policy_estimator": {}, "episode_reward_min": 100.73242926115927, "episode_reward_mean": 146.22991172832124, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.83290433883667, "timestamp": 1559284243, "episode_len_mean": 325.0, "iterations_since_restore": 111, "training_iteration": 151, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-30-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.277585481226, "outflow_rate_min": 815.0465411368052, "system_level_velocity_max": 17.727043097708368, "cost2_min": -112.91262943097776, "cost1_mean": 182.0900420630708, "system_level_velocity_min": 11.757083761887023, "cost2_max": -92.42443769583889, "cost1_min": 139.92848106176643, "cost2_mean": -105.60366441611772, "discrim_loss": 0.3107483386993408, "outflow_rate_mean": 950.5630899610177, "system_level_velocity_mean": 15.094003944890924, "cost1_max": 211.38482049321078}}
{"sampler_perf": {"mean_inference_ms": 7.622693237491653, "mean_processing_ms": 11.254461127467719, "mean_env_wait_ms": 130.13535709475846}, "policy_reward_mean": {}, "time_since_restore": 14004.304493427277, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3520, "time_total_s": 19206.16801214218, "episode_reward_max": 202.4035119121545, "off_policy_estimator": {}, "episode_reward_min": 51.475947031751275, "episode_reward_mean": 114.75797456198498, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 127.51431608200073, "timestamp": 1559284370, "episode_len_mean": 315.95652173913044, "iterations_since_restore": 112, "training_iteration": 152, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4488>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b42f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4950>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-32-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.3061168889544, "outflow_rate_min": 734.928141881339, "system_level_velocity_max": 18.364653777054514, "cost2_min": -112.96202779377076, "cost1_mean": 173.78982605573313, "system_level_velocity_min": 11.58691413110316, "cost2_max": -54.11435704615975, "cost1_min": 77.91648684276458, "cost2_mean": -101.73085556518382, "discrim_loss": 0.3906688392162323, "outflow_rate_mean": 932.7612027898078, "system_level_velocity_mean": 14.964975216712649, "cost1_max": 211.03221890688113}}
{"sampler_perf": {"mean_inference_ms": 7.6235028562103935, "mean_processing_ms": 11.238793550957249, "mean_env_wait_ms": 130.17235491793846}, "policy_reward_mean": {}, "time_since_restore": 14132.772196769714, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3542, "time_total_s": 19334.63571548462, "episode_reward_max": 244.34615795814898, "off_policy_estimator": {}, "episode_reward_min": 97.82437865580141, "episode_reward_mean": 148.36222477088606, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.46770334243774, "timestamp": 1559284499, "episode_len_mean": 315.95454545454544, "iterations_since_restore": 113, "training_iteration": 153, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-34-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.9831369195815, "outflow_rate_min": 745.1208642739729, "system_level_velocity_max": 18.549259489858013, "cost2_min": -113.4798748515227, "cost1_mean": 174.76584563014444, "system_level_velocity_min": 11.81243998931322, "cost2_max": -57.307175485928035, "cost1_min": 83.95348699406681, "cost2_mean": -103.96941210773637, "discrim_loss": 0.3626043200492859, "outflow_rate_mean": 928.4642382404716, "system_level_velocity_mean": 14.97213202755824, "cost1_max": 212.630104953562}}
{"sampler_perf": {"mean_inference_ms": 7.613225133961035, "mean_processing_ms": 11.250077246158462, "mean_env_wait_ms": 130.21446662384665}, "policy_reward_mean": {}, "time_since_restore": 14257.47779417038, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3567, "time_total_s": 19459.341312885284, "episode_reward_max": 343.26179833261995, "off_policy_estimator": {}, "episode_reward_min": 125.00134058765252, "episode_reward_mean": 184.4085135031852, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.70559740066528, "timestamp": 1559284624, "episode_len_mean": 325.0, "iterations_since_restore": 114, "training_iteration": 154, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303659d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365950>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-37-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.8434535544463, "outflow_rate_min": 894.1147283834733, "system_level_velocity_max": 17.632137546557146, "cost2_min": -114.16114776741503, "cost1_mean": 180.94527195124837, "system_level_velocity_min": 13.743618796251887, "cost2_max": -99.21047880889387, "cost1_min": 166.39352888433268, "cost2_mean": -105.46645923723312, "discrim_loss": 0.3431553840637207, "outflow_rate_mean": 950.6630971056185, "system_level_velocity_mean": 15.031197813721796, "cost1_max": 210.3817950527437}}
{"sampler_perf": {"mean_inference_ms": 7.621294392188808, "mean_processing_ms": 11.246803664823076, "mean_env_wait_ms": 130.19285450601373}, "policy_reward_mean": {}, "time_since_restore": 14385.780329942703, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3590, "time_total_s": 19587.643848657608, "episode_reward_max": 256.3698120099143, "off_policy_estimator": {}, "episode_reward_min": 123.65248859947314, "episode_reward_mean": 175.13316018949996, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 128.3025357723236, "timestamp": 1559284752, "episode_len_mean": 325.0, "iterations_since_restore": 115, "training_iteration": 155, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4510>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b40d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-39-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.9114146107013, "outflow_rate_min": 788.2698195000718, "system_level_velocity_max": 17.794768008665628, "cost2_min": -114.23638110846127, "cost1_mean": 179.90939228643398, "system_level_velocity_min": 11.655880443059962, "cost2_max": -87.70742176411565, "cost1_min": 137.71550106929112, "cost2_mean": -104.5372558883696, "discrim_loss": 0.36296939849853516, "outflow_rate_mean": 943.5451685425397, "system_level_velocity_mean": 14.925033544655996, "cost1_max": 211.4251383351395}}
{"sampler_perf": {"mean_inference_ms": 7.624466298809844, "mean_processing_ms": 11.252466586265358, "mean_env_wait_ms": 130.16158189270718}, "policy_reward_mean": {}, "time_since_restore": 14509.921130895615, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3613, "time_total_s": 19711.78464961052, "episode_reward_max": 209.0601287408208, "off_policy_estimator": {}, "episode_reward_min": 55.488838916644454, "episode_reward_mean": 134.67130587515058, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.14080095291138, "timestamp": 1559284876, "episode_len_mean": 316.5217391304348, "iterations_since_restore": 116, "training_iteration": 156, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c28c8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c27b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2730>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-41-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1057.6248846657745, "outflow_rate_min": 726.895779014298, "system_level_velocity_max": 18.430296042215325, "cost2_min": -113.20603520477046, "cost1_mean": 176.35057991215766, "system_level_velocity_min": 9.546732613579795, "cost2_max": -58.28803842204154, "cost1_min": 86.11185092313227, "cost2_mean": -103.59941597038883, "discrim_loss": 0.31035327911376953, "outflow_rate_mean": 934.7485872086396, "system_level_velocity_mean": 15.085445377161282, "cost1_max": 211.94467021630393}}
{"sampler_perf": {"mean_inference_ms": 7.612895392381873, "mean_processing_ms": 11.253559748058196, "mean_env_wait_ms": 130.19996551778266}, "policy_reward_mean": {}, "time_since_restore": 14626.108563899994, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 3637, "time_total_s": 19827.9720826149, "episode_reward_max": 168.44278636206218, "off_policy_estimator": {}, "episode_reward_min": 85.81935791813157, "episode_reward_mean": 129.9982368436907, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 116.18743300437927, "timestamp": 1559284992, "episode_len_mean": 325.0, "iterations_since_restore": 117, "training_iteration": 157, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930425268>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-43-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1059.008133518541, "outflow_rate_min": 842.475189966032, "system_level_velocity_max": 17.89656903105762, "cost2_min": -113.39047202965057, "cost1_mean": 184.69532981543435, "system_level_velocity_min": 12.720416273235493, "cost2_max": -98.73251249657234, "cost1_min": 155.39858491657688, "cost2_mean": -106.10172020306038, "discrim_loss": 0.38818466663360596, "outflow_rate_mean": 960.2870787607493, "system_level_velocity_mean": 15.32875362377743, "cost1_max": 212.22426655082933}}
{"sampler_perf": {"mean_inference_ms": 7.620377893949886, "mean_processing_ms": 11.255805201779713, "mean_env_wait_ms": 130.12849700612688}, "policy_reward_mean": {}, "time_since_restore": 14750.539406061172, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3660, "time_total_s": 19952.402924776077, "episode_reward_max": 247.55285098844615, "off_policy_estimator": {}, "episode_reward_min": 103.26574199652532, "episode_reward_mean": 148.16746552269876, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.43084216117859, "timestamp": 1559285117, "episode_len_mean": 325.0, "iterations_since_restore": 118, "training_iteration": 158, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4a60>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4598>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-45-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1054.5687170055678, "outflow_rate_min": 842.9717048242203, "system_level_velocity_max": 17.753856603281523, "cost2_min": -113.6647949837795, "cost1_mean": 180.0550875006878, "system_level_velocity_min": 12.618277432675809, "cost2_max": -98.67446656379475, "cost1_min": 153.68167625698453, "cost2_mean": -106.59522144185061, "discrim_loss": 0.35093849897384644, "outflow_rate_mean": 944.2014961978266, "system_level_velocity_mean": 14.919862024219958, "cost1_max": 211.09010126514784}}
{"sampler_perf": {"mean_inference_ms": 7.624810788898381, "mean_processing_ms": 11.25134312397093, "mean_env_wait_ms": 130.20377850234578}, "policy_reward_mean": {}, "time_since_restore": 14875.746050596237, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3682, "time_total_s": 20077.609569311142, "episode_reward_max": 359.8678381694481, "off_policy_estimator": {}, "episode_reward_min": 129.84809538077388, "episode_reward_mean": 207.81662654561595, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.2066445350647, "timestamp": 1559285242, "episode_len_mean": 325.0, "iterations_since_restore": 119, "training_iteration": 159, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c28c8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c27b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-47-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.0364202001413, "outflow_rate_min": 789.9824956989321, "system_level_velocity_max": 17.934101031425623, "cost2_min": -113.47660648595446, "cost1_mean": 176.3807629945718, "system_level_velocity_min": 11.739836865970748, "cost2_max": -86.50812228213168, "cost1_min": 139.2451293943459, "cost2_mean": -103.54560759362768, "discrim_loss": 0.35138365626335144, "outflow_rate_mean": 929.428340780234, "system_level_velocity_mean": 14.631734939734002, "cost1_max": 212.13188702018792}}
{"sampler_perf": {"mean_inference_ms": 7.613656430801757, "mean_processing_ms": 11.247703187985254, "mean_env_wait_ms": 130.14792013863243}, "policy_reward_mean": {}, "time_since_restore": 14993.956559419632, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3705, "time_total_s": 20195.820078134537, "episode_reward_max": 247.19893724593567, "off_policy_estimator": {}, "episode_reward_min": 103.64007486272021, "episode_reward_mean": 169.51284550088212, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 118.21050882339478, "timestamp": 1559285360, "episode_len_mean": 325.0, "iterations_since_restore": 120, "training_iteration": 160, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324598>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-49-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.7483164130115, "outflow_rate_min": 769.1533950969258, "system_level_velocity_max": 17.78834937220388, "cost2_min": -113.45243437294134, "cost1_mean": 186.1724593762555, "system_level_velocity_min": 11.430921779019654, "cost2_max": -86.66934261600076, "cost1_min": 137.00637687077824, "cost2_mean": -104.65693645955537, "discrim_loss": 0.3548797070980072, "outflow_rate_mean": 964.0292954290657, "system_level_velocity_mean": 15.47598056649728, "cost1_max": 212.27913687380405}}
{"sampler_perf": {"mean_inference_ms": 7.615435680992543, "mean_processing_ms": 11.235853495552607, "mean_env_wait_ms": 130.10588202105936}, "policy_reward_mean": {}, "time_since_restore": 15118.376737356186, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3728, "time_total_s": 20320.24025607109, "episode_reward_max": 175.8567050894635, "off_policy_estimator": {}, "episode_reward_min": 73.95339789339414, "episode_reward_mean": 112.21146680633643, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.42017793655396, "timestamp": 1559285485, "episode_len_mean": 325.0, "iterations_since_restore": 121, "training_iteration": 161, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324378>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-51-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.1845770559346, "outflow_rate_min": 912.833664617754, "system_level_velocity_max": 17.77798402040546, "cost2_min": -112.58921231142574, "cost1_mean": 184.04362264733751, "system_level_velocity_min": 14.009255841864663, "cost2_max": -98.87730522576149, "cost1_min": 169.52612078828022, "cost2_mean": -106.78344606920422, "discrim_loss": 0.2796853482723236, "outflow_rate_mean": 958.3180863740814, "system_level_velocity_mean": 15.252201835384456, "cost1_max": 210.53611479354882}}
{"sampler_perf": {"mean_inference_ms": 7.618067768231256, "mean_processing_ms": 11.25821446612719, "mean_env_wait_ms": 130.06885719952118}, "policy_reward_mean": {}, "time_since_restore": 15240.37278342247, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 3752, "time_total_s": 20442.236302137375, "episode_reward_max": 220.72414146291703, "off_policy_estimator": {}, "episode_reward_min": 81.84983196569374, "episode_reward_mean": 123.58636325908911, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.99604606628418, "timestamp": 1559285607, "episode_len_mean": 325.0, "iterations_since_restore": 122, "training_iteration": 162, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c28c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c27b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-53-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1062.7891856927652, "outflow_rate_min": 791.6996127570053, "system_level_velocity_max": 17.82591996600282, "cost2_min": -113.26501329997014, "cost1_mean": 179.8954198461917, "system_level_velocity_min": 11.730684571826972, "cost2_max": -92.85960757184422, "cost1_min": 140.31971953201375, "cost2_mean": -105.96050636608105, "discrim_loss": 0.36409857869148254, "outflow_rate_mean": 943.1808553094694, "system_level_velocity_mean": 14.923725991700858, "cost1_max": 211.42412674189308}}
{"sampler_perf": {"mean_inference_ms": 7.614386889091117, "mean_processing_ms": 11.250984150889098, "mean_env_wait_ms": 130.1480053824384}, "policy_reward_mean": {}, "time_since_restore": 15364.363020420074, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3774, "time_total_s": 20566.22653913498, "episode_reward_max": 336.6455068699797, "off_policy_estimator": {}, "episode_reward_min": 107.75179588879837, "episode_reward_mean": 178.85812797487895, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.99023699760437, "timestamp": 1559285733, "episode_len_mean": 325.0, "iterations_since_restore": 123, "training_iteration": 163, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4ea0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b41e0>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-55-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1071.2461946210326, "outflow_rate_min": 829.2659508145096, "system_level_velocity_max": 18.16932435167134, "cost2_min": -114.21523977240855, "cost1_mean": 179.06389842828833, "system_level_velocity_min": 12.708200772478342, "cost2_max": -91.81511211316545, "cost1_min": 154.20290940845092, "cost2_mean": -103.70961798343941, "discrim_loss": 0.3500629663467407, "outflow_rate_mean": 939.3196373232477, "system_level_velocity_mean": 14.8757213045999, "cost1_max": 213.42211024133556}}
{"sampler_perf": {"mean_inference_ms": 7.615907233000218, "mean_processing_ms": 11.24175830335561, "mean_env_wait_ms": 130.15418652390028}, "policy_reward_mean": {}, "time_since_restore": 15486.259655714035, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 3798, "time_total_s": 20688.12317442894, "episode_reward_max": 364.401245686342, "off_policy_estimator": {}, "episode_reward_min": 123.15158018262446, "episode_reward_mean": 181.3410545112431, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 121.89663529396057, "timestamp": 1559285855, "episode_len_mean": 325.0, "iterations_since_restore": 124, "training_iteration": 164, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-57-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1048.1629417929557, "outflow_rate_min": 837.1612564547714, "system_level_velocity_max": 17.626239823885083, "cost2_min": -113.3620961507897, "cost1_mean": 181.71830307198448, "system_level_velocity_min": 12.309251089009791, "cost2_max": -98.93372603202113, "cost1_min": 149.790375467697, "cost2_mean": -107.0002216868664, "discrim_loss": 0.33113348484039307, "outflow_rate_mean": 949.3196488796217, "system_level_velocity_mean": 15.047186997678642, "cost1_max": 210.32773442304392}}
{"sampler_perf": {"mean_inference_ms": 7.6190155322588025, "mean_processing_ms": 11.263440177068444, "mean_env_wait_ms": 130.06862322528414}, "policy_reward_mean": {}, "time_since_restore": 15610.46305513382, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 3822, "time_total_s": 20812.326573848724, "episode_reward_max": 304.75407132145483, "off_policy_estimator": {}, "episode_reward_min": 99.93103960211738, "episode_reward_mean": 152.38967252295518, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 124.20339941978455, "timestamp": 1559285979, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 125, "training_iteration": 165, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303659d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303658c8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_06-59-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1053.1915044189213, "outflow_rate_min": 818.3479516409649, "system_level_velocity_max": 17.77331506314481, "cost2_min": -114.65897465421055, "cost1_mean": 183.60820891760508, "system_level_velocity_min": 12.083010481973409, "cost2_max": -93.69273205999733, "cost1_min": 144.61666451571676, "cost2_mean": -103.08364239591425, "discrim_loss": 0.35662829875946045, "outflow_rate_mean": 957.9355839403925, "system_level_velocity_mean": 15.312607152120792, "cost1_max": 211.37173684789855}}
{"sampler_perf": {"mean_inference_ms": 7.614206071483725, "mean_processing_ms": 11.252897093699904, "mean_env_wait_ms": 130.13868255643564}, "policy_reward_mean": {}, "time_since_restore": 15732.65693974495, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3844, "time_total_s": 20934.520458459854, "episode_reward_max": 241.79189679744377, "off_policy_estimator": {}, "episode_reward_min": 8.367677519796416, "episode_reward_mean": 109.86334819111329, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.19388461112976, "timestamp": 1559286101, "episode_len_mean": 311.45454545454544, "iterations_since_restore": 126, "training_iteration": 166, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1950>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c18c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c17b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-01-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1064.644445237848, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 17.985819905646164, "cost2_min": -113.23551741025219, "cost1_mean": 171.86110505217735, "system_level_velocity_min": 11.934827888934244, "cost2_max": -21.71905754291568, "cost1_min": 17.92522419000229, "cost2_mean": -102.0744362181766, "discrim_loss": 0.26963314414024353, "outflow_rate_mean": 917.1080312300156, "system_level_velocity_mean": 14.961922185845811, "cost1_max": 212.44329580466598}}
{"sampler_perf": {"mean_inference_ms": 7.6142494943646035, "mean_processing_ms": 11.255237276956525, "mean_env_wait_ms": 130.1469972358386}, "policy_reward_mean": {}, "time_since_restore": 15857.769023895264, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 25, "episodes_total": 3869, "time_total_s": 21059.63254261017, "episode_reward_max": 312.0137125112815, "off_policy_estimator": {}, "episode_reward_min": 85.82689143867901, "episode_reward_mean": 158.88817185599126, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.11208415031433, "timestamp": 1559286226, "episode_len_mean": 325.0, "iterations_since_restore": 127, "training_iteration": 167, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2730>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c28c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c27b8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-03-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1055.7701798786027, "outflow_rate_min": 791.8699853188448, "system_level_velocity_max": 17.8078250549011, "cost2_min": -109.80027768735528, "cost1_mean": 178.7337012724247, "system_level_velocity_min": 11.70806188899018, "cost2_max": -86.33685643145435, "cost1_min": 137.02222528421365, "cost2_mean": -101.0157350316114, "discrim_loss": 0.3848155736923218, "outflow_rate_mean": 944.3803367993663, "system_level_velocity_mean": 14.90981209834792, "cost1_max": 211.59849137419107}}
{"sampler_perf": {"mean_inference_ms": 7.612221867130029, "mean_processing_ms": 11.259257974911051, "mean_env_wait_ms": 130.04694715661577}, "policy_reward_mean": {}, "time_since_restore": 15980.093074083328, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3892, "time_total_s": 21181.956592798233, "episode_reward_max": 212.02142099366756, "off_policy_estimator": {}, "episode_reward_min": 98.66162041434654, "episode_reward_mean": 132.3450130881609, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 122.32405018806458, "timestamp": 1559286349, "episode_len_mean": 325.0, "iterations_since_restore": 128, "training_iteration": 168, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-05-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.3774360749642, "outflow_rate_min": 899.7448908043833, "system_level_velocity_max": 17.853906643806113, "cost2_min": -111.51967685664499, "cost1_mean": 185.58217391290233, "system_level_velocity_min": 13.90807285694647, "cost2_max": -98.870120261383, "cost1_min": 169.12034895277856, "cost2_mean": -106.24419900760894, "discrim_loss": 0.30806270241737366, "outflow_rate_mean": 964.2119067852793, "system_level_velocity_mean": 15.428214342215936, "cost1_max": 212.00930575716234}}
{"sampler_perf": {"mean_inference_ms": 7.621638576573691, "mean_processing_ms": 11.2503007134291, "mean_env_wait_ms": 130.0693439631799}, "policy_reward_mean": {}, "time_since_restore": 16103.569581747055, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3914, "time_total_s": 21305.43310046196, "episode_reward_max": 352.23530031670816, "off_policy_estimator": {}, "episode_reward_min": 119.87696914132539, "episode_reward_mean": 188.37489799738503, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.4765076637268, "timestamp": 1559286472, "episode_len_mean": 325.0, "iterations_since_restore": 129, "training_iteration": 169, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c17b8>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c18c8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-07-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.2205406538792, "outflow_rate_min": 776.3844729306174, "system_level_velocity_max": 17.97871420544914, "cost2_min": -112.82248902026956, "cost1_mean": 177.40200247021264, "system_level_velocity_min": 11.26639953146017, "cost2_max": -85.40798897303428, "cost1_min": 134.0276679707669, "cost2_mean": -104.9050567057644, "discrim_loss": 0.3399573862552643, "outflow_rate_mean": 932.427180668058, "system_level_velocity_mean": 14.682260164775586, "cost1_max": 212.23303987208425}}
{"sampler_perf": {"mean_inference_ms": 7.611111743674894, "mean_processing_ms": 11.25159820226927, "mean_env_wait_ms": 130.1121259879402}, "policy_reward_mean": {}, "time_since_restore": 16227.1973092556, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 24, "episodes_total": 3938, "time_total_s": 21429.060827970505, "episode_reward_max": 216.7466649635171, "off_policy_estimator": {}, "episode_reward_min": 91.76306728260442, "episode_reward_mean": 147.57799247579462, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 123.62772750854492, "timestamp": 1559286596, "episode_len_mean": 325.0, "iterations_since_restore": 130, "training_iteration": 170, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c20d0>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2ae8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-09-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1056.880663096532, "outflow_rate_min": 749.8245669133153, "system_level_velocity_max": 17.784667744078273, "cost2_min": -114.04669454776511, "cost1_mean": 180.53780297755873, "system_level_velocity_min": 10.949754469291335, "cost2_max": -88.32118633151006, "cost1_min": 130.98397675221827, "cost2_mean": -107.75684908980821, "discrim_loss": 0.31867721676826477, "outflow_rate_mean": 942.4633102489958, "system_level_velocity_mean": 14.931562156009448, "cost1_max": 211.32699748586936}}
{"sampler_perf": {"mean_inference_ms": 7.6185912970067085, "mean_processing_ms": 11.259498484515898, "mean_env_wait_ms": 130.08311513699726}, "policy_reward_mean": {}, "time_since_restore": 16353.111046552658, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 23, "episodes_total": 3961, "time_total_s": 21554.974565267563, "episode_reward_max": 323.81770886913, "off_policy_estimator": {}, "episode_reward_min": 81.10162806558219, "episode_reward_mean": 132.8164732898642, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 125.9137372970581, "timestamp": 1559286722, "episode_len_mean": 325.0, "iterations_since_restore": 131, "training_iteration": 171, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375f28>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303242f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-12-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1030.7455981339579, "outflow_rate_min": 785.4310764850009, "system_level_velocity_max": 17.083183573766537, "cost2_min": -114.64644656728663, "cost1_mean": 174.85610477517557, "system_level_velocity_min": 11.537521550788789, "cost2_max": -90.40958195574854, "cost1_min": 137.13791944418284, "cost2_mean": -103.63151938488711, "discrim_loss": 0.27283281087875366, "outflow_rate_mean": 927.6310337867834, "system_level_velocity_mean": 14.53505728136953, "cost1_max": 204.60924571388074}}
{"sampler_perf": {"mean_inference_ms": 7.624405119088123, "mean_processing_ms": 11.256166535713875, "mean_env_wait_ms": 130.1381012156771}, "policy_reward_mean": {}, "time_since_restore": 16474.04908156395, "experiment_id": "a3473f24edb640f09580616789b29b9e", "episodes_this_iter": 22, "episodes_total": 3983, "time_total_s": 21675.912600278854, "episode_reward_max": 197.764339197136, "off_policy_estimator": {}, "episode_reward_min": 101.83283118724103, "episode_reward_mean": 148.55412271610749, "pid": 7173, "num_metric_batches_dropped": 0, "done": false, "time_this_iter_s": 120.9380350112915, "timestamp": 1559286845, "episode_len_mean": 325.0, "iterations_since_restore": 132, "training_iteration": 172, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "grad_clip": null, "optimizer": {}, "log_level": "INFO", "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"custom_options": {}, "framestack": true, "use_lstm": false, "squash_to_range": false, "custom_preprocessor": null, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "max_seq_len": 20, "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false, "free_log_std": false, "lstm_cell_size": 256, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "fcnet_activation": "tanh"}, "custom_resources_per_worker": {}, "remote_worker_envs": false, "straggler_mitigation": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "lr": 0.0005, "discrim_lr": 0.01, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "ignore_worker_failures": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "input": "sampler", "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2400>)", "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "clip_actions": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "num_gpus_per_worker": 0, "gamma": 0.99, "shuffle_buffer_size": 0, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "compress_observations": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false}, "date": "2019-05-31_07-14-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1059.1655453425487, "outflow_rate_min": 785.0839024698307, "system_level_velocity_max": 18.02323968873306, "cost2_min": -112.48358939287289, "cost1_mean": 181.74622925423898, "system_level_velocity_min": 11.561577232883087, "cost2_max": -93.97757431155955, "cost1_min": 136.89312231079472, "cost2_mean": -104.98534765592595, "discrim_loss": 0.37363573908805847, "outflow_rate_mean": 950.8255100772046, "system_level_velocity_mean": 15.111740522346896, "cost1_max": 213.35190371654622}}

{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 145.6418583393097, "sampler_perf": {"mean_inference_ms": 7.671827673118377, "mean_processing_ms": 9.863158485067194, "mean_env_wait_ms": 130.8293795934847}, "episodes_this_iter": 20, "episodes_total": 20, "time_total_s": 145.6418583393097, "episode_reward_max": 764.131863296032, "episode_reward_mean": 636.3492102652788, "episode_reward_min": 419.4953553080559, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 145.6418583393097, "timestamp": 1559264426, "episode_len_mean": 325.0, "iterations_since_restore": 1, "training_iteration": 1, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3378>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-00-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 815.85479148927, "outflow_rate_min": 588.9521647141568, "system_level_velocity_max": 12.48202860578092, "cost2_min": -82.01854050905104, "system_level_velocity_min": 8.828625944858361, "cost1_min": 107.05664623263658, "cost1_max": 149.43908989726174, "cost2_mean": -48.56348234325817, "discrim_loss": 1.3870391845703125, "cost1_mean": 125.89148193066708, "outflow_rate_mean": 732.6820272274845, "system_level_velocity_mean": 10.484985598571706, "cost2_max": -29.735390445785463}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 264.6338758468628, "sampler_perf": {"mean_inference_ms": 7.478888363618997, "mean_processing_ms": 10.241234945822047, "mean_env_wait_ms": 127.00944515484957}, "episodes_this_iter": 20, "episodes_total": 40, "time_total_s": 264.6338758468628, "episode_reward_max": 719.2797629833221, "episode_reward_mean": 624.486938008666, "episode_reward_min": 530.2142186760902, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.9920175075531, "timestamp": 1559264545, "episode_len_mean": 325.0, "iterations_since_restore": 2, "training_iteration": 2, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-02-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 828.3848774563075, "outflow_rate_min": 681.2720711406055, "system_level_velocity_max": 12.540290477966948, "cost2_min": -74.3086336517083, "system_level_velocity_min": 8.659319027343702, "cost1_min": 103.28284200120379, "cost1_max": 152.3191348561514, "cost2_mean": -49.49854934957658, "discrim_loss": 1.3393211364746094, "cost1_mean": 131.91181605287184, "outflow_rate_mean": 755.8588991844149, "system_level_velocity_mean": 10.95305975352149, "cost2_max": -33.72409667636916}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 378.3941640853882, "sampler_perf": {"mean_inference_ms": 7.336988008483045, "mean_processing_ms": 9.849668237592102, "mean_env_wait_ms": 125.79111197110228}, "episodes_this_iter": 20, "episodes_total": 60, "time_total_s": 378.3941640853882, "episode_reward_max": 770.1431078612804, "episode_reward_mean": 675.2004759192466, "episode_reward_min": 534.934070289135, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.76028823852539, "timestamp": 1559264659, "episode_len_mean": 325.0, "iterations_since_restore": 3, "training_iteration": 3, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039ba60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039bbf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039bb70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039bae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-04-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 886.3898422077664, "outflow_rate_min": 676.8565954177828, "system_level_velocity_max": 13.7035689387968, "cost2_min": -91.17727746601385, "system_level_velocity_min": 10.079054063382008, "cost1_min": 121.49412603277018, "cost1_max": 166.7859012596752, "cost2_mean": -64.61319488752238, "discrim_loss": 1.2943545579910278, "cost1_mean": 141.6629356766584, "outflow_rate_mean": 787.6735285998403, "system_level_velocity_mean": 11.68660677357916, "cost2_max": -40.45863054773119}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 496.3139114379883, "sampler_perf": {"mean_inference_ms": 7.352215566066298, "mean_processing_ms": 10.452895742859372, "mean_env_wait_ms": 126.59342834767557}, "episodes_this_iter": 30, "episodes_total": 90, "time_total_s": 496.3139114379883, "episode_reward_max": 845.3557168245316, "episode_reward_mean": 710.3413870920738, "episode_reward_min": 624.438038110733, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 117.9197473526001, "timestamp": 1559264777, "episode_len_mean": 325.0, "iterations_since_restore": 4, "training_iteration": 4, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-06-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.3982282380953, "outflow_rate_min": 779.5688546190833, "system_level_velocity_max": 16.084211957232593, "cost2_min": -114.55964286158832, "system_level_velocity_min": 11.422827096915498, "cost1_min": 136.9833437990277, "cost1_max": 194.1774033096634, "cost2_mean": -84.68194273495506, "discrim_loss": 1.3618602752685547, "cost1_mean": 162.84954877376626, "outflow_rate_mean": 872.0466994946496, "system_level_velocity_mean": 13.414063543439589, "cost2_max": -57.360962775874796}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 620.346108675003, "sampler_perf": {"mean_inference_ms": 7.423758080913936, "mean_processing_ms": 10.293132837407907, "mean_env_wait_ms": 128.50102762386535}, "episodes_this_iter": 20, "episodes_total": 110, "time_total_s": 620.346108675003, "episode_reward_max": 744.762602083385, "episode_reward_mean": 659.8218612436206, "episode_reward_min": 594.6301893293858, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 124.03219723701477, "timestamp": 1559264901, "episode_len_mean": 325.0, "iterations_since_restore": 5, "training_iteration": 5, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793033aa60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793033a9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793033ab70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793033aae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-08-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.6951505220237, "outflow_rate_min": 811.5271418765171, "system_level_velocity_max": 16.548490058167406, "cost2_min": -131.1009610959017, "system_level_velocity_min": 12.307018485322063, "cost1_min": 148.03907786813278, "cost1_max": 199.71336336363188, "cost2_mean": -110.80792536509405, "discrim_loss": 1.4588209390640259, "cost1_mean": 179.49674061458785, "outflow_rate_mean": 924.5069483080339, "system_level_velocity_mean": 14.799279007914151, "cost2_max": -87.81952488276306}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 752.276447057724, "sampler_perf": {"mean_inference_ms": 7.529933181626123, "mean_processing_ms": 10.310621290654582, "mean_env_wait_ms": 131.579663911638}, "episodes_this_iter": 21, "episodes_total": 131, "time_total_s": 752.276447057724, "episode_reward_max": 756.7092398107052, "episode_reward_mean": 676.5525655966429, "episode_reward_min": 57.507882207632065, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 131.93033838272095, "timestamp": 1559265033, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 6, "training_iteration": 6, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793039b378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793039b510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793039b488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793039b400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-10-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.048055170445, "outflow_rate_min": 442.8785900830537, "system_level_velocity_max": 18.0843571855822, "cost2_min": -134.6999024817917, "system_level_velocity_min": 12.181610583381888, "cost1_min": 17.90032593404124, "cost1_max": 218.43284392890573, "cost2_mean": -115.60532859055517, "discrim_loss": 1.4573655128479004, "cost1_mean": 172.26845968413338, "outflow_rate_mean": 912.2842054826758, "system_level_velocity_mean": 15.07762235977306, "cost2_max": -20.835496887382654}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 884.0406143665314, "sampler_perf": {"mean_inference_ms": 7.572908983573851, "mean_processing_ms": 10.709946461119806, "mean_env_wait_ms": 132.73262605737946}, "episodes_this_iter": 30, "episodes_total": 161, "time_total_s": 884.0406143665314, "episode_reward_max": 780.8975711911917, "episode_reward_mean": 717.2262205819289, "episode_reward_min": 660.9685507267714, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 131.76416730880737, "timestamp": 1559265165, "episode_len_mean": 325.0, "iterations_since_restore": 7, "training_iteration": 7, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-12-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.6083022025143, "outflow_rate_min": 851.0042422004582, "system_level_velocity_max": 18.565255813050346, "cost2_min": -144.25842034640965, "system_level_velocity_min": 12.657942769915673, "cost1_min": 151.83507694469438, "cost1_max": 221.84444594706994, "cost2_mean": -123.88857525066643, "discrim_loss": 1.4139233827590942, "cost1_mean": 186.42493095251365, "outflow_rate_mean": 967.3656128170848, "system_level_velocity_mean": 15.674943058162702, "cost2_max": -107.83974715268275}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1013.3313875198364, "sampler_perf": {"mean_inference_ms": 7.574440653851343, "mean_processing_ms": 10.549522526878809, "mean_env_wait_ms": 133.30479380965647}, "episodes_this_iter": 20, "episodes_total": 181, "time_total_s": 1013.3313875198364, "episode_reward_max": 669.7250585854053, "episode_reward_mean": 608.7763594314456, "episode_reward_min": 384.58618730306625, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 129.29077315330505, "timestamp": 1559265300, "episode_len_mean": 319.6, "iterations_since_restore": 8, "training_iteration": 8, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303a4bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303a4d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303a4d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303a4c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-15-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1085.262548226926, "outflow_rate_min": 797.9997206577785, "system_level_velocity_max": 18.683749032148842, "cost2_min": -153.67590585344973, "system_level_velocity_min": 11.984287628339853, "cost1_min": 141.47014552898656, "cost1_max": 222.29921141044463, "cost2_mean": -128.98690195114597, "discrim_loss": 1.3406040668487549, "cost1_mean": 177.73325537188802, "outflow_rate_mean": 941.484364376795, "system_level_velocity_mean": 15.263000914660328, "cost2_max": -93.7187438188042}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1150.4197084903717, "sampler_perf": {"mean_inference_ms": 7.574135432575754, "mean_processing_ms": 10.541812695043664, "mean_env_wait_ms": 134.46277192940744}, "episodes_this_iter": 21, "episodes_total": 202, "time_total_s": 1150.4197084903717, "episode_reward_max": 618.3430603593588, "episode_reward_mean": 565.4542954996938, "episode_reward_min": 501.8299479186535, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 137.08832097053528, "timestamp": 1559265438, "episode_len_mean": 325.0, "iterations_since_restore": 9, "training_iteration": 9, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303400d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-17-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1090.2203535325382, "outflow_rate_min": 796.3820408369099, "system_level_velocity_max": 19.01989538093591, "cost2_min": -160.1782734533029, "system_level_velocity_min": 11.981062038677592, "cost1_min": 139.2465381634288, "cost1_max": 225.88529979884157, "cost2_mean": -132.34934322650915, "discrim_loss": 1.3077232837677002, "cost1_mean": 181.02001080956066, "outflow_rate_mean": 948.3362293775414, "system_level_velocity_mean": 15.218446598283501, "cost2_max": -114.15198828460738}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1278.4341685771942, "sampler_perf": {"mean_inference_ms": 7.575571036405553, "mean_processing_ms": 10.743223062450562, "mean_env_wait_ms": 134.872399803925}, "episodes_this_iter": 28, "episodes_total": 230, "time_total_s": 1278.4341685771942, "episode_reward_max": 675.5281483083963, "episode_reward_mean": 593.6908660523061, "episode_reward_min": 222.62037262320518, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 128.0144600868225, "timestamp": 1559265567, "episode_len_mean": 317.14285714285717, "iterations_since_restore": 10, "training_iteration": 10, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c32f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c39d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c36a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-19-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1083.4133519959469, "outflow_rate_min": 754.917965330828, "system_level_velocity_max": 19.285953727514556, "cost2_min": -143.41835248463423, "system_level_velocity_min": 13.243708385496793, "cost1_min": 86.55456253481256, "cost1_max": 222.34593688940635, "cost2_mean": -123.98521552671836, "discrim_loss": 1.2915656566619873, "cost1_mean": 184.32808085020002, "outflow_rate_mean": 965.8101535381142, "system_level_velocity_mean": 15.955422618454406, "cost2_max": -64.33481348543783}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1415.664184808731, "sampler_perf": {"mean_inference_ms": 7.594220867680886, "mean_processing_ms": 10.734931438160787, "mean_env_wait_ms": 135.55664876213964}, "episodes_this_iter": 22, "episodes_total": 252, "time_total_s": 1415.664184808731, "episode_reward_max": 893.7257149890065, "episode_reward_mean": 818.6672915677456, "episode_reward_min": 642.6427323818207, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 137.23001623153687, "timestamp": 1559265704, "episode_len_mean": 325.0, "iterations_since_restore": 11, "training_iteration": 11, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c37b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-21-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1085.4823931921119, "outflow_rate_min": 846.6893822660758, "system_level_velocity_max": 18.722507537409257, "cost2_min": -144.8764623190069, "system_level_velocity_min": 12.512167270220305, "cost1_min": 148.3832429925015, "cost1_max": 223.29170806127283, "cost2_mean": -127.16795961794479, "discrim_loss": 1.3098247051239014, "cost1_mean": 174.69928663981239, "outflow_rate_mean": 927.2694318578571, "system_level_velocity_mean": 14.655588522071627, "cost2_max": -111.7344873506217}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1554.0823426246643, "sampler_perf": {"mean_inference_ms": 7.578799195335803, "mean_processing_ms": 10.638066332217173, "mean_env_wait_ms": 136.16025249248446}, "episodes_this_iter": 21, "episodes_total": 273, "time_total_s": 1554.0823426246643, "episode_reward_max": 948.6861412972212, "episode_reward_mean": 882.656791120058, "episode_reward_min": 764.610950499773, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 138.41815781593323, "timestamp": 1559265843, "episode_len_mean": 325.0, "iterations_since_restore": 12, "training_iteration": 12, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930344f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303590d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-24-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1075.91459906976, "outflow_rate_min": 822.451945148542, "system_level_velocity_max": 18.32739289888132, "cost2_min": -141.5370579157808, "system_level_velocity_min": 12.217674452484486, "cost1_min": 145.42328016968668, "cost1_max": 220.30650663012528, "cost2_mean": -124.08835344524634, "discrim_loss": 1.3617596626281738, "cost1_mean": 176.51391376498273, "outflow_rate_mean": 931.9250775668323, "system_level_velocity_mean": 14.82569664352573, "cost2_max": -113.71385361539316}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1683.4172987937927, "sampler_perf": {"mean_inference_ms": 7.552535949104741, "mean_processing_ms": 10.741514061264281, "mean_env_wait_ms": 136.04878388838813}, "episodes_this_iter": 27, "episodes_total": 300, "time_total_s": 1683.4172987937927, "episode_reward_max": 980.8308808505535, "episode_reward_mean": 824.4930408232742, "episode_reward_min": 718.7685244530439, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 129.33495616912842, "timestamp": 1559265972, "episode_len_mean": 325.0, "iterations_since_restore": 13, "training_iteration": 13, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303406a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303400d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-26-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1077.7998502024814, "outflow_rate_min": 771.7676390293115, "system_level_velocity_max": 18.5520906763942, "cost2_min": -137.19631853262683, "system_level_velocity_min": 11.644753458110774, "cost1_min": 136.9296509481598, "cost1_max": 221.6048652033637, "cost2_mean": -118.35458324654054, "discrim_loss": 1.3880140781402588, "cost1_mean": 185.18240860980004, "outflow_rate_mean": 955.7879524412948, "system_level_velocity_mean": 15.45943340414146, "cost2_max": -103.18435731240524}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1806.535175561905, "sampler_perf": {"mean_inference_ms": 7.561073829488306, "mean_processing_ms": 10.694113864751904, "mean_env_wait_ms": 135.74025788162467}, "episodes_this_iter": 21, "episodes_total": 321, "time_total_s": 1806.535175561905, "episode_reward_max": 840.0496059656143, "episode_reward_mean": 696.1680660226515, "episode_reward_min": 620.4504424631596, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.11787676811218, "timestamp": 1559266096, "episode_len_mean": 325.0, "iterations_since_restore": 14, "training_iteration": 14, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930340ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79306d3f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930340f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930340e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-28-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1035.2982295038876, "outflow_rate_min": 863.0079259521625, "system_level_velocity_max": 17.07343313855481, "cost2_min": -137.57151520764893, "system_level_velocity_min": 13.561593992295876, "cost1_min": 160.64884235058474, "cost1_max": 206.09304954524953, "cost2_mean": -113.9357997102725, "discrim_loss": 1.4071509838104248, "cost1_mean": 189.17607350742063, "outflow_rate_mean": 967.1221634605632, "system_level_velocity_mean": 15.688009971262208, "cost2_max": -104.35137997854267}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 1932.1994659900665, "sampler_perf": {"mean_inference_ms": 7.584534326486803, "mean_processing_ms": 10.65331493148598, "mean_env_wait_ms": 136.3267374196316}, "episodes_this_iter": 21, "episodes_total": 342, "time_total_s": 1932.1994659900665, "episode_reward_max": 753.6976336985826, "episode_reward_mean": 617.6062458973555, "episode_reward_min": 558.7426774799824, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 125.66429042816162, "timestamp": 1559266221, "episode_len_mean": 325.0, "iterations_since_restore": 15, "training_iteration": 15, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035f730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-30-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1036.5257391238463, "outflow_rate_min": 766.3238857758354, "system_level_velocity_max": 17.071361481127713, "cost2_min": -123.54457297024301, "system_level_velocity_min": 11.271389622105774, "cost1_min": 136.1309047075495, "cost1_max": 205.8288084553785, "cost2_mean": -108.4013254354131, "discrim_loss": 1.4078913927078247, "cost1_mean": 184.69465521703128, "outflow_rate_mean": 947.497662519656, "system_level_velocity_mean": 15.196535523834811, "cost2_max": -95.54116752214529}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2065.4487459659576, "sampler_perf": {"mean_inference_ms": 7.5984358802888075, "mean_processing_ms": 10.679322297705781, "mean_env_wait_ms": 137.03781124382604}, "episodes_this_iter": 22, "episodes_total": 364, "time_total_s": 2065.4487459659576, "episode_reward_max": 682.6507795155048, "episode_reward_mean": 576.1405865969983, "episode_reward_min": 49.528213173151016, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 133.2492799758911, "timestamp": 1559266359, "episode_len_mean": 311.8181818181818, "iterations_since_restore": 16, "training_iteration": 16, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303628c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303629d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-32-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1032.4577113333914, "outflow_rate_min": 504.5827016154056, "system_level_velocity_max": 18.550388742075814, "cost2_min": -129.98516353880007, "system_level_velocity_min": 12.744648674445871, "cost1_min": 22.92567040926401, "cost1_max": 208.7150114628069, "cost2_mean": -101.1393124348237, "discrim_loss": 1.3658777475357056, "cost1_mean": 172.8166714662302, "outflow_rate_mean": 904.2936557992408, "system_level_velocity_mean": 14.896188681211164, "cost2_max": -21.7512517579732}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2192.998338699341, "sampler_perf": {"mean_inference_ms": 7.602033526483643, "mean_processing_ms": 10.811851234099041, "mean_env_wait_ms": 137.20623465516155}, "episodes_this_iter": 28, "episodes_total": 392, "time_total_s": 2192.998338699341, "episode_reward_max": 817.0772892534733, "episode_reward_mean": 670.0319400738392, "episode_reward_min": 587.8207603693008, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 127.54959273338318, "timestamp": 1559266488, "episode_len_mean": 325.0, "iterations_since_restore": 17, "training_iteration": 17, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-34-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 973.2694573943679, "outflow_rate_min": 696.9687391360471, "system_level_velocity_max": 15.485314455220491, "cost2_min": -117.12766371811226, "system_level_velocity_min": 10.683730063630142, "cost1_min": 128.4047322837845, "cost1_max": 188.77875287149874, "cost2_mean": -98.72616681045334, "discrim_loss": 1.3383285999298096, "cost1_mean": 170.31876291862758, "outflow_rate_mean": 889.4177067862325, "system_level_velocity_mean": 13.923463168990308, "cost2_max": -68.8895624907642}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2327.1057946681976, "sampler_perf": {"mean_inference_ms": 7.607069654972401, "mean_processing_ms": 10.79812003480556, "mean_env_wait_ms": 137.42913661757808}, "episodes_this_iter": 21, "episodes_total": 413, "time_total_s": 2327.1057946681976, "episode_reward_max": 982.7853128910065, "episode_reward_mean": 769.5707403534934, "episode_reward_min": 682.8216286599636, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 134.1074559688568, "timestamp": 1559266622, "episode_len_mean": 325.0, "iterations_since_restore": 18, "training_iteration": 18, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c37b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-37-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 945.6307760686941, "outflow_rate_min": 573.8908665984312, "system_level_velocity_max": 14.979571872115434, "cost2_min": -111.30692752252635, "system_level_velocity_min": 8.896742435579128, "cost1_min": 105.92500593826615, "cost1_max": 183.75023353718024, "cost2_mean": -93.97930725473725, "discrim_loss": 1.3226933479309082, "cost1_mean": 167.62503424288005, "outflow_rate_mean": 880.5119678117328, "system_level_velocity_mean": 13.697668821351082, "cost2_max": -73.30918169969489}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2462.112467765808, "sampler_perf": {"mean_inference_ms": 7.622645545785172, "mean_processing_ms": 10.790208304483372, "mean_env_wait_ms": 137.89841410727925}, "episodes_this_iter": 21, "episodes_total": 434, "time_total_s": 2462.112467765808, "episode_reward_max": 954.5114032030106, "episode_reward_mean": 798.667242230404, "episode_reward_min": 760.1320214867592, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 135.00667309761047, "timestamp": 1559266759, "episode_len_mean": 325.0, "iterations_since_restore": 19, "training_iteration": 19, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-39-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 947.8947691273244, "outflow_rate_min": 618.3710814395725, "system_level_velocity_max": 15.077178978655793, "cost2_min": -113.08237260360153, "system_level_velocity_min": 8.841078364375536, "cost1_min": 107.03472021613334, "cost1_max": 183.79770453528442, "cost2_mean": -100.57688776470947, "discrim_loss": 1.3118550777435303, "cost1_mean": 167.7054244004262, "outflow_rate_mean": 879.6149083031132, "system_level_velocity_mean": 13.709397256121466, "cost2_max": -82.73545771117946}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2588.886241674423, "sampler_perf": {"mean_inference_ms": 7.624373646949146, "mean_processing_ms": 10.874135098006914, "mean_env_wait_ms": 137.90730418908456}, "episodes_this_iter": 28, "episodes_total": 462, "time_total_s": 2588.886241674423, "episode_reward_max": 826.714436262846, "episode_reward_mean": 731.7665990250451, "episode_reward_min": 685.2284368574619, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 126.77377390861511, "timestamp": 1559266886, "episode_len_mean": 325.0, "iterations_since_restore": 20, "training_iteration": 20, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375e18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-41-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.9569427599663, "outflow_rate_min": 845.683658781161, "system_level_velocity_max": 15.949101992567426, "cost2_min": -112.67777992474274, "system_level_velocity_min": 13.003208932176245, "cost1_min": 159.10492383335844, "cost1_max": 196.15943426688534, "cost2_mean": -100.86918768466069, "discrim_loss": 1.2917463779449463, "cost1_mean": 176.59968944301568, "outflow_rate_mean": 916.3384483669787, "system_level_velocity_mean": 14.420184265352713, "cost2_max": -87.80054091689568}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2712.920952796936, "sampler_perf": {"mean_inference_ms": 7.628779004916434, "mean_processing_ms": 10.868714254351081, "mean_env_wait_ms": 138.13988462068733}, "episodes_this_iter": 21, "episodes_total": 483, "time_total_s": 2712.920952796936, "episode_reward_max": 678.9716209769249, "episode_reward_mean": 614.0106194381203, "episode_reward_min": 569.1834675073624, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 124.03471112251282, "timestamp": 1559267010, "episode_len_mean": 325.0, "iterations_since_restore": 21, "training_iteration": 21, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035f048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-43-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.379573432503, "outflow_rate_min": 859.079784761964, "system_level_velocity_max": 15.643932248648206, "cost2_min": -117.05541830169602, "system_level_velocity_min": 13.308565111423631, "cost1_min": 162.25184974591747, "cost1_max": 190.6930442554755, "cost2_mean": -104.23356854418837, "discrim_loss": 1.2820513248443604, "cost1_mean": 177.55542930356881, "outflow_rate_mean": 917.2463742845146, "system_level_velocity_mean": 14.481607832755572, "cost2_max": -76.50302043547103}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2846.9523968696594, "sampler_perf": {"mean_inference_ms": 7.633448327561349, "mean_processing_ms": 10.862675965661216, "mean_env_wait_ms": 138.3600938232814}, "episodes_this_iter": 21, "episodes_total": 504, "time_total_s": 2846.9523968696594, "episode_reward_max": 668.3118175417185, "episode_reward_mean": 579.6667214220479, "episode_reward_min": 531.7370966672897, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 134.0314440727234, "timestamp": 1559267146, "episode_len_mean": 325.0, "iterations_since_restore": 22, "training_iteration": 22, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-45-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1010.7902479257046, "outflow_rate_min": 746.2985620671025, "system_level_velocity_max": 16.680129069389434, "cost2_min": -122.56660629367968, "system_level_velocity_min": 11.102600934175786, "cost1_min": 131.8970045771688, "cost1_max": 202.89768818184947, "cost2_mean": -106.04062604497362, "discrim_loss": 1.2864387035369873, "cost1_mean": 177.00632662420506, "outflow_rate_mean": 912.6892433336172, "system_level_velocity_mean": 14.577249449557314, "cost2_max": -92.03924481714574}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 2980.489527463913, "sampler_perf": {"mean_inference_ms": 7.628221197646204, "mean_processing_ms": 10.90556687158802, "mean_env_wait_ms": 138.60632120925882}, "episodes_this_iter": 26, "episodes_total": 530, "time_total_s": 2980.489527463913, "episode_reward_max": 662.1859435588121, "episode_reward_mean": 605.0714973641129, "episode_reward_min": 547.2694294899702, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 133.53713059425354, "timestamp": 1559267281, "episode_len_mean": 325.0, "iterations_since_restore": 23, "training_iteration": 23, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-48-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1051.693740159958, "outflow_rate_min": 734.4834202865538, "system_level_velocity_max": 17.48997651368334, "cost2_min": -128.24125729932592, "system_level_velocity_min": 11.20624543485706, "cost1_min": 133.83325114722862, "cost1_max": 210.81861344302513, "cost2_mean": -111.28665333349673, "discrim_loss": 1.2772657871246338, "cost1_mean": 180.47611514479829, "outflow_rate_mean": 930.8493924435056, "system_level_velocity_mean": 14.933048907531006, "cost2_max": -100.44308610564022}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3110.0757846832275, "sampler_perf": {"mean_inference_ms": 7.63651168211971, "mean_processing_ms": 10.981922237139718, "mean_env_wait_ms": 138.8795219541552}, "episodes_this_iter": 24, "episodes_total": 554, "time_total_s": 3110.0757846832275, "episode_reward_max": 710.9282470792532, "episode_reward_mean": 658.9149409948537, "episode_reward_min": 241.58817693591118, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 129.58625721931458, "timestamp": 1559267413, "episode_len_mean": 316.3333333333333, "iterations_since_restore": 24, "training_iteration": 24, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930359ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-50-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1058.2711760373638, "outflow_rate_min": 698.820057493325, "system_level_velocity_max": 17.991684946068453, "cost2_min": -133.47436233229922, "system_level_velocity_min": 11.765327638622674, "cost1_min": 78.20194790663854, "cost1_max": 215.81968154935396, "cost2_mean": -116.40907082677074, "discrim_loss": 1.2827900648117065, "cost1_mean": 171.85802081156638, "outflow_rate_mean": 914.0691257681265, "system_level_velocity_mean": 14.84138335342634, "cost2_max": -58.459275615423486}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3232.8177258968353, "sampler_perf": {"mean_inference_ms": 7.627433091823238, "mean_processing_ms": 10.891668935514032, "mean_env_wait_ms": 138.5812114673668}, "episodes_this_iter": 20, "episodes_total": 574, "time_total_s": 3232.8177258968353, "episode_reward_max": 713.2407042980194, "episode_reward_mean": 684.3881394267082, "episode_reward_min": 665.8714362829924, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.74194121360779, "timestamp": 1559267542, "episode_len_mean": 325.0, "iterations_since_restore": 25, "training_iteration": 25, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303590d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930359400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930359598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-52-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1081.3600371739658, "outflow_rate_min": 847.1778538419512, "system_level_velocity_max": 18.56222509460923, "cost2_min": -140.56567828485242, "system_level_velocity_min": 12.792613997706251, "cost1_min": 152.14388171521557, "cost1_max": 219.56368306613106, "cost2_mean": -120.38561150189352, "discrim_loss": 1.2630622386932373, "cost1_mean": 188.18155135088045, "outflow_rate_mean": 969.1077279134006, "system_level_velocity_mean": 15.738006343898093, "cost2_max": -108.60274540465727}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3368.290930747986, "sampler_perf": {"mean_inference_ms": 7.623408056968495, "mean_processing_ms": 10.94178636227559, "mean_env_wait_ms": 138.6141269581012}, "episodes_this_iter": 26, "episodes_total": 600, "time_total_s": 3368.290930747986, "episode_reward_max": 678.6443680226803, "episode_reward_mean": 621.2274797730721, "episode_reward_min": 576.1108750402927, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 135.4732048511505, "timestamp": 1559267678, "episode_len_mean": 325.0, "iterations_since_restore": 26, "training_iteration": 26, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ec80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303600d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-54-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1084.1764776747634, "outflow_rate_min": 813.3066326469874, "system_level_velocity_max": 18.565968923211077, "cost2_min": -148.46257120121024, "system_level_velocity_min": 12.16382530086514, "cost1_min": 142.55105721713406, "cost1_max": 221.80566817680995, "cost2_mean": -125.00756156449786, "discrim_loss": 1.1791009902954102, "cost1_mean": 187.57368555200992, "outflow_rate_mean": 969.8330579832481, "system_level_velocity_mean": 15.744011339878135, "cost2_max": -111.78111309905688}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3501.665380001068, "sampler_perf": {"mean_inference_ms": 7.6325851273582295, "mean_processing_ms": 10.999467873494831, "mean_env_wait_ms": 138.82984366389914}, "episodes_this_iter": 23, "episodes_total": 623, "time_total_s": 3501.665380001068, "episode_reward_max": 631.8144474923611, "episode_reward_mean": 521.6878434286817, "episode_reward_min": 484.60721050947905, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 133.37444925308228, "timestamp": 1559267812, "episode_len_mean": 325.0, "iterations_since_restore": 27, "training_iteration": 27, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-56-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1089.5215804465624, "outflow_rate_min": 837.1368986896567, "system_level_velocity_max": 18.68313083859813, "cost2_min": -156.52908079687938, "system_level_velocity_min": 12.367485201850336, "cost1_min": 149.58943072030837, "cost1_max": 222.38749819943234, "cost2_mean": -134.0376535479689, "discrim_loss": 1.1385256052017212, "cost1_mean": 178.81493295500562, "outflow_rate_mean": 944.1617281088402, "system_level_velocity_mean": 15.071251326905093, "cost2_max": -111.7789891881872}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3632.117856025696, "sampler_perf": {"mean_inference_ms": 7.624315330705367, "mean_processing_ms": 10.942948865167063, "mean_env_wait_ms": 138.72896210338854}, "episodes_this_iter": 21, "episodes_total": 644, "time_total_s": 3632.117856025696, "episode_reward_max": 595.2477163374424, "episode_reward_mean": 523.4614677744962, "episode_reward_min": 479.84331548959017, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 130.45247602462769, "timestamp": 1559267942, "episode_len_mean": 325.0, "iterations_since_restore": 28, "training_iteration": 28, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930359f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930360158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303600d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930360048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_01-59-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1087.122302784093, "outflow_rate_min": 794.1643041814932, "system_level_velocity_max": 18.917742402694067, "cost2_min": -151.08881700266994, "system_level_velocity_min": 12.013933082700769, "cost1_min": 141.4881822656082, "cost1_max": 225.18193191544054, "cost2_mean": -132.52388628780733, "discrim_loss": 1.0951491594314575, "cost1_mean": 189.607237326842, "outflow_rate_mean": 973.4435451117322, "system_level_velocity_mean": 15.915496457994246, "cost2_max": -113.8736753375694}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3753.193403482437, "sampler_perf": {"mean_inference_ms": 7.621249789331411, "mean_processing_ms": 10.91637501886075, "mean_env_wait_ms": 138.45143156387928}, "episodes_this_iter": 20, "episodes_total": 664, "time_total_s": 3753.193403482437, "episode_reward_max": 671.1575596258044, "episode_reward_mean": 576.5151250045747, "episode_reward_min": 501.9035067334771, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.07554745674133, "timestamp": 1559268063, "episode_len_mean": 325.0, "iterations_since_restore": 29, "training_iteration": 29, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c36a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c38c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-01-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1097.0210081014027, "outflow_rate_min": 876.7932870554539, "system_level_velocity_max": 18.978727388906826, "cost2_min": -147.1809265312291, "system_level_velocity_min": 13.325543086691415, "cost1_min": 156.93397050288416, "cost1_max": 224.69341361748963, "cost2_mean": -126.8239111649365, "discrim_loss": 1.0698246955871582, "cost1_mean": 194.39935945962017, "outflow_rate_mean": 995.3424717960415, "system_level_velocity_mean": 16.368107791525347, "cost2_max": -114.3689225953679}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 3885.096083879471, "sampler_perf": {"mean_inference_ms": 7.630203000270367, "mean_processing_ms": 10.981281543310281, "mean_env_wait_ms": 138.46760171661643}, "episodes_this_iter": 30, "episodes_total": 694, "time_total_s": 3885.096083879471, "episode_reward_max": 735.4070773944259, "episode_reward_mean": 561.6723531351735, "episode_reward_min": 49.13356092572212, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 131.9026803970337, "timestamp": 1559268196, "episode_len_mean": 315.06666666666666, "iterations_since_restore": 30, "training_iteration": 30, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ebf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303330d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-03-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1089.4517220033713, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 18.89834660388268, "cost2_min": -147.63721125890095, "system_level_velocity_min": 12.543801868745843, "cost1_min": 17.771480489438336, "cost1_max": 224.5492507066603, "cost2_mean": -126.11285227748948, "discrim_loss": 1.0200169086456299, "cost1_mean": 172.07405672774365, "outflow_rate_mean": 922.3808546136582, "system_level_velocity_mean": 15.028580869234421, "cost2_max": -21.65563496259519}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4014.8044259548187, "sampler_perf": {"mean_inference_ms": 7.628804080866985, "mean_processing_ms": 10.988703399471138, "mean_env_wait_ms": 138.8812795149602}, "episodes_this_iter": 21, "episodes_total": 715, "time_total_s": 4014.8044259548187, "episode_reward_max": 692.0468389578164, "episode_reward_mean": 574.5134490304405, "episode_reward_min": 529.9177782889456, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 129.7083420753479, "timestamp": 1559268325, "episode_len_mean": 325.0, "iterations_since_restore": 31, "training_iteration": 31, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035f0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035f048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-05-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1082.2913007372172, "outflow_rate_min": 842.3276329063266, "system_level_velocity_max": 18.525914630663532, "cost2_min": -148.90207788649423, "system_level_velocity_min": 12.778797228499045, "cost1_min": 152.02244825635717, "cost1_max": 221.43478255792377, "cost2_mean": -129.53577611737776, "discrim_loss": 0.9706053137779236, "cost1_mean": 180.30334461681656, "outflow_rate_mean": 944.2786225071907, "system_level_velocity_mean": 15.115905713701409, "cost2_max": -110.17388358701915}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4150.566486120224, "sampler_perf": {"mean_inference_ms": 7.636523946097164, "mean_processing_ms": 10.976911938134336, "mean_env_wait_ms": 139.07800888767844}, "episodes_this_iter": 20, "episodes_total": 735, "time_total_s": 4150.566486120224, "episode_reward_max": 638.1160189062357, "episode_reward_mean": 538.0425037887878, "episode_reward_min": 449.3164154384285, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 135.76206016540527, "timestamp": 1559268461, "episode_len_mean": 325.0, "iterations_since_restore": 32, "training_iteration": 32, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c38c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c36a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-07-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1079.1815860815193, "outflow_rate_min": 842.553778780155, "system_level_velocity_max": 18.445541630387787, "cost2_min": -142.60400889823478, "system_level_velocity_min": 12.66537577460122, "cost1_min": 152.4130580220499, "cost1_max": 220.8380037095302, "cost2_mean": -124.32360694451779, "discrim_loss": 1.090445876121521, "cost1_mean": 184.34989718296546, "outflow_rate_mean": 958.9969402683158, "system_level_velocity_mean": 15.46398654340383, "cost2_max": -107.40572463983952}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4286.220632314682, "sampler_perf": {"mean_inference_ms": 7.642433585375554, "mean_processing_ms": 11.042663688697562, "mean_env_wait_ms": 139.32108805515574}, "episodes_this_iter": 29, "episodes_total": 764, "time_total_s": 4286.220632314682, "episode_reward_max": 590.1809615455568, "episode_reward_mean": 494.93355697342037, "episode_reward_min": 435.6961632389575, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 135.654146194458, "timestamp": 1559268598, "episode_len_mean": 325.0, "iterations_since_restore": 33, "training_iteration": 33, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035eea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-09-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1067.5323694045283, "outflow_rate_min": 790.5946802102437, "system_level_velocity_max": 18.137343853288687, "cost2_min": -144.73464329755552, "system_level_velocity_min": 11.958016831179497, "cost1_min": 141.56516769066874, "cost1_max": 217.86530038594475, "cost2_mean": -124.5213779947247, "discrim_loss": 1.0378144979476929, "cost1_mean": 177.13608518017043, "outflow_rate_mean": 930.0353743775652, "system_level_velocity_mean": 14.779935706929185, "cost2_max": -108.78366624172135}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4414.012405157089, "sampler_perf": {"mean_inference_ms": 7.645047895378836, "mean_processing_ms": 11.022094059490362, "mean_env_wait_ms": 139.247735889887}, "episodes_this_iter": 21, "episodes_total": 785, "time_total_s": 4414.012405157089, "episode_reward_max": 652.1165039967746, "episode_reward_mean": 562.7416097772352, "episode_reward_min": 452.4465061612427, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 127.79177284240723, "timestamp": 1559268727, "episode_len_mean": 325.0, "iterations_since_restore": 34, "training_iteration": 34, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930361158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303610d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930361048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-12-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1066.3390904107666, "outflow_rate_min": 814.5687040724224, "system_level_velocity_max": 18.000234041674094, "cost2_min": -142.7863704803782, "system_level_velocity_min": 12.064210412905476, "cost1_min": 146.66170999155082, "cost1_max": 215.4348416028711, "cost2_mean": -119.17570690652671, "discrim_loss": 1.1121381521224976, "cost1_mean": 189.54315412200782, "outflow_rate_mean": 970.6569778475194, "system_level_velocity_mean": 15.743585150743874, "cost2_max": -105.73066854164458}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4546.516547679901, "sampler_perf": {"mean_inference_ms": 7.644830133877621, "mean_processing_ms": 10.972979893335083, "mean_env_wait_ms": 139.2010253950063}, "episodes_this_iter": 20, "episodes_total": 805, "time_total_s": 4546.516547679901, "episode_reward_max": 656.7916392050683, "episode_reward_mean": 530.5966126969084, "episode_reward_min": 449.0265244524926, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 132.5041425228119, "timestamp": 1559268859, "episode_len_mean": 325.0, "iterations_since_restore": 35, "training_iteration": 35, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303750d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-14-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1050.439418260518, "outflow_rate_min": 824.8628663534475, "system_level_velocity_max": 17.504858889372866, "cost2_min": -142.64620789025298, "system_level_velocity_min": 12.431299752790228, "cost1_min": 150.19086955604047, "cost1_max": 210.51018474224048, "cost2_mean": -119.67069219048378, "discrim_loss": 1.0365703105926514, "cost1_mean": 179.7633648900995, "outflow_rate_mean": 934.9913420991254, "system_level_velocity_mean": 14.921187595806753, "cost2_max": -103.91118647434837}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4678.242033958435, "sampler_perf": {"mean_inference_ms": 7.636400545418031, "mean_processing_ms": 11.000935146297998, "mean_env_wait_ms": 139.27832886739708}, "episodes_this_iter": 26, "episodes_total": 831, "time_total_s": 4678.242033958435, "episode_reward_max": 586.9023675620556, "episode_reward_mean": 459.5895672434081, "episode_reward_min": 364.4225944392383, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 131.72548627853394, "timestamp": 1559268991, "episode_len_mean": 325.0, "iterations_since_restore": 36, "training_iteration": 36, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-16-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1040.5997135822954, "outflow_rate_min": 795.8144327799425, "system_level_velocity_max": 17.280234009907534, "cost2_min": -139.85860890495275, "system_level_velocity_min": 11.811937363951381, "cost1_min": 144.73730202906233, "cost1_max": 208.28825739798486, "cost2_mean": -117.39848225035712, "discrim_loss": 0.925467312335968, "cost1_mean": 184.043535444986, "outflow_rate_mean": 945.2041079371979, "system_level_velocity_mean": 15.162638826827985, "cost2_max": -101.33397580697562}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4799.9377183914185, "sampler_perf": {"mean_inference_ms": 7.649150729278183, "mean_processing_ms": 11.035743518521341, "mean_env_wait_ms": 139.04248439558157}, "episodes_this_iter": 24, "episodes_total": 855, "time_total_s": 4799.9377183914185, "episode_reward_max": 497.5655858181417, "episode_reward_mean": 419.6321039805189, "episode_reward_min": 355.1874503456056, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.6956844329834, "timestamp": 1559269114, "episode_len_mean": 325.0, "iterations_since_restore": 37, "training_iteration": 37, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930333950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-18-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.5037756896485, "outflow_rate_min": 898.3540471083401, "system_level_velocity_max": 16.421094709875597, "cost2_min": -125.18402400914908, "system_level_velocity_min": 14.077738517719391, "cost1_min": 170.99456814012538, "cost1_max": 199.61288633741538, "cost2_mean": -109.8853358869913, "discrim_loss": 1.0679192543029785, "cost1_mean": 186.70076743000823, "outflow_rate_mean": 954.5832317820776, "system_level_velocity_mean": 15.35046511834886, "cost2_max": -96.15630136436064}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 4924.663224220276, "sampler_perf": {"mean_inference_ms": 7.646476677445243, "mean_processing_ms": 10.976048662915053, "mean_env_wait_ms": 139.10774115466103}, "episodes_this_iter": 20, "episodes_total": 875, "time_total_s": 4924.663224220276, "episode_reward_max": 465.1006476134062, "episode_reward_mean": 402.2566882941872, "episode_reward_min": 341.5520569831133, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 124.72550582885742, "timestamp": 1559269246, "episode_len_mean": 325.0, "iterations_since_restore": 38, "training_iteration": 38, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303337b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930333f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930333730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930333620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-20-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.8382300241927, "outflow_rate_min": 826.2043321146716, "system_level_velocity_max": 16.445909606910455, "cost2_min": -121.35860509509217, "system_level_velocity_min": 12.79370621427196, "cost1_min": 155.68569211929818, "cost1_max": 197.98072659185698, "cost2_mean": -110.01843271279907, "discrim_loss": 0.9897647500038147, "cost1_mean": 182.35021407347955, "outflow_rate_mean": 938.4638906563193, "system_level_velocity_mean": 14.95041008881123, "cost2_max": -97.67856995576051}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5056.013830423355, "sampler_perf": {"mean_inference_ms": 7.643777207551315, "mean_processing_ms": 10.972150672721414, "mean_env_wait_ms": 139.27058044406988}, "episodes_this_iter": 25, "episodes_total": 900, "time_total_s": 5056.013830423355, "episode_reward_max": 530.4085651934147, "episode_reward_mean": 455.8912355069816, "episode_reward_min": 376.528301410377, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 131.35060620307922, "timestamp": 1559269379, "episode_len_mean": 325.0, "iterations_since_restore": 39, "training_iteration": 39, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303c3950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303c3bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c36a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-22-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.8486489791549, "outflow_rate_min": 744.5131154403242, "system_level_velocity_max": 15.896403312520949, "cost2_min": -122.27739855680859, "system_level_velocity_min": 11.428946112470427, "cost1_min": 137.17151919349735, "cost1_max": 192.55417311061015, "cost2_mean": -109.77168662521659, "discrim_loss": 0.9336557388305664, "cost1_mean": 174.60366814812147, "outflow_rate_mean": 909.1779291081262, "system_level_velocity_mean": 14.314302196094534, "cost2_max": -95.72595505276831}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5180.151888132095, "sampler_perf": {"mean_inference_ms": 7.66337050592449, "mean_processing_ms": 11.018816529913108, "mean_env_wait_ms": 139.15557597149277}, "episodes_this_iter": 24, "episodes_total": 924, "time_total_s": 5180.151888132095, "episode_reward_max": 686.5961145237088, "episode_reward_mean": 572.906450537499, "episode_reward_min": 449.3889712244272, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 124.13805770874023, "timestamp": 1559269503, "episode_len_mean": 325.0, "iterations_since_restore": 40, "training_iteration": 40, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-25-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 955.0908801687718, "outflow_rate_min": 832.1285078329249, "system_level_velocity_max": 15.05458720747663, "cost2_min": -118.00132858772741, "system_level_velocity_min": 12.926579022589744, "cost1_min": 156.90747415918673, "cost1_max": 184.55318297763267, "cost2_mean": -101.52211692585438, "discrim_loss": 1.0574874877929688, "cost1_mean": 171.86332452611148, "outflow_rate_mean": 906.6597075664071, "system_level_velocity_mean": 14.10229989817976, "cost2_max": -77.67942757940307}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5308.366633415222, "sampler_perf": {"mean_inference_ms": 7.663629254062541, "mean_processing_ms": 10.982754043421995, "mean_env_wait_ms": 139.32328054896598}, "episodes_this_iter": 21, "episodes_total": 945, "time_total_s": 5308.366633415222, "episode_reward_max": 693.8805801942945, "episode_reward_mean": 524.8003461204823, "episode_reward_min": 435.66172955185175, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 128.21474528312683, "timestamp": 1559269632, "episode_len_mean": 325.0, "iterations_since_restore": 41, "training_iteration": 41, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ec80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-27-12", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 944.6905817395248, "outflow_rate_min": 795.9426849289902, "system_level_velocity_max": 14.782151669097379, "cost2_min": -118.74845866006824, "system_level_velocity_min": 11.395938417335458, "cost1_min": 138.52964971757635, "cost1_max": 179.3881335877307, "cost2_mean": -97.02763972776687, "discrim_loss": 0.9405696392059326, "cost1_mean": 166.05961277017045, "outflow_rate_mean": 892.0935007504462, "system_level_velocity_mean": 13.65830399311977, "cost2_max": -82.34965628131823}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5438.55399107933, "sampler_perf": {"mean_inference_ms": 7.66147850680013, "mean_processing_ms": 10.957055187070942, "mean_env_wait_ms": 139.36507214304342}, "episodes_this_iter": 20, "episodes_total": 965, "time_total_s": 5438.55399107933, "episode_reward_max": 563.576885715127, "episode_reward_mean": 484.16891904762014, "episode_reward_min": 376.87376817315817, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 130.18735766410828, "timestamp": 1559269762, "episode_len_mean": 325.0, "iterations_since_restore": 42, "training_iteration": 42, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-29-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 926.393546165803, "outflow_rate_min": 782.4992424656688, "system_level_velocity_max": 14.31447221232591, "cost2_min": -110.61179029406867, "system_level_velocity_min": 11.519108147974727, "cost1_min": 138.87976167085537, "cost1_max": 171.58222443661077, "cost2_mean": -90.32605321111498, "discrim_loss": 1.038362741470337, "cost1_mean": 159.6430569988952, "outflow_rate_mean": 875.3482391482718, "system_level_velocity_mean": 13.179048713834003, "cost2_max": -68.16178630069153}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5553.750873565674, "sampler_perf": {"mean_inference_ms": 7.646940715367926, "mean_processing_ms": 10.991852885227363, "mean_env_wait_ms": 138.9443917590516}, "episodes_this_iter": 29, "episodes_total": 994, "time_total_s": 5553.750873565674, "episode_reward_max": 714.4654394872487, "episode_reward_mean": 554.7707257536722, "episode_reward_min": 424.2898034900427, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 115.19688248634338, "timestamp": 1559269877, "episode_len_mean": 325.0, "iterations_since_restore": 43, "training_iteration": 43, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-31-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 910.8492741634005, "outflow_rate_min": 757.8433747512483, "system_level_velocity_max": 13.79570367415538, "cost2_min": -101.0311584118022, "system_level_velocity_min": 10.854660862733189, "cost1_min": 130.4830464914946, "cost1_max": 165.644184006652, "cost2_mean": -76.88067467379794, "discrim_loss": 1.1714563369750977, "cost1_mean": 148.99964833846988, "outflow_rate_mean": 842.6387276218474, "system_level_velocity_mean": 12.429056688211627, "cost2_max": -58.23517496310245}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5667.562435388565, "sampler_perf": {"mean_inference_ms": 7.640587648480464, "mean_processing_ms": 10.970321133677558, "mean_env_wait_ms": 138.42469752591305}, "episodes_this_iter": 21, "episodes_total": 1015, "time_total_s": 5667.562435388565, "episode_reward_max": 757.4627346843481, "episode_reward_mean": 619.8317344971001, "episode_reward_min": 510.0852431282401, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.81156182289124, "timestamp": 1559269991, "episode_len_mean": 325.0, "iterations_since_restore": 44, "training_iteration": 44, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303c3950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303757b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303c3ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-33-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 882.3451907416218, "outflow_rate_min": 720.9521311220815, "system_level_velocity_max": 13.008343030154254, "cost2_min": -78.92864453374625, "system_level_velocity_min": 10.08141189941075, "cost1_min": 122.4944665861222, "cost1_max": 154.14281634911148, "cost2_mean": -61.511234819019734, "discrim_loss": 1.1990821361541748, "cost1_mean": 143.70928254923706, "outflow_rate_mean": 824.0092675782292, "system_level_velocity_mean": 12.109220683309804, "cost2_max": -45.97714757582199}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5775.901295185089, "sampler_perf": {"mean_inference_ms": 7.63016767471597, "mean_processing_ms": 10.921578426925645, "mean_env_wait_ms": 137.91732916651554}, "episodes_this_iter": 20, "episodes_total": 1035, "time_total_s": 5775.901295185089, "episode_reward_max": 560.2643347196281, "episode_reward_mean": 462.4977145618759, "episode_reward_min": 387.8379824459553, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.33885979652405, "timestamp": 1559270100, "episode_len_mean": 325.0, "iterations_since_restore": 45, "training_iteration": 45, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303640d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364a60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-35-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 860.6489067721354, "outflow_rate_min": 751.541079474642, "system_level_velocity_max": 12.899472813297649, "cost2_min": -70.70809762911418, "system_level_velocity_min": 10.53970243126284, "cost1_min": 125.8380519303218, "cost1_max": 151.16025923614836, "cost2_mean": -56.577046313598224, "discrim_loss": 1.058685302734375, "cost1_mean": 141.32807371081836, "outflow_rate_mean": 811.0649807960742, "system_level_velocity_mean": 11.967499932312164, "cost2_max": -47.85849871538505}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5886.860350847244, "sampler_perf": {"mean_inference_ms": 7.618892899961724, "mean_processing_ms": 10.96045336879919, "mean_env_wait_ms": 137.40899501001164}, "episodes_this_iter": 29, "episodes_total": 1064, "time_total_s": 5886.860350847244, "episode_reward_max": 563.7382932528853, "episode_reward_mean": 392.2819354387707, "episode_reward_min": 340.50732420757413, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.95905566215515, "timestamp": 1559270211, "episode_len_mean": 325.0, "iterations_since_restore": 46, "training_iteration": 46, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035eb70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e7b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-36-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 881.1065199803056, "outflow_rate_min": 753.4381785817358, "system_level_velocity_max": 12.976141887426557, "cost2_min": -71.3002291621006, "system_level_velocity_min": 10.747635015191934, "cost1_min": 127.24415716137862, "cost1_max": 153.43146561193714, "cost2_mean": -59.268478823677796, "discrim_loss": 0.9143704771995544, "cost1_mean": 142.62974424757087, "outflow_rate_mean": 816.2435494084482, "system_level_velocity_mean": 12.090420448748981, "cost2_max": -40.96009897914547}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 5994.1282081604, "sampler_perf": {"mean_inference_ms": 7.61308017383347, "mean_processing_ms": 10.938321910539234, "mean_env_wait_ms": 136.9762682873477}, "episodes_this_iter": 21, "episodes_total": 1085, "time_total_s": 5994.1282081604, "episode_reward_max": 420.8184109311551, "episode_reward_mean": 378.55482228552654, "episode_reward_min": 330.8621853608638, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.26785731315613, "timestamp": 1559270318, "episode_len_mean": 325.0, "iterations_since_restore": 47, "training_iteration": 47, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-38-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 903.523669299791, "outflow_rate_min": 717.3911165613749, "system_level_velocity_max": 13.616901151972096, "cost2_min": -89.83299963521199, "system_level_velocity_min": 10.231095684471578, "cost1_min": 122.10676193031131, "cost1_max": 160.24010297869734, "cost2_mean": -65.66044614455139, "discrim_loss": 0.9230854511260986, "cost1_mean": 147.34796184446108, "outflow_rate_mean": 839.2537414544398, "system_level_velocity_mean": 12.457528403986048, "cost2_max": -48.458562969286575}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6115.812144517899, "sampler_perf": {"mean_inference_ms": 7.619111277203385, "mean_processing_ms": 10.91409100548717, "mean_env_wait_ms": 136.90491799616038}, "episodes_this_iter": 20, "episodes_total": 1105, "time_total_s": 6115.812144517899, "episode_reward_max": 453.6337408795953, "episode_reward_mean": 402.09802763340997, "episode_reward_min": 274.3251472469419, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.68393635749817, "timestamp": 1559270443, "episode_len_mean": 325.0, "iterations_since_restore": 48, "training_iteration": 48, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-40-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 895.032952696728, "outflow_rate_min": 704.3581355758218, "system_level_velocity_max": 13.58745794167138, "cost2_min": -81.68820369853862, "system_level_velocity_min": 9.611214679286965, "cost1_min": 115.95891220676972, "cost1_max": 159.24854269319536, "cost2_mean": -68.41242131659263, "discrim_loss": 0.910753607749939, "cost1_mean": 142.16136672779118, "outflow_rate_mean": 818.9642114986143, "system_level_velocity_mean": 11.984016957722925, "cost2_max": -47.628633899032955}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6225.561356306076, "sampler_perf": {"mean_inference_ms": 7.602554318787919, "mean_processing_ms": 10.914221824326951, "mean_env_wait_ms": 136.58661994430898}, "episodes_this_iter": 26, "episodes_total": 1131, "time_total_s": 6225.561356306076, "episode_reward_max": 461.03315767552704, "episode_reward_mean": 360.2547898192245, "episode_reward_min": 287.2414281209931, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.74921178817749, "timestamp": 1559270553, "episode_len_mean": 325.0, "iterations_since_restore": 49, "training_iteration": 49, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035ebf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ee18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-42-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 903.7775198783555, "outflow_rate_min": 798.8980075750931, "system_level_velocity_max": 13.627083647606392, "cost2_min": -79.42816640433564, "system_level_velocity_min": 11.826706647058986, "cost1_min": 139.0578510270853, "cost1_max": 161.9396093809688, "cost2_mean": -69.2001324018201, "discrim_loss": 0.9293965101242065, "cost1_mean": 149.66170899930057, "outflow_rate_mean": 851.8928284071725, "system_level_velocity_mean": 12.643736715089943, "cost2_max": -55.26830454947542}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6353.0636575222015, "sampler_perf": {"mean_inference_ms": 7.618053706117428, "mean_processing_ms": 10.947180957445282, "mean_env_wait_ms": 136.41468612937697}, "episodes_this_iter": 24, "episodes_total": 1155, "time_total_s": 6353.0636575222015, "episode_reward_max": 409.81501581612974, "episode_reward_mean": 357.76845212416566, "episode_reward_min": 277.77961424551904, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 127.50230121612549, "timestamp": 1559270680, "episode_len_mean": 325.0, "iterations_since_restore": 50, "training_iteration": 50, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-44-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 917.9879291647458, "outflow_rate_min": 774.8174099538742, "system_level_velocity_max": 14.131755708618973, "cost2_min": -94.77516606770148, "system_level_velocity_min": 11.28801977046335, "cost1_min": 135.14276657634537, "cost1_max": 165.0002753954903, "cost2_mean": -82.41509340819083, "discrim_loss": 0.904761791229248, "cost1_mean": 149.99568591487318, "outflow_rate_mean": 851.1502275753801, "system_level_velocity_mean": 12.551080008748245, "cost2_max": -62.71399602481552}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6472.6340963840485, "sampler_perf": {"mean_inference_ms": 7.603494404393899, "mean_processing_ms": 10.899574965240907, "mean_env_wait_ms": 136.2693505917826}, "episodes_this_iter": 20, "episodes_total": 1175, "time_total_s": 6472.6340963840485, "episode_reward_max": 408.95537126716226, "episode_reward_mean": 335.19011258236134, "episode_reward_min": 248.30839877203107, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 119.57043886184692, "timestamp": 1559270800, "episode_len_mean": 325.0, "iterations_since_restore": 51, "training_iteration": 51, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-46-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 924.3881731383262, "outflow_rate_min": 853.8367761479595, "system_level_velocity_max": 14.295417319586939, "cost2_min": -95.42019243891676, "system_level_velocity_min": 12.676737204596183, "cost1_min": 151.55670841298783, "cost1_max": 169.15001448971714, "cost2_mean": -82.26871820617177, "discrim_loss": 0.8646988868713379, "cost1_mean": 158.82987303464103, "outflow_rate_mean": 882.557242641298, "system_level_velocity_mean": 13.348451727604413, "cost2_max": -67.42205858999013}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6599.049610376358, "sampler_perf": {"mean_inference_ms": 7.595484886092164, "mean_processing_ms": 10.886043818442442, "mean_env_wait_ms": 136.2634641505954}, "episodes_this_iter": 25, "episodes_total": 1200, "time_total_s": 6599.049610376358, "episode_reward_max": 518.3028706628829, "episode_reward_mean": 427.9453942959756, "episode_reward_min": 281.9805100094527, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 126.41551399230957, "timestamp": 1559270926, "episode_len_mean": 325.0, "iterations_since_restore": 52, "training_iteration": 52, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bbae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bba60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb9d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-48-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 948.5757770226222, "outflow_rate_min": 803.3557106884725, "system_level_velocity_max": 14.951239356904491, "cost2_min": -117.90234496326941, "system_level_velocity_min": 11.348336347001874, "cost1_min": 138.9613268730302, "cost1_max": 177.04340000114917, "cost2_mean": -92.72307379694534, "discrim_loss": 0.9521682858467102, "cost1_mean": 161.73818932349312, "outflow_rate_mean": 886.9481690904743, "system_level_velocity_mean": 13.468185877024261, "cost2_max": -74.24751245460097}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6716.168241739273, "sampler_perf": {"mean_inference_ms": 7.600539878630397, "mean_processing_ms": 10.929196947278877, "mean_env_wait_ms": 135.91023674216396}, "episodes_this_iter": 24, "episodes_total": 1224, "time_total_s": 6716.168241739273, "episode_reward_max": 584.3277853019536, "episode_reward_mean": 465.9391023242691, "episode_reward_min": 389.503938857466, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 117.11863136291504, "timestamp": 1559271044, "episode_len_mean": 325.0, "iterations_since_restore": 53, "training_iteration": 53, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ebf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-50-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 959.1191280217422, "outflow_rate_min": 870.2090328562069, "system_level_velocity_max": 15.236687849297041, "cost2_min": -112.35506425028821, "system_level_velocity_min": 13.261155026433755, "cost1_min": 161.90223710484747, "cost1_max": 180.4534981079332, "cost2_mean": -94.83671079499557, "discrim_loss": 1.0673892498016357, "cost1_mean": 173.69844974468705, "outflow_rate_mean": 930.575310861262, "system_level_velocity_mean": 14.52548116573495, "cost2_max": -83.03967850619784}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6837.472816228867, "sampler_perf": {"mean_inference_ms": 7.598354191038647, "mean_processing_ms": 10.905658036930102, "mean_env_wait_ms": 135.93016748906317}, "episodes_this_iter": 21, "episodes_total": 1245, "time_total_s": 6837.472816228867, "episode_reward_max": 497.8961521945894, "episode_reward_mean": 360.9201225051878, "episode_reward_min": 253.74983483925462, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.3045744895935, "timestamp": 1559271165, "episode_len_mean": 325.0, "iterations_since_restore": 54, "training_iteration": 54, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-52-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 974.7991508530775, "outflow_rate_min": 882.0035263205682, "system_level_velocity_max": 15.562410686195395, "cost2_min": -111.34432732439748, "system_level_velocity_min": 13.606700620302, "cost1_min": 167.33192862840306, "cost1_max": 185.27055967640896, "cost2_mean": -102.00874729247619, "discrim_loss": 1.0838823318481445, "cost1_mean": 176.25042666426376, "outflow_rate_mean": 932.6307312145975, "system_level_velocity_mean": 14.651162298193748, "cost2_max": -86.81293738896377}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 6965.586051464081, "sampler_perf": {"mean_inference_ms": 7.603642174768228, "mean_processing_ms": 10.891460993639727, "mean_env_wait_ms": 135.97320452133664}, "episodes_this_iter": 21, "episodes_total": 1266, "time_total_s": 6965.586051464081, "episode_reward_max": 391.2693610563874, "episode_reward_mean": 322.77669182359904, "episode_reward_min": 68.12401390820742, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 128.11323523521423, "timestamp": 1559271293, "episode_len_mean": 311.1904761904762, "iterations_since_restore": 55, "training_iteration": 55, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-54-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.864503680963, "outflow_rate_min": 504.5827016154056, "system_level_velocity_max": 18.46448505394352, "cost2_min": -126.129326755225, "system_level_velocity_min": 11.934979182226689, "cost1_min": 22.849638413294784, "cost1_max": 181.6440298396966, "cost2_mean": -100.15560392799274, "discrim_loss": 0.9134650230407715, "cost1_mean": 164.67446977136618, "outflow_rate_mean": 896.3065515817389, "system_level_velocity_mean": 14.471368698481788, "cost2_max": -21.237141451100587}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7087.34574508667, "sampler_perf": {"mean_inference_ms": 7.598288534754831, "mean_processing_ms": 10.923587177034081, "mean_env_wait_ms": 135.9284619931653}, "episodes_this_iter": 30, "episodes_total": 1296, "time_total_s": 7087.34574508667, "episode_reward_max": 598.6732615791261, "episode_reward_mean": 445.81052964924214, "episode_reward_min": 68.453464448452, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.75969362258911, "timestamp": 1559271415, "episode_len_mean": 315.06666666666666, "iterations_since_restore": 56, "training_iteration": 56, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-56-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 974.9681550336602, "outflow_rate_min": 468.51797875626045, "system_level_velocity_max": 16.89507514603043, "cost2_min": -129.06733337514572, "system_level_velocity_min": 12.328428774105058, "cost1_min": 17.51489691931501, "cost1_max": 182.9225430484719, "cost2_mean": -98.62753104672892, "discrim_loss": 0.937163233757019, "cost1_mean": 167.40500489453427, "outflow_rate_mean": 903.9125906482429, "system_level_velocity_mean": 14.435784891999338, "cost2_max": -17.343654719388628}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7210.09641289711, "sampler_perf": {"mean_inference_ms": 7.599250248001011, "mean_processing_ms": 10.924975058190356, "mean_env_wait_ms": 135.82355325908463}, "episodes_this_iter": 21, "episodes_total": 1317, "time_total_s": 7210.09641289711, "episode_reward_max": 532.0092360191047, "episode_reward_mean": 473.747289262202, "episode_reward_min": 363.40238044410944, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.75066781044006, "timestamp": 1559271538, "episode_len_mean": 319.3809523809524, "iterations_since_restore": 57, "training_iteration": 57, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035ee18>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_02-58-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.5372353780931, "outflow_rate_min": 833.8148332152435, "system_level_velocity_max": 16.234161063148008, "cost2_min": -114.45731637512692, "system_level_velocity_min": 13.264011568544968, "cost1_min": 121.82980148889945, "cost1_max": 186.9921055413399, "cost2_mean": -101.17051538350626, "discrim_loss": 1.0490078926086426, "cost1_mean": 173.71350225904968, "outflow_rate_mean": 927.2495180649375, "system_level_velocity_mean": 14.714642918934103, "cost2_max": -65.51195418960711}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7332.403051614761, "sampler_perf": {"mean_inference_ms": 7.595326522489759, "mean_processing_ms": 10.917274060979716, "mean_env_wait_ms": 135.75429361473067}, "episodes_this_iter": 21, "episodes_total": 1338, "time_total_s": 7332.403051614761, "episode_reward_max": 469.2430234141648, "episode_reward_mean": 394.3527660787416, "episode_reward_min": 279.4693147027865, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.30663871765137, "timestamp": 1559271660, "episode_len_mean": 325.0, "iterations_since_restore": 58, "training_iteration": 58, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930364f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-01-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 991.5473224862828, "outflow_rate_min": 791.1218164945684, "system_level_velocity_max": 15.996780633186068, "cost2_min": -130.2454404928735, "system_level_velocity_min": 12.150123636847292, "cost1_min": 147.37355275579444, "cost1_max": 189.16799371773388, "cost2_mean": -105.84438564217304, "discrim_loss": 1.0162456035614014, "cost1_mean": 177.91740542127704, "outflow_rate_mean": 936.0694197784452, "system_level_velocity_mean": 14.819500480432415, "cost2_max": -91.24281222785609}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7456.34405708313, "sampler_perf": {"mean_inference_ms": 7.593510619323035, "mean_processing_ms": 10.919424541000623, "mean_env_wait_ms": 135.61294927566323}, "episodes_this_iter": 28, "episodes_total": 1366, "time_total_s": 7456.34405708313, "episode_reward_max": 480.23594004660845, "episode_reward_mean": 389.5879818223683, "episode_reward_min": 58.785508409142494, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.94100546836853, "timestamp": 1559271784, "episode_len_mean": 314.35714285714283, "iterations_since_restore": 59, "training_iteration": 59, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375d90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-03-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1002.7791220594163, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 16.934813622878167, "cost2_min": -122.19664666547513, "system_level_velocity_min": 13.288166298340727, "cost1_min": 17.724398688381353, "cost1_max": 192.541327748322, "cost2_mean": -101.64783233803915, "discrim_loss": 1.0316002368927002, "cost1_mean": 176.05987523853216, "outflow_rate_mean": 931.323453041795, "system_level_velocity_mean": 15.192507334124125, "cost2_max": -21.130001862191314}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7579.253123044968, "sampler_perf": {"mean_inference_ms": 7.599986948045952, "mean_processing_ms": 10.945547684997592, "mean_env_wait_ms": 135.48753124712118}, "episodes_this_iter": 22, "episodes_total": 1388, "time_total_s": 7579.253123044968, "episode_reward_max": 595.0686030238867, "episode_reward_mean": 521.7737946854057, "episode_reward_min": 392.4428458176553, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.90906596183777, "timestamp": 1559271907, "episode_len_mean": 325.0, "iterations_since_restore": 60, "training_iteration": 60, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-05-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.1694812753306, "outflow_rate_min": 895.1248486052582, "system_level_velocity_max": 16.123312908645765, "cost2_min": -116.93085735121636, "system_level_velocity_min": 13.958426664626613, "cost1_min": 169.71700213311146, "cost1_max": 191.23217607364717, "cost2_mean": -107.2389405900051, "discrim_loss": 0.9791063070297241, "cost1_mean": 179.70571183088234, "outflow_rate_mean": 939.3345259826812, "system_level_velocity_mean": 14.910034420327527, "cost2_max": -94.9105125231789}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7703.199707508087, "sampler_perf": {"mean_inference_ms": 7.597897849786426, "mean_processing_ms": 10.91534631762996, "mean_env_wait_ms": 135.5365278874287}, "episodes_this_iter": 21, "episodes_total": 1409, "time_total_s": 7703.199707508087, "episode_reward_max": 571.6885888129473, "episode_reward_mean": 487.91464629399013, "episode_reward_min": 394.2880631037988, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.9465844631195, "timestamp": 1559272031, "episode_len_mean": 325.0, "iterations_since_restore": 61, "training_iteration": 61, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ed08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-07-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.8684697969359, "outflow_rate_min": 829.102834100615, "system_level_velocity_max": 16.089238121697228, "cost2_min": -127.58207660505886, "system_level_velocity_min": 12.75169472844685, "cost1_min": 155.18273485189562, "cost1_max": 190.0879152080187, "cost2_mean": -107.57088014887707, "discrim_loss": 0.8681902885437012, "cost1_mean": 178.07003901601533, "outflow_rate_mean": 934.0784088895546, "system_level_velocity_mean": 14.781524717682823, "cost2_max": -91.87816883937414}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7828.42270565033, "sampler_perf": {"mean_inference_ms": 7.592335947892817, "mean_processing_ms": 10.91801765931478, "mean_env_wait_ms": 135.5182053997133}, "episodes_this_iter": 25, "episodes_total": 1434, "time_total_s": 7828.42270565033, "episode_reward_max": 508.258214853704, "episode_reward_mean": 401.0618756763078, "episode_reward_min": 289.8376428298652, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 125.22299814224243, "timestamp": 1559272156, "episode_len_mean": 325.0, "iterations_since_restore": 62, "training_iteration": 62, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b3510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b36a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b3620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b3598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-09-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.1464486408261, "outflow_rate_min": 864.2605810204925, "system_level_velocity_max": 16.22628609449307, "cost2_min": -119.79600495145968, "system_level_velocity_min": 13.279354469409865, "cost1_min": 164.5613781771582, "cost1_max": 191.52591397213905, "cost2_mean": -104.77385014994752, "discrim_loss": 0.9777316451072693, "cost1_mean": 182.1043707106103, "outflow_rate_mean": 952.722505057889, "system_level_velocity_mean": 15.183856750136965, "cost2_max": -94.43822376790854}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 7951.454306602478, "sampler_perf": {"mean_inference_ms": 7.609693152607162, "mean_processing_ms": 10.94770439360552, "mean_env_wait_ms": 135.3780664694631}, "episodes_this_iter": 24, "episodes_total": 1458, "time_total_s": 7951.454306602478, "episode_reward_max": 365.20354840531945, "episode_reward_mean": 311.7635159260826, "episode_reward_min": 218.01048909779638, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.03160095214844, "timestamp": 1559272279, "episode_len_mean": 325.0, "iterations_since_restore": 63, "training_iteration": 63, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035e730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035eea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-11-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.4447307455135, "outflow_rate_min": 810.8686281817231, "system_level_velocity_max": 16.17861645014682, "cost2_min": -133.87646857115413, "system_level_velocity_min": 12.532698785146751, "cost1_min": 152.889900115329, "cost1_max": 190.3632759234925, "cost2_mean": -110.59893921763104, "discrim_loss": 0.9659830331802368, "cost1_mean": 175.50288400321998, "outflow_rate_mean": 920.05871543814, "system_level_velocity_mean": 14.511726394935762, "cost2_max": -89.315314949942}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8073.676447868347, "sampler_perf": {"mean_inference_ms": 7.602838714337194, "mean_processing_ms": 10.924059711757574, "mean_env_wait_ms": 135.4096753595124}, "episodes_this_iter": 20, "episodes_total": 1478, "time_total_s": 8073.676447868347, "episode_reward_max": 481.80594209209085, "episode_reward_mean": 415.43264081457164, "episode_reward_min": 311.73444208921865, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.22214126586914, "timestamp": 1559272402, "episode_len_mean": 325.0, "iterations_since_restore": 64, "training_iteration": 64, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303242f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324c80>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-13-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 995.2984397572136, "outflow_rate_min": 898.4451809085687, "system_level_velocity_max": 16.167559127023786, "cost2_min": -115.57289079283461, "system_level_velocity_min": 13.793200671849053, "cost1_min": 169.8540539393063, "cost1_max": 190.7230852354989, "cost2_mean": -104.82837317687522, "discrim_loss": 0.9790835976600647, "cost1_mean": 181.4410854424656, "outflow_rate_mean": 950.0572871151978, "system_level_velocity_mean": 15.115104349746328, "cost2_max": -95.88529391942637}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8203.627160072327, "sampler_perf": {"mean_inference_ms": 7.597249815450375, "mean_processing_ms": 10.920169971795726, "mean_env_wait_ms": 135.48737376250378}, "episodes_this_iter": 25, "episodes_total": 1503, "time_total_s": 8203.627160072327, "episode_reward_max": 487.60032161325216, "episode_reward_mean": 433.5216975609958, "episode_reward_min": 273.2105106655508, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 129.9507122039795, "timestamp": 1559272532, "episode_len_mean": 325.0, "iterations_since_restore": 65, "training_iteration": 65, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793035ed08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793035e158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793035e488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793035e950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-15-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.4768606321077, "outflow_rate_min": 822.6204293408807, "system_level_velocity_max": 16.322449260736477, "cost2_min": -132.33089554687652, "system_level_velocity_min": 12.58531827180313, "cost1_min": 152.37620011378834, "cost1_max": 192.04148210591057, "cost2_mean": -107.04107005586393, "discrim_loss": 0.8979314565658569, "cost1_mean": 179.58941309701785, "outflow_rate_mean": 941.6048456917897, "system_level_velocity_mean": 14.943923809368908, "cost2_max": -92.82140584283789}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8324.308853387833, "sampler_perf": {"mean_inference_ms": 7.609132124655301, "mean_processing_ms": 10.952819866373837, "mean_env_wait_ms": 135.26172168834285}, "episodes_this_iter": 24, "episodes_total": 1527, "time_total_s": 8324.308853387833, "episode_reward_max": 473.8560741767287, "episode_reward_mean": 396.4571010292857, "episode_reward_min": 339.13933367235586, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 120.68169331550598, "timestamp": 1559272653, "episode_len_mean": 325.0, "iterations_since_restore": 66, "training_iteration": 66, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303642f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930364488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930364400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930364378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-17-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.7694425585515, "outflow_rate_min": 881.4547967646675, "system_level_velocity_max": 16.478730811475735, "cost2_min": -123.03309128913658, "system_level_velocity_min": 13.523787315994543, "cost1_min": 167.40168729144142, "cost1_max": 194.21963226309495, "cost2_mean": -107.49373941792915, "discrim_loss": 0.9105429649353027, "cost1_mean": 181.37005769513212, "outflow_rate_mean": 946.7978110754993, "system_level_velocity_mean": 15.050955943890022, "cost2_max": -94.17625690266607}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8436.3322224617, "sampler_perf": {"mean_inference_ms": 7.597821909832543, "mean_processing_ms": 10.931826100433982, "mean_env_wait_ms": 134.9904126853496}, "episodes_this_iter": 21, "episodes_total": 1548, "time_total_s": 8436.3322224617, "episode_reward_max": 425.7099264264107, "episode_reward_mean": 385.0749497183909, "episode_reward_min": 331.28960765339434, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.0233690738678, "timestamp": 1559272765, "episode_len_mean": 325.0, "iterations_since_restore": 67, "training_iteration": 67, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-19-25", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1008.5646306299932, "outflow_rate_min": 908.8595827188796, "system_level_velocity_max": 16.422277254352757, "cost2_min": -116.58871309153369, "system_level_velocity_min": 14.305033704341874, "cost1_min": 174.28282349742386, "cost1_max": 193.8533279862836, "cost2_mean": -101.60578260579314, "discrim_loss": 0.9938634037971497, "cost1_mean": 185.90197657596386, "outflow_rate_mean": 972.759124807698, "system_level_velocity_mean": 15.584590721085265, "cost2_max": -91.2131482632881}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8562.988692998886, "sampler_perf": {"mean_inference_ms": 7.595226777258572, "mean_processing_ms": 10.921053475117308, "mean_env_wait_ms": 134.9875527526859}, "episodes_this_iter": 21, "episodes_total": 1569, "time_total_s": 8562.988692998886, "episode_reward_max": 441.74027437344193, "episode_reward_mean": 360.9764360377255, "episode_reward_min": 253.82381451129913, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 126.65647053718567, "timestamp": 1559272891, "episode_len_mean": 325.0, "iterations_since_restore": 68, "training_iteration": 68, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-21-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4206721897413, "outflow_rate_min": 847.6941018811244, "system_level_velocity_max": 16.350292117762603, "cost2_min": -124.32815919540971, "system_level_velocity_min": 12.979574306457787, "cost1_min": 158.2593564657021, "cost1_max": 192.7657678722738, "cost2_mean": -108.40976268753481, "discrim_loss": 0.9215188026428223, "cost1_mean": 179.43485826792744, "outflow_rate_mean": 941.608943526184, "system_level_velocity_mean": 14.941595896614038, "cost2_max": -93.47786830937662}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8679.889228343964, "sampler_perf": {"mean_inference_ms": 7.5881903546877725, "mean_processing_ms": 10.924311674245315, "mean_env_wait_ms": 134.83911690296833}, "episodes_this_iter": 27, "episodes_total": 1596, "time_total_s": 8679.889228343964, "episode_reward_max": 522.4250929951668, "episode_reward_mean": 444.493707393641, "episode_reward_min": 313.27801709249616, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 116.90053534507751, "timestamp": 1559273008, "episode_len_mean": 325.0, "iterations_since_restore": 69, "training_iteration": 69, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbe18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb9d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb6a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-23-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.0439012142114, "outflow_rate_min": 869.2870206364578, "system_level_velocity_max": 16.304939150008078, "cost2_min": -123.54429829254977, "system_level_velocity_min": 13.62516096387371, "cost1_min": 167.93453666466237, "cost1_max": 191.8498673208483, "cost2_mean": -102.25096861388501, "discrim_loss": 0.9858852028846741, "cost1_mean": 183.2629088891426, "outflow_rate_mean": 960.6932017180817, "system_level_velocity_mean": 15.352693599897918, "cost2_max": -91.57233060771435}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8800.240774869919, "sampler_perf": {"mean_inference_ms": 7.5953075560377785, "mean_processing_ms": 10.940366709299479, "mean_env_wait_ms": 134.66832942671977}, "episodes_this_iter": 22, "episodes_total": 1618, "time_total_s": 8800.240774869919, "episode_reward_max": 492.1352876201272, "episode_reward_mean": 395.906648499235, "episode_reward_min": 310.7025336306542, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 120.3515465259552, "timestamp": 1559273129, "episode_len_mean": 320.09090909090907, "iterations_since_restore": 70, "training_iteration": 70, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303626a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-25-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1006.6624575707492, "outflow_rate_min": 868.3872377086954, "system_level_velocity_max": 16.64965065747706, "cost2_min": -119.07975387659963, "system_level_velocity_min": 13.810006191635747, "cost1_min": 129.57289843825205, "cost1_max": 190.33265403736908, "cost2_mean": -102.00657153993406, "discrim_loss": 0.9412822127342224, "cost1_mean": 178.80583499753897, "outflow_rate_mean": 949.0199312721467, "system_level_velocity_mean": 15.20642131770495, "cost2_max": -67.69093668377099}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 8921.3006939888, "sampler_perf": {"mean_inference_ms": 7.5905154402155866, "mean_processing_ms": 10.9294554293076, "mean_env_wait_ms": 134.671322771652}, "episodes_this_iter": 21, "episodes_total": 1639, "time_total_s": 8921.3006939888, "episode_reward_max": 391.20550800673664, "episode_reward_mean": 341.4094768636638, "episode_reward_min": 280.5801093541086, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.05991911888123, "timestamp": 1559273250, "episode_len_mean": 325.0, "iterations_since_restore": 71, "training_iteration": 71, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303248c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-27-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1007.2041998331014, "outflow_rate_min": 865.9679108474841, "system_level_velocity_max": 16.276337275957083, "cost2_min": -122.9409656693289, "system_level_velocity_min": 13.179738188841903, "cost1_min": 162.31663710711481, "cost1_max": 191.36269216814122, "cost2_mean": -103.19259752643086, "discrim_loss": 0.8893154263496399, "cost1_mean": 181.93651146822992, "outflow_rate_mean": 956.9344543178423, "system_level_velocity_mean": 15.220987527492985, "cost2_max": -93.19651925240234}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9041.156102657318, "sampler_perf": {"mean_inference_ms": 7.5918817833170555, "mean_processing_ms": 10.946316433172624, "mean_env_wait_ms": 134.51614066636247}, "episodes_this_iter": 28, "episodes_total": 1667, "time_total_s": 9041.156102657318, "episode_reward_max": 429.4601889979094, "episode_reward_mean": 365.6252456981373, "episode_reward_min": 289.5165221041534, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 119.85540866851807, "timestamp": 1559273370, "episode_len_mean": 325.0, "iterations_since_restore": 72, "training_iteration": 72, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-29-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1005.7846402046732, "outflow_rate_min": 879.2033442443123, "system_level_velocity_max": 16.3022207477039, "cost2_min": -122.53648548018668, "system_level_velocity_min": 13.65608848191032, "cost1_min": 168.77967154496622, "cost1_max": 191.95245085950165, "cost2_mean": -102.69921172012745, "discrim_loss": 0.9826200008392334, "cost1_mean": 181.408641380784, "outflow_rate_mean": 953.0226700904724, "system_level_velocity_mean": 15.137291431915278, "cost2_max": -89.11862644068466}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9161.188146829605, "sampler_perf": {"mean_inference_ms": 7.590758617727538, "mean_processing_ms": 10.944540536549713, "mean_env_wait_ms": 134.4035747033155}, "episodes_this_iter": 21, "episodes_total": 1688, "time_total_s": 9161.188146829605, "episode_reward_max": 480.9627354927361, "episode_reward_mean": 430.66808506979476, "episode_reward_min": 340.4046970233321, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 120.03204417228699, "timestamp": 1559273490, "episode_len_mean": 325.0, "iterations_since_restore": 73, "training_iteration": 73, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bb1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbbf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-31-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.0116399509706, "outflow_rate_min": 890.7645925527664, "system_level_velocity_max": 16.254072925070634, "cost2_min": -112.59028790121019, "system_level_velocity_min": 13.839463022608095, "cost1_min": 167.96512632513287, "cost1_max": 190.31328705774644, "cost2_mean": -101.6009156226208, "discrim_loss": 0.9658849835395813, "cost1_mean": 180.83001884722432, "outflow_rate_mean": 954.2818686342549, "system_level_velocity_mean": 15.148738436829097, "cost2_max": -91.66494141242413}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9279.848323106766, "sampler_perf": {"mean_inference_ms": 7.5855817831710555, "mean_processing_ms": 10.938115157699885, "mean_env_wait_ms": 134.36029617176172}, "episodes_this_iter": 21, "episodes_total": 1709, "time_total_s": 9279.848323106766, "episode_reward_max": 470.5813908353448, "episode_reward_mean": 407.02945235766293, "episode_reward_min": 368.9887892943807, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.66017627716064, "timestamp": 1559273609, "episode_len_mean": 325.0, "iterations_since_restore": 74, "training_iteration": 74, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-33-29", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1004.3991468971919, "outflow_rate_min": 889.8017715660189, "system_level_velocity_max": 16.27871350236041, "cost2_min": -112.76821005153994, "system_level_velocity_min": 13.664743767960113, "cost1_min": 166.54503514770624, "cost1_max": 189.6068597645779, "cost2_mean": -103.98539285838963, "discrim_loss": 0.9087586402893066, "cost1_mean": 175.65593608327106, "outflow_rate_mean": 931.2439846700725, "system_level_velocity_mean": 14.632720020709495, "cost2_max": -90.63712764883184}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9402.583725452423, "sampler_perf": {"mean_inference_ms": 7.584628041401228, "mean_processing_ms": 10.94570229299241, "mean_env_wait_ms": 134.29119411037996}, "episodes_this_iter": 26, "episodes_total": 1735, "time_total_s": 9402.583725452423, "episode_reward_max": 441.47842613980174, "episode_reward_mean": 372.3292438711595, "episode_reward_min": 324.37487923074514, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 122.73540234565735, "timestamp": 1559273732, "episode_len_mean": 325.0, "iterations_since_restore": 75, "training_iteration": 75, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930362ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362a60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930362400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-35-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1003.8190332307533, "outflow_rate_min": 864.7050405629661, "system_level_velocity_max": 16.241963617181227, "cost2_min": -110.22960441044964, "system_level_velocity_min": 13.27268240204469, "cost1_min": 161.12456295372004, "cost1_max": 189.0664400694366, "cost2_mean": -101.23068371984684, "discrim_loss": 0.9113631844520569, "cost1_mean": 175.92230231339443, "outflow_rate_mean": 935.3502471561767, "system_level_velocity_mean": 14.722697369041969, "cost2_max": -89.64273271900035}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9522.904381275177, "sampler_perf": {"mean_inference_ms": 7.596926383653818, "mean_processing_ms": 10.958426792982308, "mean_env_wait_ms": 134.19774266002875}, "episodes_this_iter": 23, "episodes_total": 1758, "time_total_s": 9522.904381275177, "episode_reward_max": 398.7775672264397, "episode_reward_mean": 357.203780714382, "episode_reward_min": 290.1241786759347, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 120.3206558227539, "timestamp": 1559273852, "episode_len_mean": 325.0, "iterations_since_restore": 76, "training_iteration": 76, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-37-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 1009.4594566071304, "outflow_rate_min": 865.0379879816558, "system_level_velocity_max": 16.25971276206248, "cost2_min": -120.23639500571242, "system_level_velocity_min": 13.09918792692351, "cost1_min": 161.33304508890882, "cost1_max": 189.85421010595167, "cost2_mean": -102.31307093709356, "discrim_loss": 0.8919748067855835, "cost1_mean": 178.24256415705847, "outflow_rate_mean": 946.3097030222974, "system_level_velocity_mean": 14.940687233046765, "cost2_max": -91.3312227879997}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9640.528932094574, "sampler_perf": {"mean_inference_ms": 7.58909569044893, "mean_processing_ms": 10.943275740548284, "mean_env_wait_ms": 134.15371186000328}, "episodes_this_iter": 20, "episodes_total": 1778, "time_total_s": 9640.528932094574, "episode_reward_max": 389.2867454383522, "episode_reward_mean": 353.67509466866034, "episode_reward_min": 317.959284002427, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 117.62455081939697, "timestamp": 1559273970, "episode_len_mean": 325.0, "iterations_since_restore": 77, "training_iteration": 77, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bba60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bb6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bbd90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bb620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-39-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 999.8690981026972, "outflow_rate_min": 889.1476311903966, "system_level_velocity_max": 16.199754527596202, "cost2_min": -107.75248826904945, "system_level_velocity_min": 13.342223649532126, "cost1_min": 162.21209977298696, "cost1_max": 187.78616387705094, "cost2_mean": -97.5395459749427, "discrim_loss": 0.9243881106376648, "cost1_mean": 176.63010685387962, "outflow_rate_mean": 943.435633357911, "system_level_velocity_mean": 14.84116607877613, "cost2_max": -89.33489127381674}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9761.72468996048, "sampler_perf": {"mean_inference_ms": 7.583694891837563, "mean_processing_ms": 10.958794510825859, "mean_env_wait_ms": 134.11269740287096}, "episodes_this_iter": 26, "episodes_total": 1804, "time_total_s": 9761.72468996048, "episode_reward_max": 434.7302400190383, "episode_reward_mean": 378.1760254196214, "episode_reward_min": 296.41228969953954, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 121.19575786590576, "timestamp": 1559274091, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 78, "training_iteration": 78, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-41-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.97496159136, "outflow_rate_min": 836.2701463551446, "system_level_velocity_max": 16.328917110168224, "cost2_min": -108.94411389289053, "system_level_velocity_min": 13.577982163982027, "cost1_min": 122.08820428821565, "cost1_max": 186.35525600121875, "cost2_mean": -98.32138656738468, "discrim_loss": 0.9214550256729126, "cost1_mean": 171.9455604348341, "outflow_rate_mean": 927.5176570213584, "system_level_velocity_mean": 14.650013157030552, "cost2_max": -67.12499611766398}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9880.349943637848, "sampler_perf": {"mean_inference_ms": 7.592201740443175, "mean_processing_ms": 10.974133107219318, "mean_env_wait_ms": 133.96252009964766}, "episodes_this_iter": 23, "episodes_total": 1827, "time_total_s": 9880.349943637848, "episode_reward_max": 454.85053374804556, "episode_reward_mean": 425.2629849787437, "episode_reward_min": 298.8527472713031, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.62525367736816, "timestamp": 1559274210, "episode_len_mean": 325.0, "iterations_since_restore": 79, "training_iteration": 79, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930362d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930362bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303629d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-43-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.5292289034718, "outflow_rate_min": 796.6837111283431, "system_level_velocity_max": 15.906537353549878, "cost2_min": -117.72111404308411, "system_level_velocity_min": 12.058819776520963, "cost1_min": 147.57570332644033, "cost1_max": 184.9229568564225, "cost2_mean": -95.98056658501616, "discrim_loss": 0.9382648468017578, "cost1_mean": 171.66132910011703, "outflow_rate_mean": 928.3189844543755, "system_level_velocity_mean": 14.465788359521747, "cost2_max": -82.99537075602646}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 9998.35461139679, "sampler_perf": {"mean_inference_ms": 7.585597015127689, "mean_processing_ms": 10.966427832525003, "mean_env_wait_ms": 133.84473932148245}, "episodes_this_iter": 21, "episodes_total": 1848, "time_total_s": 9998.35461139679, "episode_reward_max": 442.61816894449294, "episode_reward_mean": 386.7224009901374, "episode_reward_min": 354.25905037578195, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.00466775894165, "timestamp": 1559274328, "episode_len_mean": 323.3333333333333, "iterations_since_restore": 80, "training_iteration": 80, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303750d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-45-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.1361140511985, "outflow_rate_min": 875.1743873625518, "system_level_velocity_max": 15.93568439659274, "cost2_min": -100.16480126581324, "system_level_velocity_min": 13.132209035077237, "cost1_min": 155.86235132544695, "cost1_max": 184.80416403221108, "cost2_mean": -89.15973113414053, "discrim_loss": 0.929821252822876, "cost1_mean": 169.17476037658466, "outflow_rate_mean": 926.8186346830965, "system_level_velocity_mean": 14.440073072585122, "cost2_max": -79.0142656499196}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10121.524242639542, "sampler_perf": {"mean_inference_ms": 7.581522412141434, "mean_processing_ms": 10.97325496826374, "mean_env_wait_ms": 133.7231943921263}, "episodes_this_iter": 23, "episodes_total": 1871, "time_total_s": 10121.524242639542, "episode_reward_max": 374.78485850431025, "episode_reward_mean": 349.0310467856167, "episode_reward_min": 320.74394297320396, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.16963124275208, "timestamp": 1559274451, "episode_len_mean": 325.0, "iterations_since_restore": 81, "training_iteration": 81, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bbea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b3048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bb7b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bbd08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-47-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 984.7753489721538, "outflow_rate_min": 827.7869037603856, "system_level_velocity_max": 15.707701253202721, "cost2_min": -100.55342410669445, "system_level_velocity_min": 12.18170827594735, "cost1_min": 147.38996046764066, "cost1_max": 182.66442783155895, "cost2_mean": -89.9850067516074, "discrim_loss": 0.9028164148330688, "cost1_mean": 165.02121279068436, "outflow_rate_mean": 908.3060464378473, "system_level_velocity_mean": 13.956754543398782, "cost2_max": -81.21673127285999}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10237.438444137573, "sampler_perf": {"mean_inference_ms": 7.579431198267519, "mean_processing_ms": 10.962546190142746, "mean_env_wait_ms": 133.631786416553}, "episodes_this_iter": 26, "episodes_total": 1897, "time_total_s": 10237.438444137573, "episode_reward_max": 379.21484587341547, "episode_reward_mean": 356.45355465220143, "episode_reward_min": 319.6146714342758, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 115.91420149803162, "timestamp": 1559274567, "episode_len_mean": 324.2307692307692, "iterations_since_restore": 82, "training_iteration": 82, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-49-27", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 978.6625181825164, "outflow_rate_min": 864.3170458285525, "system_level_velocity_max": 15.61143416856717, "cost2_min": -95.41391098330348, "system_level_velocity_min": 13.038061175031896, "cost1_min": 155.22427771300772, "cost1_max": 180.21356757297517, "cost2_mean": -82.74165391283056, "discrim_loss": 0.9810032844543457, "cost1_mean": 167.60831945410325, "outflow_rate_mean": 924.3918290614517, "system_level_velocity_mean": 14.358506058446908, "cost2_max": -72.43397058360539}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10347.273804664612, "sampler_perf": {"mean_inference_ms": 7.575054261532333, "mean_processing_ms": 10.971074250989426, "mean_env_wait_ms": 133.31399467814617}, "episodes_this_iter": 22, "episodes_total": 1919, "time_total_s": 10347.273804664612, "episode_reward_max": 418.61895364895463, "episode_reward_mean": 369.01737645259976, "episode_reward_min": 33.95030412077904, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.83536052703857, "timestamp": 1559274677, "episode_len_mean": 306.09090909090907, "iterations_since_restore": 83, "training_iteration": 83, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b42f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-51-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.2491702855425, "outflow_rate_min": 492.0625426222078, "system_level_velocity_max": 17.68502040010133, "cost2_min": -83.84662331657034, "system_level_velocity_min": 13.334943508579574, "cost1_min": 17.829287751419127, "cost1_max": 181.45488904443823, "cost2_mean": -75.50787708133844, "discrim_loss": 0.9904577732086182, "cost1_mean": 162.69528272932578, "outflow_rate_mean": 916.8478050887137, "system_level_velocity_mean": 15.010256592947114, "cost2_max": -18.3364403433651}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10461.655860900879, "sampler_perf": {"mean_inference_ms": 7.568450942450728, "mean_processing_ms": 10.961635252360677, "mean_env_wait_ms": 133.18501513263746}, "episodes_this_iter": 22, "episodes_total": 1941, "time_total_s": 10461.655860900879, "episode_reward_max": 399.8078268645331, "episode_reward_mean": 370.53680854536253, "episode_reward_min": 355.30522493552417, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 114.38205623626709, "timestamp": 1559274791, "episode_len_mean": 325.0, "iterations_since_restore": 84, "training_iteration": 84, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303658c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-53-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.591291402626, "outflow_rate_min": 809.7996726757676, "system_level_velocity_max": 15.762001707537845, "cost2_min": -87.07108642123401, "system_level_velocity_min": 12.00832038822045, "cost1_min": 143.22021964134348, "cost1_max": 179.63472135035124, "cost2_mean": -80.81073267122304, "discrim_loss": 0.9321382641792297, "cost1_mean": 164.23178704809658, "outflow_rate_mean": 910.6132152574803, "system_level_velocity_mean": 14.052233949641778, "cost2_max": -75.60896764805884}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10568.38551735878, "sampler_perf": {"mean_inference_ms": 7.567613567035482, "mean_processing_ms": 10.973942393159557, "mean_env_wait_ms": 132.89484003090323}, "episodes_this_iter": 28, "episodes_total": 1969, "time_total_s": 10568.38551735878, "episode_reward_max": 376.4259462514892, "episode_reward_mean": 353.31136916062263, "episode_reward_min": 318.96413340978324, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.729656457901, "timestamp": 1559274898, "episode_len_mean": 325.0, "iterations_since_restore": 85, "training_iteration": 85, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b42f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-54-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.191586448079, "outflow_rate_min": 856.3519509188204, "system_level_velocity_max": 15.737178633027417, "cost2_min": -82.84392582124062, "system_level_velocity_min": 12.56689923771417, "cost1_min": 150.6862004691075, "cost1_max": 179.98170573829566, "cost2_mean": -78.85932391825773, "discrim_loss": 0.965424656867981, "cost1_mean": 167.74522446297425, "outflow_rate_mean": 926.0670367781871, "system_level_velocity_mean": 14.40396594823463, "cost2_max": -71.02376338757053}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10678.48583483696, "sampler_perf": {"mean_inference_ms": 7.567233537415591, "mean_processing_ms": 10.959639081814345, "mean_env_wait_ms": 132.75748675532031}, "episodes_this_iter": 20, "episodes_total": 1989, "time_total_s": 10678.48583483696, "episode_reward_max": 356.35502610355616, "episode_reward_mean": 333.45650538927873, "episode_reward_min": 205.68924306705594, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.10031747817993, "timestamp": 1559275008, "episode_len_mean": 319.1, "iterations_since_restore": 86, "training_iteration": 86, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303242f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324c80>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-56-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 978.5521001659735, "outflow_rate_min": 837.1687183856263, "system_level_velocity_max": 16.17882988176308, "cost2_min": -81.88153205767031, "system_level_velocity_min": 12.837403369712545, "cost1_min": 118.90962047710157, "cost1_max": 180.5097600623492, "cost2_mean": -75.64221497099527, "discrim_loss": 0.9265710115432739, "cost1_mean": 169.0509130399191, "outflow_rate_mean": 936.5068541851042, "system_level_velocity_mean": 14.888988226692728, "cost2_max": -59.42713928675438}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10796.631091356277, "sampler_perf": {"mean_inference_ms": 7.562838862943, "mean_processing_ms": 10.979434004229594, "mean_env_wait_ms": 132.69411820024095}, "episodes_this_iter": 24, "episodes_total": 2013, "time_total_s": 10796.631091356277, "episode_reward_max": 386.37988845817745, "episode_reward_mean": 357.9878896731728, "episode_reward_min": 219.07207627967, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.14525651931763, "timestamp": 1559275128, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 87, "training_iteration": 87, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ad0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ad268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ad1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ad158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_03-58-48", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 974.2429257945874, "outflow_rate_min": 792.9068685203124, "system_level_velocity_max": 16.573156009480012, "cost2_min": -92.86401046341045, "system_level_velocity_min": 11.571631317049198, "cost1_min": 121.41033481755701, "cost1_max": 178.47239349548016, "cost2_mean": -76.5658330131174, "discrim_loss": 0.9388785362243652, "cost1_mean": 161.53824016383666, "outflow_rate_mean": 904.5280434968321, "system_level_velocity_mean": 14.112015322324304, "cost2_max": -58.866885021607075}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 10915.190256357193, "sampler_perf": {"mean_inference_ms": 7.567955186976161, "mean_processing_ms": 10.973553280330362, "mean_env_wait_ms": 132.4765994569653}, "episodes_this_iter": 24, "episodes_total": 2037, "time_total_s": 10915.190256357193, "episode_reward_max": 427.43661663867533, "episode_reward_mean": 372.3385834801399, "episode_reward_min": 337.99160393700004, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 118.55916500091553, "timestamp": 1559275247, "episode_len_mean": 325.0, "iterations_since_restore": 88, "training_iteration": 88, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-00-47", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.5029223792891, "outflow_rate_min": 779.7475302225865, "system_level_velocity_max": 15.606439751375317, "cost2_min": -84.69223628658696, "system_level_velocity_min": 11.543683241650912, "cost1_min": 137.1262475299362, "cost1_max": 177.6606897081923, "cost2_mean": -73.69266264068455, "discrim_loss": 0.9609828591346741, "cost1_mean": 164.0366707481551, "outflow_rate_mean": 913.180919015272, "system_level_velocity_mean": 14.183083927949616, "cost2_max": -66.40807986406645}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11029.57453250885, "sampler_perf": {"mean_inference_ms": 7.570184261913178, "mean_processing_ms": 10.974486527603618, "mean_env_wait_ms": 132.32012065643758}, "episodes_this_iter": 22, "episodes_total": 2059, "time_total_s": 11029.57453250885, "episode_reward_max": 371.74830779992044, "episode_reward_mean": 332.48251503435046, "episode_reward_min": 281.34822231531143, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 114.3842761516571, "timestamp": 1559275361, "episode_len_mean": 323.72727272727275, "iterations_since_restore": 89, "training_iteration": 89, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b42f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-02-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 969.1634237595565, "outflow_rate_min": 798.4754299656094, "system_level_velocity_max": 15.583133034850107, "cost2_min": -78.96713528238013, "system_level_velocity_min": 11.828447154115977, "cost1_min": 139.0607046574612, "cost1_max": 176.075570509339, "cost2_mean": -70.80095256843704, "discrim_loss": 0.9279766082763672, "cost1_mean": 161.5960513351413, "outflow_rate_mean": 902.3062356596434, "system_level_velocity_mean": 14.035232958763226, "cost2_max": -65.02109093327425}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11138.248780727386, "sampler_perf": {"mean_inference_ms": 7.559335325849373, "mean_processing_ms": 10.982262143649704, "mean_env_wait_ms": 132.14831168157508}, "episodes_this_iter": 23, "episodes_total": 2082, "time_total_s": 11138.248780727386, "episode_reward_max": 331.51000333577394, "episode_reward_mean": 296.58344214765924, "episode_reward_min": 236.76670885831118, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.67424821853638, "timestamp": 1559275470, "episode_len_mean": 323.7826086956522, "iterations_since_restore": 90, "training_iteration": 90, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4048>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-04-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 972.7048464165676, "outflow_rate_min": 876.6388597980432, "system_level_velocity_max": 15.554967920583202, "cost2_min": -74.09544599919559, "system_level_velocity_min": 13.362923543428545, "cost1_min": 155.75717690062487, "cost1_max": 178.0113985010667, "cost2_mean": -69.24972235114384, "discrim_loss": 0.9129872918128967, "cost1_mean": 166.55348641721733, "outflow_rate_mean": 924.0260756201059, "system_level_velocity_mean": 14.507380800828104, "cost2_max": -63.226528690709365}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11247.51244711876, "sampler_perf": {"mean_inference_ms": 7.563277238964681, "mean_processing_ms": 10.97646490917739, "mean_env_wait_ms": 131.91394409898123}, "episodes_this_iter": 25, "episodes_total": 2107, "time_total_s": 11247.51244711876, "episode_reward_max": 395.8623614516109, "episode_reward_mean": 349.43265393912793, "episode_reward_min": 281.9425128661096, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.26366639137268, "timestamp": 1559275579, "episode_len_mean": 325.0, "iterations_since_restore": 91, "training_iteration": 91, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-06-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.4279777021546, "outflow_rate_min": 844.8455607682837, "system_level_velocity_max": 15.58249230627008, "cost2_min": -75.99543934368445, "system_level_velocity_min": 12.624392858999048, "cost1_min": 148.38005752114572, "cost1_max": 177.26601028012328, "cost2_mean": -69.17492918481234, "discrim_loss": 0.9195190668106079, "cost1_mean": 163.89633077154133, "outflow_rate_mean": 909.6001482260721, "system_level_velocity_mean": 14.167505143140726, "cost2_max": -61.477906312210266}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11357.857335090637, "sampler_perf": {"mean_inference_ms": 7.561766507810091, "mean_processing_ms": 10.991555350203669, "mean_env_wait_ms": 131.76210584027865}, "episodes_this_iter": 22, "episodes_total": 2129, "time_total_s": 11357.857335090637, "episode_reward_max": 444.8020717408508, "episode_reward_mean": 386.74157555621457, "episode_reward_min": 341.3662417382002, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.34488797187805, "timestamp": 1559275690, "episode_len_mean": 325.0, "iterations_since_restore": 92, "training_iteration": 92, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303242f0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-08-10", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 968.1418919271025, "outflow_rate_min": 820.3111416779146, "system_level_velocity_max": 15.571996796752629, "cost2_min": -77.38073055361865, "system_level_velocity_min": 12.1972270036446, "cost1_min": 143.6618338766105, "cost1_max": 176.57185748010215, "cost2_mean": -70.15179085002818, "discrim_loss": 0.9189704656600952, "cost1_mean": 160.1728107021431, "outflow_rate_mean": 892.7423129164298, "system_level_velocity_mean": 13.803767551998055, "cost2_max": -63.667809356440124}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11466.855335235596, "sampler_perf": {"mean_inference_ms": 7.55534489932557, "mean_processing_ms": 10.982551167401647, "mean_env_wait_ms": 131.63734208932792}, "episodes_this_iter": 22, "episodes_total": 2151, "time_total_s": 11466.855335235596, "episode_reward_max": 375.2168715316802, "episode_reward_mean": 305.80191517655146, "episode_reward_min": 26.6187464594841, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.9980001449585, "timestamp": 1559275799, "episode_len_mean": 310.1818181818182, "iterations_since_restore": 93, "training_iteration": 93, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-09-59", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 970.2098941935795, "outflow_rate_min": 478.1690499040066, "system_level_velocity_max": 17.7561646549029, "cost2_min": -75.4241439898389, "system_level_velocity_min": 12.594981722099137, "cost1_min": 17.862594198342812, "cost1_max": 177.40841279225833, "cost2_mean": -66.06590745652838, "discrim_loss": 0.8897836208343506, "cost1_mean": 158.19948285927958, "outflow_rate_mean": 892.8749176382039, "system_level_velocity_mean": 14.512916926558596, "cost2_max": -18.782433106636415}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11576.809179544449, "sampler_perf": {"mean_inference_ms": 7.561255230143651, "mean_processing_ms": 11.003376596340994, "mean_env_wait_ms": 131.45272852597768}, "episodes_this_iter": 24, "episodes_total": 2175, "time_total_s": 11576.809179544449, "episode_reward_max": 327.01125384680927, "episode_reward_mean": 289.9225195123193, "episode_reward_min": 241.51509468257427, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.95384430885315, "timestamp": 1559275911, "episode_len_mean": 325.0, "iterations_since_restore": 94, "training_iteration": 94, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-11-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 970.208048410234, "outflow_rate_min": 794.4110553006258, "system_level_velocity_max": 15.631074851839898, "cost2_min": -77.6389363415327, "system_level_velocity_min": 11.976670116676344, "cost1_min": 142.4117667620984, "cost1_max": 178.13794347592165, "cost2_mean": -69.9122171982648, "discrim_loss": 0.8784812688827515, "cost1_mean": 164.24956289205286, "outflow_rate_mean": 910.2532896436647, "system_level_velocity_mean": 14.190043719118515, "cost2_max": -62.63681314402624}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11689.306102275848, "sampler_perf": {"mean_inference_ms": 7.566008066217869, "mean_processing_ms": 10.982062935442679, "mean_env_wait_ms": 131.3563095533987}, "episodes_this_iter": 25, "episodes_total": 2200, "time_total_s": 11689.306102275848, "episode_reward_max": 349.5115475859493, "episode_reward_mean": 317.19197937015446, "episode_reward_min": 261.72074659354985, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.49692273139954, "timestamp": 1559276024, "episode_len_mean": 325.0, "iterations_since_restore": 95, "training_iteration": 95, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b4e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930348048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-13-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 973.7365932721485, "outflow_rate_min": 787.4638762735656, "system_level_velocity_max": 15.755973820330267, "cost2_min": -80.32462836868825, "system_level_velocity_min": 11.747954026843919, "cost1_min": 140.86982326866348, "cost1_max": 178.75979427731718, "cost2_mean": -70.94031564997438, "discrim_loss": 0.8759922385215759, "cost1_mean": 167.58253298909648, "outflow_rate_mean": 923.6153009421948, "system_level_velocity_mean": 14.469799915516614, "cost2_max": -64.55352241624644}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11803.768163204193, "sampler_perf": {"mean_inference_ms": 7.561155097468403, "mean_processing_ms": 10.999557308970253, "mean_env_wait_ms": 131.2947234555563}, "episodes_this_iter": 22, "episodes_total": 2222, "time_total_s": 11803.768163204193, "episode_reward_max": 375.56334104016423, "episode_reward_mean": 337.59350531163034, "episode_reward_min": 39.231764540076256, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 114.46206092834473, "timestamp": 1559276138, "episode_len_mean": 311.8181818181818, "iterations_since_restore": 96, "training_iteration": 96, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303249d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-15-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 969.0503425841126, "outflow_rate_min": 462.43348918263234, "system_level_velocity_max": 18.345601390023504, "cost2_min": -80.31695032907106, "system_level_velocity_min": 12.277497095893109, "cost1_min": 22.851881033951482, "cost1_max": 177.9492779505909, "cost2_mean": -69.63353879870401, "discrim_loss": 0.8649265766143799, "cost1_mean": 160.32250054223525, "outflow_rate_mean": 898.8548317123016, "system_level_velocity_mean": 14.574280254771514, "cost2_max": -24.100837320127397}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 11915.56232380867, "sampler_perf": {"mean_inference_ms": 7.563387739501072, "mean_processing_ms": 11.009035872701565, "mean_env_wait_ms": 131.13378192700424}, "episodes_this_iter": 23, "episodes_total": 2245, "time_total_s": 11915.56232380867, "episode_reward_max": 367.36855313181877, "episode_reward_mean": 347.68454748934704, "episode_reward_min": 320.08183718752116, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.79416060447693, "timestamp": 1559276250, "episode_len_mean": 322.5652173913044, "iterations_since_restore": 97, "training_iteration": 97, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b1158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b1268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b11e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b10d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-17-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 976.6187507811962, "outflow_rate_min": 846.3085354149073, "system_level_velocity_max": 15.641567489647512, "cost2_min": -77.43820140669843, "system_level_velocity_min": 12.656792171344586, "cost1_min": 147.6842201074075, "cost1_max": 178.12138099926523, "cost2_mean": -72.19973553254275, "discrim_loss": 0.8775728940963745, "cost1_mean": 163.19592798948096, "outflow_rate_mean": 909.261208106151, "system_level_velocity_mean": 14.158375011578098, "cost2_max": -67.32926050018585}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12029.352326869965, "sampler_perf": {"mean_inference_ms": 7.567269870563996, "mean_processing_ms": 11.000077076278973, "mean_env_wait_ms": 130.94515288827532}, "episodes_this_iter": 26, "episodes_total": 2271, "time_total_s": 12029.352326869965, "episode_reward_max": 343.8188667111099, "episode_reward_mean": 308.5727894160395, "episode_reward_min": 269.07626271247864, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.79000306129456, "timestamp": 1559276364, "episode_len_mean": 325.0, "iterations_since_restore": 98, "training_iteration": 98, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-19-24", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 972.4313496490828, "outflow_rate_min": 831.4880021141466, "system_level_velocity_max": 15.570044476628976, "cost2_min": -82.8415818237425, "system_level_velocity_min": 12.299574330541745, "cost1_min": 147.09401874340992, "cost1_max": 177.9560394859502, "cost2_mean": -71.52033204047929, "discrim_loss": 0.8542740345001221, "cost1_mean": 166.6083086069113, "outflow_rate_mean": 920.8725703210018, "system_level_velocity_mean": 14.379036142215389, "cost2_max": -66.277930879244}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12140.532753944397, "sampler_perf": {"mean_inference_ms": 7.5611678453342215, "mean_processing_ms": 11.00042275532894, "mean_env_wait_ms": 130.87952595957327}, "episodes_this_iter": 21, "episodes_total": 2292, "time_total_s": 12140.532753944397, "episode_reward_max": 352.5338034518063, "episode_reward_mean": 283.15199588860077, "episode_reward_min": 27.96763762831688, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.18042707443237, "timestamp": 1559276475, "episode_len_mean": 310.8095238095238, "iterations_since_restore": 99, "training_iteration": 99, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ae488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ae400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ae2f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-21-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.6393543337011, "outflow_rate_min": 474.3699846082663, "system_level_velocity_max": 16.97660450713944, "cost2_min": -77.6806923039536, "system_level_velocity_min": 12.296893539624136, "cost1_min": 17.568650500603365, "cost1_max": 177.8646885394071, "cost2_mean": -68.18632507266993, "discrim_loss": 0.8567996025085449, "cost1_mean": 160.3232014765459, "outflow_rate_mean": 903.1884612015432, "system_level_velocity_mean": 14.62068810118459, "cost2_max": -16.72425855626341}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12250.739186763763, "sampler_perf": {"mean_inference_ms": 7.557168737052083, "mean_processing_ms": 11.02265395658838, "mean_env_wait_ms": 130.730466122017}, "episodes_this_iter": 24, "episodes_total": 2316, "time_total_s": 12250.739186763763, "episode_reward_max": 339.23708202317357, "episode_reward_mean": 311.4414036129213, "episode_reward_min": 257.1029050387442, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.20643281936646, "timestamp": 1559276586, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 100, "training_iteration": 100, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303247b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-23-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 977.8206534515656, "outflow_rate_min": 849.2258289602239, "system_level_velocity_max": 15.69877321834306, "cost2_min": -75.57184159243666, "system_level_velocity_min": 12.614940837956892, "cost1_min": 148.55333970764917, "cost1_max": 179.05696334145296, "cost2_mean": -70.79753120766145, "discrim_loss": 0.8366671800613403, "cost1_mean": 165.50017183660444, "outflow_rate_mean": 915.8655262966912, "system_level_velocity_mean": 14.278634382973095, "cost2_max": -64.9082592609712}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12357.403760671616, "sampler_perf": {"mean_inference_ms": 7.564338436394364, "mean_processing_ms": 11.012072749560323, "mean_env_wait_ms": 130.44036183067237}, "episodes_this_iter": 25, "episodes_total": 2341, "time_total_s": 12357.403760671616, "episode_reward_max": 381.6666597565636, "episode_reward_mean": 344.94635155845435, "episode_reward_min": 279.012682903558, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.66457390785217, "timestamp": 1559276692, "episode_len_mean": 325.0, "iterations_since_restore": 101, "training_iteration": 101, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-24-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 972.7803482116211, "outflow_rate_min": 866.7337626659191, "system_level_velocity_max": 15.723957063954364, "cost2_min": -74.54193786760978, "system_level_velocity_min": 13.106406411478602, "cost1_min": 154.9462087262254, "cost1_max": 179.3567828408108, "cost2_mean": -69.98086971367877, "discrim_loss": 0.8579127192497253, "cost1_mean": 170.11562893215915, "outflow_rate_mean": 931.2762572294337, "system_level_velocity_mean": 14.699649825645754, "cost2_max": -65.32572701149894}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12469.237689971924, "sampler_perf": {"mean_inference_ms": 7.56182240175067, "mean_processing_ms": 11.010969563221014, "mean_env_wait_ms": 130.37801543260647}, "episodes_this_iter": 21, "episodes_total": 2362, "time_total_s": 12469.237689971924, "episode_reward_max": 394.1502103880048, "episode_reward_mean": 344.545195888107, "episode_reward_min": 310.62091191578656, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.83392930030823, "timestamp": 1559276804, "episode_len_mean": 325.0, "iterations_since_restore": 102, "training_iteration": 102, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-26-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 969.8570821748223, "outflow_rate_min": 815.1179910042886, "system_level_velocity_max": 15.55616068664833, "cost2_min": -81.94239184756931, "system_level_velocity_min": 12.023298984878481, "cost1_min": 143.99457453891495, "cost1_max": 178.34798913360007, "cost2_mean": -72.96806064235803, "discrim_loss": 0.8708882331848145, "cost1_mean": 167.61020619835568, "outflow_rate_mean": 921.167024829208, "system_level_velocity_mean": 14.39734997805655, "cost2_max": -67.23954945790354}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12579.879428386688, "sampler_perf": {"mean_inference_ms": 7.558419088571829, "mean_processing_ms": 11.012181315988835, "mean_env_wait_ms": 130.26623865490478}, "episodes_this_iter": 23, "episodes_total": 2385, "time_total_s": 12579.879428386688, "episode_reward_max": 333.6765464935452, "episode_reward_mean": 284.03208514130876, "episode_reward_min": 32.726917922496796, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.6417384147644, "timestamp": 1559276915, "episode_len_mean": 312.04347826086956, "iterations_since_restore": 103, "training_iteration": 103, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b82f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-28-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.7169454144675, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 17.652538535750697, "cost2_min": -77.83847430261065, "system_level_velocity_min": 12.443847982085902, "cost1_min": 17.849178017482533, "cost1_max": 180.8643221729936, "cost2_mean": -69.38353894303413, "discrim_loss": 0.8402819633483887, "cost1_mean": 162.04594277885744, "outflow_rate_mean": 905.2701970410322, "system_level_velocity_mean": 14.627013990658112, "cost2_max": -17.539880466895628}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12692.413871049881, "sampler_perf": {"mean_inference_ms": 7.563957835324922, "mean_processing_ms": 11.028208755275614, "mean_env_wait_ms": 130.0390757301382}, "episodes_this_iter": 26, "episodes_total": 2411, "time_total_s": 12692.413871049881, "episode_reward_max": 330.19242254272103, "episode_reward_mean": 301.39228167033826, "episode_reward_min": 273.2787864282727, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.53444266319275, "timestamp": 1559277028, "episode_len_mean": 325.0, "iterations_since_restore": 104, "training_iteration": 104, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303246a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324a60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-30-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.2188691920013, "outflow_rate_min": 824.6807851681563, "system_level_velocity_max": 15.913208209085553, "cost2_min": -78.76972911169179, "system_level_velocity_min": 12.305131720409403, "cost1_min": 147.17118485124945, "cost1_max": 181.02107198671115, "cost2_mean": -71.4252615377687, "discrim_loss": 0.8576227426528931, "cost1_mean": 167.86203466910848, "outflow_rate_mean": 921.8349445148558, "system_level_velocity_mean": 14.430617350724305, "cost2_max": -67.00925749561347}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12805.159793138504, "sampler_perf": {"mean_inference_ms": 7.55881601635558, "mean_processing_ms": 11.019514832389602, "mean_env_wait_ms": 130.06739153981732}, "episodes_this_iter": 23, "episodes_total": 2434, "time_total_s": 12805.159793138504, "episode_reward_max": 360.64486435893923, "episode_reward_mean": 321.30625390180427, "episode_reward_min": 194.6713347537443, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.74592208862305, "timestamp": 1559277140, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 105, "training_iteration": 105, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303488c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303489d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930348f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930348a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-32-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 970.0759960401795, "outflow_rate_min": 838.020317088404, "system_level_velocity_max": 16.18298446130595, "cost2_min": -73.50816382265828, "system_level_velocity_min": 12.792701852680592, "cost1_min": 118.83351662814503, "cost1_max": 178.3293355087563, "cost2_mean": -68.96313590574947, "discrim_loss": 0.8597716093063354, "cost1_mean": 166.75619092105256, "outflow_rate_mean": 922.2294222107364, "system_level_velocity_mean": 14.63036781762971, "cost2_max": -54.48405357008828}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 12912.72744679451, "sampler_perf": {"mean_inference_ms": 7.562227289391258, "mean_processing_ms": 11.013973614394029, "mean_env_wait_ms": 129.87374665879574}, "episodes_this_iter": 20, "episodes_total": 2454, "time_total_s": 12912.72744679451, "episode_reward_max": 399.8115801019594, "episode_reward_mean": 345.62430788476485, "episode_reward_min": 303.84088517539203, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.56765365600586, "timestamp": 1559277248, "episode_len_mean": 325.0, "iterations_since_restore": 106, "training_iteration": 106, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bda60>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bdb70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-34-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.284974976623, "outflow_rate_min": 858.7102365402762, "system_level_velocity_max": 15.662610799413502, "cost2_min": -76.12485006973807, "system_level_velocity_min": 12.93949859920555, "cost1_min": 154.57835621244212, "cost1_max": 179.48654424998503, "cost2_mean": -68.57279251533205, "discrim_loss": 0.8512194156646729, "cost1_mean": 170.2671146217883, "outflow_rate_mean": 931.8948674036865, "system_level_velocity_mean": 14.694673088806653, "cost2_max": -61.04853416716452}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13025.523729085922, "sampler_perf": {"mean_inference_ms": 7.564605750409116, "mean_processing_ms": 11.035649166322749, "mean_env_wait_ms": 129.71946740614302}, "episodes_this_iter": 26, "episodes_total": 2480, "time_total_s": 13025.523729085922, "episode_reward_max": 370.19759340491146, "episode_reward_mean": 332.5725464199025, "episode_reward_min": 210.2526440108195, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.79628229141235, "timestamp": 1559277362, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 107, "training_iteration": 107, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bdbf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd9d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd2f0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-36-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 984.9985514491106, "outflow_rate_min": 838.983303709979, "system_level_velocity_max": 16.277517643344353, "cost2_min": -75.63714793748814, "system_level_velocity_min": 12.785102612156171, "cost1_min": 120.41519314945592, "cost1_max": 180.73504556977988, "cost2_mean": -69.40568190280491, "discrim_loss": 0.8625519871711731, "cost1_mean": 167.77602568611044, "outflow_rate_mean": 924.4870714411403, "system_level_velocity_mean": 14.6798083158217, "cost2_max": -55.52864458007702}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13136.328937768936, "sampler_perf": {"mean_inference_ms": 7.5677357951029345, "mean_processing_ms": 11.040708054600557, "mean_env_wait_ms": 129.71520287143565}, "episodes_this_iter": 24, "episodes_total": 2504, "time_total_s": 13136.328937768936, "episode_reward_max": 351.70025253482163, "episode_reward_mean": 302.15309956421453, "episode_reward_min": 36.14884603023529, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.80520868301392, "timestamp": 1559277476, "episode_len_mean": 307.6666666666667, "iterations_since_restore": 108, "training_iteration": 108, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b82f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b8620>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b88c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-37-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 977.2169564713616, "outflow_rate_min": 493.8123238995481, "system_level_velocity_max": 17.338199723071753, "cost2_min": -74.36995074629513, "system_level_velocity_min": 13.152345010431622, "cost1_min": 17.55100572402547, "cost1_max": 179.5591494754001, "cost2_mean": -67.30290545346197, "discrim_loss": 0.8608700037002563, "cost1_mean": 161.54671352511534, "outflow_rate_mean": 905.5285967037311, "system_level_velocity_mean": 14.802858262388725, "cost2_max": -18.33025049526493}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13253.763029813766, "sampler_perf": {"mean_inference_ms": 7.570515980348002, "mean_processing_ms": 11.052807758291609, "mean_env_wait_ms": 129.57865643453638}, "episodes_this_iter": 22, "episodes_total": 2526, "time_total_s": 13253.763029813766, "episode_reward_max": 328.8922979561612, "episode_reward_mean": 306.85123835068026, "episode_reward_min": 270.81545807793736, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 117.43409204483032, "timestamp": 1559277593, "episode_len_mean": 325.0, "iterations_since_restore": 109, "training_iteration": 109, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-39-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 978.8995862200792, "outflow_rate_min": 834.2537086572265, "system_level_velocity_max": 15.74754822406671, "cost2_min": -74.39802218509693, "system_level_velocity_min": 12.445104686710723, "cost1_min": 147.5718451616426, "cost1_max": 180.27893448245857, "cost2_mean": -69.93513706721369, "discrim_loss": 0.8753122687339783, "cost1_mean": 168.04965753159806, "outflow_rate_mean": 918.5939187502772, "system_level_velocity_mean": 14.402712361088783, "cost2_max": -62.22422210243251}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13365.44990515709, "sampler_perf": {"mean_inference_ms": 7.565186525186736, "mean_processing_ms": 11.029979449487104, "mean_env_wait_ms": 129.46319577979818}, "episodes_this_iter": 23, "episodes_total": 2549, "time_total_s": 13365.44990515709, "episode_reward_max": 350.5120211066678, "episode_reward_mean": 322.98713111838975, "episode_reward_min": 211.6643786020577, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.68687534332275, "timestamp": 1559277705, "episode_len_mean": 318.6521739130435, "iterations_since_restore": 110, "training_iteration": 110, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bd158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bd510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bd6a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-41-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 984.1643139742206, "outflow_rate_min": 818.8207904064495, "system_level_velocity_max": 16.025188954272043, "cost2_min": -74.13039873085313, "system_level_velocity_min": 13.187444894883027, "cost1_min": 119.3100334561637, "cost1_max": 181.1794680551045, "cost2_mean": -69.08712540168003, "discrim_loss": 0.9022226929664612, "cost1_mean": 168.92689657056374, "outflow_rate_mean": 930.5035527400205, "system_level_velocity_mean": 14.853532408730349, "cost2_max": -57.295601691251996}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13481.467303037643, "sampler_perf": {"mean_inference_ms": 7.5729209784514975, "mean_processing_ms": 11.05897251136986, "mean_env_wait_ms": 129.33380115502382}, "episodes_this_iter": 27, "episodes_total": 2576, "time_total_s": 13481.467303037643, "episode_reward_max": 413.6201793849468, "episode_reward_mean": 344.2221949612032, "episode_reward_min": 40.44510780274868, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 116.0173978805542, "timestamp": 1559277821, "episode_len_mean": 313.962962962963, "iterations_since_restore": 111, "training_iteration": 111, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-43-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.1206953266394, "outflow_rate_min": 452.1702014201058, "system_level_velocity_max": 17.49585164387117, "cost2_min": -79.89632001648135, "system_level_velocity_min": 11.861699602641218, "cost1_min": 17.89082061650777, "cost1_max": 180.50519313150113, "cost2_mean": -69.77905032661896, "discrim_loss": 0.8804165124893188, "cost1_mean": 159.65660985289065, "outflow_rate_mean": 888.9998371527697, "system_level_velocity_mean": 14.186714378539135, "cost2_max": -20.171429250676365}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13592.139205217361, "sampler_perf": {"mean_inference_ms": 7.57205881514948, "mean_processing_ms": 11.055330914733062, "mean_env_wait_ms": 129.24833365850978}, "episodes_this_iter": 21, "episodes_total": 2597, "time_total_s": 13592.139205217361, "episode_reward_max": 397.6463841116056, "episode_reward_mean": 371.40047500648404, "episode_reward_min": 340.34634151123464, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.67190217971802, "timestamp": 1559277932, "episode_len_mean": 325.0, "iterations_since_restore": 112, "training_iteration": 112, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b8730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b82f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b8620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b89d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-45-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.7038718280585, "outflow_rate_min": 869.0418849976393, "system_level_velocity_max": 15.810855795610662, "cost2_min": -76.00721608384202, "system_level_velocity_min": 13.19805459372218, "cost1_min": 157.38339124368807, "cost1_max": 180.6597610874138, "cost2_mean": -70.56313457534475, "discrim_loss": 0.9009917378425598, "cost1_mean": 170.48869969769146, "outflow_rate_mean": 928.2958073485712, "system_level_velocity_mean": 14.596687022867657, "cost2_max": -64.60003107841257}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13701.904974937439, "sampler_perf": {"mean_inference_ms": 7.5692435638869044, "mean_processing_ms": 11.041121815309005, "mean_env_wait_ms": 129.1421053980799}, "episodes_this_iter": 23, "episodes_total": 2620, "time_total_s": 13701.904974937439, "episode_reward_max": 411.49070352036506, "episode_reward_mean": 339.6013628878307, "episode_reward_min": 291.65506116114557, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.76576972007751, "timestamp": 1559278042, "episode_len_mean": 325.0, "iterations_since_restore": 113, "training_iteration": 113, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303248c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303242f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-47-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 981.353119421412, "outflow_rate_min": 818.8597589782804, "system_level_velocity_max": 15.92221858254185, "cost2_min": -85.81671433490177, "system_level_velocity_min": 12.179339296834772, "cost1_min": 146.49380298617314, "cost1_max": 182.40074255419853, "cost2_mean": -70.4235051213047, "discrim_loss": 0.8614609241485596, "cost1_mean": 172.6333303508014, "outflow_rate_mean": 937.525154084352, "system_level_velocity_mean": 14.868771352375846, "cost2_max": -60.49823320865881}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13812.697692394257, "sampler_perf": {"mean_inference_ms": 7.578094853062226, "mean_processing_ms": 11.071848919423578, "mean_env_wait_ms": 128.92053052945383}, "episodes_this_iter": 24, "episodes_total": 2644, "time_total_s": 13812.697692394257, "episode_reward_max": 362.1728669507429, "episode_reward_mean": 309.5694905172568, "episode_reward_min": 280.88237929251045, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.79271745681763, "timestamp": 1559278153, "episode_len_mean": 325.0, "iterations_since_restore": 114, "training_iteration": 114, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bdd90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bda60>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bdb70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bd268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-49-13", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.7225520362325, "outflow_rate_min": 831.2345101284566, "system_level_velocity_max": 15.870856396916189, "cost2_min": -79.6107188980509, "system_level_velocity_min": 12.463377664008206, "cost1_min": 149.17257377764733, "cost1_max": 181.6593725900895, "cost2_mean": -70.34296960148995, "discrim_loss": 0.8925179243087769, "cost1_mean": 169.39400157607818, "outflow_rate_mean": 922.4223857836228, "system_level_velocity_mean": 14.525518675789792, "cost2_max": -65.70982922124804}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 13921.843526601791, "sampler_perf": {"mean_inference_ms": 7.56931904265232, "mean_processing_ms": 11.063721667892215, "mean_env_wait_ms": 128.92738886306742}, "episodes_this_iter": 24, "episodes_total": 2668, "time_total_s": 13921.843526601791, "episode_reward_max": 384.2944576703012, "episode_reward_mean": 327.61959060685086, "episode_reward_min": 216.8678791858256, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.14583420753479, "timestamp": 1559278262, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 115, "training_iteration": 115, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303247b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324730>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-51-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.3669547337618, "outflow_rate_min": 823.6100904770793, "system_level_velocity_max": 16.47570810871104, "cost2_min": -77.6733895944308, "system_level_velocity_min": 12.508992825405663, "cost1_min": 122.0267771090451, "cost1_max": 182.00097354831772, "cost2_mean": -68.05294528294884, "discrim_loss": 0.8996878862380981, "cost1_mean": 166.8620988642094, "outflow_rate_mean": 917.0799481853132, "system_level_velocity_mean": 14.561661324420825, "cost2_max": -57.24343096247646}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14032.514362573624, "sampler_perf": {"mean_inference_ms": 7.568100475204887, "mean_processing_ms": 11.038407331649971, "mean_env_wait_ms": 128.70152294450486}, "episodes_this_iter": 22, "episodes_total": 2690, "time_total_s": 14032.514362573624, "episode_reward_max": 424.4243877567351, "episode_reward_mean": 387.1790306650695, "episode_reward_min": 340.11617760173976, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.67083597183228, "timestamp": 1559278373, "episode_len_mean": 325.0, "iterations_since_restore": 116, "training_iteration": 116, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba0d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-52-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.653429241991, "outflow_rate_min": 889.5152854675459, "system_level_velocity_max": 15.963677818771863, "cost2_min": -70.74638797147304, "system_level_velocity_min": 13.77016494266008, "cost1_min": 162.22937376293328, "cost1_max": 182.51137900971102, "cost2_mean": -67.97266727328116, "discrim_loss": 0.9225435256958008, "cost1_mean": 172.91845649052127, "outflow_rate_mean": 936.4053144502973, "system_level_velocity_mean": 14.882779604869334, "cost2_max": -64.3921737540218}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14144.16501379013, "sampler_perf": {"mean_inference_ms": 7.575490454449904, "mean_processing_ms": 11.061594342428657, "mean_env_wait_ms": 128.5212744934325}, "episodes_this_iter": 23, "episodes_total": 2713, "time_total_s": 14144.16501379013, "episode_reward_max": 416.59681679308414, "episode_reward_mean": 374.5144888671601, "episode_reward_min": 338.42877389490604, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.65065121650696, "timestamp": 1559278484, "episode_len_mean": 325.0, "iterations_since_restore": 117, "training_iteration": 117, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-54-44", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 967.2487014451016, "outflow_rate_min": 805.5335924709365, "system_level_velocity_max": 15.591698322015722, "cost2_min": -74.56997628754911, "system_level_velocity_min": 11.835320122492003, "cost1_min": 143.43386354605974, "cost1_max": 178.81718152670442, "cost2_mean": -68.13499285784088, "discrim_loss": 0.9236196875572205, "cost1_mean": 165.6354117810478, "outflow_rate_mean": 902.070094207297, "system_level_velocity_mean": 14.147972960822237, "cost2_max": -63.27810100446611}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14252.060814857483, "sampler_perf": {"mean_inference_ms": 7.5699472180601, "mean_processing_ms": 11.059953496688214, "mean_env_wait_ms": 128.50619512929327}, "episodes_this_iter": 24, "episodes_total": 2737, "time_total_s": 14252.060814857483, "episode_reward_max": 420.76069171447307, "episode_reward_mean": 322.07259873487055, "episode_reward_min": 210.1647172551602, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.8958010673523, "timestamp": 1559278592, "episode_len_mean": 315.1666666666667, "iterations_since_restore": 118, "training_iteration": 118, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-56-32", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 954.4756590305507, "outflow_rate_min": 769.735221610882, "system_level_velocity_max": 16.48673318785679, "cost2_min": -71.81592740233337, "system_level_velocity_min": 11.43826522182093, "cost1_min": 119.1537243200832, "cost1_max": 178.23324000148364, "cost2_mean": -63.652716489508975, "discrim_loss": 0.9119759798049927, "cost1_mean": 161.13056388807473, "outflow_rate_mean": 891.4630838107105, "system_level_velocity_mean": 14.329963237811995, "cost2_max": -53.82804305089972}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14358.268849134445, "sampler_perf": {"mean_inference_ms": 7.569999410938849, "mean_processing_ms": 11.050746786781286, "mean_env_wait_ms": 128.29261097127386}, "episodes_this_iter": 23, "episodes_total": 2760, "time_total_s": 14358.268849134445, "episode_reward_max": 393.9058499839157, "episode_reward_mean": 339.3580000685204, "episode_reward_min": 291.10381397232413, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.20803427696228, "timestamp": 1559278699, "episode_len_mean": 325.0, "iterations_since_restore": 119, "training_iteration": 119, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_04-58-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 976.2247996730594, "outflow_rate_min": 826.7527483783882, "system_level_velocity_max": 15.955622593274269, "cost2_min": -66.59578340685482, "system_level_velocity_min": 12.773201424112424, "cost1_min": 149.09131279311458, "cost1_max": 179.76850934960157, "cost2_mean": -62.823004733474235, "discrim_loss": 0.9472107291221619, "cost1_mean": 168.33269425543133, "outflow_rate_mean": 914.2495414377389, "system_level_velocity_mean": 14.533208523112755, "cost2_max": -59.543581386952994}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14465.48156118393, "sampler_perf": {"mean_inference_ms": 7.5692898127038255, "mean_processing_ms": 11.067157166035344, "mean_env_wait_ms": 128.12672498364773}, "episodes_this_iter": 24, "episodes_total": 2784, "time_total_s": 14465.48156118393, "episode_reward_max": 426.05029377900064, "episode_reward_mean": 371.093452933128, "episode_reward_min": 270.0376627035439, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.21271204948425, "timestamp": 1559278806, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 120, "training_iteration": 120, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-00-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 963.7285449943647, "outflow_rate_min": 795.3439827767172, "system_level_velocity_max": 16.199025999998316, "cost2_min": -72.98888480288645, "system_level_velocity_min": 11.60886724537388, "cost1_min": 119.97275620860886, "cost1_max": 178.25937721759095, "cost2_mean": -64.32032198730333, "discrim_loss": 0.9312086701393127, "cost1_mean": 164.28036058335502, "outflow_rate_mean": 901.5079552184125, "system_level_velocity_mean": 14.367719155071448, "cost2_max": -51.21450899400604}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14574.954557180405, "sampler_perf": {"mean_inference_ms": 7.5624740327074855, "mean_processing_ms": 11.051957822159473, "mean_env_wait_ms": 128.07246566396594}, "episodes_this_iter": 23, "episodes_total": 2807, "time_total_s": 14574.954557180405, "episode_reward_max": 436.52996533736587, "episode_reward_mean": 403.384122972984, "episode_reward_min": 360.7293309215456, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.47299599647522, "timestamp": 1559278915, "episode_len_mean": 325.0, "iterations_since_restore": 121, "training_iteration": 121, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bf510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bf0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-01-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 970.675185237092, "outflow_rate_min": 856.4698115525849, "system_level_velocity_max": 15.71476598197329, "cost2_min": -67.59457070077436, "system_level_velocity_min": 13.306236451482535, "cost1_min": 158.06823999114863, "cost1_max": 180.06740246520255, "cost2_mean": -64.10049235401222, "discrim_loss": 0.9620137214660645, "cost1_mean": 171.37663158606117, "outflow_rate_mean": 926.0775780034359, "system_level_velocity_mean": 14.7950940778823, "cost2_max": -60.39225447492981}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14681.543395996094, "sampler_perf": {"mean_inference_ms": 7.5643318264456525, "mean_processing_ms": 11.056091421874777, "mean_env_wait_ms": 127.86539422292888}, "episodes_this_iter": 24, "episodes_total": 2831, "time_total_s": 14681.543395996094, "episode_reward_max": 429.6031811926514, "episode_reward_mean": 363.1480292996469, "episode_reward_min": 246.12230558134615, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.58883881568909, "timestamp": 1559279022, "episode_len_mean": 318.9166666666667, "iterations_since_restore": 122, "training_iteration": 122, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930365840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303659d8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-03-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 966.8457378638412, "outflow_rate_min": 849.0428022416738, "system_level_velocity_max": 16.542720008401428, "cost2_min": -67.13026669768672, "system_level_velocity_min": 13.317846014205621, "cost1_min": 121.47437770096349, "cost1_max": 179.49323858037405, "cost2_mean": -62.32679621003327, "discrim_loss": 0.9748001098632812, "cost1_mean": 168.43185098636488, "outflow_rate_mean": 919.1589033600902, "system_level_velocity_mean": 14.83771347584497, "cost2_max": -54.76744969393644}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14789.929309129715, "sampler_perf": {"mean_inference_ms": 7.56764085791515, "mean_processing_ms": 11.06842427179756, "mean_env_wait_ms": 127.79698466022464}, "episodes_this_iter": 22, "episodes_total": 2853, "time_total_s": 14789.929309129715, "episode_reward_max": 387.88931780308485, "episode_reward_mean": 346.8437729386867, "episode_reward_min": 239.90290762484074, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.38591313362122, "timestamp": 1559279131, "episode_len_mean": 318.3636363636364, "iterations_since_restore": 123, "training_iteration": 123, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-05-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 977.3600667461291, "outflow_rate_min": 779.5146589466905, "system_level_velocity_max": 16.185722235640768, "cost2_min": -70.04109769542396, "system_level_velocity_min": 11.547449183128998, "cost1_min": 119.86959334434778, "cost1_max": 180.18331690653434, "cost2_mean": -62.645447086625374, "discrim_loss": 0.958748459815979, "cost1_mean": 161.756583378453, "outflow_rate_mean": 889.2667979037717, "system_level_velocity_mean": 14.212510812224194, "cost2_max": -52.05668618512658}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14896.694313764572, "sampler_perf": {"mean_inference_ms": 7.56779148856001, "mean_processing_ms": 11.068430011605008, "mean_env_wait_ms": 127.70910058228839}, "episodes_this_iter": 25, "episodes_total": 2878, "time_total_s": 14896.694313764572, "episode_reward_max": 403.57738601975143, "episode_reward_mean": 364.9783485269919, "episode_reward_min": 331.6263932045549, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.76500463485718, "timestamp": 1559279240, "episode_len_mean": 323.88, "iterations_since_restore": 124, "training_iteration": 124, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034abf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a8c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-07-20", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 960.7254928788369, "outflow_rate_min": 826.474295928473, "system_level_velocity_max": 15.577427596610203, "cost2_min": -64.91116206777278, "system_level_velocity_min": 12.67722712967828, "cost1_min": 149.3548254771409, "cost1_max": 178.50793761094258, "cost2_mean": -61.76844075165722, "discrim_loss": 0.9776391983032227, "cost1_mean": 166.25865171201633, "outflow_rate_mean": 900.0723310530869, "system_level_velocity_mean": 14.341464965378504, "cost2_max": -58.08583972567515}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 14999.682421922684, "sampler_perf": {"mean_inference_ms": 7.566777086085143, "mean_processing_ms": 11.070439111268591, "mean_env_wait_ms": 127.49842645315444}, "episodes_this_iter": 22, "episodes_total": 2900, "time_total_s": 14999.682421922684, "episode_reward_max": 424.6139862742275, "episode_reward_mean": 388.0015314024958, "episode_reward_min": 286.01388758793473, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 102.98810815811157, "timestamp": 1559279343, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 125, "training_iteration": 125, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bfe18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfa60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-09-03", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 963.0160340265783, "outflow_rate_min": 827.491334569558, "system_level_velocity_max": 16.553038337396735, "cost2_min": -66.49129219885484, "system_level_velocity_min": 12.666746570080011, "cost1_min": 121.59612048060761, "cost1_max": 180.04812115004415, "cost2_mean": -61.17761551588506, "discrim_loss": 0.9578049182891846, "cost1_mean": 164.70699064510507, "outflow_rate_mean": 898.3230960705339, "system_level_velocity_mean": 14.44356343713567, "cost2_max": -53.08221724134624}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15102.896019935608, "sampler_perf": {"mean_inference_ms": 7.565162551454532, "mean_processing_ms": 11.060672241499871, "mean_env_wait_ms": 127.351722046153}, "episodes_this_iter": 23, "episodes_total": 2923, "time_total_s": 15102.896019935608, "episode_reward_max": 437.05224359966815, "episode_reward_mean": 387.1159505398296, "episode_reward_min": 344.81231409683824, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 103.2135980129242, "timestamp": 1559279446, "episode_len_mean": 325.0, "iterations_since_restore": 126, "training_iteration": 126, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-10-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 956.8424355809983, "outflow_rate_min": 837.9604398286998, "system_level_velocity_max": 15.730047760215681, "cost2_min": -64.56321834207688, "system_level_velocity_min": 13.018039611713318, "cost1_min": 152.64477487683632, "cost1_max": 180.14231314171815, "cost2_mean": -60.68239090366336, "discrim_loss": 0.974297046661377, "cost1_mean": 167.15033327834968, "outflow_rate_mean": 899.8267187689438, "system_level_velocity_mean": 14.386236380072829, "cost2_max": -56.97222962805699}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15204.35605597496, "sampler_perf": {"mean_inference_ms": 7.565752388828172, "mean_processing_ms": 11.073538757780234, "mean_env_wait_ms": 127.19948743537711}, "episodes_this_iter": 23, "episodes_total": 2946, "time_total_s": 15204.35605597496, "episode_reward_max": 402.8921930529177, "episode_reward_mean": 350.4541011685101, "episode_reward_min": 305.7945281434804, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 101.46003603935242, "timestamp": 1559279548, "episode_len_mean": 325.0, "iterations_since_restore": 127, "training_iteration": 127, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034aea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-12-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 960.3699952530202, "outflow_rate_min": 808.802194286183, "system_level_velocity_max": 15.773338501151672, "cost2_min": -64.34166894193166, "system_level_velocity_min": 12.540419482949062, "cost1_min": 149.00065710802994, "cost1_max": 180.32184710853267, "cost2_mean": -60.69578071061295, "discrim_loss": 0.9763379096984863, "cost1_mean": 168.93439931037264, "outflow_rate_mean": 907.3521430405519, "system_level_velocity_mean": 14.570509934725875, "cost2_max": -55.94022029757513}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15313.472998857498, "sampler_perf": {"mean_inference_ms": 7.55862740101522, "mean_processing_ms": 11.055879637861993, "mean_env_wait_ms": 127.1447083130642}, "episodes_this_iter": 23, "episodes_total": 2969, "time_total_s": 15313.472998857498, "episode_reward_max": 389.08677382953465, "episode_reward_mean": 358.9759446116083, "episode_reward_min": 318.8259062767029, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.11694288253784, "timestamp": 1559279657, "episode_len_mean": 325.0, "iterations_since_restore": 128, "training_iteration": 128, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303246a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-14-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 975.8140609249149, "outflow_rate_min": 840.5213286568978, "system_level_velocity_max": 15.97645427272661, "cost2_min": -68.04842058935566, "system_level_velocity_min": 13.05597137618624, "cost1_min": 153.9515845803823, "cost1_max": 183.27438100498784, "cost2_mean": -64.62589815305348, "discrim_loss": 0.9510408043861389, "cost1_mean": 169.30676372821728, "outflow_rate_mean": 909.8568584708046, "system_level_velocity_mean": 14.481743816695284, "cost2_max": -56.698141057249245}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15421.88863492012, "sampler_perf": {"mean_inference_ms": 7.559981538378776, "mean_processing_ms": 11.06831276243829, "mean_env_wait_ms": 126.93420511032757}, "episodes_this_iter": 24, "episodes_total": 2993, "time_total_s": 15421.88863492012, "episode_reward_max": 411.27898302674294, "episode_reward_mean": 376.60060445421067, "episode_reward_min": 347.94947304204106, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.41563606262207, "timestamp": 1559279766, "episode_len_mean": 325.0, "iterations_since_restore": 129, "training_iteration": 129, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ad048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfbf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bfd90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-16-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 974.5797280551337, "outflow_rate_min": 855.5305560176693, "system_level_velocity_max": 15.845717682155444, "cost2_min": -73.29175148218157, "system_level_velocity_min": 12.883060051961666, "cost1_min": 153.73035489758064, "cost1_max": 182.56190376228307, "cost2_mean": -66.36681239217523, "discrim_loss": 0.9821299910545349, "cost1_mean": 169.75165117334993, "outflow_rate_mean": 914.9914395614775, "system_level_velocity_mean": 14.466072668826305, "cost2_max": -59.09418149332617}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15529.548110246658, "sampler_perf": {"mean_inference_ms": 7.559917884722687, "mean_processing_ms": 11.073735266669658, "mean_env_wait_ms": 126.86340503205635}, "episodes_this_iter": 23, "episodes_total": 3016, "time_total_s": 15529.548110246658, "episode_reward_max": 434.24636238627136, "episode_reward_mean": 402.56629193323135, "episode_reward_min": 369.69098203629255, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.65947532653809, "timestamp": 1559279873, "episode_len_mean": 325.0, "iterations_since_restore": 130, "training_iteration": 130, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324f28>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303249d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-17-53", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.9541995874395, "outflow_rate_min": 810.0113612430944, "system_level_velocity_max": 16.12250543423613, "cost2_min": -76.74683310598, "system_level_velocity_min": 12.207214031726403, "cost1_min": 145.89720688914343, "cost1_max": 185.999611466574, "cost2_mean": -69.94309626200388, "discrim_loss": 0.9987872838973999, "cost1_mean": 172.87738072802532, "outflow_rate_mean": 926.8695920060151, "system_level_velocity_mean": 14.690400183006174, "cost2_max": -64.70984027521088}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15638.75812458992, "sampler_perf": {"mean_inference_ms": 7.554037269535634, "mean_processing_ms": 11.05437472400874, "mean_env_wait_ms": 126.84199282229206}, "episodes_this_iter": 23, "episodes_total": 3039, "time_total_s": 15638.75812458992, "episode_reward_max": 444.5634379517287, "episode_reward_mean": 405.7908135532685, "episode_reward_min": 379.1269708033651, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.21001434326172, "timestamp": 1559279983, "episode_len_mean": 325.0, "iterations_since_restore": 131, "training_iteration": 131, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-19-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.5593911213385, "outflow_rate_min": 803.8708706655133, "system_level_velocity_max": 16.052502210055163, "cost2_min": -81.70369054333025, "system_level_velocity_min": 12.251651705613767, "cost1_min": 147.59705496175388, "cost1_max": 185.2719148408943, "cost2_mean": -69.92778900606788, "discrim_loss": 0.9956367015838623, "cost1_mean": 175.04850741198845, "outflow_rate_mean": 934.7579927258499, "system_level_velocity_mean": 14.887711014772774, "cost2_max": -64.60264051364908}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15752.263496875763, "sampler_perf": {"mean_inference_ms": 7.561471399056381, "mean_processing_ms": 11.056476528397896, "mean_env_wait_ms": 126.69068322963794}, "episodes_this_iter": 23, "episodes_total": 3062, "time_total_s": 15752.263496875763, "episode_reward_max": 427.4853662699461, "episode_reward_mean": 395.3268462236485, "episode_reward_min": 355.33552854321897, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.5053722858429, "timestamp": 1559280100, "episode_len_mean": 325.0, "iterations_since_restore": 132, "training_iteration": 132, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d90>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303248c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-21-40", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.37897585169, "outflow_rate_min": 779.7138793124998, "system_level_velocity_max": 16.073476791599596, "cost2_min": -83.5244534474084, "system_level_velocity_min": 11.756745654822016, "cost1_min": 141.69321862049605, "cost1_max": 185.1828902164964, "cost2_mean": -70.56995358409259, "discrim_loss": 0.9899582862854004, "cost1_mean": 170.1813341837556, "outflow_rate_mean": 911.307012954821, "system_level_velocity_mean": 14.370816353994329, "cost2_max": -65.6357603131411}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15865.452610254288, "sampler_perf": {"mean_inference_ms": 7.5592537583166886, "mean_processing_ms": 11.078738027817485, "mean_env_wait_ms": 126.69211129422176}, "episodes_this_iter": 24, "episodes_total": 3086, "time_total_s": 15865.452610254288, "episode_reward_max": 420.53042648360133, "episode_reward_mean": 370.39151315251365, "episode_reward_min": 229.26578503102064, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.18911337852478, "timestamp": 1559280213, "episode_len_mean": 320.0833333333333, "iterations_since_restore": 133, "training_iteration": 133, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bff28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bfae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bfe18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302bf8c8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-23-33", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.3879491497007, "outflow_rate_min": 773.9804202027701, "system_level_velocity_max": 16.60796200963814, "cost2_min": -86.4197339618502, "system_level_velocity_min": 11.773999941229675, "cost1_min": 123.77242987468838, "cost1_max": 186.9903622318783, "cost2_mean": -71.09388338435474, "discrim_loss": 0.9389078617095947, "cost1_mean": 171.35499499302514, "outflow_rate_mean": 922.6223571602271, "system_level_velocity_mean": 14.738120176596356, "cost2_max": -58.799310268807346}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 15978.863054513931, "sampler_perf": {"mean_inference_ms": 7.55555057675823, "mean_processing_ms": 11.052407534565994, "mean_env_wait_ms": 126.70477904286184}, "episodes_this_iter": 22, "episodes_total": 3108, "time_total_s": 15978.863054513931, "episode_reward_max": 397.8839188814163, "episode_reward_mean": 371.80925204824996, "episode_reward_min": 336.9021699130535, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.41044425964355, "timestamp": 1559280326, "episode_len_mean": 325.0, "iterations_since_restore": 134, "training_iteration": 134, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303659d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-25-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.8035331595506, "outflow_rate_min": 867.0119273289192, "system_level_velocity_max": 16.1585669343325, "cost2_min": -76.8817921040639, "system_level_velocity_min": 13.16977909450752, "cost1_min": 159.8208124973931, "cost1_max": 186.7318889060549, "cost2_mean": -72.44097538522566, "discrim_loss": 0.9398294687271118, "cost1_mean": 172.41414662347262, "outflow_rate_mean": 921.387080446122, "system_level_velocity_mean": 14.486519640018907, "cost2_max": -68.3300841191651}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16098.384540319443, "sampler_perf": {"mean_inference_ms": 7.559281025684083, "mean_processing_ms": 11.060253289054877, "mean_env_wait_ms": 126.54702506510397}, "episodes_this_iter": 24, "episodes_total": 3132, "time_total_s": 16098.384540319443, "episode_reward_max": 425.6520581934601, "episode_reward_mean": 384.31289247617434, "episode_reward_min": 328.64471957832575, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 119.52148580551147, "timestamp": 1559280446, "episode_len_mean": 325.0, "iterations_since_restore": 135, "training_iteration": 135, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302beb70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be0d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-27-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.9077428702581, "outflow_rate_min": 797.145114569013, "system_level_velocity_max": 16.122978604892577, "cost2_min": -87.68567628435287, "system_level_velocity_min": 12.100844277254996, "cost1_min": 147.43923736859068, "cost1_max": 187.17719573019826, "cost2_mean": -72.56010460242018, "discrim_loss": 0.9412816762924194, "cost1_mean": 171.8333335879994, "outflow_rate_mean": 919.4808415388675, "system_level_velocity_mean": 14.485918536716744, "cost2_max": -66.81306451066723}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16210.134490966797, "sampler_perf": {"mean_inference_ms": 7.554288606862801, "mean_processing_ms": 11.063668257824668, "mean_env_wait_ms": 126.53654336534687}, "episodes_this_iter": 24, "episodes_total": 3156, "time_total_s": 16210.134490966797, "episode_reward_max": 433.9056261740625, "episode_reward_mean": 383.0750555838458, "episode_reward_min": 58.99686840176582, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.74995064735413, "timestamp": 1559280558, "episode_len_mean": 308.375, "iterations_since_restore": 136, "training_iteration": 136, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324400>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-29-18", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.9488961155, "outflow_rate_min": 511.17688865063195, "system_level_velocity_max": 18.501806439286774, "cost2_min": -77.06893872491854, "system_level_velocity_min": 13.021685619017259, "cost1_min": 22.763441047011312, "cost1_max": 186.29281038661404, "cost2_mean": -69.88076801734319, "discrim_loss": 0.9489911198616028, "cost1_mean": 164.66556220191708, "outflow_rate_mean": 902.0214956431646, "system_level_velocity_mean": 14.772767047910387, "cost2_max": -22.04014790583274}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16319.577225923538, "sampler_perf": {"mean_inference_ms": 7.556658671846802, "mean_processing_ms": 11.069125690054882, "mean_env_wait_ms": 126.45809833455624}, "episodes_this_iter": 23, "episodes_total": 3179, "time_total_s": 16319.577225923538, "episode_reward_max": 403.7584091089666, "episode_reward_mean": 381.9317827106494, "episode_reward_min": 355.22835563495755, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.44273495674133, "timestamp": 1559280667, "episode_len_mean": 325.0, "iterations_since_restore": 137, "training_iteration": 137, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302bf730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-31-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.7942263134161, "outflow_rate_min": 871.6177176026769, "system_level_velocity_max": 16.10665608715443, "cost2_min": -76.06884094376889, "system_level_velocity_min": 13.10072168354303, "cost1_min": 158.16412697020442, "cost1_max": 186.97013027474483, "cost2_mean": -70.67693540515491, "discrim_loss": 0.9528127312660217, "cost1_mean": 175.06455438671324, "outflow_rate_mean": 933.0610772463389, "system_level_velocity_mean": 14.76619925430403, "cost2_max": -66.53163223771001}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16443.21311736107, "sampler_perf": {"mean_inference_ms": 7.5576316651615345, "mean_processing_ms": 11.070225537257022, "mean_env_wait_ms": 126.40974453025014}, "episodes_this_iter": 22, "episodes_total": 3201, "time_total_s": 16443.21311736107, "episode_reward_max": 405.173347229138, "episode_reward_mean": 364.71569831686264, "episode_reward_min": 339.684878885746, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 123.63589143753052, "timestamp": 1559280791, "episode_len_mean": 322.8181818181818, "iterations_since_restore": 138, "training_iteration": 138, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324bf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303241e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-33-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.2519057297925, "outflow_rate_min": 804.1167803141251, "system_level_velocity_max": 16.082272116431685, "cost2_min": -83.28448732036178, "system_level_velocity_min": 12.174094078957479, "cost1_min": 147.35213748392584, "cost1_max": 186.98982750015486, "cost2_mean": -70.61347122042304, "discrim_loss": 0.9028351902961731, "cost1_mean": 173.12383954646486, "outflow_rate_mean": 925.8941152008705, "system_level_velocity_mean": 14.706918056983575, "cost2_max": -66.11786736537495}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16559.63978099823, "sampler_perf": {"mean_inference_ms": 7.560243005567746, "mean_processing_ms": 11.074912253313277, "mean_env_wait_ms": 126.37019461538141}, "episodes_this_iter": 24, "episodes_total": 3225, "time_total_s": 16559.63978099823, "episode_reward_max": 411.8496475405991, "episode_reward_mean": 370.4553196463967, "episode_reward_min": 307.9418267868459, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 116.42666363716125, "timestamp": 1559280907, "episode_len_mean": 323.8333333333333, "iterations_since_restore": 139, "training_iteration": 139, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba1e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-35-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.0024275551195, "outflow_rate_min": 608.0916233215603, "system_level_velocity_max": 16.071388708173124, "cost2_min": -86.85802669228497, "system_level_velocity_min": 8.076407028013664, "cost1_min": 100.33247471028812, "cost1_max": 185.79192328600809, "cost2_mean": -71.35019452149037, "discrim_loss": 0.9255915284156799, "cost1_mean": 167.68581524473697, "outflow_rate_mean": 904.1014332317123, "system_level_velocity_mean": 14.155128712248194, "cost2_max": -62.518909648390085}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16673.11856532097, "sampler_perf": {"mean_inference_ms": 7.5653864653997625, "mean_processing_ms": 11.071461481512056, "mean_env_wait_ms": 126.38070820483325}, "episodes_this_iter": 23, "episodes_total": 3248, "time_total_s": 16673.11856532097, "episode_reward_max": 398.0137499831617, "episode_reward_mean": 364.41855206583506, "episode_reward_min": 331.7413157299161, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.47878432273865, "timestamp": 1559281021, "episode_len_mean": 325.0, "iterations_since_restore": 140, "training_iteration": 140, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-37-01", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.1230928246828, "outflow_rate_min": 863.1733705972846, "system_level_velocity_max": 16.056168288532856, "cost2_min": -75.9976912303528, "system_level_velocity_min": 13.274147950531367, "cost1_min": 160.48224026240183, "cost1_max": 186.39086640785118, "cost2_mean": -69.29406212477613, "discrim_loss": 0.9059068560600281, "cost1_mean": 173.25768471630238, "outflow_rate_mean": 924.5232933206835, "system_level_velocity_mean": 14.59667112506936, "cost2_max": -61.533001142690395}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16783.006240606308, "sampler_perf": {"mean_inference_ms": 7.559107896635234, "mean_processing_ms": 11.072455547469161, "mean_env_wait_ms": 126.35233126367666}, "episodes_this_iter": 22, "episodes_total": 3270, "time_total_s": 16783.006240606308, "episode_reward_max": 404.9836626946926, "episode_reward_mean": 362.61159591817045, "episode_reward_min": 322.3763301707804, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.88767528533936, "timestamp": 1559281131, "episode_len_mean": 325.0, "iterations_since_restore": 141, "training_iteration": 141, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba158>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-38-51", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.9413441855166, "outflow_rate_min": 876.631688991285, "system_level_velocity_max": 16.03570938611154, "cost2_min": -75.41424309440893, "system_level_velocity_min": 13.283635491576979, "cost1_min": 160.0098030951422, "cost1_max": 186.33140934545116, "cost2_mean": -68.0743091029032, "discrim_loss": 0.9089838266372681, "cost1_mean": 175.47964622443408, "outflow_rate_mean": 935.5989069412019, "system_level_velocity_mean": 14.874794764452627, "cost2_max": -60.34139042585609}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16890.175636291504, "sampler_perf": {"mean_inference_ms": 7.565388281248367, "mean_processing_ms": 11.085301908649441, "mean_env_wait_ms": 126.21110831579367}, "episodes_this_iter": 25, "episodes_total": 3295, "time_total_s": 16890.175636291504, "episode_reward_max": 397.77044312655926, "episode_reward_mean": 354.6530400452018, "episode_reward_min": 324.6393082179129, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.16939568519592, "timestamp": 1559281238, "episode_len_mean": 325.0, "iterations_since_restore": 142, "training_iteration": 142, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-40-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.4918734644368, "outflow_rate_min": 878.0403969851401, "system_level_velocity_max": 16.184040466104975, "cost2_min": -74.80804316904212, "system_level_velocity_min": 13.46408417208883, "cost1_min": 162.57661386338683, "cost1_max": 186.7464278838714, "cost2_mean": -68.3722875299818, "discrim_loss": 0.9202735424041748, "cost1_mean": 178.90674694329152, "outflow_rate_mean": 952.2614457714783, "system_level_velocity_mean": 15.230934559720739, "cost2_max": -63.91453057025595}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 16997.569217443466, "sampler_perf": {"mean_inference_ms": 7.567688131883719, "mean_processing_ms": 11.080434158548446, "mean_env_wait_ms": 126.16015646890678}, "episodes_this_iter": 23, "episodes_total": 3318, "time_total_s": 16997.569217443466, "episode_reward_max": 386.089632358402, "episode_reward_mean": 349.37844659112716, "episode_reward_min": 321.3577278479934, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.39358115196228, "timestamp": 1559281346, "episode_len_mean": 325.0, "iterations_since_restore": 143, "training_iteration": 143, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba8c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba7b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-42-26", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 994.4241251489141, "outflow_rate_min": 856.2628342766225, "system_level_velocity_max": 16.18884407165847, "cost2_min": -74.64327119492718, "system_level_velocity_min": 13.067879660010462, "cost1_min": 157.5144066903308, "cost1_max": 186.74917397635625, "cost2_mean": -69.23044839426171, "discrim_loss": 0.8897606134414673, "cost1_mean": 175.71635226035764, "outflow_rate_mean": 937.8763285918765, "system_level_velocity_mean": 14.923598596807688, "cost2_max": -64.16653023777633}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17108.08956694603, "sampler_perf": {"mean_inference_ms": 7.560859464741304, "mean_processing_ms": 11.074284498925664, "mean_env_wait_ms": 126.11498378886704}, "episodes_this_iter": 22, "episodes_total": 3340, "time_total_s": 17108.08956694603, "episode_reward_max": 368.8693076763302, "episode_reward_mean": 333.6153260459277, "episode_reward_min": 207.31601318717003, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.52034950256348, "timestamp": 1559281456, "episode_len_mean": 320.0, "iterations_since_restore": 144, "training_iteration": 144, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303757b8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375b70>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-44-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.0650722185351, "outflow_rate_min": 803.6540001952762, "system_level_velocity_max": 16.68733517218068, "cost2_min": -82.35232554765625, "system_level_velocity_min": 12.202223182910869, "cost1_min": 128.36768213338146, "cost1_max": 186.50093557579714, "cost2_mean": -69.58827974551978, "discrim_loss": 0.8901636600494385, "cost1_mean": 168.1218614637569, "outflow_rate_mean": 907.2957982874789, "system_level_velocity_mean": 14.420034058849787, "cost2_max": -55.486846337586215}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17219.211929798126, "sampler_perf": {"mean_inference_ms": 7.566021121907165, "mean_processing_ms": 11.095579322975897, "mean_env_wait_ms": 126.00748789485648}, "episodes_this_iter": 26, "episodes_total": 3366, "time_total_s": 17219.211929798126, "episode_reward_max": 394.2038791254163, "episode_reward_mean": 341.59843241616795, "episode_reward_min": 229.3931853249669, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.12236285209656, "timestamp": 1559281571, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 145, "training_iteration": 145, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ba268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ba0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ba400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ba1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-46-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.9175906050508, "outflow_rate_min": 805.116897354785, "system_level_velocity_max": 16.46152772518889, "cost2_min": -79.09245773375137, "system_level_velocity_min": 12.268982304357507, "cost1_min": 123.54515682901494, "cost1_max": 185.49521081385672, "cost2_mean": -68.39746143761133, "discrim_loss": 0.8830443620681763, "cost1_mean": 170.1503631238468, "outflow_rate_mean": 915.4190322461072, "system_level_velocity_mean": 14.602052997734031, "cost2_max": -60.36961543405544}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17328.319966316223, "sampler_perf": {"mean_inference_ms": 7.564802493194116, "mean_processing_ms": 11.08192643251429, "mean_env_wait_ms": 125.93620750784383}, "episodes_this_iter": 23, "episodes_total": 3389, "time_total_s": 17328.319966316223, "episode_reward_max": 406.56012297049165, "episode_reward_mean": 371.1651654032909, "episode_reward_min": 316.20994636416435, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.10803651809692, "timestamp": 1559281680, "episode_len_mean": 325.0, "iterations_since_restore": 146, "training_iteration": 146, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303241e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930425268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-48-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.2815673389318, "outflow_rate_min": 802.4675326221576, "system_level_velocity_max": 16.08838533342578, "cost2_min": -84.09381510980751, "system_level_velocity_min": 11.737973373690137, "cost1_min": 144.39967469902996, "cost1_max": 186.37552909422743, "cost2_mean": -69.10346657808073, "discrim_loss": 0.886673629283905, "cost1_mean": 172.68000519373888, "outflow_rate_mean": 923.1710604916127, "system_level_velocity_mean": 14.611781579386703, "cost2_max": -58.83581901844548}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17437.13600230217, "sampler_perf": {"mean_inference_ms": 7.5629970982127395, "mean_processing_ms": 11.078887542406095, "mean_env_wait_ms": 125.91998625190453}, "episodes_this_iter": 21, "episodes_total": 3410, "time_total_s": 17437.13600230217, "episode_reward_max": 390.3325909692794, "episode_reward_mean": 358.40522997267544, "episode_reward_min": 321.83824879676104, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.81603598594666, "timestamp": 1559281789, "episode_len_mean": 325.0, "iterations_since_restore": 147, "training_iteration": 147, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c16a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-49-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.1336482559411, "outflow_rate_min": 854.8229161420181, "system_level_velocity_max": 16.101707202787065, "cost2_min": -73.30223912780923, "system_level_velocity_min": 12.818551279942778, "cost1_min": 154.13361900655383, "cost1_max": 185.75070839056957, "cost2_mean": -68.33147281688505, "discrim_loss": 0.904157280921936, "cost1_mean": 170.9080454159392, "outflow_rate_mean": 915.5307997122984, "system_level_velocity_mean": 14.438834714433115, "cost2_max": -64.06629659927046}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17551.209839105606, "sampler_perf": {"mean_inference_ms": 7.569271662371846, "mean_processing_ms": 11.102817089600325, "mean_env_wait_ms": 125.83938241858732}, "episodes_this_iter": 25, "episodes_total": 3435, "time_total_s": 17551.209839105606, "episode_reward_max": 381.9993277583271, "episode_reward_mean": 319.83347907558084, "episode_reward_min": 45.645318031311035, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 114.07383680343628, "timestamp": 1559281903, "episode_len_mean": 308.68, "iterations_since_restore": 148, "training_iteration": 148, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930365840>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-51-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.5752070548183, "outflow_rate_min": 493.8745706160326, "system_level_velocity_max": 18.40065705720584, "cost2_min": -75.91842571566043, "system_level_velocity_min": 12.28597058011124, "cost1_min": 22.800712987774205, "cost1_max": 186.1714603211768, "cost2_mean": -64.40427678892502, "discrim_loss": 0.8602944612503052, "cost1_mean": 165.68514638803518, "outflow_rate_mean": 905.6268871073348, "system_level_velocity_mean": 14.93376638175962, "cost2_max": -22.058268574354383}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17662.085047245026, "sampler_perf": {"mean_inference_ms": 7.561961745526873, "mean_processing_ms": 11.085664606303979, "mean_env_wait_ms": 125.72937639865503}, "episodes_this_iter": 23, "episodes_total": 3458, "time_total_s": 17662.085047245026, "episode_reward_max": 393.12463252898306, "episode_reward_mean": 336.5054735297175, "episode_reward_min": 296.89059066027403, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.87520813941956, "timestamp": 1559282014, "episode_len_mean": 325.0, "iterations_since_restore": 149, "training_iteration": 149, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c16a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c11e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1510>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-53-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.6815493008318, "outflow_rate_min": 803.6896202500322, "system_level_velocity_max": 16.21512466372718, "cost2_min": -73.70294445532791, "system_level_velocity_min": 12.191018530711492, "cost1_min": 145.69422055342608, "cost1_max": 185.84316370208342, "cost2_mean": -65.90347582551507, "discrim_loss": 0.8747178316116333, "cost1_mean": 172.61386063252422, "outflow_rate_mean": 921.470524779061, "system_level_velocity_mean": 14.67142828819411, "cost2_max": -60.55577684689328}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17769.417920589447, "sampler_perf": {"mean_inference_ms": 7.563825167173159, "mean_processing_ms": 11.080700406890083, "mean_env_wait_ms": 125.6521045136691}, "episodes_this_iter": 23, "episodes_total": 3481, "time_total_s": 17769.417920589447, "episode_reward_max": 368.8952373676002, "episode_reward_mean": 342.36291538033146, "episode_reward_min": 305.68926395848393, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.33287334442139, "timestamp": 1559282121, "episode_len_mean": 325.0, "iterations_since_restore": 150, "training_iteration": 150, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302bebf8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bec80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-55-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.8858045799456, "outflow_rate_min": 843.4291849317453, "system_level_velocity_max": 16.177230184516915, "cost2_min": -73.67637554264478, "system_level_velocity_min": 12.695148622465936, "cost1_min": 152.91388407704298, "cost1_max": 185.77108002194473, "cost2_mean": -64.15637596174167, "discrim_loss": 0.8679599761962891, "cost1_mean": 175.07127751088666, "outflow_rate_mean": 931.9007224825801, "system_level_velocity_mean": 14.94295975594745, "cost2_max": -56.61712926074378}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17875.674654960632, "sampler_perf": {"mean_inference_ms": 7.56430536424423, "mean_processing_ms": 11.09452181328079, "mean_env_wait_ms": 125.5307121808619}, "episodes_this_iter": 22, "episodes_total": 3503, "time_total_s": 17875.674654960632, "episode_reward_max": 404.02944080904126, "episode_reward_mean": 353.80732850489125, "episode_reward_min": 312.8720959536731, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.2567343711853, "timestamp": 1559282228, "episode_len_mean": 325.0, "iterations_since_restore": 151, "training_iteration": 151, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302beea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302bef28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-57-08", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.3254608546746, "outflow_rate_min": 731.9451663829099, "system_level_velocity_max": 16.04701737442785, "cost2_min": -79.10924284123391, "system_level_velocity_min": 10.945713025932196, "cost1_min": 134.4236769623147, "cost1_max": 184.72225597669865, "cost2_mean": -65.77484219070196, "discrim_loss": 0.8655084371566772, "cost1_mean": 168.41876203773694, "outflow_rate_mean": 900.3790727860091, "system_level_velocity_mean": 14.277814593356169, "cost2_max": -56.479251275151846}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 17985.59908103943, "sampler_perf": {"mean_inference_ms": 7.559340987796374, "mean_processing_ms": 11.087253836292726, "mean_env_wait_ms": 125.38314414437816}, "episodes_this_iter": 24, "episodes_total": 3527, "time_total_s": 17985.59908103943, "episode_reward_max": 382.43298180773854, "episode_reward_mean": 344.09471070277505, "episode_reward_min": 305.6745143458247, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.92442607879639, "timestamp": 1559282338, "episode_len_mean": 325.0, "iterations_since_restore": 152, "training_iteration": 152, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_05-58-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.5680932670637, "outflow_rate_min": 836.2449023329026, "system_level_velocity_max": 16.225150657987772, "cost2_min": -68.65635368712027, "system_level_velocity_min": 13.046548041714285, "cost1_min": 155.13738565201305, "cost1_max": 185.4340273678706, "cost2_mean": -63.74261809749172, "discrim_loss": 0.8857714533805847, "cost1_mean": 173.44993402325204, "outflow_rate_mean": 925.274960086594, "system_level_velocity_mean": 14.82163152418159, "cost2_max": -60.26374182813895}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18089.88166975975, "sampler_perf": {"mean_inference_ms": 7.559493818393407, "mean_processing_ms": 11.082359806919742, "mean_env_wait_ms": 125.28891465895343}, "episodes_this_iter": 23, "episodes_total": 3550, "time_total_s": 18089.88166975975, "episode_reward_max": 349.4940394125879, "episode_reward_mean": 312.0400342312844, "episode_reward_min": 277.2021300047636, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 104.28258872032166, "timestamp": 1559282442, "episode_len_mean": 325.0, "iterations_since_restore": 153, "training_iteration": 153, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303751e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-00-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.9374365065784, "outflow_rate_min": 854.6523949962142, "system_level_velocity_max": 16.214056285304462, "cost2_min": -67.26579286962189, "system_level_velocity_min": 13.160355690288169, "cost1_min": 156.3322179074001, "cost1_max": 185.18474613025816, "cost2_mean": -62.42114902700018, "discrim_loss": 0.8509011268615723, "cost1_mean": 177.78864175240852, "outflow_rate_mean": 944.4182484782028, "system_level_velocity_mean": 15.289244749028734, "cost2_max": -57.75344571068657}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18197.50931239128, "sampler_perf": {"mean_inference_ms": 7.558541061838027, "mean_processing_ms": 11.086102952858528, "mean_env_wait_ms": 125.27485676748906}, "episodes_this_iter": 22, "episodes_total": 3572, "time_total_s": 18197.50931239128, "episode_reward_max": 336.7394303791225, "episode_reward_mean": 301.54647311796856, "episode_reward_min": 275.0977455601096, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.62764263153076, "timestamp": 1559282550, "episode_len_mean": 325.0, "iterations_since_restore": 154, "training_iteration": 154, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302be1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be730>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302be8c8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302be0d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-02-30", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.8673433158081, "outflow_rate_min": 845.1652065688905, "system_level_velocity_max": 16.06195344845838, "cost2_min": -67.55071089492566, "system_level_velocity_min": 13.202788124330176, "cost1_min": 158.40295219675693, "cost1_max": 185.03551374467952, "cost2_mean": -63.60882493109259, "discrim_loss": 0.8591970205307007, "cost1_mean": 173.87656314054507, "outflow_rate_mean": 926.3499758648031, "system_level_velocity_mean": 14.843302215686514, "cost2_max": -59.39865034574026}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18304.452674150467, "sampler_perf": {"mean_inference_ms": 7.558055430560177, "mean_processing_ms": 11.096132948583955, "mean_env_wait_ms": 125.14902602057921}, "episodes_this_iter": 26, "episodes_total": 3598, "time_total_s": 18304.452674150467, "episode_reward_max": 420.47729662247, "episode_reward_mean": 329.95580258170287, "episode_reward_min": 47.171541929244995, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.94336175918579, "timestamp": 1559282657, "episode_len_mean": 313.84615384615387, "iterations_since_restore": 155, "training_iteration": 155, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302ae2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302ae488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302ae400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302ae378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-04-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 969.1461955130366, "outflow_rate_min": 493.2509405449511, "system_level_velocity_max": 18.34565720039714, "cost2_min": -74.79516975344914, "system_level_velocity_min": 11.756082300208288, "cost1_min": 22.745071163884, "cost1_max": 183.90115039094286, "cost2_mean": -63.55262296094721, "discrim_loss": 0.8476241827011108, "cost1_mean": 162.61416474298022, "outflow_rate_mean": 883.0620644743974, "system_level_velocity_mean": 14.43707891522079, "cost2_max": -20.50661679647484}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18412.9686896801, "sampler_perf": {"mean_inference_ms": 7.561785928747969, "mean_processing_ms": 11.092375044817425, "mean_env_wait_ms": 125.08755198662166}, "episodes_this_iter": 23, "episodes_total": 3621, "time_total_s": 18412.9686896801, "episode_reward_max": 399.0645048264414, "episode_reward_mean": 349.58029160915834, "episode_reward_min": 308.0218077413738, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.51601552963257, "timestamp": 1559282765, "episode_len_mean": 325.0, "iterations_since_restore": 156, "training_iteration": 156, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324ea0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-06-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.295205652462, "outflow_rate_min": 842.6765691388758, "system_level_velocity_max": 16.18630689203018, "cost2_min": -68.84514843820445, "system_level_velocity_min": 13.03585284589956, "cost1_min": 157.85909098768596, "cost1_max": 185.2466266110899, "cost2_mean": -63.08143755988491, "discrim_loss": 0.8605610132217407, "cost1_mean": 173.7954567566606, "outflow_rate_mean": 926.4508323714965, "system_level_velocity_mean": 14.84971892788934, "cost2_max": -56.47959633056669}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18522.434963941574, "sampler_perf": {"mean_inference_ms": 7.559211660006914, "mean_processing_ms": 11.101220078218985, "mean_env_wait_ms": 125.05432753487858}, "episodes_this_iter": 22, "episodes_total": 3643, "time_total_s": 18522.434963941574, "episode_reward_max": 406.2971140863374, "episode_reward_mean": 335.77701028567657, "episode_reward_min": 280.88047472015023, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.46627426147461, "timestamp": 1559282875, "episode_len_mean": 325.0, "iterations_since_restore": 157, "training_iteration": 157, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1d08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c17b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1950>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-07-55", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.9635257221893, "outflow_rate_min": 771.7327869988003, "system_level_velocity_max": 15.865041968434685, "cost2_min": -75.15768598438491, "system_level_velocity_min": 11.824745395958324, "cost1_min": 142.16380805339054, "cost1_max": 183.59277418487068, "cost2_mean": -64.02896492480194, "discrim_loss": 0.8518029451370239, "cost1_mean": 169.7748227028267, "outflow_rate_mean": 906.6869806124079, "system_level_velocity_mean": 14.414497094608457, "cost2_max": -58.76776795398047}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18628.53775024414, "sampler_perf": {"mean_inference_ms": 7.559303744316238, "mean_processing_ms": 11.103024728306172, "mean_env_wait_ms": 124.90805000109258}, "episodes_this_iter": 25, "episodes_total": 3668, "time_total_s": 18628.53775024414, "episode_reward_max": 376.6508186273277, "episode_reward_mean": 309.86152620855717, "episode_reward_min": 197.31264661997557, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.10278630256653, "timestamp": 1559282981, "episode_len_mean": 320.28, "iterations_since_restore": 158, "training_iteration": 158, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303247b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-09-41", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.6360578989637, "outflow_rate_min": 780.1048161804381, "system_level_velocity_max": 16.64215064708569, "cost2_min": -75.65615937710251, "system_level_velocity_min": 11.773228932359999, "cost1_min": 123.40000154712672, "cost1_max": 185.38188748444202, "cost2_mean": -65.98558318034185, "discrim_loss": 0.8243331909179688, "cost1_mean": 165.6171983766363, "outflow_rate_mean": 895.4355771017523, "system_level_velocity_mean": 14.281243361500168, "cost2_max": -54.47980687675958}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18729.012321472168, "sampler_perf": {"mean_inference_ms": 7.5588935606018195, "mean_processing_ms": 11.103019076282058, "mean_env_wait_ms": 124.81456360274133}, "episodes_this_iter": 24, "episodes_total": 3692, "time_total_s": 18729.012321472168, "episode_reward_max": 349.2436181101948, "episode_reward_mean": 302.59479127738933, "episode_reward_min": 48.18425016850233, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 100.47457122802734, "timestamp": 1559283082, "episode_len_mean": 312.9166666666667, "iterations_since_restore": 159, "training_iteration": 159, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a0d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a1e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-11-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.0400112600231, "outflow_rate_min": 468.0395315843013, "system_level_velocity_max": 18.149197357841132, "cost2_min": -70.90557309328298, "system_level_velocity_min": 13.116136835210979, "cost1_min": 22.67846634014863, "cost1_max": 185.64708088050037, "cost2_mean": -63.26056257394357, "discrim_loss": 0.8430193662643433, "cost1_mean": 164.7536053921422, "outflow_rate_mean": 892.7452047486132, "system_level_velocity_mean": 14.664912488700368, "cost2_max": -24.250332679452193}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18827.240286827087, "sampler_perf": {"mean_inference_ms": 7.556744408517669, "mean_processing_ms": 11.098076687459312, "mean_env_wait_ms": 124.65983331156275}, "episodes_this_iter": 21, "episodes_total": 3713, "time_total_s": 18827.240286827087, "episode_reward_max": 369.6343390494585, "episode_reward_mean": 335.7306009837027, "episode_reward_min": 307.4576850757003, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 98.22796535491943, "timestamp": 1559283180, "episode_len_mean": 325.0, "iterations_since_restore": 160, "training_iteration": 160, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79304250d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303751e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375f28>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-13-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.2777312235203, "outflow_rate_min": 791.2836290705319, "system_level_velocity_max": 16.087105678522203, "cost2_min": -74.65944537565672, "system_level_velocity_min": 12.06224828531356, "cost1_min": 144.4221532365643, "cost1_max": 185.63228239393726, "cost2_mean": -65.577584752585, "discrim_loss": 0.8237821459770203, "cost1_mean": 173.52038316693864, "outflow_rate_mean": 924.2463051130084, "system_level_velocity_mean": 14.798555542799452, "cost2_max": -60.48236772506027}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 18930.150782823563, "sampler_perf": {"mean_inference_ms": 7.551113834291674, "mean_processing_ms": 11.103977483912265, "mean_env_wait_ms": 124.57745194904713}, "episodes_this_iter": 24, "episodes_total": 3737, "time_total_s": 18930.150782823563, "episode_reward_max": 372.1170835439116, "episode_reward_mean": 334.72748784022406, "episode_reward_min": 301.0391600765288, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 102.91049599647522, "timestamp": 1559283283, "episode_len_mean": 325.0, "iterations_since_restore": 161, "training_iteration": 161, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a6a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-14-43", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.0437529981031, "outflow_rate_min": 838.8771909455302, "system_level_velocity_max": 16.1353389302933, "cost2_min": -70.21886314626491, "system_level_velocity_min": 13.116409518047059, "cost1_min": 156.4848660202081, "cost1_max": 185.44516862281324, "cost2_mean": -64.65146860873598, "discrim_loss": 0.8393446803092957, "cost1_mean": 174.4377110757265, "outflow_rate_mean": 928.1431752470353, "system_level_velocity_mean": 14.863216108205295, "cost2_max": -58.281207670295295}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19038.06044816971, "sampler_perf": {"mean_inference_ms": 7.547723696914211, "mean_processing_ms": 11.088808878206105, "mean_env_wait_ms": 124.45822605677944}, "episodes_this_iter": 23, "episodes_total": 3760, "time_total_s": 19038.06044816971, "episode_reward_max": 370.84555192478, "episode_reward_mean": 327.5232308070054, "episode_reward_min": 287.82822174206376, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.90966534614563, "timestamp": 1559283391, "episode_len_mean": 325.0, "iterations_since_restore": 162, "training_iteration": 162, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303246a8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-16-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.4987890478482, "outflow_rate_min": 789.1565258835733, "system_level_velocity_max": 16.165878553043243, "cost2_min": -75.51327337821479, "system_level_velocity_min": 12.244467641032816, "cost1_min": 148.29931621927562, "cost1_max": 185.77831028381652, "cost2_mean": -66.13246721508443, "discrim_loss": 0.8391464948654175, "cost1_mean": 172.00889824755447, "outflow_rate_mean": 916.6025133203317, "system_level_velocity_mean": 14.580157184540324, "cost2_max": -59.97076066282982}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19145.594567537308, "sampler_perf": {"mean_inference_ms": 7.553605380381878, "mean_processing_ms": 11.086764399571772, "mean_env_wait_ms": 124.40718060761574}, "episodes_this_iter": 22, "episodes_total": 3782, "time_total_s": 19145.594567537308, "episode_reward_max": 351.6267958730459, "episode_reward_mean": 318.7651436783119, "episode_reward_min": 296.18851398304105, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.53411936759949, "timestamp": 1559283499, "episode_len_mean": 325.0, "iterations_since_restore": 163, "training_iteration": 163, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a1e0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a6a8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-18-19", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.0471818975717, "outflow_rate_min": 869.0381454959995, "system_level_velocity_max": 16.21894647832599, "cost2_min": -71.60740281365186, "system_level_velocity_min": 13.296684310736326, "cost1_min": 160.31546406593958, "cost1_max": 186.38739017017483, "cost2_mean": -65.42966010641331, "discrim_loss": 0.8259325623512268, "cost1_mean": 175.3159933643851, "outflow_rate_mean": 932.1998348824274, "system_level_velocity_mean": 14.916003296727803, "cost2_max": -60.24785335014965}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19253.24449467659, "sampler_perf": {"mean_inference_ms": 7.5544173802042, "mean_processing_ms": 11.113520835800772, "mean_env_wait_ms": 124.35368182654878}, "episodes_this_iter": 26, "episodes_total": 3808, "time_total_s": 19253.24449467659, "episode_reward_max": 348.1564141791314, "episode_reward_mean": 294.7748939013467, "episode_reward_min": 40.75180659815669, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.64992713928223, "timestamp": 1559283606, "episode_len_mean": 308.2307692307692, "iterations_since_restore": 164, "training_iteration": 164, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375d08>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79303750d0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-20-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.6727763891766, "outflow_rate_min": 492.0625426222078, "system_level_velocity_max": 17.67802252610265, "cost2_min": -73.48228422195604, "system_level_velocity_min": 13.042564135523923, "cost1_min": 17.78981444799615, "cost1_max": 186.24128034116853, "cost2_mean": -64.02176149146108, "discrim_loss": 0.8397009968757629, "cost1_mean": 166.7055067906347, "outflow_rate_mean": 910.1751315380764, "system_level_velocity_mean": 15.066678669338652, "cost2_max": -18.09175144596863}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19361.971762418747, "sampler_perf": {"mean_inference_ms": 7.553503723057014, "mean_processing_ms": 11.09341471268507, "mean_env_wait_ms": 124.27967794823735}, "episodes_this_iter": 22, "episodes_total": 3830, "time_total_s": 19361.971762418747, "episode_reward_max": 355.58317723311484, "episode_reward_mean": 319.6471966192211, "episode_reward_min": 288.7866709046066, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.72726774215698, "timestamp": 1559283720, "episode_len_mean": 325.0, "iterations_since_restore": 165, "training_iteration": 165, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a9d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034ab70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034aae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034aa60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-22-00", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.182681480361, "outflow_rate_min": 842.0496716599106, "system_level_velocity_max": 16.15027458292336, "cost2_min": -72.04314892028246, "system_level_velocity_min": 12.668192653571221, "cost1_min": 152.66349709810865, "cost1_max": 185.9718773428177, "cost2_mean": -65.43983439258544, "discrim_loss": 0.8113371133804321, "cost1_mean": 173.1934938714386, "outflow_rate_mean": 924.3673820194938, "system_level_velocity_mean": 14.742172399579777, "cost2_max": -60.8534857096907}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19471.651770830154, "sampler_perf": {"mean_inference_ms": 7.557117178114411, "mean_processing_ms": 11.097588676988066, "mean_env_wait_ms": 124.24306857812054}, "episodes_this_iter": 23, "episodes_total": 3853, "time_total_s": 19471.651770830154, "episode_reward_max": 362.69169390015304, "episode_reward_mean": 332.43652013932234, "episode_reward_min": 287.3923957236111, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.68000841140747, "timestamp": 1559283830, "episode_len_mean": 325.0, "iterations_since_restore": 166, "training_iteration": 166, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79303750d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930375d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-23-50", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 984.2335746338074, "outflow_rate_min": 863.1573052057993, "system_level_velocity_max": 16.098339550065138, "cost2_min": -71.15160006242334, "system_level_velocity_min": 13.355576305482257, "cost1_min": 160.26264173030637, "cost1_max": 185.79196881094248, "cost2_mean": -65.56443174859977, "discrim_loss": 0.8259961605072021, "cost1_mean": 176.27121072074416, "outflow_rate_mean": 936.0140057399495, "system_level_velocity_mean": 15.020377018610116, "cost2_max": -60.36719618858754}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19583.474175453186, "sampler_perf": {"mean_inference_ms": 7.55454558244231, "mean_processing_ms": 11.117718698908341, "mean_env_wait_ms": 124.17738446949117}, "episodes_this_iter": 26, "episodes_total": 3879, "time_total_s": 19583.474175453186, "episode_reward_max": 366.8974597863853, "episode_reward_mean": 306.8220170060746, "episode_reward_min": 40.85972394794226, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.82240462303162, "timestamp": 1559283942, "episode_len_mean": 312.46153846153845, "iterations_since_restore": 167, "training_iteration": 167, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b49d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4b70>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4ae8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-25-42", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.4428807300103, "outflow_rate_min": 431.75782487237836, "system_level_velocity_max": 16.68701838383305, "cost2_min": -75.18339376861039, "system_level_velocity_min": 12.110763336494918, "cost1_min": 17.542841458235348, "cost1_max": 186.35549385409968, "cost2_mean": -63.08787127641635, "discrim_loss": 0.8291246891021729, "cost1_mean": 167.96800905083865, "outflow_rate_mean": 909.3296853820646, "system_level_velocity_mean": 14.965482392760276, "cost2_max": -21.448719367454796}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19692.378492116928, "sampler_perf": {"mean_inference_ms": 7.55277111893277, "mean_processing_ms": 11.099427530241535, "mean_env_wait_ms": 124.07785036072507}, "episodes_this_iter": 22, "episodes_total": 3901, "time_total_s": 19692.378492116928, "episode_reward_max": 348.46387229766697, "episode_reward_mean": 316.14946485494943, "episode_reward_min": 226.56394620612264, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.90431666374207, "timestamp": 1559284051, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 168, "training_iteration": 168, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324378>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-27-31", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 991.048440971713, "outflow_rate_min": 759.197762165524, "system_level_velocity_max": 16.200032215034888, "cost2_min": -74.04098773347506, "system_level_velocity_min": 12.365341270917844, "cost1_min": 113.14501490208413, "cost1_max": 186.2785262010774, "cost2_mean": -63.53584479458416, "discrim_loss": 0.8172281980514526, "cost1_mean": 166.94197992914076, "outflow_rate_mean": 901.0305449385454, "system_level_velocity_mean": 14.372672492975193, "cost2_max": -55.84487373454306}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19798.464678525925, "sampler_perf": {"mean_inference_ms": 7.554661003169399, "mean_processing_ms": 11.098220048737003, "mean_env_wait_ms": 124.00599164032766}, "episodes_this_iter": 23, "episodes_total": 3924, "time_total_s": 19798.464678525925, "episode_reward_max": 346.09120535152033, "episode_reward_mean": 306.73616151404366, "episode_reward_min": 276.66610417328775, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.08618640899658, "timestamp": 1559284157, "episode_len_mean": 325.0, "iterations_since_restore": 169, "training_iteration": 169, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c21e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c20d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-29-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.3411843651879, "outflow_rate_min": 850.0130845478255, "system_level_velocity_max": 16.190132806534134, "cost2_min": -69.16824066406451, "system_level_velocity_min": 13.115346896472452, "cost1_min": 155.85088352004237, "cost1_max": 185.89673502747738, "cost2_mean": -64.085362885938, "discrim_loss": 0.8266191482543945, "cost1_mean": 171.7122457969464, "outflow_rate_mean": 915.4364905722372, "system_level_velocity_mean": 14.603118486399415, "cost2_max": -60.11498124938865}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 19911.86670899391, "sampler_perf": {"mean_inference_ms": 7.555201328933028, "mean_processing_ms": 11.10457560227737, "mean_env_wait_ms": 123.9324597299584}, "episodes_this_iter": 24, "episodes_total": 3948, "time_total_s": 19911.86670899391, "episode_reward_max": 390.47720846999437, "episode_reward_mean": 334.1646511802489, "episode_reward_min": 287.5171119328588, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 113.40203046798706, "timestamp": 1559284271, "episode_len_mean": 325.0, "iterations_since_restore": 170, "training_iteration": 170, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324950>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-31-11", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.602203796312, "outflow_rate_min": 790.4949477512246, "system_level_velocity_max": 16.178596376242595, "cost2_min": -74.33214783778352, "system_level_velocity_min": 12.19200091020389, "cost1_min": 147.78488719390316, "cost1_max": 185.81809974369958, "cost2_mean": -65.29748778038915, "discrim_loss": 0.8063522577285767, "cost1_mean": 169.74932377582016, "outflow_rate_mean": 906.7639401963985, "system_level_velocity_mean": 14.416031993405468, "cost2_max": -61.072545681896585}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20022.85069179535, "sampler_perf": {"mean_inference_ms": 7.548115472036952, "mean_processing_ms": 11.110624488930714, "mean_env_wait_ms": 123.90046607777606}, "episodes_this_iter": 23, "episodes_total": 3971, "time_total_s": 20022.85069179535, "episode_reward_max": 369.7876414731145, "episode_reward_mean": 334.83062432908815, "episode_reward_min": 253.63957016915083, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 110.98398280143738, "timestamp": 1559284382, "episode_len_mean": 318.6521739130435, "iterations_since_restore": 171, "training_iteration": 171, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c26a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2620>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2598>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-33-02", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.2199352535401, "outflow_rate_min": 761.2323068149648, "system_level_velocity_max": 16.257376232981468, "cost2_min": -69.49232284739621, "system_level_velocity_min": 13.152368193186028, "cost1_min": 112.2648058473132, "cost1_max": 186.66454041104518, "cost2_mean": -63.26101480003523, "discrim_loss": 0.8222916126251221, "cost1_mean": 169.51297572067938, "outflow_rate_mean": 913.4676409245519, "system_level_velocity_mean": 14.682134475027093, "cost2_max": -60.17609709069243}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20130.265711545944, "sampler_perf": {"mean_inference_ms": 7.553536746496329, "mean_processing_ms": 11.094781269526457, "mean_env_wait_ms": 123.83582209038295}, "episodes_this_iter": 22, "episodes_total": 3993, "time_total_s": 20130.265711545944, "episode_reward_max": 357.6761948298663, "episode_reward_mean": 320.3196646084755, "episode_reward_min": 281.4908892326057, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.41501975059509, "timestamp": 1559284489, "episode_len_mean": 325.0, "iterations_since_restore": 172, "training_iteration": 172, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375ae8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-34-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.0779818050398, "outflow_rate_min": 859.8374161103244, "system_level_velocity_max": 16.104888517170224, "cost2_min": -71.41156881704384, "system_level_velocity_min": 13.063077708955754, "cost1_min": 156.83476173075212, "cost1_max": 185.19186580965714, "cost2_mean": -65.36861565993777, "discrim_loss": 0.8073890209197998, "cost1_mean": 170.52712056912696, "outflow_rate_mean": 910.348234757061, "system_level_velocity_mean": 14.43430508669852, "cost2_max": -60.2244231032612}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20246.401262044907, "sampler_perf": {"mean_inference_ms": 7.551935240625761, "mean_processing_ms": 11.104386653838846, "mean_env_wait_ms": 123.75068194236778}, "episodes_this_iter": 25, "episodes_total": 4018, "time_total_s": 20246.401262044907, "episode_reward_max": 387.5005131997168, "episode_reward_mean": 314.5224405647069, "episode_reward_min": 258.9761960543692, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 116.1355504989624, "timestamp": 1559284605, "episode_len_mean": 323.88, "iterations_since_restore": 173, "training_iteration": 173, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c20d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2158>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c21e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-36-45", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.6425227734256, "outflow_rate_min": 775.4670647890348, "system_level_velocity_max": 16.3508754944219, "cost2_min": -77.58753355680355, "system_level_velocity_min": 11.759977830765672, "cost1_min": 141.6035544840927, "cost1_max": 186.7559554450452, "cost2_mean": -66.92761391842099, "discrim_loss": 0.7933743596076965, "cost1_mean": 172.0028622285198, "outflow_rate_mean": 920.2538295187842, "system_level_velocity_mean": 14.643752052481133, "cost2_max": -61.807100063020094}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20355.767370700836, "sampler_perf": {"mean_inference_ms": 7.547728284983281, "mean_processing_ms": 11.113937680938118, "mean_env_wait_ms": 123.7609126591676}, "episodes_this_iter": 23, "episodes_total": 4041, "time_total_s": 20355.767370700836, "episode_reward_max": 340.2060470599681, "episode_reward_mean": 304.44752759117955, "episode_reward_min": 277.12223663181067, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.36610865592957, "timestamp": 1559284715, "episode_len_mean": 325.0, "iterations_since_restore": 174, "training_iteration": 174, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303246a8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324b70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930324ae8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-38-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.675769296791, "outflow_rate_min": 865.8298090538701, "system_level_velocity_max": 16.157779386921852, "cost2_min": -72.39781637010742, "system_level_velocity_min": 13.068414058289337, "cost1_min": 156.74653398474675, "cost1_max": 186.46481342418917, "cost2_mean": -66.13793840620485, "discrim_loss": 0.8060472011566162, "cost1_mean": 174.47499499042095, "outflow_rate_mean": 928.7679863584215, "system_level_velocity_mean": 14.828554665619334, "cost2_max": -61.61680110150532}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20462.43148779869, "sampler_perf": {"mean_inference_ms": 7.550143494450349, "mean_processing_ms": 11.096215594499599, "mean_env_wait_ms": 123.65952786859685}, "episodes_this_iter": 22, "episodes_total": 4063, "time_total_s": 20462.43148779869, "episode_reward_max": 375.8332725642249, "episode_reward_mean": 310.54588486436245, "episode_reward_min": 202.625506516546, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.66411709785461, "timestamp": 1559284821, "episode_len_mean": 319.6363636363636, "iterations_since_restore": 175, "training_iteration": 175, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c26a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2598>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2510>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2620>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-40-21", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.5026347229139, "outflow_rate_min": 809.4365360487363, "system_level_velocity_max": 16.584824205696922, "cost2_min": -78.02197054625725, "system_level_velocity_min": 12.374924357520388, "cost1_min": 123.38813487943408, "cost1_max": 186.21800534973204, "cost2_mean": -65.75984776115514, "discrim_loss": 0.7878018617630005, "cost1_mean": 171.40803544224053, "outflow_rate_mean": 920.9055986129614, "system_level_velocity_mean": 14.842894413335356, "cost2_max": -54.49226128452135}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20567.614468336105, "sampler_perf": {"mean_inference_ms": 7.5471379232474645, "mean_processing_ms": 11.102025915852463, "mean_env_wait_ms": 123.58967360980809}, "episodes_this_iter": 22, "episodes_total": 4085, "time_total_s": 20567.614468336105, "episode_reward_max": 361.4886228768155, "episode_reward_mean": 321.2473958804145, "episode_reward_min": 290.5357004031539, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 105.18298053741455, "timestamp": 1559284927, "episode_len_mean": 325.0, "iterations_since_restore": 176, "training_iteration": 176, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303249d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324c80>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303241e0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-42-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.9916726715575, "outflow_rate_min": 809.530003299616, "system_level_velocity_max": 16.154015497282586, "cost2_min": -77.07666726923536, "system_level_velocity_min": 12.342647171426005, "cost1_min": 148.48617076962358, "cost1_max": 186.57451446901499, "cost2_mean": -65.93204494870238, "discrim_loss": 0.8016439080238342, "cost1_mean": 171.67639884933553, "outflow_rate_mean": 916.9074354573386, "system_level_velocity_mean": 14.543609494812438, "cost2_max": -62.151518305677115}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20679.2565305233, "sampler_perf": {"mean_inference_ms": 7.548852915780882, "mean_processing_ms": 11.105284337294135, "mean_env_wait_ms": 123.52007931453903}, "episodes_this_iter": 26, "episodes_total": 4111, "time_total_s": 20679.2565305233, "episode_reward_max": 392.2760059069842, "episode_reward_mean": 326.7492045344642, "episode_reward_min": 277.6128875091672, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 111.64206218719482, "timestamp": 1559285038, "episode_len_mean": 325.0, "iterations_since_restore": 177, "training_iteration": 177, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034a6a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034ab70>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034ad08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-43-58", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 993.6474841215129, "outflow_rate_min": 774.9979916412926, "system_level_velocity_max": 16.247412383882644, "cost2_min": -78.79213673763897, "system_level_velocity_min": 11.725637294099698, "cost1_min": 140.94588931419582, "cost1_max": 186.51717920518095, "cost2_mean": -66.81617224165494, "discrim_loss": 0.8066237568855286, "cost1_mean": 170.3839359623113, "outflow_rate_mean": 911.8814305221184, "system_level_velocity_mean": 14.421386342977343, "cost2_max": -61.03776409980807}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20786.483658075333, "sampler_perf": {"mean_inference_ms": 7.543333316058075, "mean_processing_ms": 11.104600797303979, "mean_env_wait_ms": 123.45688248389784}, "episodes_this_iter": 21, "episodes_total": 4132, "time_total_s": 20786.483658075333, "episode_reward_max": 350.1263210568577, "episode_reward_mean": 314.07288169089173, "episode_reward_min": 283.75147398747504, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.22712755203247, "timestamp": 1559285146, "episode_len_mean": 325.0, "iterations_since_restore": 178, "training_iteration": 178, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b42f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b48c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4840>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4400>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-45-46", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.2504723777561, "outflow_rate_min": 872.7962973716723, "system_level_velocity_max": 16.23685873986941, "cost2_min": -71.73731749190944, "system_level_velocity_min": 13.399186709254735, "cost1_min": 160.43885855071838, "cost1_max": 186.43841138025044, "cost2_mean": -64.38832527747871, "discrim_loss": 0.7904245257377625, "cost1_mean": 178.65271876761457, "outflow_rate_mean": 948.4997067546461, "system_level_velocity_mean": 15.277669069999062, "cost2_max": -60.15842375495012}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20894.943880081177, "sampler_perf": {"mean_inference_ms": 7.544328571840882, "mean_processing_ms": 11.102086843271245, "mean_env_wait_ms": 123.41786566614591}, "episodes_this_iter": 23, "episodes_total": 4155, "time_total_s": 20894.943880081177, "episode_reward_max": 362.5889781578444, "episode_reward_mean": 300.04891968793845, "episode_reward_min": 250.8797001838684, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.46022200584412, "timestamp": 1559285254, "episode_len_mean": 325.0, "iterations_since_restore": 179, "training_iteration": 179, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f793034aae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f793034a2f0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f793034a9d8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f793034a378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-47-34", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 990.4467364057153, "outflow_rate_min": 765.3983795960654, "system_level_velocity_max": 16.180077069626858, "cost2_min": -77.1864612922283, "system_level_velocity_min": 11.79608546287157, "cost1_min": 142.93770460202117, "cost1_max": 186.1596238880747, "cost2_mean": -65.14972208124402, "discrim_loss": 0.8145928382873535, "cost1_mean": 173.10234398620915, "outflow_rate_mean": 921.5010020398983, "system_level_velocity_mean": 14.713135747627684, "cost2_max": -60.37730363653746}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 20996.94373369217, "sampler_perf": {"mean_inference_ms": 7.543904768078513, "mean_processing_ms": 11.10264266095599, "mean_env_wait_ms": 123.31627429018636}, "episodes_this_iter": 25, "episodes_total": 4180, "time_total_s": 20996.94373369217, "episode_reward_max": 328.13775691203773, "episode_reward_mean": 298.3242589206062, "episode_reward_min": 262.2831543907523, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 101.99985361099243, "timestamp": 1559285356, "episode_len_mean": 325.0, "iterations_since_restore": 180, "training_iteration": 180, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930324a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930324510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930324bf8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303247b8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-49-16", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.5855995977523, "outflow_rate_min": 854.4895532347373, "system_level_velocity_max": 16.171916404764637, "cost2_min": -71.53213084454154, "system_level_velocity_min": 13.231489271791522, "cost1_min": 159.53836482303058, "cost1_max": 186.39485361349244, "cost2_mean": -65.99872063587877, "discrim_loss": 0.7843214273452759, "cost1_mean": 173.2326759344755, "outflow_rate_mean": 921.393104735567, "system_level_velocity_mean": 14.715926553230767, "cost2_max": -61.29600556766766}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21104.134277820587, "sampler_perf": {"mean_inference_ms": 7.5438846714266, "mean_processing_ms": 11.107492989482298, "mean_env_wait_ms": 123.22752630911833}, "episodes_this_iter": 22, "episodes_total": 4202, "time_total_s": 21104.134277820587, "episode_reward_max": 371.43425193149596, "episode_reward_mean": 328.60368758605114, "episode_reward_min": 295.2625859361142, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.19054412841797, "timestamp": 1559285464, "episode_len_mean": 325.0, "iterations_since_restore": 181, "training_iteration": 181, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f7930375d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f7930375488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930375598>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79303750d0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-51-04", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 992.1813529104973, "outflow_rate_min": 870.032234376607, "system_level_velocity_max": 16.24025293684175, "cost2_min": -69.23485677227418, "system_level_velocity_min": 13.344453113920908, "cost1_min": 160.59699742507885, "cost1_max": 186.3822375397104, "cost2_mean": -63.911232724126606, "discrim_loss": 0.7958548069000244, "cost1_mean": 177.78932944342395, "outflow_rate_mean": 943.9208836659382, "system_level_velocity_mean": 15.20328078491063, "cost2_max": -58.91649684579821}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21216.464832544327, "sampler_perf": {"mean_inference_ms": 7.544388951752711, "mean_processing_ms": 11.105930364448417, "mean_env_wait_ms": 123.2409625265717}, "episodes_this_iter": 23, "episodes_total": 4225, "time_total_s": 21216.464832544327, "episode_reward_max": 360.8578363163397, "episode_reward_mean": 324.7730876084255, "episode_reward_min": 279.8524226844311, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 112.33055472373962, "timestamp": 1559285576, "episode_len_mean": 325.0, "iterations_since_restore": 182, "training_iteration": 182, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b41e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b4048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4e18>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4268>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-52-56", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.799952700072, "outflow_rate_min": 803.7794185048832, "system_level_velocity_max": 16.167986024801255, "cost2_min": -76.5353598811589, "system_level_velocity_min": 12.2693015296856, "cost1_min": 147.12407320123546, "cost1_max": 185.9865805751727, "cost2_mean": -65.59469020352068, "discrim_loss": 0.7969647645950317, "cost1_mean": 172.59223765371934, "outflow_rate_mean": 919.6872594471391, "system_level_velocity_mean": 14.662842675239178, "cost2_max": -59.26731305488295}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21319.027636766434, "sampler_perf": {"mean_inference_ms": 7.546781373524329, "mean_processing_ms": 11.105980250601101, "mean_env_wait_ms": 123.11651542869747}, "episodes_this_iter": 24, "episodes_total": 4249, "time_total_s": 21319.027636766434, "episode_reward_max": 337.47036790754646, "episode_reward_mean": 302.1131696373923, "episode_reward_min": 262.4913673363626, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 102.56280422210693, "timestamp": 1559285679, "episode_len_mean": 325.0, "iterations_since_restore": 183, "training_iteration": 183, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b92f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b9488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b9400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b9378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-54-39", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.6119446566034, "outflow_rate_min": 807.233360731611, "system_level_velocity_max": 16.18894100919138, "cost2_min": -71.24667839671486, "system_level_velocity_min": 12.288170910353342, "cost1_min": 146.9764120680098, "cost1_max": 185.7636574216558, "cost2_mean": -65.01589857178323, "discrim_loss": 0.7823667526245117, "cost1_mean": 172.47753586087057, "outflow_rate_mean": 922.4016916493825, "system_level_velocity_mean": 14.694132800432058, "cost2_max": -57.671164788473035}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21427.155516147614, "sampler_perf": {"mean_inference_ms": 7.54155448673207, "mean_processing_ms": 11.108710354420827, "mean_env_wait_ms": 123.05750270720287}, "episodes_this_iter": 23, "episodes_total": 4272, "time_total_s": 21427.155516147614, "episode_reward_max": 327.3892104001716, "episode_reward_mean": 291.942961036997, "episode_reward_min": 227.64976193755865, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 108.12787938117981, "timestamp": 1559285788, "episode_len_mean": 319.8695652173913, "iterations_since_restore": 184, "training_iteration": 184, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b46a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303658c8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b4950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b4488>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-56-28", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 986.8305541468686, "outflow_rate_min": 760.4851372675888, "system_level_velocity_max": 16.201166310158158, "cost2_min": -70.27182664277036, "system_level_velocity_min": 12.930308644258291, "cost1_min": 112.13033225125015, "cost1_max": 186.12276020372818, "cost2_mean": -65.31676044254391, "discrim_loss": 0.7956050038337708, "cost1_mean": 167.08108166455176, "outflow_rate_mean": 898.9795345832775, "system_level_velocity_mean": 14.363015983585827, "cost2_max": -60.51468259176499}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21536.37881040573, "sampler_perf": {"mean_inference_ms": 7.540707792193222, "mean_processing_ms": 11.09618789815835, "mean_env_wait_ms": 123.02462913963205}, "episodes_this_iter": 23, "episodes_total": 4295, "time_total_s": 21536.37881040573, "episode_reward_max": 372.16742337308824, "episode_reward_mean": 311.0784199401615, "episode_reward_min": 51.026590287685394, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.22329425811768, "timestamp": 1559285897, "episode_len_mean": 307.2608695652174, "iterations_since_restore": 185, "training_iteration": 185, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c10d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c11e0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1158>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_06-58-17", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 989.7376108416521, "outflow_rate_min": 462.43348918263234, "system_level_velocity_max": 18.191355921635115, "cost2_min": -72.22885903382353, "system_level_velocity_min": 12.495974222041273, "cost1_min": 22.73969415909582, "cost1_max": 185.8885892468353, "cost2_mean": -62.638183316974974, "discrim_loss": 0.7831388711929321, "cost1_mean": 163.12691352952555, "outflow_rate_mean": 892.590958573625, "system_level_velocity_mean": 14.805682174658658, "cost2_max": -24.366056752413577}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21644.08802819252, "sampler_perf": {"mean_inference_ms": 7.541504165962025, "mean_processing_ms": 11.119856466583101, "mean_env_wait_ms": 122.96944472474627}, "episodes_this_iter": 25, "episodes_total": 4320, "time_total_s": 21644.08802819252, "episode_reward_max": 355.29098526295274, "episode_reward_mean": 315.0492326546833, "episode_reward_min": 281.5567487422377, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.70921778678894, "timestamp": 1559286005, "episode_len_mean": 323.88, "iterations_since_restore": 186, "training_iteration": 186, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c26a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2e18>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2f28>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2ea0>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-00-05", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 991.1655169840047, "outflow_rate_min": 826.3429879969557, "system_level_velocity_max": 16.24826288546544, "cost2_min": -69.02988290699996, "system_level_velocity_min": 12.914304032119997, "cost1_min": 147.47792095307642, "cost1_max": 186.42527881408714, "cost2_mean": -64.05971837069727, "discrim_loss": 0.7927545309066772, "cost1_mean": 174.07461083032922, "outflow_rate_mean": 925.9248044309556, "system_level_velocity_mean": 14.880013979032832, "cost2_max": -59.16707777289137}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21751.24464726448, "sampler_perf": {"mean_inference_ms": 7.543564433835912, "mean_processing_ms": 11.119376347523561, "mean_env_wait_ms": 122.88440949862576}, "episodes_this_iter": 23, "episodes_total": 4343, "time_total_s": 21751.24464726448, "episode_reward_max": 378.0149996820837, "episode_reward_mean": 293.53643887763354, "episode_reward_min": 217.23134257644415, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 107.15661907196045, "timestamp": 1559286112, "episode_len_mean": 317.4347826086956, "iterations_since_restore": 187, "training_iteration": 187, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c1d90>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1d08>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1bf8>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-01-52", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 971.9096139599379, "outflow_rate_min": 756.761030488583, "system_level_velocity_max": 15.90171325576748, "cost2_min": -73.71661044480578, "system_level_velocity_min": 12.238627636476265, "cost1_min": 112.45608346473965, "cost1_max": 182.98090741018888, "cost2_mean": -63.36074381778747, "discrim_loss": 0.7883378267288208, "cost1_mean": 167.39269266133692, "outflow_rate_mean": 901.0381516716132, "system_level_velocity_mean": 14.582331219420608, "cost2_max": -58.42670239312336}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21857.428795337677, "sampler_perf": {"mean_inference_ms": 7.538974948601777, "mean_processing_ms": 11.097393201720376, "mean_env_wait_ms": 122.86113900501377}, "episodes_this_iter": 23, "episodes_total": 4366, "time_total_s": 21857.428795337677, "episode_reward_max": 315.31398090161383, "episode_reward_mean": 292.3168307655572, "episode_reward_min": 261.7754842489958, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 106.18414807319641, "timestamp": 1559286218, "episode_len_mean": 325.0, "iterations_since_restore": 188, "training_iteration": 188, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2d08>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-03-38", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 980.8927915034437, "outflow_rate_min": 856.6648761187429, "system_level_velocity_max": 16.15189227003529, "cost2_min": -68.43611985087489, "system_level_velocity_min": 13.26946382193427, "cost1_min": 157.94672676610347, "cost1_max": 185.5158951178351, "cost2_mean": -61.966108949110804, "discrim_loss": 0.7767907977104187, "cost1_mean": 174.58658476495575, "outflow_rate_mean": 927.970585853388, "system_level_velocity_mean": 14.934699860173646, "cost2_max": -57.56375220383537}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 21961.370572566986, "sampler_perf": {"mean_inference_ms": 7.5429817703968975, "mean_processing_ms": 11.114180695063856, "mean_env_wait_ms": 122.74290818792734}, "episodes_this_iter": 23, "episodes_total": 4389, "time_total_s": 21961.370572566986, "episode_reward_max": 367.5724021336064, "episode_reward_mean": 311.5168591913686, "episode_reward_min": 287.336130829528, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 103.94177722930908, "timestamp": 1559286322, "episode_len_mean": 325.0, "iterations_since_restore": 189, "training_iteration": 189, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79304250d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302be048>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930425268>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930425048>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-05-22", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 982.633231241298, "outflow_rate_min": 765.0351104311162, "system_level_velocity_max": 16.040028659636615, "cost2_min": -75.61049353877573, "system_level_velocity_min": 11.079364061247931, "cost1_min": 135.00202264842795, "cost1_max": 185.42010962803192, "cost2_mean": -63.76129558619257, "discrim_loss": 0.8012698888778687, "cost1_mean": 169.4893462575925, "outflow_rate_mean": 905.1849258520509, "system_level_velocity_mean": 14.422129119049576, "cost2_max": -60.062788855379466}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22065.585909366608, "sampler_perf": {"mean_inference_ms": 7.540640237129208, "mean_processing_ms": 11.122242067742386, "mean_env_wait_ms": 122.68729496535582}, "episodes_this_iter": 24, "episodes_total": 4413, "time_total_s": 22065.585909366608, "episode_reward_max": 324.978577288799, "episode_reward_mean": 296.8875668522863, "episode_reward_min": 257.84725470654666, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 104.21533679962158, "timestamp": 1559286427, "episode_len_mean": 325.0, "iterations_since_restore": 190, "training_iteration": 190, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c28c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2510>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c2488>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2730>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-07-07", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 987.1928764905557, "outflow_rate_min": 842.6607492272411, "system_level_velocity_max": 16.30351092953369, "cost2_min": -65.86453615182022, "system_level_velocity_min": 13.097406293228033, "cost1_min": 155.7686207694218, "cost1_max": 185.82916671311483, "cost2_mean": -61.81854633798307, "discrim_loss": 0.7783783078193665, "cost1_mean": 172.34044204389292, "outflow_rate_mean": 917.3805545730196, "system_level_velocity_mean": 14.716947030196017, "cost2_max": -57.887249954546036}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22167.805598258972, "sampler_perf": {"mean_inference_ms": 7.538273247940774, "mean_processing_ms": 11.101878235015922, "mean_env_wait_ms": 122.61312147642158}, "episodes_this_iter": 20, "episodes_total": 4433, "time_total_s": 22167.805598258972, "episode_reward_max": 305.9019200289622, "episode_reward_mean": 273.11406031423246, "episode_reward_min": 249.26708463393152, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 102.2196888923645, "timestamp": 1559286529, "episode_len_mean": 325.0, "iterations_since_restore": 191, "training_iteration": 191, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c1e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c10d0>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c1ea0>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c1a60>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-08-49", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 985.3016813787679, "outflow_rate_min": 840.5365676533143, "system_level_velocity_max": 16.148257747445864, "cost2_min": -67.385122529843, "system_level_velocity_min": 13.277264215697693, "cost1_min": 158.7531365162429, "cost1_max": 185.54069933877796, "cost2_mean": -61.386782038257266, "discrim_loss": 0.759513258934021, "cost1_mean": 178.06605428208104, "outflow_rate_mean": 943.0528837822106, "system_level_velocity_mean": 15.303624461788562, "cost2_max": -54.76609473356932}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22273.456662893295, "sampler_perf": {"mean_inference_ms": 7.537980598571935, "mean_processing_ms": 11.102407976811204, "mean_env_wait_ms": 122.53801647974835}, "episodes_this_iter": 26, "episodes_total": 4459, "time_total_s": 22273.456662893295, "episode_reward_max": 417.20242642611265, "episode_reward_mean": 315.38557289999267, "episode_reward_min": 188.08005909994245, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 105.65106463432312, "timestamp": 1559286635, "episode_len_mean": 320.46153846153845, "iterations_since_restore": 192, "training_iteration": 192, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79303659d8>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f7930365950>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f7930365840>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-10-35", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 979.6588929036936, "outflow_rate_min": 776.6893306412351, "system_level_velocity_max": 16.587125138793827, "cost2_min": -75.60997579077538, "system_level_velocity_min": 11.812376095880857, "cost1_min": 122.83647189069532, "cost1_max": 184.8512844602162, "cost2_mean": -63.163835282220596, "discrim_loss": 0.7794793844223022, "cost1_mean": 164.27118212180483, "outflow_rate_mean": 886.0040176847425, "system_level_velocity_mean": 14.131888334323035, "cost2_max": -53.61563612423764}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22373.383919000626, "sampler_perf": {"mean_inference_ms": 7.535567536044861, "mean_processing_ms": 11.112316839748557, "mean_env_wait_ms": 122.41204813634137}, "episodes_this_iter": 24, "episodes_total": 4483, "time_total_s": 22373.383919000626, "episode_reward_max": 348.8054148852825, "episode_reward_mean": 312.5644698436954, "episode_reward_min": 220.74920142441988, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 99.92725610733032, "timestamp": 1559286735, "episode_len_mean": 315.1666666666667, "iterations_since_restore": 193, "training_iteration": 193, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302b92f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302b9488>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302b9400>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302b9378>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-12-15", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 988.0190178447458, "outflow_rate_min": 764.4082352958433, "system_level_velocity_max": 16.499976840334448, "cost2_min": -68.83591675877071, "system_level_velocity_min": 13.238846514685765, "cost1_min": 113.60031874588256, "cost1_max": 185.57574792642703, "cost2_mean": -62.40082028557409, "discrim_loss": 0.7768968343734741, "cost1_mean": 166.57183142859617, "outflow_rate_mean": 900.9072517628025, "system_level_velocity_mean": 14.622790593048563, "cost2_max": -55.9776986171233}}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "time_since_restore": 22483.10382580757, "sampler_perf": {"mean_inference_ms": 7.536137397262683, "mean_processing_ms": 11.101271723867859, "mean_env_wait_ms": 122.39729042963499}, "episodes_this_iter": 20, "episodes_total": 4503, "time_total_s": 22483.10382580757, "episode_reward_max": 321.27107088873163, "episode_reward_mean": 279.2358308432391, "episode_reward_min": 220.9533108845353, "off_policy_estimator": {}, "pid": 7156, "experiment_id": "c9cf1d39a15a4cc5b3e8332a64ce725b", "done": false, "time_this_iter_s": 109.7199068069458, "timestamp": 1559286846, "episode_len_mean": 319.1, "iterations_since_restore": 194, "training_iteration": 194, "node_ip": "10.138.0.2", "timesteps_total": null, "hostname": "flow-main", "config": {"discrim_hidden_size": 128, "lr_schedule": null, "num_envs_per_worker": 1, "model": {"custom_options": {}, "fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "zero_mean": true, "framestack": true, "dim": 84, "lstm_use_prev_action_reward": false, "use_lstm": false, "lstm_cell_size": 256, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false}, "optimizer": {}, "log_level": "INFO", "vf_share_layers": false, "simple_optimizer": false, "grad_clip": null, "custom_resources_per_worker": {}, "remote_worker_envs": false, "compress_observations": false, "horizon": 750, "remote_env_batch_wait_ms": 0, "batch_mode": "truncate_episodes", "gamma": 0.99, "num_workers": 10, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_sgd_iter": 10, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "lr": 0.0005, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "metrics_smoothing_episodes": 100, "soft_horizon": false, "clip_actions": false, "expert_path": "/headless/rl_project/flow_codes/InverseRL/expert_sample", "kl_target": 0.01, "clip_rewards": null, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "collect_metrics_timeout": 180, "lambda": 0.97, "sample_async": false, "postprocess_inputs": false, "clip_param": 0.3, "synchronize_filters": true, "multiagent": {"policy_mapping_fn": "tune.function(<function main.<locals>.<lambda> at 0x7f79302c2620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}, "policies_to_train": ["default_policy"]}, "input_evaluation": ["is", "wis"], "kl_coeff": 0.2, "ignore_worker_failures": false, "sample_batch_size": 750, "env": "MultiWaveAttenuationMergePOEnvGAIL-v0", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "train_batch_size": 7500, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvGAIL\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "discrim_lr": 0.01, "shuffle_buffer_size": 0, "input": "sampler", "callbacks": {"on_sample_end": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f79302c2268>)", "on_train_result": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f79302c27b8>)", "on_postprocess_traj": null, "on_episode_end": "tune.function(<function on_episode_end at 0x7f79302c2d90>)"}, "straggler_mitigation": false, "num_gpus": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_clip_param": 1000000.0, "monitor": false, "num_cpus_per_worker": 1}, "date": "2019-05-31_07-14-06", "timesteps_since_restore": 0, "custom_metrics": {"outflow_rate_max": 983.3683822743924, "outflow_rate_min": 764.1777917444285, "system_level_velocity_max": 16.123755309636103, "cost2_min": -70.62153469572553, "system_level_velocity_min": 12.034777798194494, "cost1_min": 112.45752837735213, "cost1_max": 185.23881464823705, "cost2_mean": -63.99562228938667, "discrim_loss": 0.7705655694007874, "cost1_mean": 166.58836764928657, "outflow_rate_mean": 897.3483471166552, "system_level_velocity_mean": 14.40334168657601, "cost2_max": -59.40132131528112}}
